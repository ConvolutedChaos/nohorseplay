import { dom as Gg, requireDropdownContext as Xo, DropdownContext as Cy, DropdownProvider as $y, position as yh, requireContext as Ir, uuidv4 as Cr, createProxySignal as Ie, toast as Qt, debounce as qa, delay as Ls, loadTranslations as Ey, registerServerMessage as Fg, Color as Vg, transformImagePath as ed, SolidFrameworkContext as Ty, SolidFramework as Ay, date as fe, ExposeInternals as ky, rootWindow as bh, HSLColor as Hn, customElement as Te } from "./common.bundle.js";
import { sharedConfig as Sn, createRenderEffect as R, untrack as js, getOwner as wh, createEffect as Z, runWithOwner as Iy, createMemo as P, createSignal as I, createRoot as td, onCleanup as Gn, splitProps as Wr, $PROXY as Xi, $TRACK as _h, getListener as Zc, batch as Hg, children as us, onMount as jt, createComponent as h, Show as B, mergeProps as Xt, createContext as bt, useContext as Nt, For as de, Switch as Zt, Match as Pe, on as Tr, createResource as Oy, Suspense as Dy, createUniqueId as Ly, Index as gc } from "./solid.bundle.js";
import { extractDataEditor as Ql, queryEditor as zg, STQueryConditionContainer as Ny, QBDisplayType as go, QBAltCodeType as Ti, ColumnAggregateType as Wi, QBBreakType as wl, dataSourceEditor as Py, koDataSourceEditor as Sh, reportBrowser as _r, memoGeneratorBtn as Kl, WritingStyle as Wg, aiLoaderTranslations as Ry, Verbosity as ai, VoiceTone as Yl, VoiceAttitude as Xl, smGenerator as My, ViewDefinition as qy, personNotifications as nd, collaborativeEdit as Oi, supportAssist as rd, GridRowData as By, grid as Jg, findResultPanel as Uy, gridGeneratorBtn as Zl, iacMenu as jy, JobState as cr, jobQueueStatus as _l, ReportExportFilterType as ar, QueryPreview as ea, queryAssist as To, Recur as Gy, DateStatus as pc, scheduleGrid as xh, UserFilterGroupInfo as Qg, RevCollectionData as Fy, UserFilterObj as Vy, viewFilters as Un, CheckListPreference as Hy } from "./st.api.bundle.js";
const zy = ["allowfullscreen", "async", "autofocus", "autoplay", "checked", "controls", "default", "disabled", "formnovalidate", "hidden", "indeterminate", "inert", "ismap", "loop", "multiple", "muted", "nomodule", "novalidate", "open", "playsinline", "readonly", "required", "reversed", "seamless", "selected"], Wy = /* @__PURE__ */ new Set(["className", "value", "readOnly", "formNoValidate", "isMap", "noModule", "playsInline", ...zy]), Jy = /* @__PURE__ */ new Set(["innerHTML", "textContent", "innerText", "children"]), Qy = /* @__PURE__ */ Object.assign(/* @__PURE__ */ Object.create(null), {
  className: "class",
  htmlFor: "for"
}), Ky = /* @__PURE__ */ Object.assign(/* @__PURE__ */ Object.create(null), {
  class: "className",
  formnovalidate: {
    $: "formNoValidate",
    BUTTON: 1,
    INPUT: 1
  },
  ismap: {
    $: "isMap",
    IMG: 1
  },
  nomodule: {
    $: "noModule",
    SCRIPT: 1
  },
  playsinline: {
    $: "playsInline",
    VIDEO: 1
  },
  readonly: {
    $: "readOnly",
    INPUT: 1,
    TEXTAREA: 1
  }
});
function Yy(t, e) {
  const n = Ky[t];
  return typeof n == "object" ? n[e] ? n.$ : void 0 : n;
}
const Xy = /* @__PURE__ */ new Set(["beforeinput", "click", "dblclick", "contextmenu", "focusin", "focusout", "input", "keydown", "keyup", "mousedown", "mousemove", "mouseout", "mouseover", "mouseup", "pointerdown", "pointermove", "pointerout", "pointerover", "pointerup", "touchend", "touchmove", "touchstart"]), Zy = /* @__PURE__ */ new Set([
  "altGlyph",
  "altGlyphDef",
  "altGlyphItem",
  "animate",
  "animateColor",
  "animateMotion",
  "animateTransform",
  "circle",
  "clipPath",
  "color-profile",
  "cursor",
  "defs",
  "desc",
  "ellipse",
  "feBlend",
  "feColorMatrix",
  "feComponentTransfer",
  "feComposite",
  "feConvolveMatrix",
  "feDiffuseLighting",
  "feDisplacementMap",
  "feDistantLight",
  "feDropShadow",
  "feFlood",
  "feFuncA",
  "feFuncB",
  "feFuncG",
  "feFuncR",
  "feGaussianBlur",
  "feImage",
  "feMerge",
  "feMergeNode",
  "feMorphology",
  "feOffset",
  "fePointLight",
  "feSpecularLighting",
  "feSpotLight",
  "feTile",
  "feTurbulence",
  "filter",
  "font",
  "font-face",
  "font-face-format",
  "font-face-name",
  "font-face-src",
  "font-face-uri",
  "foreignObject",
  "g",
  "glyph",
  "glyphRef",
  "hkern",
  "image",
  "line",
  "linearGradient",
  "marker",
  "mask",
  "metadata",
  "missing-glyph",
  "mpath",
  "path",
  "pattern",
  "polygon",
  "polyline",
  "radialGradient",
  "rect",
  "set",
  "stop",
  "svg",
  "switch",
  "symbol",
  "text",
  "textPath",
  "tref",
  "tspan",
  "use",
  "view",
  "vkern"
]), eb = {
  xlink: "http://www.w3.org/1999/xlink",
  xml: "http://www.w3.org/XML/1998/namespace"
};
function tb(t, e, n) {
  let r = n.length, i = e.length, s = r, o = 0, l = 0, a = e[i - 1].nextSibling, c = null;
  for (; o < i || l < s; ) {
    if (e[o] === n[l]) {
      o++, l++;
      continue;
    }
    for (; e[i - 1] === n[s - 1]; )
      i--, s--;
    if (i === o) {
      const u = s < r ? l ? n[l - 1].nextSibling : n[s - l] : a;
      for (; l < s; ) t.insertBefore(n[l++], u);
    } else if (s === l)
      for (; o < i; )
        (!c || !c.has(e[o])) && e[o].remove(), o++;
    else if (e[o] === n[s - 1] && n[l] === e[i - 1]) {
      const u = e[--i].nextSibling;
      t.insertBefore(n[l++], e[o++].nextSibling), t.insertBefore(n[--s], u), e[i] = n[s];
    } else {
      if (!c) {
        c = /* @__PURE__ */ new Map();
        let d = l;
        for (; d < s; ) c.set(n[d], d++);
      }
      const u = c.get(e[o]);
      if (u != null)
        if (l < u && u < s) {
          let d = o, f = 1, g;
          for (; ++d < i && d < s && !((g = c.get(e[d])) == null || g !== u + f); )
            f++;
          if (f > u - l) {
            const p = e[o];
            for (; l < u; ) t.insertBefore(n[l++], p);
          } else t.replaceChild(n[l++], e[o++]);
        } else o++;
      else e[o++].remove();
    }
  }
}
const Ch = "_$DX_DELEGATE";
function Kg(t, e, n, r = {}) {
  let i;
  return td((s) => {
    i = s, e === document ? t() : w(e, t(), e.firstChild ? null : void 0, n);
  }, r.owner), () => {
    i(), e.textContent = "";
  };
}
function T(t, e, n) {
  let r;
  const i = () => {
    const o = document.createElement("template");
    return o.innerHTML = t, o.content.firstChild;
  }, s = () => (r || (r = i())).cloneNode(!0);
  return s.cloneNode = s, s;
}
function Xe(t, e = window.document) {
  const n = e[Ch] || (e[Ch] = /* @__PURE__ */ new Set());
  for (let r = 0, i = t.length; r < i; r++) {
    const s = t[r];
    n.has(s) || (n.add(s), e.addEventListener(s, ob));
  }
}
function ye(t, e, n) {
  Sn.context && t.isConnected || (n == null ? t.removeAttribute(e) : t.setAttribute(e, n));
}
function nb(t, e, n, r) {
  Sn.context && t.isConnected || (r == null ? t.removeAttributeNS(e, n) : t.setAttributeNS(e, n, r));
}
function D(t, e) {
  Sn.context && t.isConnected || (e == null ? t.removeAttribute("class") : t.className = e);
}
function Ao(t, e, n, r) {
  if (r)
    Array.isArray(n) ? (t[`$$${e}`] = n[0], t[`$$${e}Data`] = n[1]) : t[`$$${e}`] = n;
  else if (Array.isArray(n)) {
    const i = n[0];
    t.addEventListener(e, n[0] = (s) => i.call(t, n[1], s));
  } else t.addEventListener(e, n);
}
function ro(t, e, n = {}) {
  const r = Object.keys(e || {}), i = Object.keys(n);
  let s, o;
  for (s = 0, o = i.length; s < o; s++) {
    const l = i[s];
    !l || l === "undefined" || e[l] || ($h(t, l, !1), delete n[l]);
  }
  for (s = 0, o = r.length; s < o; s++) {
    const l = r[s], a = !!e[l];
    !l || l === "undefined" || n[l] === a || !a || ($h(t, l, !0), n[l] = a);
  }
  return n;
}
function Yn(t, e, n) {
  if (!e) return n ? ye(t, "style") : e;
  const r = t.style;
  if (typeof e == "string") return r.cssText = e;
  typeof n == "string" && (r.cssText = n = void 0), n || (n = {}), e || (e = {});
  let i, s;
  for (s in n)
    e[s] == null && r.removeProperty(s), delete n[s];
  for (s in e)
    i = e[s], i !== n[s] && (r.setProperty(s, i), n[s] = i);
  return n;
}
function io(t, e = {}, n, r) {
  const i = {};
  return r || R(() => i.children = Io(t, e.children, i.children)), R(() => typeof e.ref == "function" && Le(e.ref, t)), R(() => rb(t, e, n, !0, i, !0)), i;
}
function Le(t, e, n) {
  return js(() => t(e, n));
}
function w(t, e, n, r) {
  if (n !== void 0 && !r && (r = []), typeof e != "function") return Io(t, e, r, n);
  R((i) => Io(t, e(), i, n), r);
}
function rb(t, e, n, r, i = {}, s = !1) {
  e || (e = {});
  for (const o in i)
    if (!(o in e)) {
      if (o === "children") continue;
      i[o] = Eh(t, o, null, i[o], n, s);
    }
  for (const o in e) {
    if (o === "children")
      continue;
    const l = e[o];
    i[o] = Eh(t, o, l, i[o], n, s);
  }
}
function ib(t) {
  let e, n;
  return !Sn.context || !(e = Sn.registry.get(n = lb())) ? t() : (Sn.completed && Sn.completed.add(e), Sn.registry.delete(n), e);
}
function sb(t) {
  return t.toLowerCase().replace(/-([a-z])/g, (e, n) => n.toUpperCase());
}
function $h(t, e, n) {
  const r = e.trim().split(/\s+/);
  for (let i = 0, s = r.length; i < s; i++) t.classList.toggle(r[i], n);
}
function Eh(t, e, n, r, i, s) {
  let o, l, a, c, u;
  if (e === "style") return Yn(t, n, r);
  if (e === "classList") return ro(t, n, r);
  if (n === r) return r;
  if (e === "ref")
    s || n(t);
  else if (e.slice(0, 3) === "on:") {
    const d = e.slice(3);
    r && t.removeEventListener(d, r), n && t.addEventListener(d, n);
  } else if (e.slice(0, 10) === "oncapture:") {
    const d = e.slice(10);
    r && t.removeEventListener(d, r, !0), n && t.addEventListener(d, n, !0);
  } else if (e.slice(0, 2) === "on") {
    const d = e.slice(2).toLowerCase(), f = Xy.has(d);
    if (!f && r) {
      const g = Array.isArray(r) ? r[0] : r;
      t.removeEventListener(d, g);
    }
    (f || n) && (Ao(t, d, n, f), f && Xe([d]));
  } else if (e.slice(0, 5) === "attr:")
    ye(t, e.slice(5), n);
  else if ((u = e.slice(0, 5) === "prop:") || (a = Jy.has(e)) || !i && ((c = Yy(e, t.tagName)) || (l = Wy.has(e))) || (o = t.nodeName.includes("-"))) {
    if (u)
      e = e.slice(5), l = !0;
    else if (Sn.context && t.isConnected) return n;
    e === "class" || e === "className" ? D(t, n) : o && !l && !a ? t[sb(e)] = n : t[c || e] = n;
  } else {
    const d = i && e.indexOf(":") > -1 && eb[e.split(":")[0]];
    d ? nb(t, d, e, n) : ye(t, Qy[e] || e, n);
  }
  return n;
}
function ob(t) {
  const e = `$$${t.type}`;
  let n = t.composedPath && t.composedPath()[0] || t.target;
  for (t.target !== n && Object.defineProperty(t, "target", {
    configurable: !0,
    value: n
  }), Object.defineProperty(t, "currentTarget", {
    configurable: !0,
    get() {
      return n || document;
    }
  }), Sn.registry && !Sn.done && (Sn.done = _$HY.done = !0); n; ) {
    const r = n[e];
    if (r && !n.disabled) {
      const i = n[`${e}Data`];
      if (i !== void 0 ? r.call(n, i, t) : r.call(n, t), t.cancelBubble) return;
    }
    n = n._$host || n.parentNode || n.host;
  }
}
function Io(t, e, n, r, i) {
  const s = !!Sn.context && t.isConnected;
  if (s) {
    !n && (n = [...t.childNodes]);
    let a = [];
    for (let c = 0; c < n.length; c++) {
      const u = n[c];
      u.nodeType === 8 && u.data.slice(0, 2) === "!$" ? u.remove() : a.push(u);
    }
    n = a;
  }
  for (; typeof n == "function"; ) n = n();
  if (e === n) return n;
  const o = typeof e, l = r !== void 0;
  if (t = l && n[0] && n[0].parentNode || t, o === "string" || o === "number") {
    if (s || o === "number" && (e = e.toString(), e === n))
      return n;
    if (l) {
      let a = n[0];
      a && a.nodeType === 3 ? a.data !== e && (a.data = e) : a = document.createTextNode(e), n = xs(t, n, r, a);
    } else
      n !== "" && typeof n == "string" ? n = t.firstChild.data = e : n = t.textContent = e;
  } else if (e == null || o === "boolean") {
    if (s) return n;
    n = xs(t, n, r);
  } else {
    if (o === "function")
      return R(() => {
        let a = e();
        for (; typeof a == "function"; ) a = a();
        n = Io(t, a, n, r);
      }), () => n;
    if (Array.isArray(e)) {
      const a = [], c = n && Array.isArray(n);
      if (eu(a, e, n, i))
        return R(() => n = Io(t, a, n, r, !0)), () => n;
      if (s) {
        if (!a.length) return n;
        if (r === void 0) return [...t.childNodes];
        let u = a[0], d = [u];
        for (; (u = u.nextSibling) !== r; ) d.push(u);
        return n = d;
      }
      if (a.length === 0) {
        if (n = xs(t, n, r), l) return n;
      } else c ? n.length === 0 ? Th(t, a, r) : tb(t, n, a) : (n && xs(t), Th(t, a));
      n = a;
    } else if (e.nodeType) {
      if (s && e.parentNode) return n = l ? [e] : e;
      if (Array.isArray(n)) {
        if (l) return n = xs(t, n, r, e);
        xs(t, n, null, e);
      } else n == null || n === "" || !t.firstChild ? t.appendChild(e) : t.replaceChild(e, t.firstChild);
      n = e;
    }
  }
  return n;
}
function eu(t, e, n, r) {
  let i = !1;
  for (let s = 0, o = e.length; s < o; s++) {
    let l = e[s], a = n && n[t.length], c;
    if (!(l == null || l === !0 || l === !1)) if ((c = typeof l) == "object" && l.nodeType)
      t.push(l);
    else if (Array.isArray(l))
      i = eu(t, l, a) || i;
    else if (c === "function")
      if (r) {
        for (; typeof l == "function"; ) l = l();
        i = eu(t, Array.isArray(l) ? l : [l], Array.isArray(a) ? a : [a]) || i;
      } else
        t.push(l), i = !0;
    else {
      const u = String(l);
      a && a.nodeType === 3 && a.data === u ? t.push(a) : t.push(document.createTextNode(u));
    }
  }
  return i;
}
function Th(t, e, n = null) {
  for (let r = 0, i = e.length; r < i; r++) t.insertBefore(e[r], n);
}
function xs(t, e, n, r) {
  if (n === void 0) return t.textContent = "";
  const i = r || document.createTextNode("");
  if (e.length) {
    let s = !1;
    for (let o = e.length - 1; o >= 0; o--) {
      const l = e[o];
      if (i !== l) {
        const a = l.parentNode === t;
        !s && !o ? a ? t.replaceChild(i, l) : t.insertBefore(i, n) : a && l.remove();
      } else s = !0;
    }
  } else t.insertBefore(i, n);
  return [i];
}
function lb() {
  return Sn.getNextContextId();
}
const ab = "http://www.w3.org/2000/svg";
function Yg(t, e = !1) {
  return e ? document.createElementNS(ab, t) : document.createElement(t);
}
function id(t) {
  const {
    useShadow: e
  } = t, n = document.createTextNode(""), r = () => t.mount || document.body, i = wh();
  let s, o = !!Sn.context;
  return Z(() => {
    o && (wh().user = o = !1), s || (s = Iy(i, () => P(() => t.children)));
    const l = r();
    if (l instanceof HTMLHeadElement) {
      const [a, c] = I(!1), u = () => c(!0);
      td((d) => w(l, () => a() ? d() : s(), null)), Gn(u);
    } else {
      const a = Yg(t.isSVG ? "g" : "div", t.isSVG), c = e && a.attachShadow ? a.attachShadow({
        mode: "open"
      }) : a;
      Object.defineProperty(a, "_$host", {
        get() {
          return n.parentNode;
        },
        configurable: !0
      }), w(c, s), l.appendChild(a), t.ref && t.ref(a), Gn(() => l.removeChild(a));
    }
  }, void 0, {
    render: !o
  }), n;
}
function sd(t) {
  const [e, n] = Wr(t, ["component"]), r = P(() => e.component);
  return P(() => {
    const i = r();
    switch (typeof i) {
      case "function":
        return js(() => i(n));
      case "string":
        const s = Zy.has(i), o = Sn.context ? ib() : Yg(i, s);
        return io(o, n, s), o;
    }
  });
}
const ta = Symbol("store-raw"), Ns = Symbol("store-node"), ii = Symbol("store-has"), Xg = Symbol("store-self");
function Zg(t) {
  let e = t[Xi];
  if (!e && (Object.defineProperty(t, Xi, {
    value: e = new Proxy(t, db)
  }), !Array.isArray(t))) {
    const n = Object.keys(t), r = Object.getOwnPropertyDescriptors(t);
    for (let i = 0, s = n.length; i < s; i++) {
      const o = n[i];
      r[o].get && Object.defineProperty(t, o, {
        enumerable: r[o].enumerable,
        get: r[o].get.bind(e)
      });
    }
  }
  return e;
}
function Gs(t) {
  let e;
  return t != null && typeof t == "object" && (t[Xi] || !(e = Object.getPrototypeOf(t)) || e === Object.prototype || Array.isArray(t));
}
function Fs(t, e = /* @__PURE__ */ new Set()) {
  let n, r, i, s;
  if (n = t != null && t[ta]) return n;
  if (!Gs(t) || e.has(t)) return t;
  if (Array.isArray(t)) {
    Object.isFrozen(t) ? t = t.slice(0) : e.add(t);
    for (let o = 0, l = t.length; o < l; o++)
      i = t[o], (r = Fs(i, e)) !== i && (t[o] = r);
  } else {
    Object.isFrozen(t) ? t = Object.assign({}, t) : e.add(t);
    const o = Object.keys(t), l = Object.getOwnPropertyDescriptors(t);
    for (let a = 0, c = o.length; a < c; a++)
      s = o[a], !l[s].get && (i = t[s], (r = Fs(i, e)) !== i && (t[s] = r));
  }
  return t;
}
function na(t, e) {
  let n = t[e];
  return n || Object.defineProperty(t, e, {
    value: n = /* @__PURE__ */ Object.create(null)
  }), n;
}
function Oo(t, e, n) {
  if (t[e]) return t[e];
  const [r, i] = I(n, {
    equals: !1,
    internal: !0
  });
  return r.$ = i, t[e] = r;
}
function cb(t, e) {
  const n = Reflect.getOwnPropertyDescriptor(t, e);
  return !n || n.get || !n.configurable || e === Xi || e === Ns || (delete n.value, delete n.writable, n.get = () => t[Xi][e]), n;
}
function ep(t) {
  Zc() && Oo(na(t, Ns), Xg)();
}
function ub(t) {
  return ep(t), Reflect.ownKeys(t);
}
const db = {
  get(t, e, n) {
    if (e === ta) return t;
    if (e === Xi) return n;
    if (e === _h)
      return ep(t), n;
    const r = na(t, Ns), i = r[e];
    let s = i ? i() : t[e];
    if (e === Ns || e === ii || e === "__proto__") return s;
    if (!i) {
      const o = Object.getOwnPropertyDescriptor(t, e);
      Zc() && (typeof s != "function" || t.hasOwnProperty(e)) && !(o && o.get) && (s = Oo(r, e, s)());
    }
    return Gs(s) ? Zg(s) : s;
  },
  has(t, e) {
    return e === ta || e === Xi || e === _h || e === Ns || e === ii || e === "__proto__" ? !0 : (Zc() && Oo(na(t, ii), e)(), e in t);
  },
  set() {
    return !0;
  },
  deleteProperty() {
    return !0;
  },
  ownKeys: ub,
  getOwnPropertyDescriptor: cb
};
function Vs(t, e, n, r = !1) {
  if (!r && t[e] === n) return;
  const i = t[e], s = t.length;
  n === void 0 ? (delete t[e], t[ii] && t[ii][e] && i !== void 0 && t[ii][e].$()) : (t[e] = n, t[ii] && t[ii][e] && i === void 0 && t[ii][e].$());
  let o = na(t, Ns), l;
  if ((l = Oo(o, e, i)) && l.$(() => n), Array.isArray(t) && t.length !== s) {
    for (let a = t.length; a < s; a++) (l = o[a]) && l.$();
    (l = Oo(o, "length", s)) && l.$(t.length);
  }
  (l = o[Xg]) && l.$();
}
function tp(t, e) {
  const n = Object.keys(e);
  for (let r = 0; r < n.length; r += 1) {
    const i = n[r];
    Vs(t, i, e[i]);
  }
}
function hb(t, e) {
  if (typeof e == "function" && (e = e(t)), e = Fs(e), Array.isArray(e)) {
    if (t === e) return;
    let n = 0, r = e.length;
    for (; n < r; n++) {
      const i = e[n];
      t[n] !== i && Vs(t, n, i);
    }
    Vs(t, "length", r);
  } else tp(t, e);
}
function bo(t, e, n = []) {
  let r, i = t;
  if (e.length > 1) {
    r = e.shift();
    const o = typeof r, l = Array.isArray(t);
    if (Array.isArray(r)) {
      for (let a = 0; a < r.length; a++)
        bo(t, [r[a]].concat(e), n);
      return;
    } else if (l && o === "function") {
      for (let a = 0; a < t.length; a++)
        r(t[a], a) && bo(t, [a].concat(e), n);
      return;
    } else if (l && o === "object") {
      const {
        from: a = 0,
        to: c = t.length - 1,
        by: u = 1
      } = r;
      for (let d = a; d <= c; d += u)
        bo(t, [d].concat(e), n);
      return;
    } else if (e.length > 1) {
      bo(t[r], e, [r].concat(n));
      return;
    }
    i = t[r], n = [r].concat(n);
  }
  let s = e[0];
  typeof s == "function" && (s = s(i, n), s === i) || r === void 0 && s == null || (s = Fs(s), r === void 0 || Gs(i) && Gs(s) && !Array.isArray(s) ? tp(i, s) : Vs(t, r, s));
}
function er(...[t, e]) {
  const n = Fs(t || {}), r = Array.isArray(n), i = Zg(n);
  function s(...o) {
    Hg(() => {
      r && o.length === 1 ? hb(n, o[0]) : bo(n, o);
    });
  }
  return [i, s];
}
const ra = /* @__PURE__ */ new WeakMap(), np = {
  get(t, e) {
    if (e === ta) return t;
    const n = t[e];
    let r;
    return Gs(n) ? ra.get(n) || (ra.set(n, r = new Proxy(n, np)), r) : n;
  },
  set(t, e, n) {
    return Vs(t, e, Fs(n)), !0;
  },
  deleteProperty(t, e) {
    return Vs(t, e, void 0, !0), !0;
  }
};
function ia(t) {
  return (e) => {
    if (Gs(e)) {
      let n;
      (n = ra.get(e)) || ra.set(e, n = new Proxy(e, np)), t(n);
    }
    return e;
  };
}
const fb = "_icon_1yzc9_69", mc = {
  "st-input": "_st-input_1yzc9_1",
  "input-container": "_input-container_1yzc9_61",
  icon: fb
};
var gb = /* @__PURE__ */ T("<label class=flexbox><span></span><div><input size=1><span role=presentation>");
class pb {
  placeholder;
  value;
  label;
  type;
  onEnterKey;
  icon = void 0;
  selected = !1;
  focused = !1;
  required = !1;
  disabled = !1;
  defaultInput = void 0;
}
function dt(t) {
  function e(i) {
    Z(() => {
      const s = t.focused, o = t.selected;
      s ? requestAnimationFrame(() => {
        i?.focus();
      }) : i?.blur(), o && i?.select();
    }), t.ref && typeof t.ref == "function" && t.ref(i);
  }
  return (() => {
    var i = gb(), s = i.firstChild, o = s.nextSibling, l = o.firstChild, a = l.nextSibling;
    w(s, () => t.label), Ao(l, "blur", t.onBlur), Ao(l, "focusout", t.onFocusOut, !0), l.$$input = n, l.$$keydown = r;
    var c = e;
    return typeof c == "function" ? Le(c, l) : e = l, Le(defaultInput, l, () => t.defaultInput), R((u) => {
      var d = mc["input-container"], f = t.disabled, g = `${mc["st-input"]} auto`, p = t.type, S = t.placeholder ?? " ", _ = t.style, m = t.required, y = !!t.icon, v = `${mc.icon} ${t.icon}`;
      return d !== u.e && D(o, u.e = d), f !== u.t && (l.disabled = u.t = f), g !== u.a && D(l, u.a = g), p !== u.o && ye(l, "type", u.o = p), S !== u.i && ye(l, "placeholder", u.i = S), u.n = Yn(l, _, u.n), m !== u.s && (l.required = u.s = m), y !== u.h && ye(l, "data-has-icon", u.h = y), v !== u.r && D(a, u.r = v), u;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0,
      n: void 0,
      s: void 0,
      h: void 0,
      r: void 0
    }), R(() => l.value = t.value[0]()), i;
  })();
  function n(i) {
    t.value[1](this.value);
  }
  function r(i) {
    i.key === "Enter" && t.onEnterKey && t.onEnterKey();
  }
}
dt.defaultProps = new pb();
Xe(["keydown", "input", "focusout"]);
const mb = "_dialog_1uzgk_1", vb = "_title_1uzgk_87", yb = "_content_1uzgk_105", bb = "_header_1uzgk_113", po = {
  "dialog-container": "_dialog-container_1uzgk_1",
  dialog: mb,
  title: vb,
  content: yb,
  header: bb
};
var wb = /* @__PURE__ */ T('<div><h2 draggable=true></h2><span role=button class="btn btn-link st-tool-button"aria-label=Close><i class="fa fa-times"role=presentation>'), _b = /* @__PURE__ */ T("<div><div><div>");
class Sb {
  show;
  class;
  title;
  draggable;
  children;
}
const rp = new Image();
rp.src = "data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=";
function Gt(t) {
  const [e, n] = t.show, [r, i] = I({
    x: 0,
    y: 0
  }), s = us(() => t.children);
  let o, l;
  function a(g) {
    o = g, o.addEventListener("close", (p) => {
      e() && n(!1);
    }), o.addEventListener("mousedown", (p) => {
      p.target === o && n(!1);
    }), requestAnimationFrame(() => {
      let p = o.clientWidth, S = o.clientHeight;
      l = new ResizeObserver((_) => {
        const [m] = _, y = r(), v = y.x / p * m.contentRect.width, x = y.y / S * m.contentRect.height;
        i({
          x: v,
          y: x
        }), p = m.contentRect.width, S = m.contentRect.height;
      }), l.observe(o);
    });
  }
  let c = 0, u = 0;
  const d = (g) => {
    g.dataTransfer?.setDragImage(rp, 0, 0), c = g.clientX, u = g.clientY;
  }, f = (g) => {
    const p = g.clientX - c, S = g.clientY - u;
    c = g.clientX, u = g.clientY, i({
      x: r().x + p,
      y: r().y + S
    });
  };
  return Gn(() => {
    l?.disconnect();
  }), jt(() => {
    Z(() => {
      if (!e()) return;
      let g = 0, p = o?.parentElement;
      for (; p = p?.previousElementSibling; )
        if (p instanceof HTMLElement && Gg.isElementInViewport(p)) {
          const S = parseInt(getComputedStyle(p).zIndex);
          S < 1e4 && S > g && (g = S);
        }
      o?.parentElement?.style.setProperty("z-index", `${g + 1}`);
    });
  }), h(B, {
    get when() {
      return e();
    },
    get children() {
      return h(id, {
        get children() {
          var g = _b(), p = g.firstChild, S = p.firstChild, _ = a;
          return typeof _ == "function" ? Le(_, g) : a = g, w(p, h(B, {
            get when() {
              return t.title;
            },
            get children() {
              var m = wb(), y = m.firstChild, v = y.nextSibling;
              return y.addEventListener("drag", f), y.addEventListener("dragstart", d), w(y, () => t.title), v.$$click = () => n(!1), R((x) => {
                var C = `flexbox horizontal middle padded ${po.header}`, E = `auto ${po.title}`;
                return C !== x.e && D(m, x.e = C), E !== x.t && D(y, x.t = E), x;
              }, {
                e: void 0,
                t: void 0
              }), m;
            }
          }), S), w(S, s), R((m) => {
            var y = po["dialog-container"], v = `${po.dialog} ${t.class ?? ""}`, x = r().x * 2 + "px", C = r().y * 2 + "px", E = po.content;
            return y !== m.e && D(g, m.e = y), v !== m.t && D(p, m.t = v), x !== m.a && ((m.a = x) != null ? p.style.setProperty("margin-left", x) : p.style.removeProperty("margin-left")), C !== m.o && ((m.o = C) != null ? p.style.setProperty("margin-top", C) : p.style.removeProperty("margin-top")), E !== m.i && D(S, m.i = E), m;
          }, {
            e: void 0,
            t: void 0,
            a: void 0,
            o: void 0,
            i: void 0
          }), g;
        }
      });
    }
  });
}
Gt.defaultProps = new Sb();
async function ip(t, e) {
  const [n, r] = I(!0), i = document.createElement("div");
  document.body.appendChild(i);
  let s = () => {
  };
  try {
    let o = !1;
    return await new Promise((a, c) => {
      Z(() => {
        !o && !n() && c();
      });
      const u = (g) => {
        o = !0, r(!1), a(g);
      }, d = (g) => {
        o = !0, r(!1), c(g);
      };
      s = Kg(() => h(Gt, Xt({
        show: [n, r]
      }, e ?? {}, {
        get children() {
          return t(u, d);
        }
      })), i);
    });
  } catch (o) {
    throw o;
  } finally {
    r(!1), s(), document.body.removeChild(i);
  }
}
Xe(["click"]);
var xb = /* @__PURE__ */ T("<i>"), Cb = /* @__PURE__ */ T("<button>");
class $b {
  enabled = !0;
  active = !1;
  tooltip;
  label;
  type;
  ref;
  icon;
  loading = !1;
  focused = !1;
  // Note: If you manually bind a click event using ref, this click handler will not be triggered.
  onClick;
}
function Eb(t, e) {
  const n = {}, r = document.createElement(t), i = {
    class: "className",
    for: "htmlFor",
    tabindex: "tabIndex",
    readonly: "readOnly",
    maxlength: "maxLength",
    colspan: "colSpan",
    rowspan: "rowSpan",
    autoplay: "autoPlay",
    spellcheck: "spellCheck",
    enctype: "encType",
    acceptcharset: "acceptCharset",
    datetime: "dateTime",
    usemap: "useMap",
    frameborder: "frameBorder",
    contenteditable: "contentEditable"
  };
  for (const s in e)
    (s in r || s in i) && (n[s] = e[s]);
  return n;
}
function ne(t) {
  const e = Eb("button", t), n = (l) => {
    l.stopPropagation(), t.onClick?.(l);
  }, r = P(() => t.type || "default"), i = P(() => {
    const l = t.enabled;
    return t.loading == !0 ? !1 : l === void 0 ? !0 : l;
  }), s = P(() => t.active ? "active" : ""), o = P(() => {
    const l = t.icon;
    return t.loading ? "fa fa-spinner fa-spin" : l;
  });
  return jt(() => {
    t.focused && setTimeout(() => t.ref.focus(), 500), t.label && t.ref instanceof HTMLButtonElement && t.ref.setAttribute("aria-label", t.label);
  }), (() => {
    var l = Cb();
    Le(tooltip, l, () => t.tooltip);
    var a = t.ref;
    return typeof a == "function" ? Le(a, l) : t.ref = l, io(l, Xt(e, {
      type: "button",
      get class() {
        return `${s()} ${t.class ?? ""} st-btn`;
      },
      get disabled() {
        return !i();
      },
      get "data-type"() {
        return r();
      },
      onClick: (c) => n(c),
      get style() {
        return t.style;
      }
    }), !1, !0), w(l, h(B, {
      get when() {
        return !!o();
      },
      get children() {
        var c = xb();
        return R((u) => {
          var d = o(), f = t.children ? "0.5rem" : "";
          return d !== u.e && D(c, u.e = d), f !== u.t && ((u.t = f) != null ? c.style.setProperty("margin-right", f) : c.style.removeProperty("margin-right")), u;
        }, {
          e: void 0,
          t: void 0
        }), c;
      }
    }), null), w(l, () => t.children, null), l;
  })();
}
ne.defaultProps = new $b();
const sp = bt(), Tb = () => {
  const [t, e] = er({
    loadingBoids: [],
    businessObjects: {},
    propertyPicker: {
      selectedBoid: "",
      businessObjects: [],
      additionalBusinessObjects: [],
      isAdding: !1
    }
  }), n = (d) => {
    e("propertyPicker", "selectedBoid", d);
  }, r = async (d) => {
    const f = [...new Set(d.items.map((p) => p.srcObject))], g = await a(f);
    e("propertyPicker", "businessObjects", g);
  }, i = (d) => {
    a([d.boid]), e("propertyPicker", "additionalBusinessObjects", (f) => [...f, d]), n(d.boid), l(!1);
  }, s = (d) => {
    const f = [...t.propertyPicker.businessObjects, ...t.propertyPicker.additionalBusinessObjects], g = f.indexOf(d), p = f[g - 1];
    t.propertyPicker.additionalBusinessObjects.includes(d) && (e("propertyPicker", "additionalBusinessObjects", (S) => [...S.slice(0, S.indexOf(d)), ...S.slice(S.indexOf(d) + 1)]), p && e("propertyPicker", "selectedBoid", p.boid));
  }, o = () => {
    e("propertyPicker", "additionalBusinessObjects", []);
  }, l = (d) => e("propertyPicker", "isAdding", d ?? !t.propertyPicker.isAdding), a = async (d) => {
    const f = [], g = [];
    for (const p of d)
      t.businessObjects[p] ? f.push(t.businessObjects[p]) : g.push(p);
    if (g.length) {
      const p = await Ql.GetBusinessObjectInfos(g), S = {};
      for (const _ of p)
        f.push(_), S[_.boid] = _;
      e("businessObjects", {
        ...t.businessObjects,
        ...S
      });
    }
    return f;
  }, c = async (d) => {
    const [f] = await a([d]);
    return f;
  };
  return [t, {
    getProperties: async (d) => (await c(d)).properties,
    loadBusinessObjects: a,
    getBusinessObject: c,
    setSelectedPropertyPickerBoid: n,
    loadPropertyPickerBos: r,
    addPropertyPickerBo: i,
    removePropertyPickerBo: s,
    toggleAddOneToOneModal: l,
    resetAdditionalPropertyPickerBos: o
  }];
};
function Ab(t) {
  const e = Tb();
  return h(sp.Provider, {
    value: e,
    get children() {
      return t.children;
    }
  });
}
function Ba() {
  return Nt(sp);
}
function kb(t) {
  const [e, n] = Wr(t, ["as", "action", "onClick"]), r = Xo();
  return Z(() => {
    r.setTriggerAction(e.action ?? "click");
  }), h(sd, Xt({
    get component() {
      return e.as ?? "div";
    },
    ref: (l) => {
      r.registerTrigger(l);
    },
    onClick: (l) => {
      r.toggle(), t.onClick?.(l);
    },
    onMouseEnter: () => r.setIsHoveringTrigger(!0),
    onMouseLeave: () => r.setIsHoveringTrigger(!1),
    onKeyDown: (l) => {
      (l.key === "Enter" || l.key === " ") && r.toggle();
    },
    tabIndex: 0,
    role: "button"
  }, n, {
    get children() {
      return t.children;
    }
  }));
}
const Ib = "_menu_1srop_1", Ob = {
  menu: Ib,
  "dropdown-content-overlay": "_dropdown-content-overlay_1srop_25"
};
var Db = /* @__PURE__ */ T("<div>");
const si = [];
function Lb(t) {
  si.indexOf(t) > -1 || si.unshift(t);
}
function Nb(t) {
  si.indexOf(t) !== -1 && requestAnimationFrame(() => {
    si[0] && si[0] !== t && si.shift()?.setIsOpen(!1), si.shift();
  });
}
document.addEventListener("mousedown", Pb);
document.addEventListener("keydown", Rb);
function Pb(t) {
  for (const e of si) {
    if (e.content?.contains(t.target) || e.trigger?.contains(t.target)) break;
    e.toggle(!1);
  }
}
function Rb(t) {
  t.key === "Escape" && si[0]?.toggle(!1);
}
function Mb(t) {
  const e = Xo();
  return h(B, {
    get when() {
      return e.isOpen();
    },
    get children() {
      return h(id, {
        get children() {
          return h(qb, t);
        }
      });
    }
  });
}
function qb(t) {
  const [e, n] = Wr(t, ["as"]), r = Xo();
  Z(() => {
    r.isOpen() ? Lb(r) : Nb(r);
  });
  const i = (s) => {
    r.registerContent(s);
  };
  return jt(() => {
    Z(() => {
      if (!r.isOpen()) return;
      let s = 0, o = r.content?.parentElement;
      for (; o = o?.previousElementSibling; )
        if (o instanceof HTMLElement && Gg.isElementInViewport(o)) {
          const l = parseInt(getComputedStyle(o).zIndex);
          l < 1e4 && l > s && (s = l);
        }
      r.content?.parentElement?.style.setProperty("z-index", `${s + 1}`);
    });
  }), (() => {
    var s = Db();
    return s.addEventListener("mouseleave", () => r.setIsHoveringContent(!1)), s.addEventListener("mouseenter", () => r.setIsHoveringContent(!0)), Le(i, s), w(s, h(sd, Xt({
      get component() {
        return e.as ?? "div";
      }
    }, n, {
      get style() {
        return {
          "max-height": `calc(100vh - ${r.offsetY()}px)`,
          "overflow-y": "auto",
          ...t.style ?? {}
        };
      },
      get children() {
        return t.children;
      }
    }))), R((o) => {
      var l = Ob["dropdown-content-overlay"], a = `${r.offsetX()}px`, c = `${r.offsetY()}px`, u = `calc(100vh - ${r.offsetY()}px)`;
      return l !== o.e && D(s, o.e = l), a !== o.t && ((o.t = a) != null ? s.style.setProperty("left", a) : s.style.removeProperty("left")), c !== o.a && ((o.a = c) != null ? s.style.setProperty("top", c) : s.style.removeProperty("top")), u !== o.o && ((o.o = u) != null ? s.style.setProperty("max-height", u) : s.style.removeProperty("max-height")), o;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0
    }), s;
  })();
}
class op {
  open;
  class;
  placement;
}
function Ve(t) {
  const e = new Cy(t.open);
  return Z(() => {
    e.setPlacement(t.placement ?? "bottom-start");
  }), h($y, {
    value: e,
    get children() {
      return t.children;
    }
  });
}
Ve.defaultProps = new op();
Ve.Trigger = kb;
Ve.Content = Mb;
class lp {
  label;
  items;
  constructor(e) {
    this.label = e, this.items = [];
  }
}
class Bb {
  hasTrigger = !1;
  open;
  setOpen;
  value;
  setValue;
  groups;
  setGroups;
  trigger;
  setTrigger;
  content;
  setContent;
  placement;
  setPlacement;
  defaultDisplayValue;
  setDefaultDisplayValue;
  constructor(e, n) {
    [this.value, this.setValue] = e, [this.open, this.setOpen] = n, [this.placement, this.setPlacement] = I("bottom-start"), [this.groups, this.setGroups] = I([]), [this.trigger, this.setTrigger] = I(), [this.content, this.setContent] = I("ul");
    const r = this;
    [this.defaultDisplayValue, this.setDefaultDisplayValue] = I(P(() => r.value()));
  }
  triggerEl;
  contentEl;
  bindTriggerEvents(e) {
    e.addEventListener("mousedown", (n) => n.stopPropagation()), e.addEventListener("click", () => {
      this.setOpen(!this.open()), this.resetWatcher();
    }), this.triggerEl = e, this.resetWatcher();
  }
  cleanupWatcher = () => {
  };
  resetWatcher() {
    requestAnimationFrame(() => {
      this.cleanupWatcher();
      const e = this.triggerEl, n = this.contentEl;
      e && n && (this.cleanupWatcher = yh.observePosition(e, n, () => {
        const {
          x: r,
          y: i
        } = yh.computePosition(e, n, {
          placement: this.placement()
        });
        n.style.left = `${r}px`, n.style.top = `${i}px`;
      }));
    });
  }
}
const ap = bt(), Ub = ap.Provider;
function Ua() {
  return Ir(ap);
}
function jb(t) {
  const e = Ua();
  return e.hasTrigger = !0, h(Ve.Trigger, t);
}
function Gb(t) {
  const e = Ua(), n = new lp(t.label);
  return e.setGroups([...e.groups(), n]), P(() => t.children);
}
var Fb = /* @__PURE__ */ T('<li role=button class="flexbox horizontal middle"><span>');
function cp(t) {
  const e = Ua(), n = P(() => t.label ?? t.children ?? t.value?.toString()), r = P(() => e.value() == t.value?.toString());
  Z(() => {
    t.value === e.value() && e.setDefaultDisplayValue(P(() => t.label ?? t.children ?? t.value?.toString() ?? ""));
  });
  function i() {
    function o() {
      e.setValue(t.value?.toString() ?? ""), e.setOpen(!1);
    }
    return (() => {
      var l = Fb(), a = l.firstChild;
      return l.$$click = o, l.style.setProperty("user-select", "none"), w(a, h(B, {
        get when() {
          return !n();
        },
        children: "Â "
      }), null), w(a, n, null), R(() => ye(l, "data-selected", r())), l;
    })();
  }
  return e.groups().length == 0 && e.setGroups([new lp("")]), e.groups()[e.groups().length - 1].items.push(h(i, {})), [];
}
Xe(["click"]);
const Vb = "_dropdown_1e8jx_71", vc = {
  "select-trigger": "_select-trigger_1e8jx_1",
  "select-option": "_select-option_1e8jx_27",
  dropdown: Vb,
  "select-list": "_select-list_1e8jx_95",
  "group-label": "_group-label_1e8jx_125"
};
var Hb = /* @__PURE__ */ T("<div class=auto>"), zb = /* @__PURE__ */ T("<div><i style=padding-right:0.25em;opacity:0.7;>"), Wb = /* @__PURE__ */ T("<li>");
class Jb {
  children;
  value;
  label;
  icon;
  open;
  as;
  displayValue;
}
function Ee(t) {
  const e = new Bb(t.value, t.open ?? I(!1));
  return h(Ub, {
    value: e,
    get children() {
      return h(Qb, t);
    }
  });
}
Ee.defaultProps = new Jb();
function Qb(t) {
  const e = Ua();
  return h(Ve, {
    get open() {
      return [e.open, e.setOpen];
    },
    get children() {
      return [P(() => t.children), h(B, {
        get when() {
          return !e.hasTrigger;
        },
        get children() {
          return h(Ve.Trigger, {
            as: "div",
            get class() {
              return `${vc["select-trigger"]} flexbox horizontal middle`;
            },
            role: "button",
            tabindex: "0",
            get children() {
              return [(() => {
                var n = Hb();
                return w(n, () => t.displayValue ?? e.defaultDisplayValue()), n;
              })(), (() => {
                var n = zb(), r = n.firstChild;
                return R(() => D(r, `fa fa-${t.icon ?? "caret-down"}`)), n;
              })()];
            }
          });
        }
      }), h(Ve.Content, {
        get children() {
          return h(sd, {
            get component() {
              return t.as ?? "ul";
            },
            get class() {
              return vc["select-list"];
            },
            get children() {
              return h(de, {
                get each() {
                  return e.groups();
                },
                children: (n) => [h(B, {
                  get when() {
                    return n.label;
                  },
                  get children() {
                    var r = Wb();
                    return w(r, () => n.label), R(() => D(r, vc["group-label"])), r;
                  }
                }), h(de, {
                  get each() {
                    return n.items;
                  },
                  children: (r) => r
                })]
              });
            }
          });
        }
      })];
    }
  });
}
Ee.Trigger = jb;
Ee.Group = Gb;
Ee.Item = cp;
Ee.Option = cp;
var Kb = /* @__PURE__ */ T("<div class=st-checkbox-list>"), Yb = /* @__PURE__ */ T("<label class=st-checkbox><input type=checkbox><span>");
class Xb {
  options;
  value;
}
function sa(t) {
  const [e, n] = t.value ?? I([]), r = (s, o) => {
    o && e().includes(s.value) === !1 ? n([...e(), s.value]) : !o && e().includes(s.value) && n([...e().slice(0, e().indexOf(s.value)), ...e().slice(e().indexOf(s.value) + 1)]);
  }, i = (s) => {
    r(s, !e().includes(s.value));
  };
  return (() => {
    var s = Kb();
    return w(s, h(de, {
      get each() {
        return t.options ?? [];
      },
      children: (o) => (() => {
        var l = Yb(), a = l.firstChild, c = a.nextSibling;
        return a.addEventListener("change", () => i(o)), w(c, () => o.label), R(() => a.checked = e().includes(o.value)), l;
      })()
    })), s;
  })();
}
sa.defaultProps = new Xb();
var Zb = /* @__PURE__ */ T("<div>");
class e0 {
  children;
  vertical;
}
function Zn(t) {
  const e = us(() => t.children);
  return (() => {
    var n = Zb();
    return w(n, e), R(() => D(n, `flexbox ${t.vertical ? "vertical" : "horizontal"} middle st-btn-group`)), n;
  })();
}
Zn.defaultProps = new e0();
var Ah = /* @__PURE__ */ T('<span class="fa fa-times">'), t0 = /* @__PURE__ */ T('<div class=title-bar><span></span><div class="flexbox horizontal"style=gap:4px;>'), n0 = /* @__PURE__ */ T("<div class=extract-data-editor>"), r0 = /* @__PURE__ */ T("<div style=width:100%;height:100%;display:flex;justify-content:center;align-items:center;>"), up = /* @__PURE__ */ T('<div class=business-object-picker-modal><div class=business-object-picker-header><span>Select a Business Object</span><button class="fa fa-x">'), i0 = /* @__PURE__ */ T('<div class=main-interface><div class="panel left-panel"></div><div class="panel right-panel">'), od = /* @__PURE__ */ T("<div>"), s0 = /* @__PURE__ */ T("<ul role=tree class=extract-data-tree>"), dp = /* @__PURE__ */ T('<span class="fa fa-plus">'), hp = /* @__PURE__ */ T('<span class="fa fa-x">'), o0 = /* @__PURE__ */ T('<li role=treeitem><div class=extract-data-detail><span class="fa detail-node-toggle"></span><span class=detail-node-label></span><div class=detail-node-actions>'), l0 = /* @__PURE__ */ T("<div style=min-width:80px;>"), a0 = /* @__PURE__ */ T('<div class=property-picker><div style="display:grid;grid-template-columns:1fr auto;gap:4px;"><div style=position:relative></div></div><table class=property-list><tbody>'), c0 = /* @__PURE__ */ T('<span class="fa fa-check">'), u0 = /* @__PURE__ */ T("<tr role=button tabindex=0 aria-pressed=false><td class=property-title></td><td class=property-type></td><td>"), d0 = /* @__PURE__ */ T('<span class="fa fa-lock">'), h0 = /* @__PURE__ */ T("<div class=business-object-picker-modal><div class=business-object-picker-header><span>Select a Business Object"), f0 = /* @__PURE__ */ T("<div class=bo-tab-bar-container><div class=bo-tab-bar></div><div class=add-new-container>"), g0 = /* @__PURE__ */ T('<div style=cursor:pointer;><span class="fa fa-close">'), p0 = /* @__PURE__ */ T("<a href=# class=bo-tab tabindex=0><span class=bo-tab-title>"), m0 = /* @__PURE__ */ T("<div class=group-header>Frequently Used"), v0 = /* @__PURE__ */ T("<div class=group-header>Primary"), y0 = /* @__PURE__ */ T("<div class=group-header>Non-Primary"), b0 = /* @__PURE__ */ T("<div class=business-object-picker><div class=results-list>"), yc = /* @__PURE__ */ T("<button class=bo-find-result>"), kh = /* @__PURE__ */ T("<span>"), w0 = /* @__PURE__ */ T("<span style=color:red;>");
class _0 {
  reportGu = "";
  events = {
    onSaved: () => {
    }
  };
}
function tu(t) {
  const [e, n] = er({
    ID: Cr(),
    locked: !1,
    guid: "",
    label: "",
    namespace: "",
    primaryObject: "",
    resultType: "NESTED",
    items: [],
    details: []
  }), [r, i] = I(null), s = (m, y) => {
    if (!m) return;
    if (m === e.ID) {
      n("details", [...e.details, y]);
      return;
    }
    const v = (x) => x.map((C) => C.ID === m ? {
      ...C,
      details: [...C.details, y]
    } : C.details ? {
      ...C,
      details: v(C.details)
    } : C);
    n("details", (x) => v(x));
  }, o = (m, y) => {
    if (!m) {
      a();
      return;
    }
    if (m === e.ID) {
      const x = e.details.findIndex((C) => C.ID === y.ID);
      n("details", (C) => [...C.slice(0, x), ...C.slice(x + 1)]);
      return;
    }
    const v = (x) => x.map((C) => {
      if (C.ID === m) {
        const E = C.details, k = E.findIndex((L) => L.ID === y.ID);
        return {
          ...C,
          details: [...E.slice(0, k), ...E.slice(k + 1)]
        };
      } else if (C.details)
        return {
          ...C,
          details: v(C.details)
        };
      return C;
    });
    n("details", (x) => v(x));
  }, l = (m) => {
    n((y) => ({
      ...y,
      label: m.name ?? "",
      namespace: m.nameSpace ?? "",
      primaryObject: m.boid ?? "",
      items: [],
      details: []
    }));
  }, a = () => {
    n((m) => ({
      ...m,
      label: "",
      namespace: "",
      primaryObject: "",
      items: [],
      details: []
    }));
  }, c = (m, y, v) => {
    const x = m.items, C = x.findIndex((Y) => Y.srcElement === y.srcElement), E = C >= 0, k = v === void 0 ? !E : v === !0, L = v === void 0 ? E : v === !1;
    let M = [...x];
    if (k && !E ? M = [...x, {
      srcElement: y.srcElement,
      srcObject: y.boid,
      type: y.type,
      visible: !0,
      showTitle: !0,
      showAllOptions: !1,
      columns: 0,
      labelWrap: !1,
      locked: !1,
      neverDisable: !1,
      order: 0
    }] : L && E && (M = [...x.slice(0, C), ...x.slice(C + 1)]), m.ID === e.ID) {
      n("items", M);
      return;
    }
    const G = (Y) => Y.map((ie) => ie.ID === m.ID ? {
      ...m,
      items: M
    } : ie.details ? {
      ...ie,
      details: G(ie.details)
    } : ie);
    n("details", (Y) => G(Y));
  }, [u, d] = I(!1), f = async () => {
    d(!0);
    try {
      const m = await Ql.SaveExtractData(e.guid, e);
      n(m), i(m);
    } catch (m) {
      console.error(m);
    }
    d(!1), t.events.onSaved(), window.refreshDesigner && window.refreshDesigner();
  }, g = async () => {
    await f(), window.closeDataSourceEditor && window.closeDataSourceEditor();
  };
  Z(async () => {
    if (t.reportGu) {
      const m = await Ql.LoadExtractData(t.reportGu);
      n(m), i(m);
    }
  });
  const p = P(() => fp(r(), e)), S = () => {
    r() && n(r());
  }, _ = () => {
    S(), window.closeDataSourceEditor && window.closeDataSourceEditor();
  };
  return (() => {
    var m = n0();
    return w(m, h(Ab, {
      get children() {
        return [(() => {
          var y = t0(), v = y.firstChild, x = v.nextSibling;
          return w(v, () => e.fullyQualifiedName), w(x, h(Zn, {
            get children() {
              return [h(ne, {
                icon: "fa fa-check",
                get loading() {
                  return u();
                },
                get enabled() {
                  return p();
                },
                type: "success",
                onClick: f,
                children: "Save"
              }), h(ne, {
                get enabled() {
                  return P(() => !u())() && p();
                },
                type: "success",
                onClick: g,
                get children() {
                  return Ah();
                }
              })];
            }
          }), null), w(x, h(Zn, {
            get children() {
              return [h(ne, {
                icon: "fa fa-share",
                get enabled() {
                  return P(() => !u())() && p();
                },
                type: "warning",
                onClick: S,
                children: "Undo"
              }), h(ne, {
                get enabled() {
                  return P(() => !u())() && p();
                },
                onClick: _,
                type: "warning",
                get children() {
                  return Ah();
                }
              })];
            }
          }), null), y;
        })(), h(S0, {
          extractData: e,
          addDetail: s,
          removeDetail: o,
          setPrimaryObject: l,
          toggleItem: c
        })];
      }
    })), m;
  })();
}
tu.defaultProps = new _0();
function fp(t, e) {
  if (!t) return !1;
  for (const n of e.details) {
    const r = t.details.find((i) => i.primaryObject === n.primaryObject);
    if (!r || fp(r, n)) return !0;
  }
  for (const n of e.items)
    if (!t.items.find((i) => i.srcElement === n.srcElement)) return !0;
  return !!t.items.some((n) => !e.items.some((r) => n.srcElement === r.srcElement));
}
function S0(t) {
  Ba();
  const [e, n] = I(""), r = P(() => {
    const c = (u) => {
      if (u.ID === e()) return u;
      for (const d of u.details) {
        const f = c(d);
        if (f) return f;
      }
      return null;
    };
    return c(t.extractData);
  }), [i, s] = I(!1), o = (c) => {
    t.setPrimaryObject(c), s(!1);
  }, l = (c, u) => {
    const d = r();
    d && t.toggleItem(d, c, u);
  }, a = P(() => r()?.items ?? []);
  return (() => {
    var c = i0(), u = c.firstChild, d = u.nextSibling;
    return w(u, h(B, {
      get when() {
        return t.extractData.primaryObject;
      },
      get children() {
        return h(gp, {
          get selectedDetail() {
            return r();
          },
          get nodes() {
            return [t.extractData];
          },
          selectedDetailId: [e, n],
          get addDetail() {
            return t.addDetail;
          },
          get removeDetail() {
            return t.removeDetail;
          }
        });
      }
    }), null), w(u, h(B, {
      get when() {
        return !t.extractData.primaryObject;
      },
      get children() {
        var f = r0();
        return w(f, h(ne, {
          type: "primary",
          onClick: () => s(!0),
          children: "Select Primary Object"
        })), f;
      }
    }), null), w(d, h(C0, {
      get detail() {
        return r();
      },
      get items() {
        return a();
      },
      toggleItem: l
    })), w(c, h(Gt, {
      show: [i, s],
      get children() {
        var f = up(), g = f.firstChild, p = g.firstChild, S = p.nextSibling;
        return S.$$click = () => s(!1), w(f, h(B, {
          get when() {
            return i();
          },
          get fallback() {
            return od();
          },
          get children() {
            return h(ld, {
              get selectedDetail() {
                return r();
              },
              setSelectedBusinessObject: o
            });
          }
        }), null), f;
      }
    }), null), c;
  })();
}
function gp(t) {
  const [e, {
    toggleAddOneToOneModal: n
  }] = Ba(), [r, i] = I(!0), [s, o] = I(!1), [l, a] = t.selectedDetailId, c = (f) => {
    const g = t.selectedDetailId[0]();
    if (!g) return;
    const p = {
      ID: Cr(),
      locked: !1,
      primaryObject: f.boid ?? "",
      label: f.name ?? "",
      items: [],
      details: []
    };
    t.addDetail(g, p), o(!1), a(p.ID);
  }, u = (f) => {
    const g = t.parent?.ID;
    t.removeDetail(t.parent?.ID ?? "", f), g && a(g);
  }, d = (f) => {
    a(f.ID), n(!0);
  };
  return (() => {
    var f = s0();
    return w(f, h(de, {
      get each() {
        return t.nodes;
      },
      children: (g) => (() => {
        var p = o0(), S = p.firstChild, _ = S.firstChild, m = _.nextSibling, y = m.nextSibling;
        return S.$$click = () => a(g.ID), _.$$click = () => i(!r()), w(m, () => g.fullyQualifiedName), w(y, h(ne, {
          type: "primary",
          onClick: () => d(g),
          get children() {
            return dp();
          }
        }), null), w(y, h(B, {
          get when() {
            return !g.locked;
          },
          get children() {
            return h(ne, {
              type: "danger",
              onClick: () => u(g),
              get children() {
                return hp();
              }
            });
          }
        }), null), w(p, h(B, {
          get when() {
            return P(() => !!g.details.length)() && r();
          },
          get children() {
            return h(gp, {
              get selectedDetail() {
                return t.selectedDetail;
              },
              parent: g,
              get nodes() {
                return g.details;
              },
              get selectedDetailId() {
                return t.selectedDetailId;
              },
              get addDetail() {
                return t.addDetail;
              },
              get removeDetail() {
                return t.removeDetail;
              }
            });
          }
        }), null), R((v) => {
          var x = g.ID === l(), C = !r(), E = !!r(), k = g.details.length ? "100%" : 0;
          return x !== v.e && S.classList.toggle("selected", v.e = x), C !== v.t && _.classList.toggle("fa-chevron-right", v.t = C), E !== v.a && _.classList.toggle("fa-chevron-down", v.a = E), k !== v.o && ((v.o = k) != null ? _.style.setProperty("opacity", k) : _.style.removeProperty("opacity")), v;
        }, {
          e: void 0,
          t: void 0,
          a: void 0,
          o: void 0
        }), p;
      })()
    }), null), w(f, h(Gt, {
      show: [s, o],
      get children() {
        var g = up(), p = g.firstChild, S = p.firstChild, _ = S.nextSibling;
        return _.$$click = () => o(!1), w(g, h(B, {
          get when() {
            return s();
          },
          get fallback() {
            return od();
          },
          get children() {
            return h(ld, {
              get selectedDetail() {
                return t.selectedDetail;
              },
              setSelectedBusinessObject: (m) => c(m)
            });
          }
        }), null), g;
      }
    }), null), f;
  })();
}
const x0 = [{
  value: "Selected",
  label: "Selected"
}, {
  value: "Currency",
  label: "Currency"
}, {
  value: "Date",
  label: "Date"
}, {
  value: "DateTime",
  label: "DateTime"
}, {
  value: "GUID",
  label: "GUID"
}, {
  value: "Image",
  label: "Image"
}, {
  value: "Lookup",
  label: "Lookup"
}, {
  value: "Memo",
  label: "Memo"
}, {
  value: "Numeric",
  label: "Numeric"
}, {
  value: "Phone",
  label: "Phone"
}, {
  value: "SSN",
  label: "SSN"
}, {
  value: "String",
  label: "String"
}];
function C0(t) {
  const [e, {
    setSelectedPropertyPickerBoid: n
  }] = Ba(), [r, i] = I(""), [s, o] = I([]);
  Z(() => n(t.detail?.primaryObject ?? ""));
  const l = P(() => {
    const g = r();
    return s().filter((p) => !r() || p.srcElement?.includes(g)).filter((p) => !d().includes("Selected") || a().some((S) => S.srcElement == p.srcElement && S.srcObject == p.boid)).filter((p) => d().includes(p.type));
  }), a = P(() => t.detail?.items ?? []);
  Z(async (g) => {
    if (e.propertyPicker.selectedBoid) {
      const p = e.businessObjects[e.propertyPicker.selectedBoid]?.properties ?? [];
      i(""), p && o(p);
    } else
      o([]);
  });
  const c = (g, p) => {
    a().find((_) => _.srcElement === g.srcElement && _.srcObject == g.boid)?.locked || t.toggleItem(g, p);
  }, u = (g, p) => {
    switch (g.code) {
      case "Space":
      case "Enter":
        g.preventDefault(), c(p);
        break;
    }
  }, [d, f] = I(["Currency", "Date", "DateTime", "GUID", "Image", "Lookup", "Memo", "Numeric", "Phone", "SSN", "String"]);
  return (() => {
    var g = a0(), p = g.firstChild, S = p.firstChild, _ = p.nextSibling, m = _.firstChild;
    return w(g, h(B, {
      get when() {
        return t.detail;
      },
      get children() {
        return h($0, {
          get detail() {
            return t.detail;
          },
          toggleItem: c
        });
      }
    }), p), w(p, h(dt, {
      value: [r, i],
      placeholder: "Filter"
    }), S), w(S, h(Ee, {
      label: "",
      icon: "filter",
      get value() {
        return I("");
      },
      get children() {
        var y = l0();
        return w(y, h(sa, {
          value: [d, f],
          options: x0
        })), y;
      }
    })), w(m, h(de, {
      get each() {
        return l();
      },
      children: (y) => (() => {
        var v = u0(), x = v.firstChild, C = x.nextSibling, E = C.nextSibling;
        return v.$$keydown = (k) => u(k, y), v.$$click = () => c(y), w(x, h(ql, {
          get search() {
            return r();
          },
          get text() {
            return y.srcElement ?? "";
          }
        })), w(C, () => y.type), w(E, h(B, {
          get when() {
            return a().some((k) => k.srcObject === y.boid && k.srcElement === y.srcElement);
          },
          get children() {
            return h(B, {
              get when() {
                return !a().find((k) => k.srcObject === y.boid && k.srcElement === y.srcElement)?.locked;
              },
              get fallback() {
                return d0();
              },
              get children() {
                return c0();
              }
            });
          }
        })), R((k) => {
          var L = !!a().some((G) => G.srcObject === y.boid && G.srcElement === y.srcElement), M = !!a().find((G) => G.srcObject === y.boid && G.srcElement === y.srcElement)?.locked;
          return L !== k.e && v.classList.toggle("active", k.e = L), M !== k.t && v.classList.toggle("locked", k.t = M), k;
        }, {
          e: void 0,
          t: void 0
        }), v;
      })()
    })), g;
  })();
}
function $0(t) {
  const [e, {
    loadPropertyPickerBos: n,
    setSelectedPropertyPickerBoid: r,
    addPropertyPickerBo: i,
    removePropertyPickerBo: s,
    toggleAddOneToOneModal: o,
    resetAdditionalPropertyPickerBos: l
  }] = Ba(), [a, c] = I(!1);
  Z(async () => {
    await n(t.detail);
  }), Z(() => {
    t.detail && l();
  }), Z(() => c(e.propertyPicker.isAdding)), Z(() => {
    a() != e.propertyPicker.isAdding && o(a());
  });
  const u = P(() => [...e.propertyPicker.businessObjects, ...e.propertyPicker.additionalBusinessObjects].map((g) => ({
    boid: g.boid,
    title: `${g.nameSpace}.${g.name}`,
    locked: g.boid === t.detail.primaryObject || t.detail.items.some((p) => p.srcObject === g.boid && p.locked)
  })) ?? []), d = (f) => {
    const g = [...e.propertyPicker.businessObjects, ...e.propertyPicker.additionalBusinessObjects].find((p) => p.boid === f.boid);
    if (g && !f.locked) {
      for (const p of g.properties)
        t.toggleItem(p, !1);
      s(g);
    }
  };
  return (() => {
    var f = f0(), g = f.firstChild, p = g.nextSibling;
    return w(g, h(de, {
      get each() {
        return u();
      },
      children: (S) => (() => {
        var _ = p0(), m = _.firstChild;
        return _.$$click = () => r(S.boid), w(m, () => S.title), w(_, h(B, {
          get when() {
            return !S.locked;
          },
          get children() {
            var y = g0();
            return y.$$click = () => d(S), y;
          }
        }), null), R(() => _.classList.toggle("active", S.boid === e.propertyPicker.selectedBoid)), _;
      })()
    })), w(p, h(ne, {
      onClick: () => {
        o(!0);
      },
      get children() {
        return dp();
      }
    }), null), w(p, h(Gt, {
      show: [a, c],
      get children() {
        var S = h0(), _ = S.firstChild;
        return _.firstChild, w(_, h(ne, {
          type: "info",
          onClick: () => o(!1),
          get children() {
            return hp();
          }
        }), null), w(S, h(B, {
          get when() {
            return t.detail;
          },
          get fallback() {
            return od();
          },
          get children() {
            return h(ld, {
              get selectedDetail() {
                return t.detail;
              },
              setSelectedBusinessObject: i
            });
          }
        }), null), S;
      }
    }), null), f;
  })();
}
function ld(t) {
  const [e, n] = I(""), [r, i] = I(!1), [s, o] = I();
  Z(async () => {
    const a = await Ql.GetRelatedBusinessObjects(t.selectedDetail?.primaryObject ?? "", r());
    o(a);
  });
  const l = P(() => {
    if (!e()) return s();
    const a = e();
    return {
      frequentlyUsed: s()?.frequentlyUsed.filter((u) => `${u.nameSpace}.${u.name}`.toLowerCase().includes(a?.toLowerCase())) ?? [],
      primary: s()?.primary.filter((u) => `${u.nameSpace}.${u.name}`.toLowerCase().includes(a?.toLowerCase())) ?? [],
      nonPrimary: s()?.nonPrimary.filter((u) => `${u.nameSpace}.${u.name}`.toLowerCase().includes(a?.toLowerCase())) ?? []
    };
  });
  return (() => {
    var a = b0(), c = a.firstChild;
    return w(a, h(dt, {
      value: [e, n],
      placeholder: "Filter"
    }), c), w(c, h(B, {
      get when() {
        return l();
      },
      get children() {
        return [h(B, {
          get when() {
            return l()?.frequentlyUsed.length;
          },
          get children() {
            return [m0(), h(de, {
              get each() {
                return l().frequentlyUsed;
              },
              children: (u) => (() => {
                var d = yc();
                return d.$$click = () => t.setSelectedBusinessObject(u), w(d, h(ql, {
                  get search() {
                    return e();
                  },
                  get text() {
                    return `${u.nameSpace}.${u.name}`;
                  }
                })), d;
              })()
            })];
          }
        }), h(B, {
          get when() {
            return l().primary.length;
          },
          get children() {
            return [v0(), h(de, {
              get each() {
                return l().primary;
              },
              children: (u) => (() => {
                var d = yc();
                return d.$$click = () => t.setSelectedBusinessObject(u), w(d, h(ql, {
                  get search() {
                    return e();
                  },
                  get text() {
                    return `${u.nameSpace}.${u.name}`;
                  }
                })), d;
              })()
            })];
          }
        }), h(B, {
          get when() {
            return l().nonPrimary.length;
          },
          get children() {
            return [y0(), h(de, {
              get each() {
                return l().nonPrimary;
              },
              children: (u) => (() => {
                var d = yc();
                return d.$$click = () => t.setSelectedBusinessObject(u), w(d, h(ql, {
                  get search() {
                    return e();
                  },
                  get text() {
                    return `${u.nameSpace}.${u.name}`;
                  }
                })), d;
              })()
            })];
          }
        })];
      }
    })), a;
  })();
}
function ql(t) {
  const e = P(() => t.text.toLowerCase().indexOf(t.search.toLowerCase())), n = P(() => e() + t.search.length), r = () => t.text.substring(0, e()), i = () => t.text.substring(e(), n()), s = () => t.text.substring(n());
  return [(() => {
    var o = kh();
    return w(o, r), o;
  })(), (() => {
    var o = w0();
    return w(o, i), o;
  })(), (() => {
    var o = kh();
    return w(o, s), o;
  })()];
}
Xe(["click", "keydown"]);
var E0 = /* @__PURE__ */ T('<button class=inline-edit-button><span class="fa fa-edit">'), T0 = /* @__PURE__ */ T("<div class=inline-edit-value tabindex=0><div>"), A0 = /* @__PURE__ */ T("<div class=inline-edit-editor>"), k0 = /* @__PURE__ */ T("<div class=inline-edit>");
class I0 {
  disabled;
  model = I("");
  onSave;
}
let wo = null;
const pp = (t) => {
  wo && (wo.el.contains(t.target) || (wo.save(), wo.isEditing[1](!1), document.removeEventListener("mouseup", pp)));
};
function Hs(t) {
  let e;
  const n = I(!1), [r, i] = n, [s, o] = t.model, l = () => {
  }, a = (u) => {
    u.stopPropagation(), u.preventDefault(), u.stopImmediatePropagation(), t.disabled || (i(!0), e.focus(), document.addEventListener("mouseup", pp), wo = {
      el: e,
      isEditing: n,
      save: c
    });
  }, c = async () => {
    try {
      t.onSave && typeof t.onSave == "function" && await t.onSave(s());
    } catch (u) {
      console.error(u);
    }
    i(!1);
  };
  return (() => {
    var u = k0();
    return w(u, h(B, {
      get when() {
        return !r();
      },
      get children() {
        var d = T0(), f = d.firstChild;
        return d.$$keydown = l, w(f, s), w(d, h(B, {
          get when() {
            return !t.disabled;
          },
          get children() {
            var g = E0();
            return g.$$click = a, g;
          }
        }), null), d;
      }
    }), null), w(u, h(B, {
      get when() {
        return r();
      },
      get children() {
        var d = A0();
        return w(d, h(dt, {
          ref(f) {
            var g = e;
            typeof g == "function" ? g(f) : e = f;
          },
          get value() {
            return t.model;
          }
        })), d;
      }
    }), null), u;
  })();
}
Hs.defaultProps = new I0();
Xe(["keydown", "click"]);
const oi = {
  "st-data-source-editor": "_st-data-source-editor_j8m4d_1",
  "query-error": "_query-error_j8m4d_15",
  "preview-table": "_preview-table_j8m4d_31",
  "sql-query-textarea": "_sql-query-textarea_j8m4d_79",
  "parameter-editor-container": "_parameter-editor-container_j8m4d_97",
  "parameter-list": "_parameter-list_j8m4d_113",
  "parameter-list-item": "_parameter-list-item_j8m4d_133",
  "parameter-editor": "_parameter-editor_j8m4d_97"
};
var O0 = /* @__PURE__ */ T("<label><input type=checkbox><span>");
class D0 {
  label;
  value;
  class;
}
function ut(t) {
  const [e, n] = t.value ?? I(!1);
  return (() => {
    var r = O0(), i = r.firstChild, s = i.nextSibling;
    return i.addEventListener("change", (o) => n(o.target.checked)), w(s, () => t.label), R(() => D(r, `st-checkbox ${t.class || ""}`)), R(() => i.checked = e()), r;
  })();
}
ut.defaultProps = new D0();
var L0 = /* @__PURE__ */ T("<span style=white-space:nowrap>Data Source"), N0 = /* @__PURE__ */ T("<div class=flexbox style=gap:8px><b style=font-size:13px>Parameters</b><div><div></div><div>"), P0 = /* @__PURE__ */ T("<button>"), R0 = /* @__PURE__ */ T("<div>No parameter selected"), M0 = /* @__PURE__ */ T("<div class=flexbox>");
function q0() {
  cd();
  const [t, e] = er({
    "@SQL_PARAM": new Ih(),
    "@DATA_SOURCE_PARAM": new Oh(),
    "@LOOKUP_PARAM": new Dh(),
    "@DATE_PARAM": new Lh(),
    "@NUMBER_PARAM": new Nh(),
    "@TEXT_PARAM": new Ph()
  }), n = P(() => Object.keys(t)), [r, i] = I("@SQL_PARAM"), s = P(() => t[r()]), o = (l) => {
    if (!s() || s().type === l) return;
    let a;
    switch (l) {
      case "SQL":
        a = new Ih();
        break;
      case "Data Source":
        a = new Oh();
        break;
      case "Lookup":
        a = new Dh();
        break;
      case "Date":
        a = new Lh();
        break;
      case "Number":
        a = new Nh();
        break;
      case "Text":
        a = new Ph();
        break;
    }
    e(r(), a);
  };
  return (() => {
    var l = N0(), a = l.firstChild, c = a.nextSibling, u = c.firstChild, d = u.nextSibling;
    return w(u, h(de, {
      get each() {
        return n();
      },
      children: (f) => (() => {
        var g = P0();
        return g.$$click = () => i(f), w(g, f), R((p) => {
          var S = oi["parameter-list-item"], _ = r() === f;
          return S !== p.e && D(g, p.e = S), _ !== p.t && ye(g, "data-selected", p.t = _), p;
        }, {
          e: void 0,
          t: void 0
        }), g;
      })()
    })), w(d, h(B, {
      get when() {
        return s();
      },
      get fallback() {
        return h(B0, {});
      },
      get children() {
        return h(Zn, {
          get children() {
            return [h(ne, {
              icon: "fa fa-database",
              onClick: () => o("SQL"),
              get active() {
                return s()?.type === "SQL";
              },
              children: "SQL"
            }), h(ne, {
              icon: "fa fa-folder",
              onClick: () => o("Data Source"),
              get active() {
                return s()?.type === "Data Source";
              },
              get children() {
                return L0();
              }
            }), h(ne, {
              icon: "fa fa-table",
              onClick: () => o("Lookup"),
              get active() {
                return s()?.type === "Lookup";
              },
              children: "Lookup"
            }), h(ne, {
              icon: "fa fa-calendar",
              onClick: () => o("Date"),
              get active() {
                return s()?.type === "Date";
              },
              children: "Date"
            }), h(ne, {
              icon: "fa fa-dollar-sign",
              onClick: () => o("Number"),
              get active() {
                return s()?.type === "Number";
              },
              children: "Number"
            }), h(ne, {
              icon: "fa fa-pencil",
              onClick: () => o("Text"),
              get active() {
                return s()?.type === "Text";
              },
              children: "Text"
            })];
          }
        });
      }
    }), null), w(d, h(Zt, {
      get children() {
        return h(Pe, {
          get when() {
            return s()?.type === "SQL";
          },
          get children() {
            return h(U0, {});
          }
        });
      }
    }), null), R((f) => {
      var g = oi["parameter-editor-container"], p = oi["parameter-list"], S = oi["parameter-editor"];
      return g !== f.e && D(c, f.e = g), p !== f.t && D(u, f.t = p), S !== f.a && D(d, f.a = S), f;
    }, {
      e: void 0,
      t: void 0,
      a: void 0
    }), l;
  })();
}
const B0 = () => R0(), U0 = () => {
  const t = I("0");
  return I(""), I(""), I(!1), (() => {
    var e = M0();
    return w(e, h(dt, {
      type: "number",
      value: t,
      label: "Display Sequence"
    })), e;
  })();
};
class so {
  name = "";
  displaySequence = 0;
  inputLabelOverride = "";
}
class Ih extends so {
  type = "SQL";
  query = "";
  useCurrentParamAsDefault = !1;
  useFirstListValueAsDefault = !0;
  currentParamValue;
  displayField;
  valueField;
}
class Oh extends so {
  type = "Data Source";
  currentParamValue;
  useCurrentParamAsDefault = !1;
  useFirstListValueAsDefault = !0;
  dataSource;
  displayField;
  valueField;
}
class Dh extends so {
  type = "Lookup";
  currentParamValue;
  useCurrentParamAsDefault = !1;
  useFirstListValueAsDefault = !0;
  lookupType;
  //TODO: Not sure what the valid options are
  //TODO: Potentially able to define a custom static lookup here
}
class Lh extends so {
  type = "Date";
  offset = 0;
  date = "";
  useCurrentParamAsDefault = !1;
}
class Nh extends so {
  type = "Number";
  number = 0;
  useCurrentParamAsDefault = !1;
}
class Ph extends so {
  type = "Text";
  text = "";
  useCurrentParamAsDefault = !1;
}
Xe(["click"]);
const pr = {
  "bo-panel": "_bo-panel_r4e96_1",
  "bo-panel-left": "_bo-panel-left_r4e96_19",
  "bo-panel-right": "_bo-panel-right_r4e96_41",
  "bo-node": "_bo-node_r4e96_49",
  "bo-node-label": "_bo-node-label_r4e96_85",
  "bo-node-actions": "_bo-node-actions_r4e96_143",
  "property-panel": "_property-panel_r4e96_163",
  "property-list": "_property-list_r4e96_171",
  "property-helper-text": "_property-helper-text_r4e96_191",
  "property-list-item": "_property-list-item_r4e96_203",
  "property-table": "_property-table_r4e96_233"
}, j0 = {
  "tab-group": "_tab-group_1t9dc_1"
};
var G0 = /* @__PURE__ */ T("<div><nav><ul role=tablist>"), F0 = /* @__PURE__ */ T("<li role=presentation><button role=tab tabindex=0>");
class V0 {
  selectedTabId;
  setSelectedTabId;
  tabs = [];
  setTabs;
  constructor(e) {
    [this.selectedTabId, this.setSelectedTabId] = e ?? I(""), [this.tabs, this.setTabs] = er([]);
  }
  addTab(e, n) {
    this.setTabs((r) => [...r, {
      id: e,
      label: n
    }]);
  }
  removeTab(e) {
    this.setTabs((n) => n.filter((r) => r.id !== e));
  }
}
const mp = bt();
class H0 {
  id;
  selectedTabId;
}
function oa(t) {
  const e = new V0(t.selectedTabId);
  return h(mp.Provider, {
    value: e,
    get children() {
      var n = G0(), r = n.firstChild, i = r.firstChild;
      return w(i, h(de, {
        get each() {
          return e.tabs;
        },
        children: (s) => (() => {
          var o = F0(), l = o.firstChild;
          return l.$$click = () => e.setSelectedTabId(s.id), w(l, () => s.label), R((a) => {
            var c = e.selectedTabId() === s.id, u = `panel-${s.id}`, d = `tab-${s.id}`;
            return c !== a.e && ye(l, "aria-selected", a.e = c), u !== a.t && ye(l, "aria-controls", a.t = u), d !== a.a && ye(l, "id", a.a = d), a;
          }, {
            e: void 0,
            t: void 0,
            a: void 0
          }), o;
        })()
      })), w(n, () => t.children, null), R(() => D(n, j0["tab-group"])), n;
    }
  });
}
oa.defaultProps = new H0();
const z0 = () => {
  const t = Nt(mp);
  if (!t)
    throw new Error("TabGroupContext not found");
  return t;
};
Xe(["click"]);
const W0 = {
  "st-tab": "_st-tab_1nyi0_1"
};
var J0 = /* @__PURE__ */ T("<div role=tabpanel tabindex=0>");
class Q0 {
  id;
  label;
  readOnly = !1;
  hidden = !1;
  dataInvalidOnTabChange = !1;
  helpId;
  licenseKey;
  lmsPage;
  localization;
  system = !1;
  useInAddWizard = !1;
}
function Ji(t) {
  const e = t.id ?? Cr(), n = z0();
  return jt(() => {
    n.addTab(e, t.label);
  }), h(B, {
    get when() {
      return n.selectedTabId() === e;
    },
    get children() {
      var r = J0();
      return ye(r, "id", `panel-${e}`), ye(r, "aria-labelledby", `tab-${e}`), w(r, () => t.children), R(() => D(r, W0["st-tab"])), r;
    }
  });
}
Ji.defaultProps = new Q0();
const Jn = {
  "st-table": "_st-table_1i9g8_1",
  "st-table-head": "_st-table-head_1i9g8_1",
  "st-table-head-row": "_st-table-head-row_1i9g8_47",
  "st-table-head-cell": "_st-table-head-cell_1i9g8_61",
  "st-table-head-cell-actions": "_st-table-head-cell-actions_1i9g8_91",
  "st-table-body": "_st-table-body_1i9g8_131",
  "st-head-action": "_st-head-action_1i9g8_147",
  "st-table-row": "_st-table-row_1i9g8_163",
  "st-table-row-cell": "_st-table-row-cell_1i9g8_191"
};
class K0 {
  columnIds;
  setColumnIds;
  maxHeaderDepth;
  setMaxHeaderDepth;
  hiddenColumnIds;
  setHiddenColumnIds;
  page;
  setPage;
  loading;
  setLoading;
  visibleColumnIds;
  constructor() {
    [this.columnIds, this.setColumnIds] = I([]), [this.maxHeaderDepth, this.setMaxHeaderDepth] = I(0), [this.hiddenColumnIds, this.setHiddenColumnIds] = I([]), [this.page, this.setPage] = I(0), [this.loading, this.setLoading] = I(!1), this.visibleColumnIds = P(() => this.columnIds().filter((e) => !this.hiddenColumnIds().includes(e)));
  }
  registerColumn(e, n) {
    this.setColumnIds((r) => [...r, e]), this.setMaxHeaderDepth((r) => Math.max(r, n));
  }
  toggleColumnVisibility(e, n) {
    const r = !this.hiddenColumnIds().includes(e), i = n ?? !r;
    this.setHiddenColumnIds((s) => i ? s.filter((o) => o !== e) : [...s, e]);
  }
}
const vp = bt(), Y0 = vp.Provider, Zo = () => {
  const t = Nt(vp);
  if (!t) throw new Error("useTable must be called from a child of STTable");
  return t;
};
var X0 = /* @__PURE__ */ T("<tr>");
const yp = (t) => (() => {
  var e = X0();
  return w(e, () => t.children), R(() => D(e, Jn["st-table-row"])), e;
})();
var Z0 = /* @__PURE__ */ T("<td>");
const bp = (t) => {
  const e = Zo(), [n, r] = Wr(t, ["children", "id", "class"]), i = P(() => t.id ? !e.hiddenColumnIds().includes(t.id) : !0);
  return h(B, {
    get when() {
      return i();
    },
    get children() {
      var s = Z0();
      return io(s, Xt({
        get class() {
          return `${Jn["st-table-row-cell"]} ${t.class}`;
        }
      }, r), !1, !0), w(s, () => t.children), s;
    }
  });
};
var e1 = /* @__PURE__ */ T('<div class="flexbox middle"style=height:300px;width:100%;justify-content:center;gap:1rem;><div><i class="fa fa-spinner fa-spin"style=font-size:5rem></i></div><div style=font-size:1.3rem;>Loading...'), t1 = /* @__PURE__ */ T("<tbody>");
const n1 = (t) => {
  const e = Zo(), [n, r] = I([]);
  Z(async () => {
    if (t.load) {
      e.setLoading(!0);
      try {
        const o = await t.load(e.page(), {});
        r(o);
      } catch {
      }
      e.setLoading(!1);
    }
  });
  const i = P(() => {
    if (typeof t.children == "function") {
      const o = t.children;
      return h(de, {
        get each() {
          return n();
        },
        children: (l) => o(l)
      });
    }
    return t.children;
  }), s = () => h(yp, {
    get children() {
      return h(bp, {
        style: "grid-column-start: 1; grid-column-end: -1;",
        get children() {
          return e1();
        }
      });
    }
  });
  return (() => {
    var o = t1();
    return w(o, h(B, {
      get when() {
        return !e.loading();
      },
      get fallback() {
        return h(s, {});
      },
      get children() {
        return i();
      }
    })), R(() => D(o, Jn["st-table-body"])), o;
  })();
};
var r1 = /* @__PURE__ */ T("<th>");
class i1 {
  depth = 0;
  parent = void 0;
  columnIds;
  setColumnIds;
  columnStart;
  setColumnStart;
  columnEnd;
  setColumnEnd;
  constructor(e) {
    this.parent = e, this.depth = e ? e.depth + 1 : 0, [this.columnIds, this.setColumnIds] = I([]), [this.columnStart, this.setColumnStart] = I(0), [this.columnEnd, this.setColumnEnd] = I(0);
  }
  registerColumn(e) {
    this.setColumnIds((n) => [...n, e]), this.parent?.registerColumn(e);
  }
}
const wp = bt(), _p = () => Nt(wp), s1 = (t) => {
  const e = Zo(), n = _p(), r = new i1(n), i = P(() => r.columnIds().filter((u) => !e.hiddenColumnIds().includes(u)).map((u) => e.visibleColumnIds().indexOf(u))), s = P(() => i().reduce((u, d) => Math.min(u, d), 1 / 0)), o = P(() => i().reduce((u, d) => Math.max(u, d), -1 / 0)), l = P(() => n ? n.depth + 2 : 1), a = P(() => l() + 1), c = () => {
    for (const u of r.columnIds())
      e.toggleColumnVisibility(u, !1);
  };
  return h(wp.Provider, {
    value: r,
    get children() {
      return [h(B, {
        get when() {
          return i().length;
        },
        get children() {
          var u = r1();
          return u.$$click = c, w(u, () => t.title), R((d) => {
            var f = Jn["st-table-head-cell"], g = `grid-column-start: ${s() + 1}; grid-column-end: ${o() + 2}; grid-row-start: ${l()}; grid-row-end: ${a()};`;
            return f !== d.e && D(u, d.e = f), d.t = Yn(u, g, d.t), d;
          }, {
            e: void 0,
            t: void 0
          }), u;
        }
      }), P(() => t.children)];
    }
  });
};
Xe(["click"]);
var o1 = /* @__PURE__ */ T("<thead><tr>");
const l1 = (t) => {
  const e = Zo();
  return (() => {
    var n = o1(), r = n.firstChild;
    return w(r, () => t.children), R((i) => {
      var s = Jn["st-table-head"], o = Jn["st-table-head-row"], l = `grid-template-rows: repeat(${e.maxHeaderDepth() + 1}, 1fr)`;
      return s !== i.e && D(n, i.e = s), o !== i.t && D(r, i.t = o), i.a = Yn(r, l, i.a), i;
    }, {
      e: void 0,
      t: void 0,
      a: void 0
    }), n;
  })();
};
var a1 = /* @__PURE__ */ T('<th><div><span></span><div class="flexbox vertical"><span></span><span></span></div><span>');
const c1 = (t) => {
  const e = Zo(), n = _p(), r = t.id ?? Cr(), i = P(() => e.visibleColumnIds().indexOf(r)), s = n ? n.depth + 1 : 0;
  e.registerColumn(r, s), n?.registerColumn(r);
  const o = P(() => `grid-column-start: ${i() + 1}; grid-column-end: ${i() + 2}; grid-row-start: ${s + 1}; grid-row-end: -1;`), l = P(() => !e.hiddenColumnIds().includes(r));
  return h(B, {
    get when() {
      return l();
    },
    get children() {
      var a = a1(), c = a.firstChild, u = c.firstChild, d = u.nextSibling, f = d.firstChild, g = f.nextSibling, p = d.nextSibling;
      return w(a, () => t.children, c), R((S) => {
        var _ = Jn["st-table-head-cell"], m = o(), y = Jn["st-table-head-cell-actions"], v = `${Jn["st-head-action"]} fa fa-caret-down`, x = `${Jn["st-head-action"]} fa fa-caret-up`, C = `${Jn["st-head-action"]} fa fa-caret-down`, E = `${Jn["st-head-action"]} fa fa-filter`;
        return _ !== S.e && D(a, S.e = _), S.t = Yn(a, m, S.t), y !== S.a && D(c, S.a = y), v !== S.o && D(u, S.o = v), x !== S.i && D(f, S.i = x), C !== S.n && D(g, S.n = C), E !== S.s && D(p, S.s = E), S;
      }, {
        e: void 0,
        t: void 0,
        a: void 0,
        o: void 0,
        i: void 0,
        n: void 0,
        s: void 0
      }), a;
    }
  });
};
var u1 = /* @__PURE__ */ T("<table>");
const kn = (t) => {
  const e = new K0();
  return h(Y0, {
    value: e,
    get children() {
      var n = u1();
      return w(n, () => t.children), R((r) => {
        var i = Jn["st-table"], s = `repeat(${e.visibleColumnIds().length}, auto)`;
        return i !== r.e && D(n, r.e = i), s !== r.t && ((r.t = s) != null ? n.style.setProperty("grid-template-columns", s) : n.style.removeProperty("grid-template-columns")), r;
      }, {
        e: void 0,
        t: void 0
      }), n;
    }
  });
};
kn.defaultProps = {};
kn.Head = l1;
kn.HeadCell = c1;
kn.Body = n1;
kn.Row = yp;
kn.Cell = bp;
kn.SuperTitle = s1;
var d1 = /* @__PURE__ */ T("<div>Conditions"), h1 = /* @__PURE__ */ T("<div>Sorts"), f1 = /* @__PURE__ */ T("<div>Type in Query"), g1 = /* @__PURE__ */ T("<ul>"), p1 = /* @__PURE__ */ T("<div>"), m1 = /* @__PURE__ */ T("<div class=flexbox style=gap:8px;padding-top:8px;><div></div><div></div><div><table><thead><tr><th rowspan=2></th><th rowspan=2></th><th rowspan=2></th><th rowspan=2>Name</th><th rowspan=2>Label Override</th><th rowspan=2>Width</th><th rowspan=2>Hide</th><th colspan=2>Lookup Display</th><th rowspan=2>Group</th><th rowspan=2>Aggregate</th><th rowspan=2>Break</th></tr><tr><th>Display Type</th><th>Include Alt Code</th></tr></thead><tbody>"), v1 = /* @__PURE__ */ T("<span>Loading..."), y1 = /* @__PURE__ */ T('<span class="fa fa-trash"style=color:var(--st-color-red)>'), b1 = /* @__PURE__ */ T('<span class="fa fa-bars"style=cursor:move;>'), w1 = /* @__PURE__ */ T('<span class="fa fa-chart-simple">'), _1 = /* @__PURE__ */ T("<tr><td></td><td></td><td></td><td><span></span></td><td></td><td></td><td></td><td></td><td></td><td></td><td></td><td>"), S1 = /* @__PURE__ */ T('<span class="fa fa-plus">'), x1 = /* @__PURE__ */ T('<span class="fa fa-trash">'), C1 = /* @__PURE__ */ T('<li><div><div class="flexbox horizontal"style=gap:4px;><span class=fa-regular></span><span></span></div><div></div></div><ul>'), $1 = /* @__PURE__ */ T('<div class=flexbox><span class="fa fa-plus"style=font-size:3rem;></span><span style=font-size:0.9rem;>Add Root Business Object'), E1 = /* @__PURE__ */ T("<div><div><span>Select a property to add it to the list"), Rh = /* @__PURE__ */ T("<span>"), T1 = /* @__PURE__ */ T("<span style=color:red;>"), A1 = /* @__PURE__ */ T("<div><div style=grid-column:1;></div><div style=grid-column:2;>");
class k1 {
  query;
  setQuery;
  queryModel;
  setQueryModel;
  selectedBoAlias;
  setSelectedBoAlias;
  isLoading;
  setIsLoading;
  selectedBo;
  allBos;
  properties;
  boProperties = {};
  constructor(e) {
    [this.query, this.setQuery] = e ?? I(""), [this.selectedBoAlias, this.setSelectedBoAlias] = I(""), [this.queryModel, this.setQueryModel] = er({
      conditionContainer: new Ny(),
      sorts: [],
      primaryBO: void 0,
      properties: []
    }), [this.isLoading, this.setIsLoading] = I(!1), this.selectedBo = P(() => {
      let n = this.queryModel.primaryBO ? {
        ...this.queryModel.primaryBO
      } : void 0;
      if (!n) return;
      const r = (i) => {
        if (i.alias === this.selectedBoAlias()) return i;
        for (let s of i.children) {
          const o = r(s);
          if (o) return o;
        }
      };
      return r(n);
    }), this.allBos = P(() => {
      const n = [], r = (i) => {
        n.push(i);
        for (let s of i.children)
          r(s);
      };
      return this.queryModel.primaryBO && r(this.queryModel.primaryBO), n;
    }), this.properties = P(() => this.selectedBo() ? [] : []);
  }
  removeBO(e) {
    console.log("removing", e), this.queryModel.primaryBO && (this.queryModel.primaryBO.alias === e.alias && this.setQueryModel("primaryBO", void 0), this.setQueryModel(ia((n) => {
      const r = (i) => {
        const s = i.children.findIndex((o) => o.alias === e.alias);
        if (s !== -1) {
          console.log("splice", i.alias), i.children.splice(s, 1);
          return;
        }
        for (let o of i.children)
          r(o);
      };
      r(n.primaryBO);
    })));
  }
  editProperty(e, n, r) {
    this.setQueryModel("properties", (i) => i.order === e.order, n, r);
  }
}
const Sp = bt();
class I1 {
  query;
}
function la(t) {
  const [e, n] = t.query ?? I(""), r = new k1([e, n]);
  Z(Tr([() => t.query], async () => {
    r.setIsLoading(!0);
    try {
      const o = await zg.ParseQuery(e());
      r.setQueryModel(o);
    } catch (o) {
      console.error(o);
    }
    r.setIsLoading(!1);
  }));
  const [i, s] = I("columns");
  return h(Sp.Provider, {
    value: r,
    get children() {
      return h(oa, {
        selectedTabId: [i, s],
        get children() {
          return [h(Ji, {
            id: "columns",
            label: "Columns",
            get children() {
              return h(O1, {});
            }
          }), h(Ji, {
            id: "conditions",
            label: "Conditions",
            get children() {
              return d1();
            }
          }), h(Ji, {
            id: "sorts",
            label: "Sorts",
            get children() {
              return h1();
            }
          }), h(Ji, {
            id: "type-in-query",
            label: "Type in Query",
            get children() {
              return f1();
            }
          })];
        }
      });
    }
  });
}
la.defaultProps = new I1();
const O1 = () => {
  const t = ad();
  return (() => {
    var e = m1(), n = e.firstChild, r = n.nextSibling, i = r.nextSibling, s = i.firstChild, o = s.firstChild, l = o.nextSibling;
    return w(n, h(B, {
      get when() {
        return !t.isLoading();
      },
      get fallback() {
        return v1();
      },
      get children() {
        return [(() => {
          var a = g1();
          return w(a, h(B, {
            get when() {
              return t.queryModel?.primaryBO;
            },
            get fallback() {
              return h(D1, {});
            },
            get children() {
              return h(xp, {
                get bo() {
                  return t.queryModel.primaryBO;
                }
              });
            }
          })), R(() => D(a, pr["bo-panel-left"])), a;
        })(), (() => {
          var a = p1();
          return w(a, h(L1, {})), R(() => D(a, pr["bo-panel-right"])), a;
        })()];
      }
    })), w(r, h(kn, {
      get children() {
        return h(kn.Head, {
          get children() {
            return [h(kn.HeadCell, {
              children: "Actions"
            }), h(kn.HeadCell, {
              children: "Actions"
            }), h(kn.HeadCell, {
              children: "Actions"
            }), h(kn.HeadCell, {
              children: "Actions"
            })];
          }
        });
      }
    })), w(l, h(de, {
      get each() {
        return t.queryModel.properties;
      },
      children: (a) => (() => {
        var c = _1(), u = c.firstChild, d = u.nextSibling, f = d.nextSibling, g = f.nextSibling, p = g.firstChild, S = g.nextSibling, _ = S.nextSibling, m = _.nextSibling, y = m.nextSibling, v = y.nextSibling, x = v.nextSibling, C = x.nextSibling, E = C.nextSibling;
        return w(u, h(ne, {
          onClick: () => {
          },
          type: "info",
          get children() {
            return y1();
          }
        })), w(d, h(ne, {
          onClick: () => {
          },
          type: "info",
          get children() {
            return b1();
          }
        })), w(f, h(ne, {
          onClick: () => {
          },
          type: "default",
          get children() {
            return w1();
          }
        })), w(p, () => a.name.srcElement), w(S, h(dt, {
          get value() {
            return Ie(() => a.labelOverride ?? "", (k) => t.editProperty(a, "labelOverride", k));
          }
        })), w(_, h(dt, {
          get value() {
            return Ie(() => a.width ?? "", (k) => t.editProperty(a, "width", k));
          }
        })), w(m, h(ut, {
          get value() {
            return Ie(() => a.hide ?? !1, (k) => t.editProperty(a, "hide", k));
          },
          label: ""
        })), w(y, h(Ee, {
          label: "",
          get value() {
            return Ie(() => go[a.displayType], (k) => t.editProperty(a, "displayType", k));
          },
          get children() {
            return [h(Ee.Option, {
              get value() {
                return go.Default;
              },
              children: "Default"
            }), h(Ee.Option, {
              get value() {
                return go.Code;
              },
              children: "Code"
            }), h(Ee.Option, {
              get value() {
                return go.Description;
              },
              children: "Description"
            }), h(Ee.Option, {
              get value() {
                return go.Both;
              },
              children: "Both"
            })];
          }
        })), w(v, h(Ee, {
          label: "",
          get value() {
            return Ie(() => Ti[a.altCodeType] ?? "", (k) => t.editProperty(a, "altCodeType", k));
          },
          get children() {
            return [h(Ee.Option, {
              get value() {
                return Ti.None;
              },
              children: "None"
            }), h(Ee.Option, {
              get value() {
                return Ti.SIS;
              },
              children: "SIS"
            }), h(Ee.Option, {
              get value() {
                return Ti.State;
              },
              children: "State"
            }), h(Ee.Option, {
              get value() {
                return Ti.Alt3;
              },
              children: "Alt3"
            }), h(Ee.Option, {
              get value() {
                return Ti.SIF;
              },
              children: "SIF"
            }), h(Ee.Option, {
              get value() {
                return Ti.EdFi;
              },
              children: "EdFi"
            }), h(Ee.Option, {
              get value() {
                return Ti.Federal;
              },
              children: "Federal"
            })];
          }
        })), w(x, h(dt, {
          get value() {
            return Ie(() => a.group ?? "", (k) => t.editProperty(a, "group", k));
          }
        })), w(C, h(Ee, {
          label: "",
          get value() {
            return Ie(() => Wi[a.aggregateType], (k) => t.editProperty(a, "aggregateType", k));
          },
          get children() {
            return [h(Ee.Option, {
              get value() {
                return Wi.None;
              },
              children: "None"
            }), h(Ee.Option, {
              get value() {
                return Wi.Sum;
              },
              children: "Sum"
            }), h(Ee.Option, {
              get value() {
                return Wi.Count;
              },
              children: "Count"
            }), h(Ee.Option, {
              get value() {
                return Wi.Min;
              },
              children: "Min"
            }), h(Ee.Option, {
              get value() {
                return Wi.Max;
              },
              children: "Max"
            }), h(Ee.Option, {
              get value() {
                return Wi.Avg;
              },
              children: "Avg"
            })];
          }
        })), w(E, h(Ee, {
          label: "",
          get value() {
            return Ie(() => wl[a.break], (k) => t.editProperty(a, "break", k));
          },
          get children() {
            return [h(Ee.Option, {
              get value() {
                return wl.None;
              },
              children: "None"
            }), h(Ee.Option, {
              get value() {
                return wl.Group;
              },
              children: "Group"
            }), h(Ee.Option, {
              get value() {
                return wl.Page;
              },
              children: "Page"
            })];
          }
        })), c;
      })()
    })), R((a) => {
      var c = pr["bo-panel"], u = pr["property-table"];
      return c !== a.e && D(n, a.e = c), u !== a.t && D(s, a.t = u), a;
    }, {
      e: void 0,
      t: void 0
    }), e;
  })();
}, xp = (t) => {
  const e = ad(), [n, r] = I(!0);
  return (() => {
    var i = C1(), s = i.firstChild, o = s.firstChild, l = o.firstChild, a = l.nextSibling, c = o.nextSibling, u = s.nextSibling;
    return s.$$click = () => e.setSelectedBoAlias(t.bo.alias ?? ""), l.$$click = () => r(!n()), w(a, () => `${t.bo.name} (${t.bo.alias})`), w(c, h(ne, {
      onClick: () => {
      },
      type: "primary",
      get children() {
        return S1();
      }
    }), null), w(c, h(ne, {
      onClick: () => {
        e.removeBO(t.bo);
      },
      type: "danger",
      get children() {
        return x1();
      }
    }), null), w(u, h(B, {
      get when() {
        return n();
      },
      get children() {
        return h(de, {
          get each() {
            return t.bo.children;
          },
          children: (d) => h(xp, {
            bo: d
          })
        });
      }
    })), R((d) => {
      var f = `flexbox ${pr["bo-node"]}`, g = pr["bo-node-label"], p = t.bo.alias === e.selectedBoAlias(), S = {
        "fa-square-minus": n(),
        "fa-square-plus": !n()
      }, _ = t.bo.children.length > 0 ? 1 : 0, m = pr["bo-node-actions"], y = pr["bo-node-list"];
      return f !== d.e && D(i, d.e = f), g !== d.t && D(s, d.t = g), p !== d.a && ye(s, "data-selected", d.a = p), d.o = ro(l, S, d.o), _ !== d.i && ((d.i = _) != null ? l.style.setProperty("opacity", _) : l.style.removeProperty("opacity")), m !== d.n && D(c, d.n = m), y !== d.s && D(u, d.s = y), d;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0,
      n: void 0,
      s: void 0
    }), i;
  })();
}, D1 = () => h(ne, {
  type: "primary",
  onClick: () => {
  },
  get children() {
    return $1();
  }
}), L1 = () => {
  const [t, e] = I(""), n = ad(), [r, i] = I(!1), [s, o] = I([]);
  Z(Tr([() => n.selectedBo()], async () => {
    console.log("loading properties");
    const a = n.selectedBo();
    if (!a || !a.BOID) return;
    const c = n.boProperties[a.BOID];
    if (c) {
      o(Object.values(c));
      return;
    }
    i(!0);
    const u = await zg.LoadProperties(a.BOID, !0);
    n.boProperties[a.BOID] = u, o(u), i(!1);
  }));
  const l = P(() => s().filter((a) => a.srcElement?.toLowerCase().includes(t().toLowerCase())));
  return (() => {
    var a = E1(), c = a.firstChild, u = c.firstChild;
    return w(a, h(dt, {
      placeholder: "Filter",
      icon: "fa fa-search",
      value: [t, e]
    }), c), w(c, h(de, {
      get each() {
        return l();
      },
      children: (d) => {
        const f = P(() => t() && d.srcElement ? d.srcElement.toLowerCase().indexOf(t().toLowerCase()) : -1);
        return (() => {
          var g = A1(), p = g.firstChild, S = p.nextSibling;
          return w(p, h(B, {
            get when() {
              return f() > -1;
            },
            get fallback() {
              return d.srcElement;
            },
            get children() {
              return [(() => {
                var _ = Rh();
                return w(_, () => d.srcElement?.substring(0, f())), _;
              })(), (() => {
                var _ = T1();
                return w(_, () => d.srcElement?.substring(f(), f() + t().length)), _;
              })(), (() => {
                var _ = Rh();
                return w(_, () => d.srcElement?.substring(f() + t().length)), _;
              })()];
            }
          })), w(S, () => d.type), R((_) => {
            var m = pr["property-list-item"], y = n.properties().some((v) => v.name.srcElement === d.srcElement);
            return m !== _.e && D(g, _.e = m), y !== _.t && ye(g, "data-included", _.t = y), _;
          }, {
            e: void 0,
            t: void 0
          }), g;
        })();
      }
    }), null), R((d) => {
      var f = pr["property-panel"], g = pr["property-list"], p = pr["property-helper-text"];
      return f !== d.e && D(a, d.e = f), g !== d.t && D(c, d.t = g), p !== d.a && D(u, d.a = p), d;
    }, {
      e: void 0,
      t: void 0,
      a: void 0
    }), a;
  })();
}, ad = () => {
  const t = Nt(Sp);
  if (!t)
    throw new Error("useSTQueryEditor must be used within a STQueryEditorContext.Provider");
  return t;
};
Xe(["click"]);
var N1 = /* @__PURE__ */ T("<span>"), P1 = /* @__PURE__ */ T("<div>"), R1 = /* @__PURE__ */ T('<div><div style="display:grid;grid-template-columns:1fr 1fr;gap:8px"></div><div class="flexbox horizontal"style=justify-content:space-between;><div><h5>Caching</h5></div><div><h5>Sample Data</h5></div><div><h5>No Results Message</h5></div><div><h5>Maximum Preview Results</h5></div></div><h3>Preview Results</h3><div><table><thead><tr><th>Column Name</th><th>Value</th></tr></thead><tbody>'), M1 = /* @__PURE__ */ T("<tr><td></td><td>"), q1 = /* @__PURE__ */ T("<p style=font-size:12px;>SQL Statements with UPDATE, INSERT, or DELETE are not allowed.<br>Focus parameters include <b>@GRADINGPERIODID</b>, <b>@ENROLLMENTPERIODID</b>, <b>@CLASSID</b>, <b>@SCHOOLYEARID</b>, <b>@SCHOOLID</b>, <b>@TEACHERID</b>, <b>@ORGANIZATION_YEAR_GU</b>, <b>@ORGANIZATION_GU</b>, <b>@FOCUS_ORGANIZATION_GU</b>, <b>@FOCUS_ORG_YEAR_GU_LIST</b>, <b>@YEAR_GU</b>, <b>@FOCUS_YEAR_GU</b>, <b>@FOCUS_SCHOOL_YEAR</b>, <b>@FOCUS_STUDENT_ACTIVE_STATE</b>(Active Only = 0, Inactive Only = 1, Active And Inactive = 2) AND <b>@USER_GU</b>."), B1 = /* @__PURE__ */ T("<span> (Last Execution Time: <!> seconds) "), U1 = /* @__PURE__ */ T('<div class="flexbox horizontal middle"style=font-size:13px><b> Query '), Mh = /* @__PURE__ */ T("<textarea>"), j1 = /* @__PURE__ */ T('<div class="flexbox horizontal middle"style=font-size:13px;justify-content:space-between;><b> Query </b><div class="flexbox horizontal"style=gap:8px;>'), G1 = /* @__PURE__ */ T("<div class=flexbox style=width:90dvw;height:85dvh;padding-top:8px;>"), F1 = /* @__PURE__ */ T("<div class=flexbox style=min-height:300px;gap:8px>");
class V1 {
  type;
  query;
  shouldCache;
  shouldUseSampleData;
  noResultsMessage;
  maximumPreviewRows;
  executionTime;
  previewData;
  parameters;
  setParameters;
  queryError;
  constructor(e, n, r, i, s, o) {
    this.type = e, this.query = n, this.shouldCache = r, this.shouldUseSampleData = i, this.noResultsMessage = s, this.maximumPreviewRows = o, this.queryError = I(""), this.executionTime = I(0), this.previewData = I([]), [this.parameters, this.setParameters] = er({});
  }
}
const Cp = bt(), H1 = "Student R0, Student R1, K12.AccommodationInfo.VA.FCPSCurrentStudentIEP R3 COLS R0.AddressValidationFlag, R0.AdultEdDiplomaType, R0.AICEDiploma";
class z1 {
  type;
  query;
  shouldCache;
  shouldUseSampleData;
  noResultsMessage;
  maximumPreviewRows;
}
function aa(t) {
  const e = t.type ?? I("ST Query"), n = t.query ?? I(H1), r = t.shouldCache ?? I(!1), i = t.shouldUseSampleData ?? I(!1), s = t.noResultsMessage ?? I(""), o = t.maximumPreviewRows ?? I(void 0), l = new V1(e, n, r, i, s, o), [a] = l.queryError, [c] = l.previewData, u = Ie(() => `${l.maximumPreviewRows[0]()}`, (d) => l.maximumPreviewRows[1](Number.parseInt(d)));
  return h(Cp.Provider, {
    value: l,
    get children() {
      var d = R1(), f = d.firstChild, g = f.nextSibling, p = g.firstChild;
      p.firstChild;
      var S = p.nextSibling;
      S.firstChild;
      var _ = S.nextSibling;
      _.firstChild;
      var m = _.nextSibling;
      m.firstChild;
      var y = g.nextSibling, v = y.nextSibling, x = v.firstChild, C = x.firstChild, E = C.nextSibling;
      return w(d, h(J1, {}), f), w(f, h(Q1, {}), null), w(f, h(q0, {}), null), w(d, h(B, {
        get when() {
          return a();
        },
        get children() {
          var k = N1();
          return w(k, a), R(() => D(k, oi["query-error"])), k;
        }
      }), g), w(p, h(ut, {
        label: "Cache this query",
        get value() {
          return l.shouldCache;
        }
      }), null), w(S, h(ut, {
        label: "Use sample data for report configuration",
        get value() {
          return l.shouldUseSampleData;
        }
      }), null), w(_, h(dt, {
        get value() {
          return l.noResultsMessage;
        }
      }), null), w(m, h(dt, {
        type: "number",
        value: u
      }), null), w(d, h(B, {
        get when() {
          return l.type[0]() === "SQL Query";
        },
        get children() {
          var k = P1();
          return w(k, h(W1, {})), k;
        }
      }), y), w(E, h(de, {
        get each() {
          return c();
        },
        children: (k) => (() => {
          var L = M1(), M = L.firstChild, G = M.nextSibling;
          return w(M, () => k.name), w(G, () => k.value), L;
        })()
      })), R((k) => {
        var L = oi["st-data-source-editor"], M = oi["preview-table"];
        return L !== k.e && D(d, k.e = L), M !== k.t && D(x, k.t = M), k;
      }, {
        e: void 0,
        t: void 0
      }), d;
    }
  });
}
aa.defaultProps = new z1();
const W1 = () => q1(), J1 = () => {
  const t = cd(), [e, n] = t.type;
  return h(Zn, {
    get children() {
      return [h(ne, {
        type: "primary",
        get active() {
          return e() === "SQL Query";
        },
        onClick: () => n("SQL Query"),
        children: "SQL Query"
      }), h(ne, {
        type: "primary",
        get active() {
          return e() === "ST Query";
        },
        onClick: () => n("ST Query"),
        children: "Synergy Query"
      })];
    }
  });
}, Q1 = () => {
  const t = cd(), [e, n] = t.type, [r, i] = t.query, [s, o] = t.executionTime, [l, a] = t.previewData, [c, u] = t.queryError, [d, f] = I(!0);
  return Z(Tr(() => [r()], async () => {
    const g = r();
    if (!g)
      o(void 0), a([]), u("");
    else
      try {
        const p = await Py.PreviewDataSource(g, e());
        o(p.executionTimeInSeconds), a(p.results), u("");
      } catch (p) {
        p instanceof Error ? u(p.message) : u("An error occurred while executing the query.");
      }
  })), (() => {
    var g = F1();
    return w(g, h(Zt, {
      get children() {
        return [h(Pe, {
          get when() {
            return e() === "SQL Query";
          },
          get children() {
            return [(() => {
              var p = U1();
              return p.firstChild, w(p, h(B, {
                get when() {
                  return s();
                },
                get children() {
                  var S = B1(), _ = S.firstChild, m = _.nextSibling;
                  return m.nextSibling, w(S, s, m), S;
                }
              }), null), p;
            })(), (() => {
              var p = Mh();
              return p.addEventListener("change", (S) => i(S.target.value)), R(() => D(p, oi["sql-query-textarea"])), R(() => p.value = r()), p;
            })()];
          }
        }), h(Pe, {
          get when() {
            return e() === "ST Query";
          },
          get children() {
            return [(() => {
              var p = j1(), S = p.firstChild, _ = S.nextSibling;
              return w(_, h(ne, {
                onClick: () => {
                  f(!0);
                },
                children: "Query Designer"
              }), null), w(_, h(ne, {
                onClick: () => {
                },
                children: "Validate"
              }), null), p;
            })(), (() => {
              var p = Mh();
              return p.addEventListener("change", (S) => i(S.target.value)), R(() => D(p, oi["sql-query-textarea"])), R(() => p.value = r()), p;
            })(), h(Gt, {
              title: "Query",
              show: [d, f],
              get children() {
                var p = G1();
                return w(p, h(la, {
                  query: [r, i]
                })), p;
              }
            })];
          }
        })];
      }
    })), g;
  })();
}, cd = () => {
  const t = Nt(Cp);
  if (!t)
    throw new Error("useDataSourceEditor must be used within a STDataSourceEditor");
  return t;
};
var K1 = /* @__PURE__ */ T("<div class=edit-actions>"), Y1 = /* @__PURE__ */ T(`<div class=data-source-editor><div data-bind="component: { name: 'analytics.reportsetup.queries', params: { config: editVM } }">`);
function X1(t) {
  if (!window.ko) return h(aa, {
    get query() {
      return t.query;
    },
    get type() {
      return t.queryType;
    }
  });
  let e;
  const [n, r] = t.query, [i, s] = t.queryType, o = ko.observable(), l = ko.observable(null), a = ko.observable(""), c = ko.observable(""), u = ko.observable();
  a.subscribe(r), c.subscribe(s), jt(async () => {
    await new Promise((f) => {
      const g = setInterval(() => {
        window.COMPONENT_LOADER && (clearTimeout(g), f());
      }, 10);
    }), ko.bindingHandlers.bsChecked = {
      init: function(f, g, p, S, _) {
        var m = g(), y = function() {
          return {
            change: function() {
              m(f.value);
            }
          };
        };
        ko.bindingHandlers.event.init(f, y, p, S, _);
      },
      update: function(f, g, p, S, _) {
        $(f).val() == ko.unwrap(g()) && setTimeout(function() {
          $(f).closest(".btn").button("toggle");
        }, 1);
      }
    }, require(["analytics.reportsetup.edit"], (f) => {
      const g = new f({}, null, () => ({
        subscribe: () => {
        }
      }));
      g.tabsConfig.component = {
        selectedIndex: ko.observable()
      }, g.config.showDatabaseConnectionDropDown = !1, g.config.showQueryEditSaveButton = !1, g.config.fromReportBrowser = !0, ko.when(() => !g.isLoading(), async () => {
        if (o()) {
          const p = await Sh.GetDataSourceInfo(o());
          switch (g.report.queryType(p.queryType), p.queryType) {
            case "ST Query":
              g.report.sql(""), g.report.stQueryText(p.query);
              break;
            case "SQL Query":
              g.report.stQueryText(""), g.report.sql(p.query);
              break;
          }
        } else
          l(g.report), g.report.sql.subscribe((p) => {
            g.report.queryType() === "SQL Query" && a(p);
          }), g.report.stQueryText.subscribe((p) => {
            g.report.queryType() === "ST Query" && a(p);
          }), g.report.queryType.subscribe((p) => {
            switch (c(p), p) {
              case "ST Query":
                a(g.report.stQueryText());
                break;
              case "SQL Query":
                a(g.report.sql());
                break;
            }
          });
      }), u(g), ko.applyBindings({
        reportGu: o,
        report: l,
        query: a,
        queryType: c,
        editVM: u
      }, e);
    });
  });
  const d = async () => {
    const f = u().getPostData();
    await Sh.Save(o(), f.queryType, f.query, f.columns, f.parameters);
  };
  return (() => {
    var f = Y1(), g = f.firstChild;
    w(f, h(B, {
      get when() {
        return t.showActions;
      },
      get children() {
        var S = K1();
        return w(S, h(ne, {
          type: "primary",
          onClick: d,
          children: "Save"
        })), S;
      }
    }), g);
    var p = e;
    return typeof p == "function" ? Le(p, g) : e = g, f;
  })();
}
const $p = bt();
class Z1 {
  searchResults = [];
  groups = [];
  viewMode = "tile";
  searchStr = "";
  selectedGroupId;
  selectedReportId;
  isEditing = !1;
  isCreating = !1;
  isInCarousel = !1;
  carouselIndex = 0;
  canEdit = !1;
  canAdd = !1;
  canPublish = !1;
  canAccessMyReports = !1;
  isPublishDialogOpen = !1;
  isPublishing = !1;
  isCopyDialogOpen = !1;
  isCopying = !1;
  isThumbnailDialogOpen = !1;
  isUpdatingThumbnail = !1;
  isDeleteDialogOpen = !1;
  isDeleting = !1;
  isLoadingGroups = !1;
  reportBrowserScrollTop = 0;
}
class ew {
  state;
  setState;
  allReports;
  selectedGroup;
  selectedReport;
  reports;
  shouldShowReports;
  constructor() {
    [this.state, this.setState] = er(new Z1()), this.allReports = P(() => this.state.groups.flatMap((e) => e.reports)), this.selectedGroup = P(() => this.state.groups.find((e) => e.description === this.state.selectedGroupId)), this.selectedReport = P(() => {
      const e = this.state.selectedReportId;
      return this.allReports().find((n) => n.reportGU === e);
    }), this.reports = P(() => {
      const e = this.state.searchStr, n = this.selectedGroup();
      return e ? this.state.searchResults ?? [] : n ? n.reports : [];
    }), this.shouldShowReports = P(() => !!(this.state.searchStr || this.selectedGroup()));
  }
  async refresh() {
    this.setReportGroupLoading(!0);
    try {
      const e = await _r.LoadReports();
      this.setGroups(e);
    } catch {
      Qt.notify("error", "An error ocurred while refreshing.");
    } finally {
      this.setReportGroupLoading(!1);
    }
  }
  setGroups(e) {
    this.setState("groups", e);
  }
  toggleEditMode(e) {
    this.setState("isEditing", (n) => e ?? !n);
  }
  toggleCreateMode(e) {
    this.setState("isCreating", (n) => e ?? !n);
  }
  setSearchStr(e) {
    this.setState("searchStr", e), this.search(e);
  }
  setSelectedGroup(e) {
    this.setState("selectedGroupId", e?.description);
  }
  setViewMode(e) {
    this.toggleCarousel(!1), this.setState("viewMode", e);
  }
  toggleCarousel(e) {
    this.selectedGroup() && (this.setState("carouselIndex", 0), this.setState("isInCarousel", (n) => e ?? !n));
  }
  carouselForward() {
    this.selectedGroup() && this.state.carouselIndex < this.selectedGroup().reports.length - 1 && this.setState("carouselIndex", this.state.carouselIndex + 1);
  }
  carouselBackward() {
    this.selectedGroup() && this.state.carouselIndex > 0 && this.setState("carouselIndex", this.state.carouselIndex - 1);
  }
  updateGroup(e, n) {
    this.setState("groups", (r) => r.reportGroupDefGU === e.reportGroupDefGU, {
      ...e,
      ...n
    });
  }
  updateReport(e, n) {
    this.state.searchResults, this.setState("groups", (r) => r.reports.some((i) => i.reportGU === e.reportGU), "reports", (r) => r.reportGU === e.reportGU, () => ({
      ...e,
      ...n
    }));
  }
  addReport(e) {
    this.setState("groups", (n) => n.description === "My Reports", "reports", (n) => [...n, e]);
  }
  removeReport(e) {
    this.setState("groups", (n) => n.reports.some((r) => r.reportGU === e.reportGU), "reports", (n) => [...n.slice(0, n.findIndex((r) => r.reportGU === e.reportGU)), ...n.slice(n.findIndex((r) => r.reportGU === e.reportGU) + 1)]);
  }
  expandReport(e) {
    if (this.selectedGroup()) {
      const n = this.selectedGroup().reports.findIndex((r) => r.reportGU === e.reportGU);
      this.setState("carouselIndex", n), this.setState("isInCarousel", !0);
    }
  }
  search = qa((e) => {
    if (!e) {
      this.setState("searchResults", []);
      return;
    }
    const r = (this.selectedGroup() ? this.selectedGroup().reports : this.allReports()).filter((i) => i.number?.toLowerCase().includes(e.toLowerCase()) || i.name?.toLowerCase().includes(e.toLowerCase()));
    this.setState("searchResults", r);
  }, 200);
  launchReportInterface(e) {
    const n = e.groupReportGU ? `${e.reportGU}^${e.groupReportGU}` : e.reportGU;
    ST.GetParentInstance().OpenViewInDialog(n, n, {
      REV_RENDER: {
        VIEW: {
          "@TYPE": "REPORT"
        }
      }
    });
  }
  async launchReportDesigner(e) {
    try {
      window.ST.OpenViewWindow("2D6E7F8B-E654-4CF6-9116-F851E33046CB", null, e.reportGU);
    } catch (n) {
      Qt.notify("error", "An error ocurred while launching the report"), console.error(n);
    }
  }
  setCanEdit = (e) => {
    this.setState("canEdit", e);
  };
  setCanAdd = (e) => {
    this.setState("canAdd", e);
  };
  setCanPublish = (e) => {
    this.setState("canPublish", e);
  };
  setCanAccessMyReports = (e) => {
    this.setState("canAccessMyReports", e);
  };
  closeAllDialogs = () => {
    this.setState("isCopyDialogOpen", !1), this.setState("isThumbnailDialogOpen", !1), this.setState("isPublishDialogOpen", !1), this.setState("isDeleteDialogOpen", !1);
  };
  openCopyDialog(e) {
    this.closeAllDialogs(), this.setState("isCopyDialogOpen", !0), this.setState("selectedReportId", e.reportGU);
  }
  cancelCopy() {
    this.setState("isCopyDialogOpen", !1), this.setState("selectedReportId", void 0);
  }
  openReportThumbnailDialog(e) {
    this.closeAllDialogs(), this.setState("isThumbnailDialogOpen", !0), this.setState("selectedReportId", e.reportGU);
  }
  cancelReportThumbnail() {
    this.setState("isThumbnailDialogOpen", !1), this.setState("selectedReportId", void 0);
  }
  openPublishDialog(e) {
    this.closeAllDialogs(), this.setState("isPublishDialogOpen", !0), this.setState("selectedReportId", e.reportGU);
  }
  cancelPublish() {
    this.setState("isPublishDialogOpen", !1), this.setState("selectedReportId", void 0);
  }
  openDeleteDialog(e) {
    this.closeAllDialogs(), this.setState("isDeleteDialogOpen", !0), this.setState("selectedReportId", e.reportGU);
  }
  cancelDelete() {
    this.setState("isDeleteDialogOpen", !1), this.setState("selectedReportId", void 0);
  }
  async deleteReport(e) {
    this.setState("isDeleting", !0);
    try {
      await _r.DeleteReport(e.reportGU) && (this.removeReport(e), this.setState("isDeleteDialogOpen", !1), this.refreshPad(), Qt.notify("success", `Successfully delete report ${e.number} - ${e.name}`));
    } catch (n) {
      Qt.notify("error", "An error ocurred while deleting the report."), console.error(n);
    }
    this.setState("isDeleting", !1);
  }
  async encode(e) {
    return new Promise((n) => {
      const r = new FileReader();
      r.onload = (i) => {
        const s = i.target.result, [o, l] = s.split(",");
        n(l);
      }, r.readAsDataURL(e);
    });
  }
  async updateReportThumbnail(e, n) {
    this.setState("isUpdatingThumbnail", !0);
    try {
      const r = await this.encode(n), i = n.name.split(".").pop(), s = await _r.EditReport(e.reportGU, "", "", "", r, i);
      s && this.updateReport(e, s);
    } catch {
      Qt.notify("error", "An error ocurred while updating the report thumbnail");
    }
    this.setState("isUpdatingThumbnail", !1);
  }
  async setReportThumbnailFromPreview(e) {
    this.setState("isUpdatingThumbnail", !0), this.setState("isUpdatingThumbnail", !1);
  }
  async setReportThumbnail(e, n, r) {
    this.setState("isUpdatingThumbnail", !0);
    try {
      const i = await _r.SetReportThumbnail(e, n, r);
      i && this.setState("groups", (s) => s.reports.some((o) => o.reportGU === e), "reports", (s) => s.reportGU === e, "reportPreviewImage", i);
    } catch {
      Qt.notify("error", "An error ocurred while updating the report thumbnail");
    }
    this.setState("isUpdatingThumbnail", !1);
  }
  async publishReport(e, n, r, i) {
    this.setState("isPublishing", !0);
    try {
      const s = await _r.PublishReport(e.reportGU, n, r, i);
      if (s) {
        this.refreshPad(), await this.refresh();
        const o = this.allReports().find((a) => a.reportGU === s.reportGU), l = this.state.groups.find((a) => a.reports.some((c) => c.reportGU === o?.reportGU));
        l && o && (this.setSelectedGroup(l), this.expandReport(o)), Qt.notify("success", `Report "${o?.number} - ${o?.name}" has been published to the PAD Tree at "${s?.padPath}"`), this.setState("isPublishDialogOpen", !1);
      }
    } catch {
      Qt.notify("error", "An error occurred while publishing the report.");
    }
    this.setState("isPublishing", !1);
  }
  refreshPad() {
    window.ST.GetRootWindow().$('.REV_VIEW[data-guid="832C78E7-471A-4392-BE48-684799F3969D"]').each(function() {
      const n = window.ST.GetRootWindow().$(this).viewData();
      n && n.RefreshOrReload(!0, null);
    });
  }
  setReportBrowserScrollTop(e) {
    this.setState("reportBrowserScrollTop", e);
  }
  setReportGroupLoading(e) {
    this.setState("isLoadingGroups", e);
  }
}
function tw(t) {
  const e = new ew();
  return h($p.Provider, {
    value: e,
    get children() {
      return t.children;
    }
  });
}
function tn() {
  const t = Nt($p);
  if (!t) throw new Error("useReportBrowser must be used within a ReportBrowserProvider");
  return t;
}
var nw = /* @__PURE__ */ T('<div class="create-report-wizard flexbox"><div class=title-bar><div style=flex-basis:40%;><span>Report Number <span style=color:var(--st-style-error-bg)>*</span></span></div><div style=flex-basis:40%;><span>Report Name <span style=color:var(--st-style-error-bg)>*</span></span></div><div><span>Orientation</span></div><div class="flexbox middle"><span style=white-space:nowrap>Default Layout</span></div><div style=flex-grow:1>');
function rw() {
  const t = tn(), [e, n] = I(""), [r, i] = I(""), [s, o] = I("portrait"), [l, a] = I(!0), [c, u] = I("SQL Query"), [d, f] = I(""), [g, p] = I(!1), S = async () => {
    p(!0);
    try {
      const _ = await _r.Create(r(), e(), c(), d(), s(), l());
      _ && (t.addReport(_), t.toggleCreateMode(!1), t.setSelectedGroup(t.state.groups.find((m) => m.description === "My Reports")), t.expandReport(_));
    } catch {
      Qt.notify("error", "An error ocurred while creating the report.");
    }
    p(!1);
  };
  return (() => {
    var _ = nw(), m = _.firstChild, y = m.firstChild;
    y.firstChild;
    var v = y.nextSibling;
    v.firstChild;
    var x = v.nextSibling;
    x.firstChild;
    var C = x.nextSibling;
    return C.firstChild, C.nextSibling, w(y, h(dt, {
      value: [e, n],
      required: !0
    }), null), w(v, h(dt, {
      value: [r, i],
      required: !0
    }), null), w(x, h(Ee, {
      value: [s, o],
      label: "",
      get children() {
        return [h(Ee.Option, {
          value: "portrait",
          children: "Portrait"
        }), h(Ee.Option, {
          value: "landscape",
          children: "Landscape"
        })];
      }
    }), null), w(C, h(ut, {
      class: "default-layout-checkbox",
      label: "",
      value: [l, a]
    }), null), w(m, h(ne, {
      get loading() {
        return g();
      },
      type: "success",
      onClick: S,
      children: "Create"
    }), null), w(_, h(X1, {
      showActions: !1,
      queryType: [c, u],
      query: [d, f]
    }), null), _;
  })();
}
var iw = /* @__PURE__ */ T("<div class=report-browser-side-nav>"), sw = /* @__PURE__ */ T("<div class=report-browser-side-nav-item><img>");
let Sl = null;
function ud() {
  const t = tn();
  let e;
  const n = (r, i) => {
    Sl = e.scrollTop || e.parentElement.scrollTop, t.setSelectedGroup(i), t.state.isInCarousel && (t.toggleCarousel(!1), t.toggleCarousel(!0));
  };
  return Z(() => {
    if (t.selectedGroup()) {
      const r = t.state.groups.indexOf(t.selectedGroup());
      if (e)
        if (Sl)
          e.scrollTo({
            top: Sl
          }), e.parentElement.scrollTo({
            top: Sl
          });
        else {
          const i = e.children.item(r);
          i && (i.scrollIntoViewIfNeeded ? i.scrollIntoViewIfNeeded() : i.scrollIntoView());
        }
    }
  }), (() => {
    var r = iw(), i = e;
    return typeof i == "function" ? Le(i, r) : e = r, w(r, h(de, {
      get each() {
        return t.state.groups;
      },
      children: (s) => (() => {
        var o = sw(), l = o.firstChild;
        return o.$$click = (a) => n(a, s), Le(tooltip, o, () => s.description), R((a) => {
          var c = t.selectedGroup()?.description === s.description, u = s.groupImage;
          return c !== a.e && o.classList.toggle("selected", a.e = c), u !== a.t && ye(l, "src", a.t = u), a;
        }, {
          e: void 0,
          t: void 0
        }), o;
      })()
    })), r;
  })();
}
Xe(["click"]);
var ow = /* @__PURE__ */ T('<span class="fa fa-chevron-down">'), lw = /* @__PURE__ */ T("<div class=report-browser-dropdown-menu>");
function dd(t) {
  const e = tn(), n = (i) => {
    i.stopPropagation(), i.preventDefault(), e.launchReportDesigner(t.report);
  }, r = t.isOpen ?? I(!1);
  return h(B, {
    get when() {
      return e.state.isEditing;
    },
    get children() {
      return h(Zn, {
        get children() {
          return [h(ne, {
            get enabled() {
              return t.report.canEdit;
            },
            onClick: n,
            children: "Edit"
          }), h(Ve, {
            placement: "bottom-end",
            open: r,
            get children() {
              return [h(Ve.Trigger, {
                as: ne,
                get children() {
                  return ow();
                }
              }), h(Ve.Content, {
                get children() {
                  var i = lw();
                  return w(i, h(Zn, {
                    vertical: !0,
                    get children() {
                      return [h(ne, {
                        get enabled() {
                          return t.report.canCopy;
                        },
                        onClick: () => e.openCopyDialog(t.report),
                        children: "Copy"
                      }), h(ne, {
                        onClick: () => e.openReportThumbnailDialog(t.report),
                        children: "Thumbnail"
                      }), h(ne, {
                        get enabled() {
                          return t.report.canEdit && e.state.canPublish;
                        },
                        onClick: () => e.openPublishDialog(t.report),
                        children: "Publish"
                      }), h(ne, {
                        get enabled() {
                          return t.report.canEdit;
                        },
                        onClick: () => e.openDeleteDialog(t.report),
                        type: "danger",
                        children: "Delete"
                      })];
                    }
                  })), i;
                }
              })];
            }
          })];
        }
      });
    }
  });
}
var aw = /* @__PURE__ */ T('<div class=report-browser-grid style="grid-template-columns:repeat(auto-fill, minmax(224px, 1fr));">'), cw = /* @__PURE__ */ T("<div style=width:100%;height:80vh;display:flex;justify-content:center;align-items:center;grid-column:1/-1;font-size:2rem;>No Reports Found."), uw = /* @__PURE__ */ T('<div style=display:flex;flex-grow:1;><div class=report-browser-grid style="grid-template-columns:repeat(auto-fill, minmax(324px, 1fr));overflow-y:auto;justify-items:center;flex-grow:1;">'), dw = /* @__PURE__ */ T("<div style=display:flex;justify-content:center;overflow-y:auto;padding-block:8px;>"), hw = /* @__PURE__ */ T("<div class=report-preview-action-container><div class=report-preview-actions-top-row><div style=flex-grow:1></div>"), fw = /* @__PURE__ */ T("<div class=report-card-container style=width:200px;><div class=report-preview-container><div class=report-preview-image><img><div class=report-preview-image-overlay></div></div></div><div style=display:flex;align-items:center;width:100%;><div class=s-link style=display:flex;flex-direction:column;width:100%;align-items:start;padding-top:8px;font-size:18px;>"), gw = /* @__PURE__ */ T("<div style=display:flex;align-items:center;margin-bottom:16px;><input type=file>"), pw = /* @__PURE__ */ T('<span class="fa fa-external-link"style=padding-left:4px;>'), mw = /* @__PURE__ */ T('<div class=report-card-container tabindex=0><div class=report-preview-container><div class=report-preview-image><div class=report-preview-actions-top-row><button class=report-preview-expand-button><span class="fa fa-expand-alt"></span></button></div><div class=report-preview-actions-main></div></div></div><div style=display:flex;align-items:center;width:100%;><div style=display:flex;flex-direction:column;width:100%;align-items:start;padding-top:8px;><div class=s-link style=font-size:18px;>');
const vw = () => {
  const t = tn();
  let e;
  function n(i) {
    switch (i.key) {
      case "Escape":
        t.setSelectedGroup(null);
        break;
    }
  }
  jt(() => {
    document.addEventListener("keydown", n), setTimeout(() => {
      e?.scrollTo({
        top: t.state.reportBrowserScrollTop,
        behavior: "auto"
      });
    });
  }), Gn(() => {
    document.removeEventListener("keydown", n);
  });
  const r = (i) => {
    const s = i.currentTarget;
    s && t.setReportBrowserScrollTop(s.scrollTop);
  };
  return (() => {
    var i = dw();
    return w(i, h(B, {
      get when() {
        return !t.shouldShowReports();
      },
      get children() {
        var s = aw();
        return w(s, h(de, {
          get each() {
            return t.state.groups;
          },
          children: (o) => h(yw, {
            group: o
          })
        })), s;
      }
    }), null), w(i, h(B, {
      get when() {
        return t.shouldShowReports();
      },
      get children() {
        var s = uw(), o = s.firstChild;
        w(s, h(ud, {}), o), o.addEventListener("scroll", r);
        var l = e;
        return typeof l == "function" ? Le(l, o) : e = o, w(o, h(B, {
          get when() {
            return t.reports().length === 0;
          },
          get children() {
            return cw();
          }
        }), null), w(o, h(B, {
          get when() {
            return t.reports().length > 0;
          },
          get children() {
            return h(de, {
              get each() {
                return t.reports();
              },
              children: (a) => h(bw, {
                report: a
              })
            });
          }
        }), null), s;
      }
    }), null), i;
  })();
}, yw = (t) => {
  const e = tn(), n = I(!1), [r, i] = n, [s, o] = I(), l = (f) => {
    f.preventDefault(), f.stopPropagation(), i(!0);
  }, a = I(t.group.description ?? ""), c = async (f) => {
    let g = null, p = null;
    f.newThumbnailFile && (g = await Ep(f.newThumbnailFile), p = f.newThumbnailFile.name.split(".").pop());
    const S = await _r.EditReportGroup(t.group.reportGroupDefGU ?? t.group.description ?? "", f.description ?? "", g ?? "", p ?? "");
    e.updateGroup(t.group, {
      description: S.description,
      groupImage: S.groupImage
    }), i(!1);
  }, u = (f) => {
    if (f.target.files) {
      const g = f.target.files[0];
      g && o(() => g);
    }
  }, d = (f) => {
    e.setSelectedGroup(t.group);
  };
  return [(() => {
    var f = fw(), g = f.firstChild, p = g.firstChild, S = p.firstChild, _ = S.nextSibling, m = g.nextSibling, y = m.firstChild;
    return f.$$click = d, w(_, h(B, {
      get when() {
        return e.state.isEditing;
      },
      get children() {
        var v = hw(), x = v.firstChild, C = x.firstChild;
        return w(C, h(ne, {
          onClick: l,
          children: "Change Thumbnail"
        })), v;
      }
    })), w(y, h(Hs, {
      model: a,
      disabled: !1,
      onSave: () => c({
        description: a[0]()
      })
    })), R(() => ye(S, "src", t.group.groupImage)), f;
  })(), h(Gt, {
    show: n,
    get children() {
      var f = gw(), g = f.firstChild;
      return g.addEventListener("change", u), w(f, h(ne, {
        onClick: () => c({
          newThumbnailFile: s()
        }),
        children: "Update Thumbnail"
      }), null), f;
    }
  })];
};
async function Ep(t) {
  return new Promise((e) => {
    const n = new FileReader();
    n.onload = (r) => {
      const i = r.target.result, [s, o] = i.split(",");
      e(o);
    }, n.readAsDataURL(t);
  });
}
const bw = (t) => {
  const e = tn(), n = I(t.report.name ?? ""), r = I(t.report.number ?? ""), i = () => e.expandReport(t.report), s = async (c) => {
    let u = "", d = "";
    c.newThumbnailFile && (u = await Ep(c.newThumbnailFile), d = c.newThumbnailFile.name.split(".").pop());
    const f = await _r.EditReport(t.report.reportGU, c?.name ?? "", c?.number ?? "", c?.editGroupOverride ?? "", u, d);
    f && e.updateReport(t.report, f);
  }, o = P(() => t.report.reportPreviewImage ? t.report.reportPreviewImage.includes("?") ? `background-image: url('${t.report.reportPreviewImage}&size=thumbnail');` : `background-image: url('${t.report.reportPreviewImage}?size=thumbnail');` : ""), [l, a] = I(!1);
  return (() => {
    var c = mw(), u = c.firstChild, d = u.firstChild, f = d.firstChild, g = f.firstChild, p = f.nextSibling, S = u.nextSibling, _ = S.firstChild, m = _.firstChild;
    return d.$$click = i, g.$$click = i, w(f, h(dd, {
      get report() {
        return t.report;
      },
      isOpen: [l, a]
    }), null), w(p, h(ne, {
      type: "primary",
      onClick: () => e.launchReportInterface(t.report),
      get children() {
        return ["Open Report", pw()];
      }
    })), w(m, h(Hs, {
      model: r,
      get disabled() {
        return !e.state.isEditing;
      },
      onSave: (y) => s({
        number: y
      })
    })), w(_, h(Hs, {
      model: n,
      onSave: (y) => s({
        name: y
      })
    }), null), R((y) => {
      var v = l(), x = o();
      return v !== y.e && ye(c, "data-active", y.e = v), y.t = Yn(d, x, y.t), y;
    }, {
      e: void 0,
      t: void 0
    }), c;
  })();
};
Xe(["click"]);
var ww = /* @__PURE__ */ T("<div style=display:flex;flex-grow:1;>"), _w = /* @__PURE__ */ T("<div style=display:flex;justify-content:center;overflow-y:auto;padding-block:8px;>"), Sw = /* @__PURE__ */ T("<div class=report-list-grid-container><table><thead><tr><th>Preview</th><th>Group Name</th></tr></thead><tbody>"), xw = /* @__PURE__ */ T("<tr style=cursor:pointer><td><img class=report-browser-list-img></td><td>"), Cw = /* @__PURE__ */ T("<div class=report-list-grid-container><table><thead><tr><th>Preview</th><th>Number</th><th>Name</th><th>Actions</th></tr></thead><tbody>"), $w = /* @__PURE__ */ T("<tr><td><img class=report-browser-list-img></td><td></td><td></td><td><div style=display:flex;gap:8px;>");
const Ew = () => {
  const t = tn();
  return (() => {
    var e = _w();
    return w(e, h(B, {
      get when() {
        return !t.shouldShowReports();
      },
      get children() {
        return h(Tw, {
          get groups() {
            return t.state.groups;
          }
        });
      }
    }), null), w(e, h(B, {
      get when() {
        return t.shouldShowReports();
      },
      get children() {
        var n = ww();
        return w(n, h(ud, {}), null), w(n, h(Aw, {
          get reports() {
            return t.reports();
          }
        }), null), n;
      }
    }), null), e;
  })();
}, Tw = (t) => {
  const e = tn();
  return (() => {
    var n = Sw(), r = n.firstChild, i = r.firstChild, s = i.nextSibling;
    return w(s, h(de, {
      get each() {
        return t.groups;
      },
      children: (o) => (() => {
        var l = xw(), a = l.firstChild, c = a.firstChild, u = a.nextSibling;
        return l.$$click = () => e.setSelectedGroup(o), w(u, () => o.description), R(() => ye(c, "src", o.groupImage)), l;
      })()
    })), n;
  })();
}, Aw = (t) => {
  const e = tn();
  return (() => {
    var n = Cw(), r = n.firstChild, i = r.firstChild, s = i.nextSibling;
    return w(s, h(de, {
      get each() {
        return t.reports;
      },
      children: (o) => (() => {
        var l = $w(), a = l.firstChild, c = a.firstChild, u = a.nextSibling, d = u.nextSibling, f = d.nextSibling, g = f.firstChild;
        return w(u, () => o.number), w(d, () => o.name), w(g, h(ne, {
          type: "primary",
          onClick: () => e.launchReportInterface(o),
          children: "Execute"
        }), null), w(g, h(B, {
          get when() {
            return e.state.isEditing;
          },
          get children() {
            return h(dd, {
              report: o
            });
          }
        }), null), R(() => ye(c, "src", o.reportPreviewImage)), l;
      })()
    })), n;
  })();
};
Xe(["click"]);
var kw = /* @__PURE__ */ T('<div style=display:flex;flex:1;align-items:stretch;position:relative;height:100%;gap:4px;><div style=position:relative;width:100px;align-self:stretch;><div style=position:absolute;height:100%;overflow-y:auto;></div></div><div class=carousel-nav-button><span class="fa fa-chevron-left"></span></div><div class=carousel-cards></div><div class=carousel-nav-button><span class="fa fa-chevron-right">'), Iw = /* @__PURE__ */ T("<div class=actions-overlay>"), Ow = /* @__PURE__ */ T('<div><span>Open Report</span><span class="fa fa-external-link"style=padding-left:4px;>'), Dw = /* @__PURE__ */ T("<div style=position:absolute;left:0;top:0;width:100%;height:100%;display:flex;align-items:center;justify-content:center;pointer-events:none;>"), Lw = /* @__PURE__ */ T("<div>"), Nw = /* @__PURE__ */ T("<div class=carousel-card><div class=carousel-card-header><span class=report-number></span><span class=report-name></span></div><div class=carousel-image-container><img></div><div><img>");
function Pw() {
  const t = tn(), [e, n] = I(!1);
  function r(s) {
    switch (s.key) {
      case "ArrowLeft":
        t.carouselBackward(), n(!1);
        break;
      case "ArrowRight":
        t.carouselForward(), n(!1);
        break;
      case "Escape":
        e() ? n(!1) : t.toggleCarousel();
        break;
    }
  }
  function i(s) {
    e() || (s.deltaY > 0 ? t.carouselForward() : t.carouselBackward());
  }
  return jt(() => {
    document.addEventListener("keydown", r);
  }), Gn(() => {
    document.removeEventListener("keydown", r);
  }), (() => {
    var s = kw(), o = s.firstChild, l = o.firstChild, a = o.nextSibling, c = a.nextSibling, u = c.nextSibling;
    return w(l, h(ud, {})), a.$$click = () => t.carouselBackward(), c.addEventListener("wheel", i), w(c, h(de, {
      get each() {
        return t.reports();
      },
      children: (d, f) => h(qw, {
        report: d,
        get offset() {
          return f() - t.state.carouselIndex;
        },
        isZoomed: [e, n]
      })
    })), u.$$click = () => t.carouselForward(), s;
  })();
}
const Rw = 1.5, Mw = 6;
function qw(t) {
  let e, n;
  const [r, i] = t.isZoomed, [s, o] = I(""), [l, a] = I(""), [c, u] = I(""), d = tn(), [f, g] = I(3), [p, S] = I(0), [_, m] = I(0), [y, v] = I(0), [x, C] = I(0), [E, k] = I(0), L = () => {
    r() && M(!1);
  }, M = qa((U) => {
    U === !0 ? document.addEventListener("click", L) : document.removeEventListener("click", L), i(U);
  }, 10), G = () => {
    d.launchReportInterface(t.report);
  };
  jt(() => {
    e && (document.addEventListener("mousemove", (U) => {
      t.offset === 0 && ie(U);
    }), e.addEventListener("wheel", (U) => {
      r() && t.offset === 0 && (U.preventDefault(), U.stopPropagation(), U.deltaY > 0 ? g(Math.max(Rw, f() - 0.5)) : g(Math.min(Mw, f() + 0.5)));
    }));
  });
  const Y = (U) => {
    U.defaultPrevented || (t.offset === 1 ? d.carouselForward() : t.offset === -1 ? d.carouselBackward() : t.offset === 0 && (M(!r()), ie(U)));
  };
  Gn(() => {
  });
  const ie = (U) => {
    if (!e) return;
    const W = e.closest(".carousel-cards");
    if (!W) return;
    const ce = (U.clientX - e.getBoundingClientRect().x) / e.clientWidth, ue = (U.clientY - e.getBoundingClientRect().y) / e.clientHeight, xe = e.parentElement.querySelector(".carousel-card-header")?.clientHeight ?? 68;
    C(W.clientWidth), k(W.clientHeight), S(x() * 0.9), m(e.clientHeight);
    const H = e.clientWidth, ee = e.clientHeight, se = p(), K = _(), re = e.clientHeight / e.clientWidth * se, J = Math.min(Math.max(ce * H - se / 2, 0), H - se), he = Math.min(Math.max(ue * ee - K / 2, 0), ee - K), be = `${ce * 100}% ${ue * 100}%`;
    o(be);
    const me = Math.min(Math.max(re * ue, 0), re - K);
    v(me), a(`${J}px`), u(`${he + xe}px`);
  }, [X, V] = I(!1);
  return (() => {
    var U = Nw(), W = U.firstChild, ce = W.firstChild, ue = ce.nextSibling, xe = W.nextSibling, H = xe.firstChild, ee = xe.nextSibling, se = ee.firstChild;
    w(ce, () => t.report.number), w(ue, () => t.report.name), xe.$$click = Y;
    var K = e;
    typeof K == "function" ? Le(K, xe) : e = xe, w(xe, h(B, {
      get when() {
        return !r() && t.offset === 0;
      },
      get children() {
        return [(() => {
          var J = Iw();
          return w(J, h(dd, {
            get report() {
              return t.report;
            },
            isOpen: [X, V]
          })), J;
        })(), (() => {
          var J = Dw();
          return w(J, h(ne, {
            type: "primary",
            onClick: G,
            get children() {
              return Ow();
            }
          })), J;
        })()];
      }
    }), null), w(U, h(B, {
      get when() {
        return r() && t.offset === 0;
      },
      get children() {
        var J = Lw();
        return R((he) => Yn(J, `position: absolute; width: ${x()}px; height: ${E()}px; background-color: black; opacity: 0.1; cursor: zoom-out;`, he)), J;
      }
    }), ee);
    var re = n;
    return typeof re == "function" ? Le(re, ee) : n = ee, R((J) => {
      var he = t.offset === 0, be = t.offset === -1, me = t.offset === 1, oe = t.offset === -2, Qe = t.offset === 2, Ae = Math.abs(t.offset) > 2, Ye = X(), De = t.report.reportPreviewImage, Oe = t.offset === 0, nt = `position: absolute; height: ${_()}px; width: ${p()}px; top: ${c()}; opacity: ${r() ? 100 : 0}%; pointer-events: none; overflow: hidden; z-index: 20; background-color: white; border-radius: 8px;`, We = t.report.reportPreviewImage, gt = `width: ${p()}px; left: -${l()}; top: -${c()}; transform: translateY(-${y()}px);`;
      return he !== J.e && U.classList.toggle("current", J.e = he), be !== J.t && U.classList.toggle("left", J.t = be), me !== J.a && U.classList.toggle("right", J.a = me), oe !== J.o && U.classList.toggle("outer-left", J.o = oe), Qe !== J.i && U.classList.toggle("outer-right", J.i = Qe), Ae !== J.n && U.classList.toggle("hide", J.n = Ae), Ye !== J.s && ye(xe, "data-active", J.s = Ye), De !== J.h && ye(H, "src", J.h = De), Oe !== J.r && H.classList.toggle("current-report", J.r = Oe), J.d = Yn(ee, nt, J.d), We !== J.l && ye(se, "src", J.l = We), J.u = Yn(se, gt, J.u), J;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0,
      n: void 0,
      s: void 0,
      h: void 0,
      r: void 0,
      d: void 0,
      l: void 0,
      u: void 0
    }), U;
  })();
}
Xe(["click"]);
var Bw = /* @__PURE__ */ T("<div style=display:flex;flex-direction:column;gap:2px;><span>Location in PAD"), Uw = /* @__PURE__ */ T("<div>"), jw = /* @__PURE__ */ T("<div style=display:flex;flex-direction:column;gap:8px;><div style=font-size:16px;font-weight:bold;>Publish (<!> - <!>)</div><div></div><div style=align-self:stretch;display:flex;justify-content:end;gap:8px;>");
function Gw() {
  const t = tn(), [e, n] = I(""), [r, i] = I(t.state.isPublishDialogOpen), s = window.ST?.LocaleDistrict ? `Root (${window.ST.LocaleDistrict})` : "Root";
  Z(() => {
    i(t.state.isPublishDialogOpen);
  }), Z(() => {
    r() !== t.state.isPublishDialogOpen && r() === !1 && t.cancelPublish();
  });
  const [o, l] = I(!0), [a, c] = I(!1), u = () => {
    d() && t.publishReport(t.selectedReport(), e(), o(), a());
  }, d = () => o() || a();
  return h(B, {
    get when() {
      return t.selectedReport();
    },
    get children() {
      return h(Gt, {
        show: [r, i],
        get children() {
          var f = jw(), g = f.firstChild, p = g.firstChild, S = p.nextSibling, _ = S.nextSibling, m = _.nextSibling;
          m.nextSibling;
          var y = g.nextSibling, v = y.nextSibling;
          return w(g, () => t.selectedReport().number, S), w(g, () => t.selectedReport().name, m), w(y, h(ut, {
            label: "Publish To PAD Tree",
            value: [o, l]
          })), w(f, h(B, {
            get when() {
              return o();
            },
            get children() {
              var x = Bw();
              return x.firstChild, w(x, h(dt, {
                value: [e, n],
                placeholder: s
              }), null), x;
            }
          }), v), w(f, h(B, {
            get when() {
              return t.selectedReport()?.parentReport;
            },
            get children() {
              var x = Uw();
              return w(x, h(ut, {
                get label() {
                  return `Override default report (${t.selectedReport().parentReport})`;
                },
                value: [a, c]
              })), x;
            }
          }), v), w(v, h(ne, {
            get enabled() {
              return !t.state.isPublishing;
            },
            onClick: () => t.cancelCopy(),
            children: "Cancel"
          }), null), w(v, h(ne, {
            get enabled() {
              return d();
            },
            get loading() {
              return t.state.isPublishing;
            },
            onClick: u,
            type: "primary",
            children: "Publish"
          }), null), f;
        }
      });
    }
  });
}
var Fw = /* @__PURE__ */ T("<span>Are you sure?"), Vw = /* @__PURE__ */ T("<div class=delete-actions>");
function Hw() {
  const t = tn(), [e, n] = I(t.state.isDeleteDialogOpen);
  return Z(() => {
    n(t.state.isDeleteDialogOpen);
  }), Z(() => {
    e() !== t.state.isDeleteDialogOpen && e() === !1 && t.cancelCopy();
  }), h(B, {
    get when() {
      return t.selectedReport();
    },
    get children() {
      return h(Gt, {
        show: [e, n],
        get children() {
          return [Fw(), (() => {
            var r = Vw();
            return w(r, h(ne, {
              get onClick() {
                return t.cancelDelete;
              },
              children: "Cancel"
            }), null), w(r, h(ne, {
              onClick: () => t.deleteReport(t.selectedReport()),
              type: "danger",
              get loading() {
                return t.state.isDeleting;
              },
              children: "Delete"
            }), null), r;
          })()];
        }
      });
    }
  });
}
var zw = /* @__PURE__ */ T("<div class=report-thumbnail-dialog--jq-picker>"), Ww = /* @__PURE__ */ T("<div class=report-thumbnail-dialog><div class=report-thumbnail-dialog--heading>Choose File</div><div class=report-thumbnail-dialog--file-picker><input type=file></div><div class=report-thumbnail-dialog--divider></div><div class=report-thumbnail-dialog--heading>Choose From Previous Runs"), Jw = /* @__PURE__ */ T("<span>Loading..."), Qw = /* @__PURE__ */ T("<div class=report-thumbnail-dialog--jq-preview><img role=button tabindex=0><span class=report-thumbnail-dialog--submit-dt>");
function Kw() {
  const t = tn(), [e, n] = I(t.state.isThumbnailDialogOpen), [r, i] = I();
  Z(() => {
    n(t.state.isThumbnailDialogOpen);
  }), Z(() => {
    e() !== t.state.isThumbnailDialogOpen && e() === !1 && t.cancelCopy();
  });
  const s = (c) => {
    if (c.target.files) {
      const u = c.target.files[0];
      u && i(() => u);
    }
  }, o = () => {
    t.updateReportThumbnail(t.selectedReport(), r());
  }, [l] = Oy(() => t.state.selectedReportId, async (c) => await _r.LoadPreviousRuns(c)), a = async (c) => {
    t.state.selectedReportId && c.imgBase64 && t.setReportThumbnail(t.state.selectedReportId, c.imgBase64, "png");
  };
  return h(B, {
    get when() {
      return t.selectedReport();
    },
    get children() {
      return h(Gt, {
        title: "Report Thumbnail",
        show: [e, n],
        get children() {
          var c = Ww(), u = c.firstChild, d = u.nextSibling, f = d.firstChild, g = d.nextSibling;
          return g.nextSibling, f.addEventListener("change", s), w(d, h(ne, {
            onClick: o,
            children: "Update Thumbnail"
          }), null), w(c, h(Dy, {
            get fallback() {
              return Jw();
            },
            get children() {
              var p = zw();
              return w(p, h(de, {
                get each() {
                  return l();
                },
                children: (S) => (() => {
                  var _ = Qw(), m = _.firstChild, y = m.nextSibling;
                  return m.$$click = () => a(S), w(y, () => S.submitDate?.substring(0, S.submitDate.length - 3)), R(() => ye(m, "src", `data:image/png;base64,${S.imgBase64}`)), _;
                })()
              })), p;
            }
          }), null), c;
        }
      });
    }
  });
}
Xe(["click"]);
var Yw = /* @__PURE__ */ T("<div class=copy-wizard><div class=report-info-container><div style=flex-basis:50%;><span>Report Number</span></div><div style=flex-basis:50%;><span>Report Name");
function Xw(t) {
  const e = tn(), n = t.report.name ? `${t.report.name} - Copy` : "", r = t.report.number ? `${t.report.number}C` : "", [i, s] = t.isCopying, o = I(n), [l] = o, a = I(r), [c] = a, [u, d] = I(!1), f = async () => {
    d(!0);
    try {
      const g = await _r.CopyReport(t.report.reportGU ?? "", c(), l());
      e.addReport(g), s(!1), e.setSearchStr(""), e.setSelectedGroup(e.state.groups.find((p) => p.description === "My Reports")), e.expandReport(g);
    } catch (g) {
      typeof g == "string" ? Qt.notify("error", g) : Qt.notify("error", "An error ocurred while copying the report.");
    }
    d(!1);
  };
  return (() => {
    var g = Yw(), p = g.firstChild, S = p.firstChild;
    S.firstChild;
    var _ = S.nextSibling;
    return _.firstChild, w(S, h(dt, {
      value: a,
      selected: !0,
      focused: !0
    }), null), w(_, h(dt, {
      value: o
    }), null), w(g, h(ne, {
      get loading() {
        return u();
      },
      type: "primary",
      onClick: f,
      children: "Create"
    }), null), g;
  })();
}
function Zw() {
  const t = tn(), [e, n] = I(t.state.isCopyDialogOpen);
  return Z(() => {
    n(t.state.isCopyDialogOpen);
  }), Z(() => {
    e() !== t.state.isCopyDialogOpen && e() === !1 && t.cancelCopy();
  }), h(B, {
    get when() {
      return t.selectedReport();
    },
    get children() {
      return h(Gt, {
        show: [e, n],
        get children() {
          return h(Xw, {
            get report() {
              return t.selectedReport();
            },
            isCopying: [e, n]
          });
        }
      });
    }
  });
}
var e_ = /* @__PURE__ */ T('<div><span class="fa fa-chevron-right"style=font-size:20pt;>'), t_ = /* @__PURE__ */ T("<div class=st-breadcrumb><span class=st-breadcrumb-text>"), n_ = /* @__PURE__ */ T('<div class=st-breadcrumbs><div class=st-breadcrumb><span class="fa fa-home"></span><span class=st-breadcrumb-text>Home'), r_ = /* @__PURE__ */ T('<span class="fa fa-list">'), i_ = /* @__PURE__ */ T('<span class="fa fa-grip-horizontal">'), s_ = /* @__PURE__ */ T('<span class="fa fa-expand">'), o_ = /* @__PURE__ */ T('<div style=display:flex;gap:6px;align-items:center;white-space:nowrap;><span class="fa fa-plus"></span>New Report'), l_ = /* @__PURE__ */ T('<div style=display:flex;gap:6px;><span class="fa fa-pencil"></span>Edit'), a_ = /* @__PURE__ */ T("<div class=report-browser-toolbar><div style=display:flex;gap:8px></div><div style=flex-basis:33%;>"), c_ = /* @__PURE__ */ T('<div class="report-browser st-ui-scrollbars">'), u_ = /* @__PURE__ */ T('<div class=report-browser-loading><div class="fa fa-spinner fa-spin"style=font-size:3rem;></div><div>Loading reports...');
const d_ = () => {
  const t = tn(), e = () => {
    t.toggleCarousel(!1), t.setSelectedGroup(null);
  };
  return (() => {
    var n = n_(), r = n.firstChild;
    return r.$$click = e, w(n, h(B, {
      get when() {
        return t.selectedGroup();
      },
      get children() {
        return [e_(), (() => {
          var i = t_(), s = i.firstChild;
          return w(s, () => t.selectedGroup().description), i;
        })()];
      }
    }), null), n;
  })();
}, h_ = () => {
  const t = tn(), [e, n] = Ie(() => t.state.isEditing, (o) => t.toggleEditMode(o)), [r, i] = Ie(() => t.state.isCreating, (o) => t.toggleCreateMode(o)), s = Ie(() => t.state.searchStr, (o) => t.setSearchStr(o));
  return (() => {
    var o = a_(), l = o.firstChild, a = l.nextSibling;
    return w(l, h(d_, {}), null), w(l, h(Zn, {
      get children() {
        return [h(ne, {
          label: "List Mode",
          onClick: () => t.setViewMode("list"),
          get active() {
            return !t.state.isInCarousel && t.state.viewMode === "list";
          },
          get children() {
            return r_();
          }
        }), h(ne, {
          label: "Tile Mode",
          onClick: () => t.setViewMode("tile"),
          get active() {
            return !t.state.isInCarousel && t.state.viewMode === "tile";
          },
          get children() {
            return i_();
          }
        }), h(ne, {
          label: "Carousel Mode",
          onClick: () => t.toggleCarousel(),
          get active() {
            return t.state.isInCarousel;
          },
          get children() {
            return s_();
          }
        }), h(B, {
          get when() {
            return P(() => !!t.state.canEdit)() && e();
          },
          get children() {
            return [h(ne, {
              onClick: () => n(!1),
              type: "primary",
              children: "Lock"
            }), h(ne, {
              get enabled() {
                return t.state.canAdd;
              },
              onClick: () => i(!0),
              type: "success",
              get children() {
                return o_();
              }
            })];
          }
        }), h(B, {
          get when() {
            return P(() => !!t.state.canEdit)() && !e();
          },
          get children() {
            return h(ne, {
              get enabled() {
                return t.state.canEdit;
              },
              onClick: () => {
                n(!0);
              },
              get children() {
                return l_();
              }
            });
          }
        })];
      }
    }), null), w(a, h(dt, {
      value: s,
      placeholder: "Search..."
    })), w(o, h(Gt, {
      show: [r, i],
      get children() {
        return h(B, {
          get when() {
            return r();
          },
          get children() {
            return h(rw, {});
          }
        });
      }
    }), null), o;
  })();
};
class f_ {
}
function nu(t) {
  return h(tw, {
    get children() {
      var e = c_();
      return w(e, h(h_, {}), null), w(e, h(g_, {}), null), w(e, h(Zw, {}), null), w(e, h(Gw, {}), null), w(e, h(Hw, {}), null), w(e, h(Kw, {}), null), e;
    }
  });
}
nu.defaultProps = new f_();
function g_() {
  const t = tn();
  return (async () => {
    await t.refresh();
    const r = new URLSearchParams(window.location.search).get("identity");
    if (r)
      for (const s of t.state.groups) {
        const o = s.reports.find((l) => l.reportGU === r);
        o && (t.setSelectedGroup(s), t.expandReport(o));
      }
    const i = await _r.GetSecurityInfo();
    t.setCanAdd(i.canAdd), t.setCanEdit(i.canEdit), t.setCanPublish(i.canPublish), t.setCanAccessMyReports(i.canAccessMyReports);
  })(), h(Zt, {
    get children() {
      return [h(Pe, {
        get when() {
          return t.state.isLoadingGroups;
        },
        get children() {
          return u_();
        }
      }), h(Pe, {
        get when() {
          return t.state.isInCarousel;
        },
        get children() {
          return h(Pw, {});
        }
      }), h(Pe, {
        get when() {
          return t.state.viewMode === "list";
        },
        get children() {
          return h(Ew, {});
        }
      }), h(Pe, {
        get when() {
          return t.state.viewMode === "tile";
        },
        get children() {
          return h(vw, {});
        }
      })];
    }
  });
}
Xe(["click"]);
const p_ = "_range_2y6zt_1", m_ = {
  range: p_
};
var v_ = /* @__PURE__ */ T('<div class="flexbox horizontal"><label aria-label=Verbosity class=auto><input type=range step=1 min=0>'), y_ = /* @__PURE__ */ T('<div class="flexbox horizontal middle"><span class=auto></span><span>');
class b_ {
  type = {};
  value = I(0);
  label = "";
}
function zs(t) {
  const [e, n] = t.value, r = (o) => {
    const l = parseInt(o.target.value, 10);
    n(l);
  }, i = P(() => e().toString()), s = P(() => t.type[i()]);
  return [(() => {
    var o = v_(), l = o.firstChild, a = l.firstChild;
    return a.addEventListener("change", r), R((c) => {
      var u = m_.range, d = Math.min(Object.keys(t.type).length / 2 - 1);
      return u !== c.e && D(a, c.e = u), d !== c.t && ye(a, "max", c.t = d), c;
    }, {
      e: void 0,
      t: void 0
    }), R(() => a.value = i()), o;
  })(), (() => {
    var o = y_(), l = o.firstChild, a = l.nextSibling;
    return w(a, s), o;
  })()];
}
zs.defaultProps = new b_();
const w_ = "_alert_s0lkz_1", __ = {
  alert: w_
};
var S_ = /* @__PURE__ */ T('<div><i style=font-size:1.4em;margin-right:10px class="fas fa-info-circle"></i><div>');
class x_ {
  children;
  type;
}
function qi(t) {
  const e = us(() => t.children);
  return (() => {
    var n = S_(), r = n.firstChild, i = r.nextSibling;
    return w(i, e), R((s) => {
      var o = `flexbox horizontal middle ${__.alert}`, l = t.type;
      return o !== s.e && D(n, s.e = o), l !== s.t && ye(n, "data-type", s.t = l), s;
    }, {
      e: void 0,
      t: void 0
    }), n;
  })();
}
qi.defaultProps = new x_();
const C_ = "_radioGroup_1hv1a_1", $_ = "_radio_1hv1a_1", E_ = "_icon_1hv1a_17", T_ = "_flexbox_1hv1a_43", A_ = "_checked_1hv1a_61", ri = {
  radioGroup: C_,
  radio: $_,
  icon: E_,
  flexbox: T_,
  checked: A_
};
var k_ = /* @__PURE__ */ T("<fieldset>"), I_ = /* @__PURE__ */ T("<img>"), O_ = /* @__PURE__ */ T("<i role=presentation>"), D_ = /* @__PURE__ */ T("<span>"), L_ = /* @__PURE__ */ T("<label><input type=radio>");
class N_ {
  type = "default";
  name;
  value;
  vertical;
}
class P_ {
  name;
  type;
  value;
  constructor(e, n, r) {
    this.name = e, this.type = n, this.value = r;
  }
}
const Tp = bt();
function R_() {
  return Ir(Tp);
}
function rt(t) {
  const e = P(() => t.vertical ? "flexbox vertical middle" : "flexbox horizontal middle");
  function n(i) {
    return (() => {
      var s = k_();
      return s.style.setProperty("align-items", "start"), w(s, () => i.children), R((o) => {
        var l = `${ri.radioGroup} ${e()}`, a = i.type;
        return l !== o.e && D(s, o.e = l), a !== o.t && ye(s, "data-type", o.t = a), o;
      }, {
        e: void 0,
        t: void 0
      }), s;
    })();
  }
  const r = Ie(() => t.value[0]().toString(), (i) => t.value[1](i));
  return h(Tp.Provider, {
    get value() {
      return new P_(t.name ?? Cr(), t.type ?? "default", r);
    },
    get children() {
      return h(n, t);
    }
  });
}
rt.defaultProps = new N_();
class $5 {
  icon;
  label;
  value;
}
rt.Option = function(t) {
  const e = R_(), n = t.value || t.label, r = P(() => t.icon ? "auto flexbox vertical middle" : "auto flexbox horizontal middle");
  function i(s) {
    s.setAttribute("name", e.name);
    const o = () => {
      if (s.checked) {
        const l = s.closest(`.${ri.radioGroup}`).querySelectorAll(`.${ri.checked}`);
        Array.from(l ?? []).forEach((a) => a.classList.remove(ri.checked)), s.parentElement?.classList.add(ri.checked), e.value[1](s.value);
      } else
        s.parentElement?.classList.remove(ri.checked);
    };
    Z(() => {
      s.checked = s.value === e.value[0](), o();
    }), s.addEventListener("change", (l) => o());
  }
  return (() => {
    var s = L_(), o = s.firstChild, l = i;
    return typeof l == "function" ? Le(l, o) : i = o, o.value = n, w(s, h(Zt, {
      get children() {
        return [h(Pe, {
          get when() {
            return t.icon?.includes("/");
          },
          get children() {
            var a = I_();
            return ye(a, "alt", n), R((c) => {
              var u = ri.icon, d = window.ST.TransformImagePath?.call(null, t.icon) || t.icon;
              return u !== c.e && D(a, c.e = u), d !== c.t && ye(a, "src", c.t = d), c;
            }, {
              e: void 0,
              t: void 0
            }), a;
          }
        }), h(Pe, {
          get when() {
            return t.icon;
          },
          get children() {
            var a = O_();
            return R(() => D(a, `${ri.icon} ${t.icon}`)), a;
          }
        })];
      }
    }), null), w(s, h(B, {
      get when() {
        return t.label;
      },
      get fallback() {
        return t.children;
      },
      get children() {
        var a = D_();
        return w(a, () => t.label), a;
      }
    }), null), R(() => D(s, `${ri.radio} ${r()}`)), s;
  })();
};
var M_ = /* @__PURE__ */ T('<button class="btn btn-link st-tool-button"><i>');
class q_ {
  icon = "";
  label = "";
  children;
  onClick = () => {
  };
}
function Dt(t) {
  const e = us(() => t.children);
  return (() => {
    var n = M_(), r = n.firstChild;
    return Le(tooltip, n, () => t.label), Ao(n, "click", t.onClick, !0), w(n, e, null), R((i) => {
      var s = t.label, o = t.icon;
      return s !== i.e && ye(n, "aria-label", i.e = s), o !== i.t && D(r, i.t = o), i;
    }, {
      e: void 0,
      t: void 0
    }), n;
  })();
}
Dt.defaultProps = new q_();
Xe(["click"]);
const [B_, qh] = I();
let Bh = !1;
class hd {
  constructor() {
    Bh || (Bh = !0, Kl.GetWritingStyles().then((e) => {
      qh(e);
    }).catch(console.error));
  }
  get styles() {
    return B_() || [];
  }
  myWritingStyle() {
    return this.styles[0] || new Wg();
  }
  getWritingStyle(e) {
    return this.styles.find((n) => n.writingStyleGU === e) || this.myWritingStyle();
  }
  setMyWritingStyle(e) {
    Kl.SaveWritingStyle(e);
    const [n, ...r] = this.styles;
    qh([e, ...r]);
  }
}
const U_ = "_loading_1pb2i_55", j_ = "_pulse_1pb2i_1", G_ = "_heading_1pb2i_101", F_ = {
  "text-preview": "_text-preview_1pb2i_19",
  "text-loading-icon": "_text-loading-icon_1pb2i_45",
  loading: U_,
  pulse: j_,
  heading: G_,
  "st-memo-gen": "_st-memo-gen_1pb2i_125",
  "use-container": "_use-container_1pb2i_133"
};
var V_ = /* @__PURE__ */ T('<div class=ai-animation><div class=ai-content style=-webkit-background-clip:text><div class="circle-container flexbox vertical middle"><span class=auto></span><div class=circle></div><span class=auto></span></div><div class="text flexbox vertical middle"><span class=auto></span><i></i><div style=text-align:center></div><span class=auto>');
class H_ {
  size = "300px";
  processing = !0;
  show = !0;
}
function Zi(t) {
  const e = P(() => t.processing ? "fa-thin" : "fa-solid"), n = P(() => !(t.show === !1 || t.show === "false"));
  return h(B, {
    get when() {
      return n();
    },
    get children() {
      var r = V_(), i = r.firstChild, s = i.firstChild, o = s.nextSibling, l = o.firstChild, a = l.nextSibling, c = a.nextSibling;
      return w(c, () => Ry.GeneratingAIContent), R((u) => {
        var d = !!t.processing, f = `--size: ${t.size}`, g = `${e()} fa-brain-circuit`;
        return d !== u.e && r.classList.toggle("is-processing", u.e = d), u.t = Yn(r, f, u.t), g !== u.a && D(a, u.a = g), u;
      }, {
        e: void 0,
        t: void 0,
        a: void 0
      }), r;
    }
  });
}
Zi.defaultProps = new H_();
var z_ = /* @__PURE__ */ T('<div class="auto flexbox vertical st-generated-text-preview"><div class="flexbox horizontal middle"style="margin:0 10px"><div class=label></div></div><div class="auto flexbox vertical text-preview"><div class="auto flexbox vertical"style=align-items:center;overflow:auto><div class=ai-loader></div><div class=content></div></div></div><div class="flexbox horizontal middle"style="margin:0 10px;position:absolute;top:100%;left:0;right:0;"><div class=auto></div><div style=z-index:1></div><div class=auto>'), W_ = /* @__PURE__ */ T("<p>");
const [E5, J_] = I("");
document.addEventListener("selectionchange", (t) => {
  let e = document.getSelection()?.toString();
  J_(e || "");
});
function Ap(t) {
  const e = P(() => t.generatedText || ""), n = P(() => t.loading), [r, i] = I(!0), [s, o] = I(!1), [l, a] = I(0), [c, u] = I(1);
  let d = !1;
  return Z(() => {
    const f = !!e();
    (async () => d || (d = !0, f ? (c() && (u(0), await Ls(1e3), i(!1)), o(!0), await Ls(1e3), a(1)) : (l() && (a(0), o(!1)), i(!0), await Ls(100), u(1)), d = !1))();
  }), (() => {
    var f = z_(), g = f.firstChild, p = g.firstChild, S = g.nextSibling, _ = S.firstChild, m = _.firstChild, y = m.nextSibling, v = S.nextSibling, x = v.firstChild, C = x.nextSibling;
    return w(p, () => t.label), w(m, h(Zi, {
      get processing() {
        return n();
      },
      size: "300px"
    })), w(y, () => e().split(`
`).map((E) => (() => {
      var k = W_();
      return w(k, E), k;
    })())), w(C, h(ne, {
      type: "success",
      get enabled() {
        return !!e();
      },
      get onClick() {
        return t.onReplace;
      },
      children: "Replace"
    })), R((E) => {
      var k = !!n(), L = r() ? "" : "none", M = c(), G = s() ? "" : "none", Y = l();
      return k !== E.e && S.classList.toggle("loading", E.e = k), L !== E.t && ((E.t = L) != null ? m.style.setProperty("display", L) : m.style.removeProperty("display")), M !== E.a && ((E.a = M) != null ? m.style.setProperty("opacity", M) : m.style.removeProperty("opacity")), G !== E.o && ((E.o = G) != null ? y.style.setProperty("display", G) : y.style.removeProperty("display")), Y !== E.i && ((E.i = Y) != null ? y.style.setProperty("opacity", Y) : y.style.removeProperty("opacity")), E;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0
    }), f;
  })();
}
var Q_ = /* @__PURE__ */ T('<div class="flexbox horizontal middle"><span class=auto style="margin:0 5px">'), K_ = /* @__PURE__ */ T('<div class="flexbox vertical middle"><div style=max-width:600px;width:100%>'), Y_ = /* @__PURE__ */ T('<div class="auto flexbox horizontal">'), X_ = /* @__PURE__ */ T('<i class="fas fa-pen-nib">'), Z_ = /* @__PURE__ */ T('<div class="flexbox horizontal middle padded"><div></div><div class=auto></div><div>');
const fd = bt(new hd());
function eS() {
  return Nt(fd);
}
const tS = window.ST || {};
let nS = class {
  onOpen;
  onClose;
  onReplace;
}, ru = class {
  code = "";
  desc = "";
  generatedText = I("");
  loading = I(!1);
};
class rS {
  srcName = "";
  identity = "";
  lookupItems = [new ru()];
  onSelected;
  events = new nS();
}
function iu(t) {
  const [e, n] = I(!!tS.DEBUGGING_COMPONENT), [r, i] = I(t.lookupItems), s = new hd(), o = I(!1), l = I(s.myWritingStyle().writingStyleGU), [a, c] = I(""), u = P(() => t.identity), d = P(() => t.srcName), [f, g] = I(s.myWritingStyle().verbosity);
  return Z(() => {
    const _ = e();
    _ && t.events.onOpen ? t.events.onOpen() : !_ && t.events.onClose && t.events.onClose(), c("");
    for (const m of r())
      _ || m.generatedText[1]("");
  }), Z(() => {
    const _ = s.myWritingStyle();
    _ && requestAnimationFrame(() => {
      _.verbosity !== f() && g(_.verbosity);
    });
  }), Z(() => {
    const _ = f();
    requestAnimationFrame(() => {
      const m = s.myWritingStyle();
      m.verbosity !== _ && (m.verbosity = _, s.setMyWritingStyle(m));
    });
  }), Z(() => {
    const _ = t.srcName;
    _ && Kl.GetMemoLookupItems(_).then((m) => {
      const y = m.map((v) => {
        const x = new ru();
        return x.code = v.code || "", x.desc = v.desc || "", x;
      }) || [];
      if (y.length === 0) {
        const v = new ru();
        y.push(v);
      }
      i(y);
    });
  }), h(fd.Provider, {
    value: s,
    get children() {
      return [h(Dt, {
        icon: "fas fa-brain-circuit s-link",
        label: "Generate Note",
        onClick: () => n(!0)
      }), h(Gt, {
        get class() {
          return `${F_["st-memo-gen"]} st-memo-gen`;
        },
        show: [e, n],
        get children() {
          return [h(qi, {
            type: "info",
            children: "What would you like to say?"
          }), (() => {
            var _ = Q_(), m = _.firstChild;
            return w(m, h(dt, {
              value: [a, c],
              onEnterKey: S
            })), w(_, h(ne, {
              type: "primary",
              onClick: S,
              children: "Compose"
            }), null), _;
          })(), (() => {
            var _ = K_(), m = _.firstChild;
            return w(m, h(zs, {
              type: ai,
              value: [f, g],
              label: "Verbosity"
            })), _;
          })(), (() => {
            var _ = Y_();
            return w(_, h(de, {
              get each() {
                return r();
              },
              children: (m) => h(Ap, {
                get label() {
                  return m.desc;
                },
                onReplace: () => p(m.generatedText[0]()),
                get loading() {
                  return m.loading[0]();
                },
                get generatedText() {
                  return m.generatedText[0]();
                }
              })
            })), _;
          })(), (() => {
            var _ = Z_(), m = _.firstChild, y = m.nextSibling, v = y.nextSibling;
            return w(m, h(ne, {
              onClick: () => o[1](!0),
              tooltip: "Configure My Writing Style",
              get children() {
                return X_();
              }
            })), w(v, h(ne, {
              onClick: () => n(!1),
              children: "Close"
            })), _;
          })(), h(kp, {
            show: o
          })];
        }
      })];
    }
  });
  function p(_) {
    t.events.onReplace && t.events.onReplace(_);
    for (const m of r())
      m.generatedText[1]("");
    n(!1);
  }
  async function S() {
    const _ = s.getWritingStyle(l[0]());
    for (const m of r())
      m.loading[1](!0), m.generatedText[1](""), Kl.Generate(a(), u(), d(), m.code, _).then((y) => new Promise((v) => setTimeout(() => v(y), 1e3))).then((y) => {
        m.generatedText[1](y.text), m.loading[1](!1);
      }).catch((y) => {
        Qt.notify("error", y), m.loading[1](!1);
      });
  }
}
iu.defaultProps = new rS();
var iS = /* @__PURE__ */ T("<dialog style=min-width:600px><h3>Tone:</h3><h3>Attitude:</h3><h3>Verbosity:");
function kp(t) {
  const e = eS();
  e.myWritingStyle();
  const n = I("0"), r = I("0"), i = I("0"), s = Object.entries(ai).filter((u) => Number(u[1]) >= 0), [o, l] = t.show;
  let a;
  return jt(() => {
    requestAnimationFrame(() => {
      Z(() => {
        o() ? a.showModal() : a.close();
      });
    });
  }), Z(() => {
    const u = e.myWritingStyle();
    n[1](u.tone.toString()), r[1](u.attitude.toString()), i[1](u.verbosity.toString());
  }), (() => {
    var u = iS(), d = u.firstChild, f = d.nextSibling, g = f.nextSibling;
    Le(draggable, u, () => {
    }), u.$$click = c;
    var p = a;
    return typeof p == "function" ? Le(p, u) : a = u, w(u, h(qi, {
      type: "info",
      children: "Define Your Writing Style"
    }), d), w(u, h(rt, {
      name: "tone",
      value: n,
      get children() {
        return [h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Casual.svg",
          label: "Casual",
          value: "0"
        }), h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Technical.svg",
          label: "Technical",
          value: "1"
        }), h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Formal.svg",
          label: "Formal",
          value: "2"
        })];
      }
    }), f), w(u, h(rt, {
      name: "attitude",
      value: r,
      get children() {
        return [h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Neutral.svg",
          label: "Neutral",
          value: "0"
        }), h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Empathetic.svg",
          label: "Empathetic",
          value: "1"
        }), h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Enthusiastic.svg",
          label: "Enthusiastic",
          value: "2"
        }), h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Persuasive.svg",
          label: "Persuasive",
          value: "3"
        })];
      }
    }), g), w(u, h(rt, {
      name: "verbosity",
      value: i,
      get children() {
        return h(de, {
          each: s,
          children: (S) => h(rt.Option, {
            get icon() {
              return `Images/ST_VIEW/WritingStyle/${S[0]}.svg`;
            },
            get label() {
              return S[0];
            },
            get value() {
              return S[1].toString();
            }
          })
        });
      }
    }), null), u;
  })();
  function c(u) {
    const d = this.getBoundingClientRect(), f = d.top <= u.clientY && u.clientY <= d.top + d.height && d.left <= u.clientX && u.clientX <= d.left + d.width;
    u.target === this && !f && (e.setMyWritingStyle({
      writingStyleGU: e.myWritingStyle().writingStyleGU,
      tone: Yl[Yl[+n[0]()]],
      attitude: Xl[Xl[+r[0]()]],
      verbosity: ai[ai[+i[0]()]]
    }), l(!1));
  }
}
Xe(["click"]);
const sS = "_loading_1w1bs_55", oS = "_pulse_1w1bs_1", lS = "_heading_1w1bs_101", aS = {
  "text-preview": "_text-preview_1w1bs_19",
  "text-loading-icon": "_text-loading-icon_1w1bs_45",
  loading: sS,
  pulse: oS,
  heading: lS,
  "st-memo-gen": "_st-memo-gen_1w1bs_125",
  "use-container": "_use-container_1w1bs_131"
};
var cS = /* @__PURE__ */ T('<div class="flexbox horizontal middle"><span class=auto style="margin:0 5px;">'), uS = /* @__PURE__ */ T('<div class="auto flexbox horizontal">'), dS = /* @__PURE__ */ T('<i class="fas fa-pen-nib">'), hS = /* @__PURE__ */ T('<div class="flexbox horizontal middle padded"><div></div><div class=auto></div><div>');
let fS = class {
  onReplace;
  onClose;
};
class gS {
  text = "";
  show = !1;
  events = new fS();
}
function su(t) {
  const [e, n] = I(t.show);
  Z(() => {
    n(t.show);
  }), Z(() => {
    e() ? l("") : t.events.onClose && t.events.onClose();
  });
  const r = new hd(), i = I(!1), s = I(r.myWritingStyle().writingStyleGU), [o, l] = I(""), [a, c] = I(!1), [u, d] = I(r.myWritingStyle().verbosity);
  Z(() => {
    const _ = r.myWritingStyle();
    _ && requestAnimationFrame(() => {
      _.verbosity !== u() && d(_.verbosity);
    });
  }), Z(() => {
    const _ = u();
    requestAnimationFrame(() => {
      const m = r.myWritingStyle();
      m.verbosity !== _ && (m.verbosity = _, r.setMyWritingStyle(m));
    });
  });
  const [f, g] = I("");
  return Z(() => {
    g(t.text);
  }), h(fd.Provider, {
    value: r,
    get children() {
      return h(Gt, {
        get class() {
          return `${aS["st-memo-gen"]} sm-generator`;
        },
        show: [e, n],
        get children() {
          return [h(qi, {
            type: "info",
            children: "What would you like to say?"
          }), (() => {
            var _ = cS(), m = _.firstChild;
            return w(m, h(dt, {
              value: [f, g],
              onEnterKey: S
            })), w(_, h(ne, {
              type: "primary",
              onClick: S,
              children: "Compose"
            }), null), _;
          })(), h(zs, {
            type: ai,
            value: [u, d],
            label: "Verbosity"
          }), (() => {
            var _ = uS();
            return w(_, h(Ap, {
              onReplace: () => p(o()),
              get loading() {
                return a();
              },
              get generatedText() {
                return o();
              }
            })), _;
          })(), (() => {
            var _ = hS(), m = _.firstChild, y = m.nextSibling, v = y.nextSibling;
            return w(m, h(ne, {
              onClick: () => i[1](!0),
              tooltip: "Configure My Writing Style",
              get children() {
                return dS();
              }
            })), w(v, h(ne, {
              onClick: () => n(!1),
              children: "Close"
            })), _;
          })(), h(kp, {
            show: i
          })];
        }
      });
    }
  });
  function p(_) {
    t.events.onReplace && t.events.onReplace(_), l(_), n(!1);
  }
  async function S() {
    const _ = r.getWritingStyle(s[0]());
    c(!0), l(""), My.Generate(f(), _).then((m) => new Promise((y) => setTimeout(() => y(m), 1e3))).then((m) => {
      l(m.text), c(!1);
    });
  }
}
su.defaultProps = new gS();
class pS {
  expandedIds;
  setExpandedIds;
  multiple;
  setMultiple;
  constructor() {
    [this.expandedIds, this.setExpandedIds] = I([]), [this.multiple, this.setMultiple] = I(!1);
  }
  receiveProps(e) {
    this.setMultiple(e.multiple ?? this.multiple());
  }
  toggle(e) {
    const n = this.expandedIds();
    this.multiple() ? n.includes(e) ? this.setExpandedIds(n.filter((r) => r !== e)) : this.setExpandedIds([...n, e]) : n.includes(e) ? this.setExpandedIds([]) : this.setExpandedIds([e]);
  }
  open(e) {
    const n = this.expandedIds();
    n.includes(e) || (this.multiple() && (n.includes(e) || this.setExpandedIds([...n, e])), n.includes(e) || this.setExpandedIds([...n, e]));
  }
  close(e) {
    const n = this.expandedIds();
    n.includes(e) && this.setExpandedIds(n.filter((r) => r !== e));
  }
}
const Ip = bt(), mS = () => {
  const t = Nt(Ip);
  if (!t)
    throw new Error("useAccordion must be used within an Accordion component");
  return t;
}, vS = Ip.Provider, yS = "_item_1xlk3_1", Cs = {
  item: yS,
  "item-header": "_item-header_1xlk3_21",
  "item-content": "_item-content_1xlk3_97",
  "item-toggle-icon": "_item-toggle-icon_1xlk3_121"
};
var bS = /* @__PURE__ */ T("<div><button><i></i></button><div>");
const wS = (t) => {
  const e = mS(), n = Ly(), [r, i] = I(t.open ?? !1);
  Z(Tr(() => [t.open], () => {
    t.open ? e.open(n) : e.close(n);
  })), Z(() => {
    i(e.expandedIds().includes(n));
  });
  const s = () => {
    t.disabled || e.toggle(n);
  }, o = (l) => {
    let a = !0;
    const c = l.currentTarget;
    switch (l.key) {
      case "Enter":
      case " ":
        s();
        break;
      case "ArrowLeft":
        e.close(c.getAttribute("data-id"));
        break;
      case "ArrowRight":
        e.open(c.getAttribute("data-id"));
        break;
      case "ArrowDown":
        const u = c.parentElement?.nextElementSibling;
        if (u) {
          const f = u.querySelector(`.${Cs["item-header"]}`);
          f && f.focus();
        }
        break;
      case "ArrowUp":
        const d = c.parentElement?.previousSibling;
        if (d) {
          const f = d.querySelector(`.${Cs["item-header"]}`);
          f && f.focus();
        }
        break;
      default:
        a = !1;
    }
    a && l.preventDefault();
  };
  return (() => {
    var l = bS(), a = l.firstChild, c = a.firstChild, u = a.nextSibling;
    return a.$$keydown = o, a.$$click = s, ye(a, "data-id", n), w(a, () => t.title, null), w(u, () => t.children), R((d) => {
      var f = Cs.item, g = r(), p = Cs["item-header"], S = t.titlePlacement ?? "right", _ = t.disabled, m = `${Cs["item-toggle-icon"]} fa fa-chevron-right`, y = Cs["item-content"];
      return f !== d.e && D(l, d.e = f), g !== d.t && ye(l, "data-expanded", d.t = g), p !== d.a && D(a, d.a = p), S !== d.o && ye(a, "data-placement", d.o = S), _ !== d.i && (a.disabled = d.i = _), m !== d.n && D(c, d.n = m), y !== d.s && D(u, d.s = y), d;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0,
      n: void 0,
      s: void 0
    }), l;
  })();
};
Xe(["click", "keydown"]);
var _S = /* @__PURE__ */ T("<div>");
class SS {
  multiple;
  disabled;
}
function xr(t) {
  const e = new pS();
  return Z(() => {
    e.receiveProps(t);
  }), h(vS, {
    value: e,
    get children() {
      var n = _S();
      return w(n, () => t.children), n;
    }
  });
}
xr.Item = wS;
xr.defaultProps = new SS();
class Op {
  viewId;
  setViewId;
  tabId;
  setTabId;
  primaryObjectGU;
  setPrimaryObjectGU;
  identity;
  setIdentity;
  definition = void 0;
  setDefinition;
  events;
  constructor() {
    [this.definition, this.setDefinition] = er(new qy()), [this.viewId, this.setViewId] = I(""), [this.tabId, this.setTabId] = I(""), [this.primaryObjectGU, this.setPrimaryObjectGU] = I(""), [this.identity, this.setIdentity] = I(""), Z(async () => {
      this.viewId();
    });
  }
}
var xS = /* @__PURE__ */ T('<i class="fa fa-bars">'), CS = /* @__PURE__ */ T("<div>");
function $S() {
  const t = Ga();
  return (() => {
    var e = CS();
    return w(e, h(Ve, {
      get children() {
        return [h(Ve.Trigger, {
          as: ne,
          get children() {
            return xS();
          }
        }), P(() => t.definition?.actionArea.menu.label), "This is a test"];
      }
    })), e;
  })();
}
var ES = /* @__PURE__ */ T("<div><h1>");
const Ws = window.ST || {}, ja = bt();
function Ga() {
  const t = Nt(ja);
  if (t) return t;
  throw new Error("Missing view context.");
}
function TS() {
  return Nt(ja);
}
class AS {
  viewId = void 0;
  tabId = void 0;
  identity = void 0;
}
function ou(t) {
  const e = new Op();
  return Z(() => {
    e.setViewId(t.viewId || ""), e.setTabId(t.tabId || "");
  }), h(ja.Provider, {
    value: e,
    get children() {
      return [h(kS, {}), "Test: I am a view (viewId: ", P(() => t.viewId), ", identity: ", P(() => t.identity), ")"];
    }
  });
}
function kS() {
  const t = Ga();
  return (() => {
    var e = ES(), n = e.firstChild;
    return w(n, () => t.definition?.title), w(e, h($S, {}), null), e;
  })();
}
ou.defaultProps = new AS();
function Uh(t, e, n = !1, r = !1, i = !1, s = !1, o = void 0, l = void 0) {
  if (Ws.LoadView) {
    Ws.LoadView(t, e, n, r, i, s, o, l);
    return;
  }
  n && window.open(`/views/${e}`, void 0, "popup=true");
}
function IS(t, e = void 0, n = void 0, r = void 0) {
  if (Ws.OpenViewWindow) {
    Ws.OpenViewWindow(t, e, n, r);
    return;
  }
  alert(`Open view ${t} in window`);
}
async function lu(t, e = void 0, n) {
  if (Ws.OpenViewInDialog) {
    const r = {
      REV_RENDER: {
        VIEW: {
          "@MODE": n?.mode ?? "NORMAL"
        }
      }
    };
    return Ws.OpenViewInDialog(t, e, r);
  }
  alert(`Open view ${t} in dialog`);
}
class OS {
  notifications = [];
  icons = [];
}
class DS {
  viewGU;
  tabGU;
  identity;
  serverState = {};
  dataElements = [];
  gridElements = [];
}
var Do = /* @__PURE__ */ ((t) => (t[t.Icon = 0] = "Icon", t[t.Banner = 1] = "Banner", t[t.IconAndBanner = 2] = "IconAndBanner", t))(Do || {});
Ey("st", "st-ai-loader");
const LS = "_popover_1duid_1", NS = "_arrow_1duid_41", bc = {
  popover: LS,
  "popover-dialog": "_popover-dialog_1duid_9",
  arrow: NS
};
var PS = /* @__PURE__ */ T("<div>"), RS = /* @__PURE__ */ T('<div class="flexbox vertical">');
function $r(t) {
  return h(Ve, Xt(t, {
    get children() {
      return t.children;
    }
  }));
}
$r.Trigger = function(e) {
  return h(Ve.Trigger, Xt(e, {
    get action() {
      return e.action ?? "hover";
    }
  }));
};
$r.Content = function(e) {
  const n = Xo(), [r, i] = Wr(e, ["children"]), s = P(() => n.placement() || "bottom");
  let o, l;
  jt(() => {
    if (!n.isOpen() || !o) return;
    const u = o.closest("dialog");
    var d = new MutationObserver((f) => {
      for (const g of f)
        g.attributeName === "open" && u.open && (u.blur(), a());
    });
    d.observe(u, {
      attributes: !0
    }), Gn(() => {
      d.disconnect();
    }), u.classList.add(bc["popover-dialog"]);
  });
  function a() {
    const c = o.closest("dialog"), u = n.isOpen(), d = n.offsetX(), f = n.offsetY();
    if (c && u && d > 0 && f > 0)
      switch (n.placement()) {
        case "bottom":
        case "bottom-start":
        case "bottom-end":
        case "top":
        case "top-start":
        case "top-end":
          l.style.top = "", l.style.left = (c.getBoundingClientRect().width - l.getBoundingClientRect().width) / 2 + "px";
          break;
        default:
          l.style.top = (c.getBoundingClientRect().height - l.getBoundingClientRect().height) / 2 + "px", l.style.left = "";
          break;
      }
  }
  return h(Ve.Content, Xt(i, {
    ref(c) {
      var u = o;
      typeof u == "function" ? u(c) : o = c;
    },
    get class() {
      return bc.popover;
    },
    get "data-placement"() {
      return s();
    },
    get children() {
      return [(() => {
        var c = PS(), u = l;
        return typeof u == "function" ? Le(u, c) : l = c, R(() => D(c, bc.arrow)), c;
      })(), (() => {
        var c = RS();
        return w(c, () => r.children), c;
      })()];
    }
  }));
};
$r.defaultProps = new op();
const MS = "_notifications_g4rdt_1", qS = "_modal_g4rdt_9", BS = "_banner_g4rdt_9", US = "_icon_g4rdt_29", jS = "_notification_g4rdt_1", GS = "_icons_g4rdt_73", di = {
  notifications: MS,
  modal: qS,
  banner: BS,
  icon: US,
  notification: jS,
  icons: GS
};
var gd = /* @__PURE__ */ T("<div>"), FS = /* @__PURE__ */ T('<div class="flexbox horizontal"style=flex-wrap:wrap>'), Dp = /* @__PURE__ */ T("<img>"), VS = /* @__PURE__ */ T("<span> "), HS = /* @__PURE__ */ T("<ol>"), zS = /* @__PURE__ */ T('<div><div class="flexbox horizontal middle"><img><div><strong>'), WS = /* @__PURE__ */ T("<li>"), JS = /* @__PURE__ */ T('<div class="flexbox vertical">'), QS = /* @__PURE__ */ T('<div><div class="flexbox horizontal"><span></span></div><span>');
const [Lo, Lp] = er(new OS());
nd.Config().then(Lp);
Fg("RefreshNotificationConfig", (t) => {
  nd.Config().then(Lp);
});
class Np {
  showModal = I(!1);
  notifications = I([]);
}
class KS {
  context;
  displayType = "icons";
}
const Pp = bt(new Np()), Fa = () => Nt(Pp);
function ca(t) {
  const e = P(() => t.context || new Np());
  return h(Pp.Provider, {
    get value() {
      return e();
    },
    get children() {
      return [h(YS, {
        get displayType() {
          return t.displayType;
        }
      }), h(nx, {})];
    }
  });
}
function YS(t) {
  const e = Fa(), n = Ga();
  return n.events.showModal = () => {
    e.showModal[1](!0);
  }, (() => {
    var r = gd();
    return w(r, h(Zt, {
      get children() {
        return [h(Pe, {
          get when() {
            return t.displayType === "banner";
          },
          get children() {
            return h(ZS, {});
          }
        }), h(Pe, {
          get when() {
            return t.displayType === "icons";
          },
          get children() {
            return h(XS, {});
          }
        })];
      }
    })), R(() => D(r, di.notifications)), r;
  })();
}
ca.defaultProps = new KS();
function XS() {
  return (() => {
    var t = gd();
    return R(() => D(t, di.icons)), t;
  })();
}
function ZS() {
  const t = Fa(), e = Ga(), [n, r] = t.notifications, i = qa(() => {
    nd.FetchNotifications(e.primaryObjectGU(), e.identity()).then(r);
  }, 100), s = P(() => Lo.notifications.reduce((a, c) => (a[c.ID ?? ""] = c, a), {}));
  function o(a) {
    const c = s()[a];
    return c && [Do.Banner, Do.IconAndBanner].includes(c.displayType);
  }
  const l = P(() => n().filter((a) => o(a.notCfgGU || "")).reduce((a, c) => {
    const u = c.notCfgGU || "";
    return a[u] = a[u] ?? [], a[u].push(c), a;
  }, {}));
  return Z(() => {
    const a = e.identity(), c = e.primaryObjectGU();
    Lo.notifications.length > 0 && a && c ? i() : (i.abort(), r([]));
  }), (() => {
    var a = FS();
    return w(a, h(de, {
      get each() {
        return Object.keys(l());
      },
      children: (c) => h(ex, {
        get notCfg() {
          return s()[c];
        },
        get perNot() {
          return l()[c];
        }
      })
    })), a;
  })();
}
function ex(t) {
  const e = Fa(), n = Lo.icons.reduce((a, c) => (a[c.iconGU ?? ""] = c, a), {}), r = P(() => n[t.notCfg?.iconGU ?? ""]), i = new Vg(t.notCfg.bannerColor || "#aaa"), s = i.gsComplement(), o = i.darken(20), l = P(() => t.perNot.length > 1 ? `(${t.perNot.length})` : "");
  return h($r, {
    placement: "bottom-start",
    get children() {
      return [h($r.Trigger, {
        onClick: () => e.showModal[1](!0),
        get class() {
          return `${di.banner} flexbox horizontal middle auto`;
        },
        get style() {
          return {
            color: s.toString(),
            "background-color": i.toString(),
            "border-color": o.toString()
          };
        },
        get children() {
          return [h(B, {
            get when() {
              return r();
            },
            get children() {
              var a = Dp();
              return R((c) => {
                var u = t.notCfg.shortDescription, d = r().iconFilePath, f = di.icon;
                return u !== c.e && ye(a, "alt", c.e = u), d !== c.t && ye(a, "src", c.t = d), f !== c.a && D(a, c.a = f), c;
              }, {
                e: void 0,
                t: void 0,
                a: void 0
              }), a;
            }
          }), (() => {
            var a = VS(), c = a.firstChild;
            return w(a, () => t.notCfg.shortDescription, c), w(a, l, null), a;
          })()];
        }
      }), h($r.Content, {
        get children() {
          return h(tx, Xt(t, {
            get icon() {
              return r();
            }
          }));
        }
      })];
    }
  });
}
function tx(t) {
  return (() => {
    var e = zS(), n = e.firstChild, r = n.firstChild, i = r.nextSibling, s = i.firstChild;
    return w(e, h(Zt, {
      get children() {
        return [h(Pe, {
          get when() {
            return t.perNot.length === 1;
          },
          get children() {
            var o = gd();
            return R(() => o.innerHTML = t.perNot[0].commentDetail || t.perNot[0].comment), o;
          }
        }), h(Pe, {
          get when() {
            return t.perNot.length > 1;
          },
          get children() {
            var o = HS();
            return w(o, h(de, {
              get each() {
                return t.perNot;
              },
              children: (l) => (() => {
                var a = WS();
                return R(() => a.innerHTML = l.commentDetail || l.comment), a;
              })()
            })), o;
          }
        })];
      }
    }), null), R((o) => {
      var l = `${di.notification} flexbox vertical`, a = t.notCfg.shortDescription, c = t.icon.iconFilePath, u = di.icon, d = t.notCfg.description || t.notCfg.shortDescription;
      return l !== o.e && D(e, o.e = l), a !== o.t && ye(r, "alt", o.t = a), c !== o.a && ye(r, "src", o.a = c), u !== o.o && D(r, o.o = u), d !== o.i && (s.innerHTML = o.i = d), o;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0
    }), e;
  })();
}
function nx() {
  const t = Fa(), [e, n] = t.showModal, [r, i] = t.notifications;
  return h(Gt, {
    get class() {
      return di.modal;
    },
    show: [e, n],
    title: "Notifications",
    get children() {
      var s = JS();
      return w(s, h(de, {
        get each() {
          return r();
        },
        children: (o) => h(rx, {
          perNot: o
        })
      })), s;
    }
  });
}
function rx(t) {
  const e = P(() => Lo.notifications.reduce((a, c) => (a[c.ID ?? ""] = c, a), {})), n = P(() => e()[t.perNot.notCfgGU ?? ""]), r = Lo.icons.reduce((a, c) => (a[c.iconGU ?? ""] = c, a), {}), i = P(() => r[n()?.iconGU ?? ""]);
  P(() => n()?.displayType == Do.Banner || n()?.displayType == Do.IconAndBanner);
  const s = new Vg(n()?.bannerColor || "#ccc"), o = s.gsComplement(), l = s.darken(20);
  return (() => {
    var a = QS(), c = a.firstChild, u = c.firstChild, d = c.nextSibling;
    return w(c, h(B, {
      get when() {
        return i();
      },
      get children() {
        var f = Dp();
        return R((g) => {
          var p = n()?.shortDescription, S = i().iconFilePath, _ = di.icon;
          return p !== g.e && ye(f, "alt", g.e = p), S !== g.t && ye(f, "src", g.t = S), _ !== g.a && D(f, g.a = _), g;
        }, {
          e: void 0,
          t: void 0,
          a: void 0
        }), f;
      }
    }), u), R((f) => {
      var g = `${di.banner} flexbox vertical auto`, p = n()?.bannerColor ? {
        color: o.toString(),
        "background-color": s.toString(),
        "border-color": l.toString()
      } : {}, S = n()?.description || n()?.shortDescription, _ = t.perNot.commentDetail || t.perNot.comment;
      return g !== f.e && D(a, f.e = g), f.t = Yn(a, p, f.t), S !== f.a && (u.innerHTML = f.a = S), _ !== f.o && (d.innerHTML = f.o = _), f;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0
    }), a;
  })();
}
function au() {
  return h(ca, {
    displayType: "banner"
  });
}
au.defaultProps = {};
const ix = "_overlay_3xn51_47", sx = "_frame_3xn51_69", ox = "_handle_3xn51_123", Br = {
  "st-camera-input": "_st-camera-input_3xn51_1",
  "preview-area": "_preview-area_3xn51_17",
  overlay: ix,
  frame: sx,
  "handle-container": "_handle-container_3xn51_123",
  handle: ox
};
var lx = /* @__PURE__ */ T("<video width=500 height=500>Video stream not available."), ax = /* @__PURE__ */ T("<div><div></div><div><div></div><div></div><div></div><div>"), cx = /* @__PURE__ */ T('<img src=Images/ST_REVELATION/NoPhoto.png width=500 height=500 alt="A preview of the image taken by the user.">'), ux = /* @__PURE__ */ T("<div style=position:relative;>"), jh = /* @__PURE__ */ T("<div>"), dx = /* @__PURE__ */ T("<div style=display:flex;flex-direction:column;align-items:end;gap:1em;>");
class hx {
  value;
  aspectRatio;
}
function ua(t) {
  let e, n, r;
  const i = P(() => t.aspectRatio ?? 1.3333333333333333), [s, o] = t.value ?? I(""), [l, a] = I([]), [c, u] = I(""), [d, f] = I({
    width: 0,
    height: 0,
    left: 0,
    top: 0
  }), [g, p] = I(!1), [S, _] = I(!1), [m, y] = I({
    width: 0,
    height: 0,
    left: 0,
    top: 0
  }), [v, x] = I(void 0), [C, E] = I(void 0), k = P(() => l().find((H) => H.deviceId === c()));
  Z(() => {
    k() && (Y(), M());
  });
  const L = () => {
    if (!navigator.mediaDevices) {
      location.protocol === "http:" ? x("The camera input is only available on secure connections (https).") : x("Your browser does not support the camera input feature.");
      return;
    }
    return navigator.mediaDevices;
  }, M = async () => {
    r = await L()?.getUserMedia({
      video: {
        deviceId: c()
      }
    }), r && (e.srcObject = r, e.play());
  }, G = async () => {
    const ee = (await L()?.enumerateDevices() ?? []).filter((se) => se.kind === "videoinput");
    a(ee), ee.length > 0 && !c() && u(ee[0].deviceId);
  }, Y = () => {
    r && r.getTracks().forEach((H) => H.stop());
  }, ie = () => {
    Y(), o(""), M();
  }, X = () => {
    const H = document.createElement("canvas");
    H.width = e.videoWidth, H.height = e.videoHeight;
    const ee = H.getContext("2d");
    if (ee) {
      ee.drawImage(e, 0, 0, e.videoWidth, e.videoHeight);
      const se = H.toDataURL("image/png");
      o(se), n.src = se, n.onload = () => {
        f(V());
        const K = d().height, re = K * i();
        y({
          width: re,
          height: K,
          left: (d().width - re) / 2,
          top: 0
        });
      };
    }
    Y();
  }, V = () => {
    const H = n.clientWidth, ee = n.clientHeight, se = n.naturalWidth / n.naturalHeight, K = H / ee, re = se > K ? H : ee * se, J = se > K ? H / se : ee;
    return {
      width: re,
      height: J,
      left: (H - re) / 2,
      top: (ee - J) / 2
    };
  };
  jt(() => {
    G();
  }), Gn(() => {
    Y();
  }), Z(() => {
    g() || S() ? (document.removeEventListener("mouseup", U), document.addEventListener("mouseup", U)) : document.removeEventListener("mouseup", U);
  }), Z(() => {
    const H = m();
    if (H.width === 0 || H.height === 0)
      return;
    const ee = H.left / d().width * n.naturalWidth, se = H.top / d().height * n.naturalHeight, K = H.width / d().width * n.naturalWidth, re = H.height / d().height * n.naturalHeight, J = document.createElement("canvas");
    J.width = K, J.height = re;
    const he = J.getContext("2d");
    if (he) {
      he.clearRect(0, 0, J.width, J.height), he.drawImage(n, ee, se, K, re, 0, 0, J.width, J.height);
      const be = J.toDataURL("image/png");
      o(be);
    }
  });
  const U = () => {
    p(!1), _(!1);
  }, W = () => {
    p(!0), document.addEventListener("mouseup", U), document.addEventListener("mousemove", ue);
  }, ce = (H) => {
    _(!0), E(H), document.addEventListener("mouseup", U), document.addEventListener("mousemove", xe);
  }, ue = (H) => {
    if (g()) {
      const ee = m(), se = Math.max(0, Math.min(d().width - ee.width, ee.left + H.movementX)), K = Math.max(0, Math.min(d().height - ee.height, ee.top + H.movementY));
      y({
        ...ee,
        left: se,
        top: K
      });
    }
  }, xe = (H) => {
    const ee = C();
    if (S() && ee !== void 0) {
      const se = H.movementX, K = H.movementY;
      let re = {
        ...m()
      };
      switch (ee) {
        case 0:
        case 2:
          re.top += ee === 0 ? K : 0, re.height += ee === 0 ? -K : K, re.top < 0 && (re.height -= re.top, re.top = 0), re.top + re.height > d().height && (re.top = d().height - re.height, re.top < 0 && (re.height += re.top, re.top = 0));
          const J = re.height * i();
          re.left += (re.width - J) / 2, re.width = J;
          break;
        case 1:
        case 3:
          re.left += ee === 3 ? se : 0, re.width += ee === 1 ? se : -se, re.left < 0 && (re.width -= re.left, re.left = 0), re.left + re.width > d().width && (re.left = d().width - re.width, re.left < 0 && (re.width += re.left, re.left = 0));
          const he = re.width / i();
          re.top += (re.height - he) / 2, re.height = he;
          break;
      }
      y(re);
    }
  };
  return (() => {
    var H = jh();
    return w(H, h(B, {
      get when() {
        return !v();
      },
      get fallback() {
        return (() => {
          var ee = jh();
          return w(ee, v), R(() => D(ee, Br["error-message"])), ee;
        })();
      },
      get children() {
        return [h(Ee, {
          value: [c, u],
          get children() {
            return h(de, {
              get each() {
                return l();
              },
              children: (ee) => h(Ee.Option, {
                get value() {
                  return ee.deviceId;
                },
                get children() {
                  return ee.label;
                }
              })
            });
          }
        }), (() => {
          var ee = ux();
          return w(ee, h(B, {
            get when() {
              return !s();
            },
            get children() {
              var se = lx(), K = e;
              return typeof K == "function" ? Le(K, se) : e = se, se;
            }
          }), null), w(ee, h(B, {
            get when() {
              return s();
            },
            get children() {
              return [(() => {
                var se = ax(), K = se.firstChild, re = K.nextSibling, J = re.firstChild, he = J.nextSibling, be = he.nextSibling, me = be.nextSibling;
                return K.$$mousedown = () => W(), J.$$mousedown = () => ce(
                  0
                  /* Top */
                ), J.style.setProperty("top", "0"), he.$$mousedown = () => ce(
                  1
                  /* Right */
                ), be.$$mousedown = () => ce(
                  2
                  /* Bottom */
                ), me.$$mousedown = () => ce(
                  3
                  /* Left */
                ), me.style.setProperty("left", "0"), R((oe) => {
                  var Qe = Br.overlay, Ae = `${d().width}px`, Ye = `${d().height}px`, De = `${d().top}px`, Oe = `${d().left}px`, nt = Br.frame, We = `${m().width}px`, gt = `${m().height}px`, ht = `${m().top}px`, it = `${m().left}px`, ot = Br["handle-container"], wt = `${m().width}px`, pt = `${m().height}px`, lt = `${m().top}px`, Ge = `${m().left}px`, yt = `${Br.handle} fa fa-arrows-v`, at = `${m().width / 2}px`, te = `${Br.handle} fa fa-arrows-h`, pe = `${m().height / 2}px`, tt = `${m().width}px`, Be = `${Br.handle} fa fa-arrows-v`, It = `${m().height}px`, nn = `${m().width / 2}px`, Lr = `${Br.handle} fa fa-arrows-h`, Ln = `${m().height / 2}px`;
                  return Qe !== oe.e && D(se, oe.e = Qe), Ae !== oe.t && ((oe.t = Ae) != null ? se.style.setProperty("width", Ae) : se.style.removeProperty("width")), Ye !== oe.a && ((oe.a = Ye) != null ? se.style.setProperty("height", Ye) : se.style.removeProperty("height")), De !== oe.o && ((oe.o = De) != null ? se.style.setProperty("top", De) : se.style.removeProperty("top")), Oe !== oe.i && ((oe.i = Oe) != null ? se.style.setProperty("left", Oe) : se.style.removeProperty("left")), nt !== oe.n && D(K, oe.n = nt), We !== oe.s && ((oe.s = We) != null ? K.style.setProperty("width", We) : K.style.removeProperty("width")), gt !== oe.h && ((oe.h = gt) != null ? K.style.setProperty("height", gt) : K.style.removeProperty("height")), ht !== oe.r && ((oe.r = ht) != null ? K.style.setProperty("top", ht) : K.style.removeProperty("top")), it !== oe.d && ((oe.d = it) != null ? K.style.setProperty("left", it) : K.style.removeProperty("left")), ot !== oe.l && D(re, oe.l = ot), wt !== oe.u && ((oe.u = wt) != null ? re.style.setProperty("width", wt) : re.style.removeProperty("width")), pt !== oe.c && ((oe.c = pt) != null ? re.style.setProperty("height", pt) : re.style.removeProperty("height")), lt !== oe.w && ((oe.w = lt) != null ? re.style.setProperty("top", lt) : re.style.removeProperty("top")), Ge !== oe.m && ((oe.m = Ge) != null ? re.style.setProperty("left", Ge) : re.style.removeProperty("left")), yt !== oe.f && D(J, oe.f = yt), at !== oe.y && ((oe.y = at) != null ? J.style.setProperty("left", at) : J.style.removeProperty("left")), te !== oe.g && D(he, oe.g = te), pe !== oe.p && ((oe.p = pe) != null ? he.style.setProperty("top", pe) : he.style.removeProperty("top")), tt !== oe.b && ((oe.b = tt) != null ? he.style.setProperty("left", tt) : he.style.removeProperty("left")), Be !== oe.T && D(be, oe.T = Be), It !== oe.A && ((oe.A = It) != null ? be.style.setProperty("top", It) : be.style.removeProperty("top")), nn !== oe.O && ((oe.O = nn) != null ? be.style.setProperty("left", nn) : be.style.removeProperty("left")), Lr !== oe.I && D(me, oe.I = Lr), Ln !== oe.S && ((oe.S = Ln) != null ? me.style.setProperty("top", Ln) : me.style.removeProperty("top")), oe;
                }, {
                  e: void 0,
                  t: void 0,
                  a: void 0,
                  o: void 0,
                  i: void 0,
                  n: void 0,
                  s: void 0,
                  h: void 0,
                  r: void 0,
                  d: void 0,
                  l: void 0,
                  u: void 0,
                  c: void 0,
                  w: void 0,
                  m: void 0,
                  f: void 0,
                  y: void 0,
                  g: void 0,
                  p: void 0,
                  b: void 0,
                  T: void 0,
                  A: void 0,
                  O: void 0,
                  I: void 0,
                  S: void 0
                }), se;
              })(), (() => {
                var se = cx(), K = n;
                return typeof K == "function" ? Le(K, se) : n = se, se;
              })()];
            }
          }), null), R(() => D(ee, Br["preview-area"])), ee;
        })(), h(B, {
          get when() {
            return s();
          },
          get children() {
            return h(ne, {
              icon: "fa fa-undo",
              onClick: () => ie(),
              children: "Retake"
            });
          }
        }), h(B, {
          get when() {
            return !s();
          },
          get children() {
            return h(ne, {
              icon: "fa fa-camera",
              onClick: () => X(),
              children: "Take photo"
            });
          }
        })];
      }
    })), R(() => D(H, Br["st-camera-input"])), H;
  })();
}
ua.defaultProps = new hx();
const I5 = async (t) => await ip((n, r) => {
  const [i, s] = I("");
  return (() => {
    var o = dx();
    return w(o, h(ua, Xt({
      value: [i, s]
    }, t)), null), w(o, h(ne, {
      get enabled() {
        return !!i();
      },
      type: "primary",
      onClick: () => n(i()),
      children: "Save"
    }), null), o;
  })();
}, {
  title: "Take a photo"
});
Xe(["mousedown"]);
const fx = "_StCard_w0xe9_23", gx = "_pulseYellow_w0xe9_1", px = "_Filterable_w0xe9_91", mx = "_FilterActiveCard_w0xe9_99", vx = "_CardLabel_w0xe9_109", yx = "_CardValue_w0xe9_119", bx = "_CardIcon_w0xe9_133", wx = "_FilterIcon_w0xe9_141", _x = "_FilterActiveIcon_w0xe9_153", Sx = "_FilterInactiveIcon_w0xe9_163", ei = {
  StCard: fx,
  pulseYellow: gx,
  Filterable: px,
  FilterActiveCard: mx,
  CardLabel: vx,
  CardValue: yx,
  CardIcon: bx,
  FilterIcon: wx,
  FilterActiveIcon: _x,
  FilterInactiveIcon: Sx
}, xx = "_icon_1bzck_1", Gh = {
  icon: xx
};
var Cx = /* @__PURE__ */ T("<span role=presentation>"), $x = /* @__PURE__ */ T("<img>");
class Ex {
  src = "";
  size = 16;
  tooltip;
  spin;
}
function vr(t) {
  return h(Zt, {
    get children() {
      return [h(Pe, {
        get when() {
          return t.src.startsWith("fa");
        },
        get children() {
          var e = Cx();
          return R(() => D(e, `${Gh.icon} ${t.src} ${t.spin ? "fa-spin" : ""}`)), e;
        }
      }), h(Pe, {
        get when() {
          return t.src.includes(".svg");
        },
        get children() {
          var e = $x();
          return R((n) => {
            var r = `${t.size ?? 16}px`, i = Gh.icon, s = ed(t.src);
            return r !== n.e && ((n.e = r) != null ? e.style.setProperty("width", r) : e.style.removeProperty("width")), i !== n.t && D(e, n.t = i), s !== n.a && ye(e, "src", n.a = s), n;
          }, {
            e: void 0,
            t: void 0,
            a: void 0
          }), e;
        }
      }), h(Pe, {
        get when() {
          return !t.src;
        },
        children: "Â "
      })];
    }
  });
}
vr.defaultProps = new Ex();
const Tx = "_spinner_1m0ad_1", Ax = {
  spinner: Tx
};
var kx = /* @__PURE__ */ T("<div>");
class Ix {
  size = "medium";
}
function da(t) {
  return h(Ox, t);
}
da.defaultProps = new Ix();
function Ox(t) {
  return (() => {
    var e = kx();
    return w(e, h(vr, {
      src: "fa-solid fa-spinner",
      spin: !0
    })), R((n) => {
      var r = Ax.spinner, i = t.size;
      return r !== n.e && D(e, n.e = r), i !== n.t && ye(e, "spinner-size", n.t = i), n;
    }, {
      e: void 0,
      t: void 0
    }), e;
  })();
}
var xl = /* @__PURE__ */ T("<span>"), Dx = /* @__PURE__ */ T("<div>"), Lx = /* @__PURE__ */ T("<div><div role=button><div></div><div>");
class Nx {
  label;
  value = "";
  size = "medium";
  style = "";
  icon = "";
  iconColor = "";
  filterActive;
  showLoadingSpinner = !1;
  dataLoaded = !1;
}
function cu(t) {
  return h(Px, t);
}
cu.defaultProps = new Nx();
function Px(t) {
  const [e, n] = t.filterActive ?? I(!1), r = (s) => {
    s.stopPropagation(), n(!e());
  }, i = P(() => {
    var s = t.showLoadingSpinner, o = t.dataLoaded;
    return s !== !0 || o === !0;
  });
  return (() => {
    var s = Lx(), o = s.firstChild, l = o.firstChild, a = l.nextSibling;
    return o.$$click = r, w(l, () => t.label), w(a, h(Zt, {
      get fallback() {
        return h(da, {
          size: "small"
        });
      },
      get children() {
        return h(Pe, {
          get when() {
            return i();
          },
          get children() {
            return [h(B, {
              get when() {
                return t.icon;
              },
              get children() {
                var c = xl();
                return w(c, h(vr, {
                  get src() {
                    return t.icon ?? "";
                  }
                })), R((u) => {
                  var d = ei.CardIcon, f = t.iconColor ?? "#000";
                  return d !== u.e && D(c, u.e = d), f !== u.t && ((u.t = f) != null ? c.style.setProperty("color", f) : c.style.removeProperty("color")), u;
                }, {
                  e: void 0,
                  t: void 0
                }), c;
              }
            }), (() => {
              var c = xl();
              return w(c, () => t.value), c;
            })()];
          }
        });
      }
    })), w(o, h(B, {
      get when() {
        return t.filterActive;
      },
      get children() {
        var c = Dx();
        return w(c, h(Zt, {
          get children() {
            return [h(Pe, {
              get when() {
                return e();
              },
              get children() {
                var u = xl();
                return w(u, h(vr, {
                  src: "fa-solid fa-filter"
                })), R(() => D(u, ei.FilterActiveIcon)), u;
              }
            }), h(Pe, {
              get when() {
                return e() === !1;
              },
              get children() {
                var u = xl();
                return w(u, h(vr, {
                  src: "fa-regular fa-filter"
                })), R(() => D(u, ei.FilterInactiveIcon)), u;
              }
            })];
          }
        })), R(() => D(c, ei.FilterIcon)), c;
      }
    }), null), R((c) => {
      var u = ei.StCard, d = {
        [ei.Filterable]: !!t.filterActive,
        [ei.FilterActiveCard]: e()
      }, f = t.size, g = t.style, p = ei.CardLabel, S = ei.CardValue;
      return u !== c.e && D(s, c.e = u), c.t = ro(s, d, c.t), f !== c.a && ye(s, "card-size", c.a = f), g !== c.o && ye(s, "card-style", c.o = g), p !== c.i && D(l, c.i = p), S !== c.n && D(a, c.n = S), c;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0,
      n: void 0
    }), s;
  })();
}
Xe(["click"]);
const jn = () => /* @__PURE__ */ new Map(), uu = (t) => {
  const e = jn();
  return t.forEach((n, r) => {
    e.set(r, n);
  }), e;
}, mi = (t, e, n) => {
  let r = t.get(e);
  return r === void 0 && t.set(e, r = n()), r;
}, Rx = (t, e) => {
  const n = [];
  for (const [r, i] of t)
    n.push(e(i, r));
  return n;
}, Mx = (t, e) => {
  for (const [n, r] of t)
    if (e(r, n))
      return !0;
  return !1;
}, es = () => /* @__PURE__ */ new Set(), wc = (t) => t[t.length - 1], qx = (t, e) => {
  for (let n = 0; n < e.length; n++)
    t.push(e[n]);
}, hi = Array.from, Bx = Array.isArray;
class Rp {
  constructor() {
    this._observers = jn();
  }
  /**
   * @template {keyof EVENTS & string} NAME
   * @param {NAME} name
   * @param {EVENTS[NAME]} f
   */
  on(e, n) {
    return mi(
      this._observers,
      /** @type {string} */
      e,
      es
    ).add(n), n;
  }
  /**
   * @template {keyof EVENTS & string} NAME
   * @param {NAME} name
   * @param {EVENTS[NAME]} f
   */
  once(e, n) {
    const r = (...i) => {
      this.off(
        e,
        /** @type {any} */
        r
      ), n(...i);
    };
    this.on(
      e,
      /** @type {any} */
      r
    );
  }
  /**
   * @template {keyof EVENTS & string} NAME
   * @param {NAME} name
   * @param {EVENTS[NAME]} f
   */
  off(e, n) {
    const r = this._observers.get(e);
    r !== void 0 && (r.delete(n), r.size === 0 && this._observers.delete(e));
  }
  /**
   * Emit a named event. All registered event listeners that listen to the
   * specified name will receive the event.
   *
   * @todo This should catch exceptions
   *
   * @template {keyof EVENTS & string} NAME
   * @param {NAME} name The event name.
   * @param {Parameters<EVENTS[NAME]>} args The arguments that are applied to the event listener.
   */
  emit(e, n) {
    return hi((this._observers.get(e) || jn()).values()).forEach((r) => r(...n));
  }
  destroy() {
    this._observers = jn();
  }
}
class Ux {
  constructor() {
    this._observers = jn();
  }
  /**
   * @param {N} name
   * @param {function} f
   */
  on(e, n) {
    mi(this._observers, e, es).add(n);
  }
  /**
   * @param {N} name
   * @param {function} f
   */
  once(e, n) {
    const r = (...i) => {
      this.off(e, r), n(...i);
    };
    this.on(e, r);
  }
  /**
   * @param {N} name
   * @param {function} f
   */
  off(e, n) {
    const r = this._observers.get(e);
    r !== void 0 && (r.delete(n), r.size === 0 && this._observers.delete(e));
  }
  /**
   * Emit a named event. All registered event listeners that listen to the
   * specified name will receive the event.
   *
   * @todo This should catch exceptions
   *
   * @param {N} name The event name.
   * @param {Array<any>} args The arguments that are applied to the event listener.
   */
  emit(e, n) {
    return hi((this._observers.get(e) || jn()).values()).forEach((r) => r(...n));
  }
  destroy() {
    this._observers = jn();
  }
}
const fi = Math.floor, Bl = Math.abs, Mp = (t, e) => t < e ? t : e, ds = (t, e) => t > e ? t : e, qp = (t) => t !== 0 ? t < 0 : 1 / t < 0, Fh = 1, Vh = 2, _c = 4, Sc = 8, No = 32, ci = 64, Xn = 128, Va = 31, du = 63, Ki = 127, jx = 2147483647, Bp = Number.MAX_SAFE_INTEGER, Gx = Number.isInteger || ((t) => typeof t == "number" && isFinite(t) && fi(t) === t), Fx = (t) => t.toLowerCase(), Vx = /^\s*/g, Hx = (t) => t.replace(Vx, ""), zx = /([A-Z])/g, Hh = (t, e) => Hx(t.replace(zx, (n) => `${e}${Fx(n)}`)), Wx = (t) => {
  const e = unescape(encodeURIComponent(t)), n = e.length, r = new Uint8Array(n);
  for (let i = 0; i < n; i++)
    r[i] = /** @type {number} */
    e.codePointAt(i);
  return r;
}, Po = (
  /** @type {TextEncoder} */
  typeof TextEncoder < "u" ? new TextEncoder() : null
), Jx = (t) => Po.encode(t), Qx = Po ? Jx : Wx;
let xo = typeof TextDecoder > "u" ? null : new TextDecoder("utf-8", { fatal: !0, ignoreBOM: !0 });
xo && xo.decode(new Uint8Array()).length === 1 && (xo = null);
class el {
  constructor() {
    this.cpos = 0, this.cbuf = new Uint8Array(100), this.bufs = [];
  }
}
const ts = () => new el(), Up = (t) => {
  let e = t.cpos;
  for (let n = 0; n < t.bufs.length; n++)
    e += t.bufs[n].length;
  return e;
}, Qn = (t) => {
  const e = new Uint8Array(Up(t));
  let n = 0;
  for (let r = 0; r < t.bufs.length; r++) {
    const i = t.bufs[r];
    e.set(i, n), n += i.length;
  }
  return e.set(new Uint8Array(t.cbuf.buffer, 0, t.cpos), n), e;
}, Kx = (t, e) => {
  const n = t.cbuf.length;
  n - t.cpos < e && (t.bufs.push(new Uint8Array(t.cbuf.buffer, 0, t.cpos)), t.cbuf = new Uint8Array(ds(n, e) * 2), t.cpos = 0);
}, an = (t, e) => {
  const n = t.cbuf.length;
  t.cpos === n && (t.bufs.push(t.cbuf), t.cbuf = new Uint8Array(n * 2), t.cpos = 0), t.cbuf[t.cpos++] = e;
}, hu = an, Ne = (t, e) => {
  for (; e > Ki; )
    an(t, Xn | Ki & e), e = fi(e / 128);
  an(t, Ki & e);
}, pd = (t, e) => {
  const n = qp(e);
  for (n && (e = -e), an(t, (e > du ? Xn : 0) | (n ? ci : 0) | du & e), e = fi(e / 64); e > 0; )
    an(t, (e > Ki ? Xn : 0) | Ki & e), e = fi(e / 128);
}, fu = new Uint8Array(3e4), Yx = fu.length / 3, Xx = (t, e) => {
  if (e.length < Yx) {
    const n = Po.encodeInto(e, fu).written || 0;
    Ne(t, n);
    for (let r = 0; r < n; r++)
      an(t, fu[r]);
  } else
    qt(t, Qx(e));
}, Zx = (t, e) => {
  const n = unescape(encodeURIComponent(e)), r = n.length;
  Ne(t, r);
  for (let i = 0; i < r; i++)
    an(
      t,
      /** @type {number} */
      n.codePointAt(i)
    );
}, Yi = Po && /** @type {any} */
Po.encodeInto ? Xx : Zx, Ha = (t, e) => {
  const n = t.cbuf.length, r = t.cpos, i = Mp(n - r, e.length), s = e.length - i;
  t.cbuf.set(e.subarray(0, i), r), t.cpos += i, s > 0 && (t.bufs.push(t.cbuf), t.cbuf = new Uint8Array(ds(n * 2, s)), t.cbuf.set(e.subarray(i)), t.cpos = s);
}, qt = (t, e) => {
  Ne(t, e.byteLength), Ha(t, e);
}, md = (t, e) => {
  Kx(t, e);
  const n = new DataView(t.cbuf.buffer, t.cpos, e);
  return t.cpos += e, n;
}, eC = (t, e) => md(t, 4).setFloat32(0, e, !1), tC = (t, e) => md(t, 8).setFloat64(0, e, !1), nC = (t, e) => (
  /** @type {any} */
  md(t, 8).setBigInt64(0, e, !1)
), zh = new DataView(new ArrayBuffer(4)), rC = (t) => (zh.setFloat32(0, t), zh.getFloat32(0) === t), Ro = (t, e) => {
  switch (typeof e) {
    case "string":
      an(t, 119), Yi(t, e);
      break;
    case "number":
      Gx(e) && Bl(e) <= jx ? (an(t, 125), pd(t, e)) : rC(e) ? (an(t, 124), eC(t, e)) : (an(t, 123), tC(t, e));
      break;
    case "bigint":
      an(t, 122), nC(t, e);
      break;
    case "object":
      if (e === null)
        an(t, 126);
      else if (Bx(e)) {
        an(t, 117), Ne(t, e.length);
        for (let n = 0; n < e.length; n++)
          Ro(t, e[n]);
      } else if (e instanceof Uint8Array)
        an(t, 116), qt(t, e);
      else {
        an(t, 118);
        const n = Object.keys(e);
        Ne(t, n.length);
        for (let r = 0; r < n.length; r++) {
          const i = n[r];
          Yi(t, i), Ro(t, e[i]);
        }
      }
      break;
    case "boolean":
      an(t, e ? 120 : 121);
      break;
    default:
      an(t, 127);
  }
};
class Wh extends el {
  /**
   * @param {function(Encoder, T):void} writer
   */
  constructor(e) {
    super(), this.w = e, this.s = null, this.count = 0;
  }
  /**
   * @param {T} v
   */
  write(e) {
    this.s === e ? this.count++ : (this.count > 0 && Ne(this, this.count - 1), this.count = 1, this.w(this, e), this.s = e);
  }
}
const Jh = (t) => {
  t.count > 0 && (pd(t.encoder, t.count === 1 ? t.s : -t.s), t.count > 1 && Ne(t.encoder, t.count - 2));
};
class Ul {
  constructor() {
    this.encoder = new el(), this.s = 0, this.count = 0;
  }
  /**
   * @param {number} v
   */
  write(e) {
    this.s === e ? this.count++ : (Jh(this), this.count = 1, this.s = e);
  }
  /**
   * Flush the encoded state and transform this to a Uint8Array.
   *
   * Note that this should only be called once.
   */
  toUint8Array() {
    return Jh(this), Qn(this.encoder);
  }
}
const Qh = (t) => {
  if (t.count > 0) {
    const e = t.diff * 2 + (t.count === 1 ? 0 : 1);
    pd(t.encoder, e), t.count > 1 && Ne(t.encoder, t.count - 2);
  }
};
class xc {
  constructor() {
    this.encoder = new el(), this.s = 0, this.count = 0, this.diff = 0;
  }
  /**
   * @param {number} v
   */
  write(e) {
    this.diff === e - this.s ? (this.s = e, this.count++) : (Qh(this), this.count = 1, this.diff = e - this.s, this.s = e);
  }
  /**
   * Flush the encoded state and transform this to a Uint8Array.
   *
   * Note that this should only be called once.
   */
  toUint8Array() {
    return Qh(this), Qn(this.encoder);
  }
}
class iC {
  constructor() {
    this.sarr = [], this.s = "", this.lensE = new Ul();
  }
  /**
   * @param {string} string
   */
  write(e) {
    this.s += e, this.s.length > 19 && (this.sarr.push(this.s), this.s = ""), this.lensE.write(e.length);
  }
  toUint8Array() {
    const e = new el();
    return this.sarr.push(this.s), this.s = "", Yi(e, this.sarr.join("")), Ha(e, this.lensE.toUint8Array()), Qn(e);
  }
}
const Bi = (t) => new Error(t), Gr = () => {
  throw Bi("Method unimplemented");
}, Ar = () => {
  throw Bi("Unexpected case");
}, jp = Bi("Unexpected end of array"), Gp = Bi("Integer out of Range");
class za {
  /**
   * @param {Uint8Array} uint8Array Binary data to decode
   */
  constructor(e) {
    this.arr = e, this.pos = 0;
  }
}
const Gi = (t) => new za(t), sC = (t) => t.pos !== t.arr.length, oC = (t, e) => {
  const n = new Uint8Array(t.arr.buffer, t.pos + t.arr.byteOffset, e);
  return t.pos += e, n;
}, _n = (t) => oC(t, Me(t)), Js = (t) => t.arr[t.pos++], Me = (t) => {
  let e = 0, n = 1;
  const r = t.arr.length;
  for (; t.pos < r; ) {
    const i = t.arr[t.pos++];
    if (e = e + (i & Ki) * n, n *= 128, i < Xn)
      return e;
    if (e > Bp)
      throw Gp;
  }
  throw jp;
}, vd = (t) => {
  let e = t.arr[t.pos++], n = e & du, r = 64;
  const i = (e & ci) > 0 ? -1 : 1;
  if (!(e & Xn))
    return i * n;
  const s = t.arr.length;
  for (; t.pos < s; ) {
    if (e = t.arr[t.pos++], n = n + (e & Ki) * r, r *= 128, e < Xn)
      return i * n;
    if (n > Bp)
      throw Gp;
  }
  throw jp;
}, lC = (t) => {
  let e = Me(t);
  if (e === 0)
    return "";
  {
    let n = String.fromCodePoint(Js(t));
    if (--e < 100)
      for (; e--; )
        n += String.fromCodePoint(Js(t));
    else
      for (; e > 0; ) {
        const r = e < 1e4 ? e : 1e4, i = t.arr.subarray(t.pos, t.pos + r);
        t.pos += r, n += String.fromCodePoint.apply(
          null,
          /** @type {any} */
          i
        ), e -= r;
      }
    return decodeURIComponent(escape(n));
  }
}, aC = (t) => (
  /** @type any */
  xo.decode(_n(t))
), Pi = xo ? aC : lC, yd = (t, e) => {
  const n = new DataView(t.arr.buffer, t.arr.byteOffset + t.pos, e);
  return t.pos += e, n;
}, cC = (t) => yd(t, 4).getFloat32(0, !1), uC = (t) => yd(t, 8).getFloat64(0, !1), dC = (t) => (
  /** @type {any} */
  yd(t, 8).getBigInt64(0, !1)
), hC = [
  (t) => {
  },
  // CASE 127: undefined
  (t) => null,
  // CASE 126: null
  vd,
  // CASE 125: integer
  cC,
  // CASE 124: float32
  uC,
  // CASE 123: float64
  dC,
  // CASE 122: bigint
  (t) => !1,
  // CASE 121: boolean (false)
  (t) => !0,
  // CASE 120: boolean (true)
  Pi,
  // CASE 119: string
  (t) => {
    const e = Me(t), n = {};
    for (let r = 0; r < e; r++) {
      const i = Pi(t);
      n[i] = Mo(t);
    }
    return n;
  },
  (t) => {
    const e = Me(t), n = [];
    for (let r = 0; r < e; r++)
      n.push(Mo(t));
    return n;
  },
  _n
  // CASE 116: Uint8Array
], Mo = (t) => hC[127 - Js(t)](t);
class Kh extends za {
  /**
   * @param {Uint8Array} uint8Array
   * @param {function(Decoder):T} reader
   */
  constructor(e, n) {
    super(e), this.reader = n, this.s = null, this.count = 0;
  }
  read() {
    return this.count === 0 && (this.s = this.reader(this), sC(this) ? this.count = Me(this) + 1 : this.count = -1), this.count--, /** @type {T} */
    this.s;
  }
}
class jl extends za {
  /**
   * @param {Uint8Array} uint8Array
   */
  constructor(e) {
    super(e), this.s = 0, this.count = 0;
  }
  read() {
    if (this.count === 0) {
      this.s = vd(this);
      const e = qp(this.s);
      this.count = 1, e && (this.s = -this.s, this.count = Me(this) + 2);
    }
    return this.count--, /** @type {number} */
    this.s;
  }
}
class Cc extends za {
  /**
   * @param {Uint8Array} uint8Array
   */
  constructor(e) {
    super(e), this.s = 0, this.count = 0, this.diff = 0;
  }
  /**
   * @return {number}
   */
  read() {
    if (this.count === 0) {
      const e = vd(this), n = e & 1;
      this.diff = fi(e / 2), this.count = 1, n && (this.count = Me(this) + 2);
    }
    return this.s += this.diff, this.count--, this.s;
  }
}
class fC {
  /**
   * @param {Uint8Array} uint8Array
   */
  constructor(e) {
    this.decoder = new jl(e), this.str = Pi(this.decoder), this.spos = 0;
  }
  /**
   * @return {string}
   */
  read() {
    const e = this.spos + this.decoder.read(), n = this.str.slice(this.spos, e);
    return this.spos = e, n;
  }
}
const gC = crypto.getRandomValues.bind(crypto), Fp = () => gC(new Uint32Array(1))[0], pC = "10000000-1000-4000-8000" + -1e11, mC = () => pC.replace(
  /[018]/g,
  /** @param {number} c */
  (t) => (t ^ Fp() & 15 >> t / 4).toString(16)
), ha = Date.now, Yh = (t) => (
  /** @type {Promise<T>} */
  new Promise(t)
);
Promise.all.bind(Promise);
const Xh = (t) => t === void 0 ? null : t;
class vC {
  constructor() {
    this.map = /* @__PURE__ */ new Map();
  }
  /**
   * @param {string} key
   * @param {any} newValue
   */
  setItem(e, n) {
    this.map.set(e, n);
  }
  /**
   * @param {string} key
   */
  getItem(e) {
    return this.map.get(e);
  }
}
let Vp = new vC(), yC = !0;
try {
  typeof localStorage < "u" && localStorage && (Vp = localStorage, yC = !1);
} catch {
}
const bC = Vp, wC = Object.assign, Hp = Object.keys, _C = (t, e) => {
  for (const n in t)
    e(t[n], n);
}, Zh = (t) => Hp(t).length, ef = (t) => Hp(t).length, SC = (t) => {
  for (const e in t)
    return !1;
  return !0;
}, xC = (t, e) => {
  for (const n in t)
    if (!e(t[n], n))
      return !1;
  return !0;
}, zp = (t, e) => Object.prototype.hasOwnProperty.call(t, e), CC = (t, e) => t === e || ef(t) === ef(e) && xC(t, (n, r) => (n !== void 0 || zp(e, r)) && e[r] === n), $C = Object.freeze, Wp = (t) => {
  for (const e in t) {
    const n = t[e];
    (typeof n == "object" || typeof n == "function") && Wp(t[e]);
  }
  return $C(t);
}, bd = (t, e, n = 0) => {
  try {
    for (; n < t.length; n++)
      t[n](...e);
  } finally {
    n < t.length && bd(t, e, n + 1);
  }
}, EC = (t) => t, TC = (t, e) => t === e, Co = (t, e) => {
  if (t == null || e == null)
    return TC(t, e);
  if (t.constructor !== e.constructor)
    return !1;
  if (t === e)
    return !0;
  switch (t.constructor) {
    case ArrayBuffer:
      t = new Uint8Array(t), e = new Uint8Array(e);
    case Uint8Array: {
      if (t.byteLength !== e.byteLength)
        return !1;
      for (let n = 0; n < t.length; n++)
        if (t[n] !== e[n])
          return !1;
      break;
    }
    case Set: {
      if (t.size !== e.size)
        return !1;
      for (const n of t)
        if (!e.has(n))
          return !1;
      break;
    }
    case Map: {
      if (t.size !== e.size)
        return !1;
      for (const n of t.keys())
        if (!e.has(n) || !Co(t.get(n), e.get(n)))
          return !1;
      break;
    }
    case Object:
      if (Zh(t) !== Zh(e))
        return !1;
      for (const n in t)
        if (!zp(t, n) || !Co(t[n], e[n]))
          return !1;
      break;
    case Array:
      if (t.length !== e.length)
        return !1;
      for (let n = 0; n < t.length; n++)
        if (!Co(t[n], e[n]))
          return !1;
      break;
    default:
      return !1;
  }
  return !0;
}, AC = (t, e) => e.includes(t), qo = typeof process < "u" && process.release && /node|io\.js/.test(process.release.name) && Object.prototype.toString.call(typeof process < "u" ? process : 0) === "[object process]";
let Ur;
const kC = () => {
  if (Ur === void 0)
    if (qo) {
      Ur = jn();
      const t = process.argv;
      let e = null;
      for (let n = 0; n < t.length; n++) {
        const r = t[n];
        r[0] === "-" ? (e !== null && Ur.set(e, ""), e = r) : e !== null && (Ur.set(e, r), e = null);
      }
      e !== null && Ur.set(e, "");
    } else typeof location == "object" ? (Ur = jn(), (location.search || "?").slice(1).split("&").forEach((t) => {
      if (t.length !== 0) {
        const [e, n] = t.split("=");
        Ur.set(`--${Hh(e, "-")}`, n), Ur.set(`-${Hh(e, "-")}`, n);
      }
    })) : Ur = jn();
  return Ur;
}, gu = (t) => kC().has(t), fa = (t) => Xh(qo ? process.env[t.toUpperCase().replaceAll("-", "_")] : bC.getItem(t)), Jp = (t) => gu("--" + t) || fa(t) !== null;
Jp("production");
const IC = qo && AC(process.env.FORCE_COLOR, ["true", "1", "2"]), OC = IC || !gu("--no-colors") && // @todo deprecate --no-colors
!Jp("no-color") && (!qo || process.stdout.isTTY) && (!qo || gu("--color") || fa("COLORTERM") !== null || (fa("TERM") || "").includes("color")), DC = (t) => new Uint8Array(t), LC = (t) => {
  const e = DC(t.byteLength);
  return e.set(t), e;
};
class NC {
  /**
   * @param {L} left
   * @param {R} right
   */
  constructor(e, n) {
    this.left = e, this.right = n;
  }
}
const ti = (t, e) => new NC(t, e);
typeof DOMParser < "u" && new DOMParser();
const PC = (t) => Rx(t, (e, n) => `${n}:${e};`).join(""), vi = Symbol, Qp = vi(), Kp = vi(), RC = vi(), MC = vi(), qC = vi(), Yp = vi(), BC = vi(), wd = vi(), UC = vi(), jC = (t) => {
  t.length === 1 && t[0]?.constructor === Function && (t = /** @type {Array<string|Symbol|Object|number>} */
  /** @type {[function]} */
  t[0]());
  const e = [], n = [];
  let r = 0;
  for (; r < t.length; r++) {
    const i = t[r];
    if (i === void 0)
      break;
    if (i.constructor === String || i.constructor === Number)
      e.push(i);
    else if (i.constructor === Object)
      break;
  }
  for (r > 0 && n.push(e.join("")); r < t.length; r++) {
    const i = t[r];
    i instanceof Symbol || n.push(i);
  }
  return n;
}, GC = {
  [Qp]: ti("font-weight", "bold"),
  [Kp]: ti("font-weight", "normal"),
  [RC]: ti("color", "blue"),
  [qC]: ti("color", "green"),
  [MC]: ti("color", "grey"),
  [Yp]: ti("color", "red"),
  [BC]: ti("color", "purple"),
  [wd]: ti("color", "orange"),
  // not well supported in chrome when debugging node with inspector - TODO: deprecate
  [UC]: ti("color", "black")
}, FC = (t) => {
  t.length === 1 && t[0]?.constructor === Function && (t = /** @type {Array<string|Symbol|Object|number>} */
  /** @type {[function]} */
  t[0]());
  const e = [], n = [], r = jn();
  let i = [], s = 0;
  for (; s < t.length; s++) {
    const o = t[s], l = GC[o];
    if (l !== void 0)
      r.set(l.left, l.right);
    else {
      if (o === void 0)
        break;
      if (o.constructor === String || o.constructor === Number) {
        const a = PC(r);
        s > 0 || a.length > 0 ? (e.push("%c" + o), n.push(a)) : e.push(o);
      } else
        break;
    }
  }
  for (s > 0 && (i = n, i.unshift(e.join(""))); s < t.length; s++) {
    const o = t[s];
    o instanceof Symbol || i.push(o);
  }
  return i;
}, Xp = OC ? FC : jC, VC = (...t) => {
  console.log(...Xp(t)), Zp.forEach((e) => e.print(t));
}, HC = (...t) => {
  console.warn(...Xp(t)), t.unshift(wd), Zp.forEach((e) => e.print(t));
}, Zp = es(), em = (t) => ({
  /**
   * @return {IterableIterator<T>}
   */
  [Symbol.iterator]() {
    return this;
  },
  // @ts-ignore
  next: t
}), zC = (t, e) => em(() => {
  let n;
  do
    n = t.next();
  while (!n.done && !e(n.value));
  return n;
}), $c = (t, e) => em(() => {
  const { done: n, value: r } = t.next();
  return { done: n, value: n ? void 0 : e(r) };
});
class _d {
  /**
   * @param {number} clock
   * @param {number} len
   */
  constructor(e, n) {
    this.clock = e, this.len = n;
  }
}
class tl {
  constructor() {
    this.clients = /* @__PURE__ */ new Map();
  }
}
const tm = (t, e, n) => e.clients.forEach((r, i) => {
  const s = (
    /** @type {Array<GC|Item>} */
    t.doc.store.clients.get(i)
  );
  for (let o = 0; o < r.length; o++) {
    const l = r[o];
    pm(t, s, l.clock, l.len, n);
  }
}), WC = (t, e) => {
  let n = 0, r = t.length - 1;
  for (; n <= r; ) {
    const i = fi((n + r) / 2), s = t[i], o = s.clock;
    if (o <= e) {
      if (e < o + s.len)
        return i;
      n = i + 1;
    } else
      r = i - 1;
  }
  return null;
}, nm = (t, e) => {
  const n = t.clients.get(e.client);
  return n !== void 0 && WC(n, e.clock) !== null;
}, Sd = (t) => {
  t.clients.forEach((e) => {
    e.sort((i, s) => i.clock - s.clock);
    let n, r;
    for (n = 1, r = 1; n < e.length; n++) {
      const i = e[r - 1], s = e[n];
      i.clock + i.len >= s.clock ? i.len = ds(i.len, s.clock + s.len - i.clock) : (r < n && (e[r] = s), r++);
    }
    e.length = r;
  });
}, JC = (t) => {
  const e = new tl();
  for (let n = 0; n < t.length; n++)
    t[n].clients.forEach((r, i) => {
      if (!e.clients.has(i)) {
        const s = r.slice();
        for (let o = n + 1; o < t.length; o++)
          qx(s, t[o].clients.get(i) || []);
        e.clients.set(i, s);
      }
    });
  return Sd(e), e;
}, ga = (t, e, n, r) => {
  mi(t.clients, e, () => (
    /** @type {Array<DeleteItem>} */
    []
  )).push(new _d(n, r));
}, QC = () => new tl(), KC = (t) => {
  const e = QC();
  return t.clients.forEach((n, r) => {
    const i = [];
    for (let s = 0; s < n.length; s++) {
      const o = n[s];
      if (o.deleted) {
        const l = o.id.clock;
        let a = o.length;
        if (s + 1 < n.length)
          for (let c = n[s + 1]; s + 1 < n.length && c.deleted; c = n[++s + 1])
            a += c.length;
        i.push(new _d(l, a));
      }
    }
    i.length > 0 && e.clients.set(r, i);
  }), e;
}, oo = (t, e) => {
  Ne(t.restEncoder, e.clients.size), hi(e.clients.entries()).sort((n, r) => r[0] - n[0]).forEach(([n, r]) => {
    t.resetDsCurVal(), Ne(t.restEncoder, n);
    const i = r.length;
    Ne(t.restEncoder, i);
    for (let s = 0; s < i; s++) {
      const o = r[s];
      t.writeDsClock(o.clock), t.writeDsLen(o.len);
    }
  });
}, xd = (t) => {
  const e = new tl(), n = Me(t.restDecoder);
  for (let r = 0; r < n; r++) {
    t.resetDsCurVal();
    const i = Me(t.restDecoder), s = Me(t.restDecoder);
    if (s > 0) {
      const o = mi(e.clients, i, () => (
        /** @type {Array<DeleteItem>} */
        []
      ));
      for (let l = 0; l < s; l++)
        o.push(new _d(t.readDsClock(), t.readDsLen()));
    }
  }
  return e;
}, tf = (t, e, n) => {
  const r = new tl(), i = Me(t.restDecoder);
  for (let s = 0; s < i; s++) {
    t.resetDsCurVal();
    const o = Me(t.restDecoder), l = Me(t.restDecoder), a = n.clients.get(o) || [], c = Bt(n, o);
    for (let u = 0; u < l; u++) {
      const d = t.readDsClock(), f = d + t.readDsLen();
      if (d < c) {
        c < f && ga(r, o, c, f - c);
        let g = Vr(a, d), p = a[g];
        for (!p.deleted && p.id.clock < d && (a.splice(g + 1, 0, _a(e, p, d - p.id.clock)), g++); g < a.length && (p = a[g++], p.id.clock < f); )
          p.deleted || (f < p.id.clock + p.length && a.splice(g, 0, _a(e, p, f - p.id.clock)), p.delete(e));
      } else
        ga(r, o, d, f - d);
    }
  }
  if (r.clients.size > 0) {
    const s = new rs();
    return Ne(s.restEncoder, 0), oo(s, r), s.toUint8Array();
  }
  return null;
}, rm = Fp;
class ns extends Rp {
  /**
   * @param {DocOpts} opts configuration
   */
  constructor({ guid: e = mC(), collectionid: n = null, gc: r = !0, gcFilter: i = () => !0, meta: s = null, autoLoad: o = !1, shouldLoad: l = !0 } = {}) {
    super(), this.gc = r, this.gcFilter = i, this.clientID = rm(), this.guid = e, this.collectionid = n, this.share = /* @__PURE__ */ new Map(), this.store = new fm(), this._transaction = null, this._transactionCleanups = [], this.subdocs = /* @__PURE__ */ new Set(), this._item = null, this.shouldLoad = l, this.autoLoad = o, this.meta = s, this.isLoaded = !1, this.isSynced = !1, this.isDestroyed = !1, this.whenLoaded = Yh((c) => {
      this.on("load", () => {
        this.isLoaded = !0, c(this);
      });
    });
    const a = () => Yh((c) => {
      const u = (d) => {
        (d === void 0 || d === !0) && (this.off("sync", u), c());
      };
      this.on("sync", u);
    });
    this.on("sync", (c) => {
      c === !1 && this.isSynced && (this.whenSynced = a()), this.isSynced = c === void 0 || c === !0, this.isSynced && !this.isLoaded && this.emit("load", [this]);
    }), this.whenSynced = a();
  }
  /**
   * Notify the parent document that you request to load data into this subdocument (if it is a subdocument).
   *
   * `load()` might be used in the future to request any provider to load the most current data.
   *
   * It is safe to call `load()` multiple times.
   */
  load() {
    const e = this._item;
    e !== null && !this.shouldLoad && Tt(
      /** @type {any} */
      e.parent.doc,
      (n) => {
        n.subdocsLoaded.add(this);
      },
      null,
      !0
    ), this.shouldLoad = !0;
  }
  getSubdocs() {
    return this.subdocs;
  }
  getSubdocGuids() {
    return new Set(hi(this.subdocs).map((e) => e.guid));
  }
  /**
   * Changes that happen inside of a transaction are bundled. This means that
   * the observer fires _after_ the transaction is finished and that all changes
   * that happened inside of the transaction are sent as one message to the
   * other peers.
   *
   * @template T
   * @param {function(Transaction):T} f The function that should be executed as a transaction
   * @param {any} [origin] Origin of who started the transaction. Will be stored on transaction.origin
   * @return T
   *
   * @public
   */
  transact(e, n = null) {
    return Tt(this, e, n);
  }
  /**
   * Define a shared data type.
   *
   * Multiple calls of `ydoc.get(name, TypeConstructor)` yield the same result
   * and do not overwrite each other. I.e.
   * `ydoc.get(name, Y.Array) === ydoc.get(name, Y.Array)`
   *
   * After this method is called, the type is also available on `ydoc.share.get(name)`.
   *
   * *Best Practices:*
   * Define all types right after the Y.Doc instance is created and store them in a separate object.
   * Also use the typed methods `getText(name)`, `getArray(name)`, ..
   *
   * @template {typeof AbstractType<any>} Type
   * @example
   *   const ydoc = new Y.Doc(..)
   *   const appState = {
   *     document: ydoc.getText('document')
   *     comments: ydoc.getArray('comments')
   *   }
   *
   * @param {string} name
   * @param {Type} TypeConstructor The constructor of the type definition. E.g. Y.Text, Y.Array, Y.Map, ...
   * @return {InstanceType<Type>} The created type. Constructed with TypeConstructor
   *
   * @public
   */
  get(e, n = (
    /** @type {any} */
    fn
  )) {
    const r = mi(this.share, e, () => {
      const s = new n();
      return s._integrate(this, null), s;
    }), i = r.constructor;
    if (n !== fn && i !== n)
      if (i === fn) {
        const s = new n();
        s._map = r._map, r._map.forEach(
          /** @param {Item?} n */
          (o) => {
            for (; o !== null; o = o.left)
              o.parent = s;
          }
        ), s._start = r._start;
        for (let o = s._start; o !== null; o = o.right)
          o.parent = s;
        return s._length = r._length, this.share.set(e, s), s._integrate(this, null), /** @type {InstanceType<Type>} */
        s;
      } else
        throw new Error(`Type with the name ${e} has already been defined with a different constructor`);
    return (
      /** @type {InstanceType<Type>} */
      r
    );
  }
  /**
   * @template T
   * @param {string} [name]
   * @return {YArray<T>}
   *
   * @public
   */
  getArray(e = "") {
    return (
      /** @type {YArray<T>} */
      this.get(e, Ms)
    );
  }
  /**
   * @param {string} [name]
   * @return {YText}
   *
   * @public
   */
  getText(e = "") {
    return this.get(e, Ys);
  }
  /**
   * @template T
   * @param {string} [name]
   * @return {YMap<T>}
   *
   * @public
   */
  getMap(e = "") {
    return (
      /** @type {YMap<T>} */
      this.get(e, Ks)
    );
  }
  /**
   * @param {string} [name]
   * @return {YXmlElement}
   *
   * @public
   */
  getXmlElement(e = "") {
    return (
      /** @type {YXmlElement<{[key:string]:string}>} */
      this.get(e, Xs)
    );
  }
  /**
   * @param {string} [name]
   * @return {YXmlFragment}
   *
   * @public
   */
  getXmlFragment(e = "") {
    return this.get(e, is);
  }
  /**
   * Converts the entire document into a js object, recursively traversing each yjs type
   * Doesn't log types that have not been defined (using ydoc.getType(..)).
   *
   * @deprecated Do not use this method and rather call toJSON directly on the shared types.
   *
   * @return {Object<string, any>}
   */
  toJSON() {
    const e = {};
    return this.share.forEach((n, r) => {
      e[r] = n.toJSON();
    }), e;
  }
  /**
   * Emit `destroy` event and unregister all event handlers.
   */
  destroy() {
    this.isDestroyed = !0, hi(this.subdocs).forEach((n) => n.destroy());
    const e = this._item;
    if (e !== null) {
      this._item = null;
      const n = (
        /** @type {ContentDoc} */
        e.content
      );
      n.doc = new ns({ guid: this.guid, ...n.opts, shouldLoad: !1 }), n.doc._item = e, Tt(
        /** @type {any} */
        e.parent.doc,
        (r) => {
          const i = n.doc;
          e.deleted || r.subdocsAdded.add(i), r.subdocsRemoved.add(this);
        },
        null,
        !0
      );
    }
    this.emit("destroyed", [!0]), this.emit("destroy", [this]), super.destroy();
  }
}
class im {
  /**
   * @param {decoding.Decoder} decoder
   */
  constructor(e) {
    this.restDecoder = e;
  }
  resetDsCurVal() {
  }
  /**
   * @return {number}
   */
  readDsClock() {
    return Me(this.restDecoder);
  }
  /**
   * @return {number}
   */
  readDsLen() {
    return Me(this.restDecoder);
  }
}
class sm extends im {
  /**
   * @return {ID}
   */
  readLeftID() {
    return ze(Me(this.restDecoder), Me(this.restDecoder));
  }
  /**
   * @return {ID}
   */
  readRightID() {
    return ze(Me(this.restDecoder), Me(this.restDecoder));
  }
  /**
   * Read the next client id.
   * Use this in favor of readID whenever possible to reduce the number of objects created.
   */
  readClient() {
    return Me(this.restDecoder);
  }
  /**
   * @return {number} info An unsigned 8-bit integer
   */
  readInfo() {
    return Js(this.restDecoder);
  }
  /**
   * @return {string}
   */
  readString() {
    return Pi(this.restDecoder);
  }
  /**
   * @return {boolean} isKey
   */
  readParentInfo() {
    return Me(this.restDecoder) === 1;
  }
  /**
   * @return {number} info An unsigned 8-bit integer
   */
  readTypeRef() {
    return Me(this.restDecoder);
  }
  /**
   * Write len of a struct - well suited for Opt RLE encoder.
   *
   * @return {number} len
   */
  readLen() {
    return Me(this.restDecoder);
  }
  /**
   * @return {any}
   */
  readAny() {
    return Mo(this.restDecoder);
  }
  /**
   * @return {Uint8Array}
   */
  readBuf() {
    return LC(_n(this.restDecoder));
  }
  /**
   * Legacy implementation uses JSON parse. We use any-decoding in v2.
   *
   * @return {any}
   */
  readJSON() {
    return JSON.parse(Pi(this.restDecoder));
  }
  /**
   * @return {string}
   */
  readKey() {
    return Pi(this.restDecoder);
  }
}
class YC {
  /**
   * @param {decoding.Decoder} decoder
   */
  constructor(e) {
    this.dsCurrVal = 0, this.restDecoder = e;
  }
  resetDsCurVal() {
    this.dsCurrVal = 0;
  }
  /**
   * @return {number}
   */
  readDsClock() {
    return this.dsCurrVal += Me(this.restDecoder), this.dsCurrVal;
  }
  /**
   * @return {number}
   */
  readDsLen() {
    const e = Me(this.restDecoder) + 1;
    return this.dsCurrVal += e, e;
  }
}
class Qs extends YC {
  /**
   * @param {decoding.Decoder} decoder
   */
  constructor(e) {
    super(e), this.keys = [], Me(e), this.keyClockDecoder = new Cc(_n(e)), this.clientDecoder = new jl(_n(e)), this.leftClockDecoder = new Cc(_n(e)), this.rightClockDecoder = new Cc(_n(e)), this.infoDecoder = new Kh(_n(e), Js), this.stringDecoder = new fC(_n(e)), this.parentInfoDecoder = new Kh(_n(e), Js), this.typeRefDecoder = new jl(_n(e)), this.lenDecoder = new jl(_n(e));
  }
  /**
   * @return {ID}
   */
  readLeftID() {
    return new Ps(this.clientDecoder.read(), this.leftClockDecoder.read());
  }
  /**
   * @return {ID}
   */
  readRightID() {
    return new Ps(this.clientDecoder.read(), this.rightClockDecoder.read());
  }
  /**
   * Read the next client id.
   * Use this in favor of readID whenever possible to reduce the number of objects created.
   */
  readClient() {
    return this.clientDecoder.read();
  }
  /**
   * @return {number} info An unsigned 8-bit integer
   */
  readInfo() {
    return (
      /** @type {number} */
      this.infoDecoder.read()
    );
  }
  /**
   * @return {string}
   */
  readString() {
    return this.stringDecoder.read();
  }
  /**
   * @return {boolean}
   */
  readParentInfo() {
    return this.parentInfoDecoder.read() === 1;
  }
  /**
   * @return {number} An unsigned 8-bit integer
   */
  readTypeRef() {
    return this.typeRefDecoder.read();
  }
  /**
   * Write len of a struct - well suited for Opt RLE encoder.
   *
   * @return {number}
   */
  readLen() {
    return this.lenDecoder.read();
  }
  /**
   * @return {any}
   */
  readAny() {
    return Mo(this.restDecoder);
  }
  /**
   * @return {Uint8Array}
   */
  readBuf() {
    return _n(this.restDecoder);
  }
  /**
   * This is mainly here for legacy purposes.
   *
   * Initial we incoded objects using JSON. Now we use the much faster lib0/any-encoder. This method mainly exists for legacy purposes for the v1 encoder.
   *
   * @return {any}
   */
  readJSON() {
    return Mo(this.restDecoder);
  }
  /**
   * @return {string}
   */
  readKey() {
    const e = this.keyClockDecoder.read();
    if (e < this.keys.length)
      return this.keys[e];
    {
      const n = this.stringDecoder.read();
      return this.keys.push(n), n;
    }
  }
}
class om {
  constructor() {
    this.restEncoder = ts();
  }
  toUint8Array() {
    return Qn(this.restEncoder);
  }
  resetDsCurVal() {
  }
  /**
   * @param {number} clock
   */
  writeDsClock(e) {
    Ne(this.restEncoder, e);
  }
  /**
   * @param {number} len
   */
  writeDsLen(e) {
    Ne(this.restEncoder, e);
  }
}
class nl extends om {
  /**
   * @param {ID} id
   */
  writeLeftID(e) {
    Ne(this.restEncoder, e.client), Ne(this.restEncoder, e.clock);
  }
  /**
   * @param {ID} id
   */
  writeRightID(e) {
    Ne(this.restEncoder, e.client), Ne(this.restEncoder, e.clock);
  }
  /**
   * Use writeClient and writeClock instead of writeID if possible.
   * @param {number} client
   */
  writeClient(e) {
    Ne(this.restEncoder, e);
  }
  /**
   * @param {number} info An unsigned 8-bit integer
   */
  writeInfo(e) {
    hu(this.restEncoder, e);
  }
  /**
   * @param {string} s
   */
  writeString(e) {
    Yi(this.restEncoder, e);
  }
  /**
   * @param {boolean} isYKey
   */
  writeParentInfo(e) {
    Ne(this.restEncoder, e ? 1 : 0);
  }
  /**
   * @param {number} info An unsigned 8-bit integer
   */
  writeTypeRef(e) {
    Ne(this.restEncoder, e);
  }
  /**
   * Write len of a struct - well suited for Opt RLE encoder.
   *
   * @param {number} len
   */
  writeLen(e) {
    Ne(this.restEncoder, e);
  }
  /**
   * @param {any} any
   */
  writeAny(e) {
    Ro(this.restEncoder, e);
  }
  /**
   * @param {Uint8Array} buf
   */
  writeBuf(e) {
    qt(this.restEncoder, e);
  }
  /**
   * @param {any} embed
   */
  writeJSON(e) {
    Yi(this.restEncoder, JSON.stringify(e));
  }
  /**
   * @param {string} key
   */
  writeKey(e) {
    Yi(this.restEncoder, e);
  }
}
class lm {
  constructor() {
    this.restEncoder = ts(), this.dsCurrVal = 0;
  }
  toUint8Array() {
    return Qn(this.restEncoder);
  }
  resetDsCurVal() {
    this.dsCurrVal = 0;
  }
  /**
   * @param {number} clock
   */
  writeDsClock(e) {
    const n = e - this.dsCurrVal;
    this.dsCurrVal = e, Ne(this.restEncoder, n);
  }
  /**
   * @param {number} len
   */
  writeDsLen(e) {
    e === 0 && Ar(), Ne(this.restEncoder, e - 1), this.dsCurrVal += e;
  }
}
class rs extends lm {
  constructor() {
    super(), this.keyMap = /* @__PURE__ */ new Map(), this.keyClock = 0, this.keyClockEncoder = new xc(), this.clientEncoder = new Ul(), this.leftClockEncoder = new xc(), this.rightClockEncoder = new xc(), this.infoEncoder = new Wh(hu), this.stringEncoder = new iC(), this.parentInfoEncoder = new Wh(hu), this.typeRefEncoder = new Ul(), this.lenEncoder = new Ul();
  }
  toUint8Array() {
    const e = ts();
    return Ne(e, 0), qt(e, this.keyClockEncoder.toUint8Array()), qt(e, this.clientEncoder.toUint8Array()), qt(e, this.leftClockEncoder.toUint8Array()), qt(e, this.rightClockEncoder.toUint8Array()), qt(e, Qn(this.infoEncoder)), qt(e, this.stringEncoder.toUint8Array()), qt(e, Qn(this.parentInfoEncoder)), qt(e, this.typeRefEncoder.toUint8Array()), qt(e, this.lenEncoder.toUint8Array()), Ha(e, Qn(this.restEncoder)), Qn(e);
  }
  /**
   * @param {ID} id
   */
  writeLeftID(e) {
    this.clientEncoder.write(e.client), this.leftClockEncoder.write(e.clock);
  }
  /**
   * @param {ID} id
   */
  writeRightID(e) {
    this.clientEncoder.write(e.client), this.rightClockEncoder.write(e.clock);
  }
  /**
   * @param {number} client
   */
  writeClient(e) {
    this.clientEncoder.write(e);
  }
  /**
   * @param {number} info An unsigned 8-bit integer
   */
  writeInfo(e) {
    this.infoEncoder.write(e);
  }
  /**
   * @param {string} s
   */
  writeString(e) {
    this.stringEncoder.write(e);
  }
  /**
   * @param {boolean} isYKey
   */
  writeParentInfo(e) {
    this.parentInfoEncoder.write(e ? 1 : 0);
  }
  /**
   * @param {number} info An unsigned 8-bit integer
   */
  writeTypeRef(e) {
    this.typeRefEncoder.write(e);
  }
  /**
   * Write len of a struct - well suited for Opt RLE encoder.
   *
   * @param {number} len
   */
  writeLen(e) {
    this.lenEncoder.write(e);
  }
  /**
   * @param {any} any
   */
  writeAny(e) {
    Ro(this.restEncoder, e);
  }
  /**
   * @param {Uint8Array} buf
   */
  writeBuf(e) {
    qt(this.restEncoder, e);
  }
  /**
   * This is mainly here for legacy purposes.
   *
   * Initial we incoded objects using JSON. Now we use the much faster lib0/any-encoder. This method mainly exists for legacy purposes for the v1 encoder.
   *
   * @param {any} embed
   */
  writeJSON(e) {
    Ro(this.restEncoder, e);
  }
  /**
   * Property keys are often reused. For example, in y-prosemirror the key `bold` might
   * occur very often. For a 3d application, the key `position` might occur very often.
   *
   * We cache these keys in a Map and refer to them via a unique number.
   *
   * @param {string} key
   */
  writeKey(e) {
    const n = this.keyMap.get(e);
    n === void 0 ? (this.keyClockEncoder.write(this.keyClock++), this.stringEncoder.write(e)) : this.keyClockEncoder.write(n);
  }
}
const XC = (t, e, n, r) => {
  r = ds(r, e[0].id.clock);
  const i = Vr(e, r);
  Ne(t.restEncoder, e.length - i), t.writeClient(n), Ne(t.restEncoder, r);
  const s = e[i];
  s.write(t, r - s.id.clock);
  for (let o = i + 1; o < e.length; o++)
    e[o].write(t, 0);
}, Cd = (t, e, n) => {
  const r = /* @__PURE__ */ new Map();
  n.forEach((i, s) => {
    Bt(e, s) > i && r.set(s, i);
  }), Wa(e).forEach((i, s) => {
    n.has(s) || r.set(s, 0);
  }), Ne(t.restEncoder, r.size), hi(r.entries()).sort((i, s) => s[0] - i[0]).forEach(([i, s]) => {
    XC(
      t,
      /** @type {Array<GC|Item>} */
      e.clients.get(i),
      i,
      s
    );
  });
}, ZC = (t, e) => {
  const n = jn(), r = Me(t.restDecoder);
  for (let i = 0; i < r; i++) {
    const s = Me(t.restDecoder), o = new Array(s), l = t.readClient();
    let a = Me(t.restDecoder);
    n.set(l, { i: 0, refs: o });
    for (let c = 0; c < s; c++) {
      const u = t.readInfo();
      switch (Va & u) {
        case 0: {
          const d = t.readLen();
          o[c] = new hr(ze(l, a), d), a += d;
          break;
        }
        case 10: {
          const d = Me(t.restDecoder);
          o[c] = new fr(ze(l, a), d), a += d;
          break;
        }
        default: {
          const d = (u & (ci | Xn)) === 0, f = new Yt(
            ze(l, a),
            null,
            // left
            (u & Xn) === Xn ? t.readLeftID() : null,
            // origin
            null,
            // right
            (u & ci) === ci ? t.readRightID() : null,
            // right origin
            d ? t.readParentInfo() ? e.get(t.readString()) : t.readLeftID() : null,
            // parent
            d && (u & No) === No ? t.readString() : null,
            // parentSub
            Nm(t, u)
            // item content
          );
          o[c] = f, a += f.length;
        }
      }
    }
  }
  return n;
}, e$ = (t, e, n) => {
  const r = [];
  let i = hi(n.keys()).sort((g, p) => g - p);
  if (i.length === 0)
    return null;
  const s = () => {
    if (i.length === 0)
      return null;
    let g = (
      /** @type {{i:number,refs:Array<GC|Item>}} */
      n.get(i[i.length - 1])
    );
    for (; g.refs.length === g.i; )
      if (i.pop(), i.length > 0)
        g = /** @type {{i:number,refs:Array<GC|Item>}} */
        n.get(i[i.length - 1]);
      else
        return null;
    return g;
  };
  let o = s();
  if (o === null)
    return null;
  const l = new fm(), a = /* @__PURE__ */ new Map(), c = (g, p) => {
    const S = a.get(g);
    (S == null || S > p) && a.set(g, p);
  };
  let u = (
    /** @type {any} */
    o.refs[
      /** @type {any} */
      o.i++
    ]
  );
  const d = /* @__PURE__ */ new Map(), f = () => {
    for (const g of r) {
      const p = g.id.client, S = n.get(p);
      S ? (S.i--, l.clients.set(p, S.refs.slice(S.i)), n.delete(p), S.i = 0, S.refs = []) : l.clients.set(p, [g]), i = i.filter((_) => _ !== p);
    }
    r.length = 0;
  };
  for (; ; ) {
    if (u.constructor !== fr) {
      const p = mi(d, u.id.client, () => Bt(e, u.id.client)) - u.id.clock;
      if (p < 0)
        r.push(u), c(u.id.client, u.id.clock - 1), f();
      else {
        const S = u.getMissing(t, e);
        if (S !== null) {
          r.push(u);
          const _ = n.get(
            /** @type {number} */
            S
          ) || { refs: [], i: 0 };
          if (_.refs.length === _.i)
            c(
              /** @type {number} */
              S,
              Bt(e, S)
            ), f();
          else {
            u = _.refs[_.i++];
            continue;
          }
        } else (p === 0 || p < u.length) && (u.integrate(t, p), d.set(u.id.client, u.id.clock + u.length));
      }
    }
    if (r.length > 0)
      u = /** @type {GC|Item} */
      r.pop();
    else if (o !== null && o.i < o.refs.length)
      u = /** @type {GC|Item} */
      o.refs[o.i++];
    else {
      if (o = s(), o === null)
        break;
      u = /** @type {GC|Item} */
      o.refs[o.i++];
    }
  }
  if (l.clients.size > 0) {
    const g = new rs();
    return Cd(g, l, /* @__PURE__ */ new Map()), Ne(g.restEncoder, 0), { missing: a, update: g.toUint8Array() };
  }
  return null;
}, t$ = (t, e) => Cd(t, e.doc.store, e.beforeState), n$ = (t, e, n, r = new Qs(t)) => Tt(e, (i) => {
  i.local = !1;
  let s = !1;
  const o = i.doc, l = o.store, a = ZC(r, o), c = e$(i, l, a), u = l.pendingStructs;
  if (u) {
    for (const [f, g] of u.missing)
      if (g < Bt(l, f)) {
        s = !0;
        break;
      }
    if (c) {
      for (const [f, g] of c.missing) {
        const p = u.missing.get(f);
        (p == null || p > g) && u.missing.set(f, g);
      }
      u.update = pa([u.update, c.update]);
    }
  } else
    l.pendingStructs = c;
  const d = tf(r, i, l);
  if (l.pendingDs) {
    const f = new Qs(Gi(l.pendingDs));
    Me(f.restDecoder);
    const g = tf(f, i, l);
    d && g ? l.pendingDs = pa([d, g]) : l.pendingDs = d || g;
  } else
    l.pendingDs = d;
  if (s) {
    const f = (
      /** @type {{update: Uint8Array}} */
      l.pendingStructs.update
    );
    l.pendingStructs = null, $d(i.doc, f);
  }
}, n, !1), $d = (t, e, n, r = Qs) => {
  const i = Gi(e);
  n$(i, t, n, new r(i));
}, r$ = (t, e, n) => $d(t, e, n, sm), i$ = (t, e, n = /* @__PURE__ */ new Map()) => {
  Cd(t, e.store, n), oo(t, KC(e.store));
}, pu = (t, e = new Uint8Array([0]), n = new rs()) => {
  const r = am(e);
  i$(n, t, r);
  const i = [n.toUint8Array()];
  if (t.store.pendingDs && i.push(t.store.pendingDs), t.store.pendingStructs && i.push(S$(t.store.pendingStructs.update, e)), i.length > 1) {
    if (n.constructor === nl)
      return w$(i.map((s, o) => o === 0 ? s : C$(s)));
    if (n.constructor === rs)
      return pa(i);
  }
  return i[0];
}, s$ = (t, e) => pu(t, e, new nl()), o$ = (t) => {
  const e = /* @__PURE__ */ new Map(), n = Me(t.restDecoder);
  for (let r = 0; r < n; r++) {
    const i = Me(t.restDecoder), s = Me(t.restDecoder);
    e.set(i, s);
  }
  return e;
}, am = (t) => o$(new im(Gi(t))), cm = (t, e) => (Ne(t.restEncoder, e.size), hi(e.entries()).sort((n, r) => r[0] - n[0]).forEach(([n, r]) => {
  Ne(t.restEncoder, n), Ne(t.restEncoder, r);
}), t), l$ = (t, e) => cm(t, Wa(e.store)), a$ = (t, e = new lm()) => (t instanceof Map ? cm(e, t) : l$(e, t), e.toUint8Array()), c$ = (t) => a$(t, new om());
class u$ {
  constructor() {
    this.l = [];
  }
}
const nf = () => new u$(), rf = (t, e) => t.l.push(e), sf = (t, e) => {
  const n = t.l, r = n.length;
  t.l = n.filter((i) => e !== i), r === t.l.length && console.error("[yjs] Tried to remove event handler that doesn't exist.");
}, um = (t, e, n) => bd(t.l, [e, n]);
class Ps {
  /**
   * @param {number} client client id
   * @param {number} clock unique per client id, continuous number
   */
  constructor(e, n) {
    this.client = e, this.clock = n;
  }
}
const Os = (t, e) => t === e || t !== null && e !== null && t.client === e.client && t.clock === e.clock, ze = (t, e) => new Ps(t, e), dm = (t) => {
  for (const [e, n] of t.doc.share.entries())
    if (n === t)
      return e;
  throw Ar();
};
class hm {
  /**
   * @param {ID|null} type
   * @param {string|null} tname
   * @param {ID|null} item
   * @param {number} assoc
   */
  constructor(e, n, r, i = 0) {
    this.type = e, this.tname = n, this.item = r, this.assoc = i;
  }
}
const of = (t) => new hm(t.type == null ? null : ze(t.type.client, t.type.clock), t.tname ?? null, t.item == null ? null : ze(t.item.client, t.item.clock), t.assoc == null ? 0 : t.assoc);
class d$ {
  /**
   * @param {AbstractType<any>} type
   * @param {number} index
   * @param {number} [assoc]
   */
  constructor(e, n, r = 0) {
    this.type = e, this.index = n, this.assoc = r;
  }
}
const h$ = (t, e, n = 0) => new d$(t, e, n), Cl = (t, e, n) => {
  let r = null, i = null;
  return t._item === null ? i = dm(t) : r = ze(t._item.id.client, t._item.id.clock), new hm(r, i, e, n);
}, lf = (t, e, n = 0) => {
  let r = t._start;
  if (n < 0) {
    if (e === 0)
      return Cl(t, null, n);
    e--;
  }
  for (; r !== null; ) {
    if (!r.deleted && r.countable) {
      if (r.length > e)
        return Cl(t, ze(r.id.client, r.id.clock + e), n);
      e -= r.length;
    }
    if (r.right === null && n < 0)
      return Cl(t, r.lastId, n);
    r = r.right;
  }
  return Cl(t, null, n);
}, f$ = (t, e) => {
  const n = Rs(t, e), r = e.clock - n.id.clock;
  return {
    item: n,
    diff: r
  };
}, af = (t, e, n = !0) => {
  const r = e.store, i = t.item, s = t.type, o = t.tname, l = t.assoc;
  let a = null, c = 0;
  if (i !== null) {
    if (Bt(r, i.client) <= i.clock)
      return null;
    const u = n ? vf(r, i) : f$(r, i), d = u.item;
    if (!(d instanceof Yt))
      return null;
    if (a = /** @type {AbstractType<any>} */
    d.parent, a._item === null || !a._item.deleted) {
      c = d.deleted || !d.countable ? 0 : u.diff + (l >= 0 ? 0 : 1);
      let f = d.left;
      for (; f !== null; )
        !f.deleted && f.countable && (c += f.length), f = f.left;
    }
  } else {
    if (o !== null)
      a = e.get(o);
    else if (s !== null) {
      if (Bt(r, s.client) <= s.clock)
        return null;
      const { item: u } = n ? vf(r, s) : { item: Rs(r, s) };
      if (u instanceof Yt && u.content instanceof Jr)
        a = u.content.type;
      else
        return null;
    } else
      throw Ar();
    l >= 0 ? c = a._length : c = 0;
  }
  return h$(a, c, t.assoc);
}, cf = (t, e) => t === e || t !== null && e !== null && t.tname === e.tname && Os(t.item, e.item) && Os(t.type, e.type) && t.assoc === e.assoc, $s = (t, e) => e === void 0 ? !t.deleted : e.sv.has(t.id.client) && (e.sv.get(t.id.client) || 0) > t.id.clock && !nm(e.ds, t.id), mu = (t, e) => {
  const n = mi(t.meta, mu, es), r = t.doc.store;
  n.has(e) || (e.sv.forEach((i, s) => {
    i < Bt(r, s) && Ui(t, ze(s, i));
  }), tm(t, e.ds, (i) => {
  }), n.add(e));
};
class fm {
  constructor() {
    this.clients = /* @__PURE__ */ new Map(), this.pendingStructs = null, this.pendingDs = null;
  }
}
const Wa = (t) => {
  const e = /* @__PURE__ */ new Map();
  return t.clients.forEach((n, r) => {
    const i = n[n.length - 1];
    e.set(r, i.id.clock + i.length);
  }), e;
}, Bt = (t, e) => {
  const n = t.clients.get(e);
  if (n === void 0)
    return 0;
  const r = n[n.length - 1];
  return r.id.clock + r.length;
}, gm = (t, e) => {
  let n = t.clients.get(e.id.client);
  if (n === void 0)
    n = [], t.clients.set(e.id.client, n);
  else {
    const r = n[n.length - 1];
    if (r.id.clock + r.length !== e.id.clock)
      throw Ar();
  }
  n.push(e);
}, Vr = (t, e) => {
  let n = 0, r = t.length - 1, i = t[r], s = i.id.clock;
  if (s === e)
    return r;
  let o = fi(e / (s + i.length - 1) * r);
  for (; n <= r; ) {
    if (i = t[o], s = i.id.clock, s <= e) {
      if (e < s + i.length)
        return o;
      n = o + 1;
    } else
      r = o - 1;
    o = fi((n + r) / 2);
  }
  throw Ar();
}, g$ = (t, e) => {
  const n = t.clients.get(e.client);
  return n[Vr(n, e.clock)];
}, Rs = (
  /** @type {function(StructStore,ID):Item} */
  g$
), vu = (t, e, n) => {
  const r = Vr(e, n), i = e[r];
  return i.id.clock < n && i instanceof Yt ? (e.splice(r + 1, 0, _a(t, i, n - i.id.clock)), r + 1) : r;
}, Ui = (t, e) => {
  const n = (
    /** @type {Array<Item>} */
    t.doc.store.clients.get(e.client)
  );
  return n[vu(t, n, e.clock)];
}, uf = (t, e, n) => {
  const r = e.clients.get(n.client), i = Vr(r, n.clock), s = r[i];
  return n.clock !== s.id.clock + s.length - 1 && s.constructor !== hr && r.splice(i + 1, 0, _a(t, s, n.clock - s.id.clock + 1)), s;
}, p$ = (t, e, n) => {
  const r = (
    /** @type {Array<GC|Item>} */
    t.clients.get(e.id.client)
  );
  r[Vr(r, e.id.clock)] = n;
}, pm = (t, e, n, r, i) => {
  if (r === 0)
    return;
  const s = n + r;
  let o = vu(t, e, n), l;
  do
    l = e[o++], s < l.id.clock + l.length && vu(t, e, s), i(l);
  while (o < e.length && e[o].id.clock < s);
};
class m$ {
  /**
   * @param {Doc} doc
   * @param {any} origin
   * @param {boolean} local
   */
  constructor(e, n, r) {
    this.doc = e, this.deleteSet = new tl(), this.beforeState = Wa(e.store), this.afterState = /* @__PURE__ */ new Map(), this.changed = /* @__PURE__ */ new Map(), this.changedParentTypes = /* @__PURE__ */ new Map(), this._mergeStructs = [], this.origin = n, this.meta = /* @__PURE__ */ new Map(), this.local = r, this.subdocsAdded = /* @__PURE__ */ new Set(), this.subdocsRemoved = /* @__PURE__ */ new Set(), this.subdocsLoaded = /* @__PURE__ */ new Set(), this._needFormattingCleanup = !1;
  }
}
const df = (t, e) => e.deleteSet.clients.size === 0 && !Mx(e.afterState, (n, r) => e.beforeState.get(r) !== n) ? !1 : (Sd(e.deleteSet), t$(t, e), oo(t, e.deleteSet), !0), hf = (t, e, n) => {
  const r = e._item;
  (r === null || r.id.clock < (t.beforeState.get(r.id.client) || 0) && !r.deleted) && mi(t.changed, e, es).add(n);
}, Gl = (t, e) => {
  let n = t[e], r = t[e - 1], i = e;
  for (; i > 0; n = r, r = t[--i - 1]) {
    if (r.deleted === n.deleted && r.constructor === n.constructor && r.mergeWith(n)) {
      n instanceof Yt && n.parentSub !== null && /** @type {AbstractType<any>} */
      n.parent._map.get(n.parentSub) === n && n.parent._map.set(
        n.parentSub,
        /** @type {Item} */
        r
      );
      continue;
    }
    break;
  }
  const s = e - i;
  return s && t.splice(e + 1 - s, s), s;
}, v$ = (t, e, n) => {
  for (const [r, i] of t.clients.entries()) {
    const s = (
      /** @type {Array<GC|Item>} */
      e.clients.get(r)
    );
    for (let o = i.length - 1; o >= 0; o--) {
      const l = i[o], a = l.clock + l.len;
      for (let c = Vr(s, l.clock), u = s[c]; c < s.length && u.id.clock < a; u = s[++c]) {
        const d = s[c];
        if (l.clock + l.len <= d.id.clock)
          break;
        d instanceof Yt && d.deleted && !d.keep && n(d) && d.gc(e, !1);
      }
    }
  }
}, y$ = (t, e) => {
  t.clients.forEach((n, r) => {
    const i = (
      /** @type {Array<GC|Item>} */
      e.clients.get(r)
    );
    for (let s = n.length - 1; s >= 0; s--) {
      const o = n[s], l = Mp(i.length - 1, 1 + Vr(i, o.clock + o.len - 1));
      for (let a = l, c = i[a]; a > 0 && c.id.clock >= o.clock; c = i[a])
        a -= 1 + Gl(i, a);
    }
  });
}, mm = (t, e) => {
  if (e < t.length) {
    const n = t[e], r = n.doc, i = r.store, s = n.deleteSet, o = n._mergeStructs;
    try {
      Sd(s), n.afterState = Wa(n.doc.store), r.emit("beforeObserverCalls", [n, r]);
      const l = [];
      n.changed.forEach(
        (a, c) => l.push(() => {
          (c._item === null || !c._item.deleted) && c._callObserver(n, a);
        })
      ), l.push(() => {
        n.changedParentTypes.forEach((a, c) => {
          c._dEH.l.length > 0 && (c._item === null || !c._item.deleted) && (a = a.filter(
            (u) => u.target._item === null || !u.target._item.deleted
          ), a.forEach((u) => {
            u.currentTarget = c, u._path = null;
          }), a.sort((u, d) => u.path.length - d.path.length), um(c._dEH, a, n));
        });
      }), l.push(() => r.emit("afterTransaction", [n, r])), bd(l, []), n._needFormattingCleanup && q$(n);
    } finally {
      r.gc && v$(s, i, r.gcFilter), y$(s, i), n.afterState.forEach((u, d) => {
        const f = n.beforeState.get(d) || 0;
        if (f !== u) {
          const g = (
            /** @type {Array<GC|Item>} */
            i.clients.get(d)
          ), p = ds(Vr(g, f), 1);
          for (let S = g.length - 1; S >= p; )
            S -= 1 + Gl(g, S);
        }
      });
      for (let u = o.length - 1; u >= 0; u--) {
        const { client: d, clock: f } = o[u].id, g = (
          /** @type {Array<GC|Item>} */
          i.clients.get(d)
        ), p = Vr(g, f);
        p + 1 < g.length && Gl(g, p + 1) > 1 || p > 0 && Gl(g, p);
      }
      if (!n.local && n.afterState.get(r.clientID) !== n.beforeState.get(r.clientID) && (VC(wd, Qp, "[yjs] ", Kp, Yp, "Changed the client-id because another client seems to be using it."), r.clientID = rm()), r.emit("afterTransactionCleanup", [n, r]), r._observers.has("update")) {
        const u = new nl();
        df(u, n) && r.emit("update", [u.toUint8Array(), n.origin, r, n]);
      }
      if (r._observers.has("updateV2")) {
        const u = new rs();
        df(u, n) && r.emit("updateV2", [u.toUint8Array(), n.origin, r, n]);
      }
      const { subdocsAdded: l, subdocsLoaded: a, subdocsRemoved: c } = n;
      (l.size > 0 || c.size > 0 || a.size > 0) && (l.forEach((u) => {
        u.clientID = r.clientID, u.collectionid == null && (u.collectionid = r.collectionid), r.subdocs.add(u);
      }), c.forEach((u) => r.subdocs.delete(u)), r.emit("subdocs", [{ loaded: a, added: l, removed: c }, r, n]), c.forEach((u) => u.destroy())), t.length <= e + 1 ? (r._transactionCleanups = [], r.emit("afterAllTransactions", [r, t])) : mm(t, e + 1);
    }
  }
}, Tt = (t, e, n = null, r = !0) => {
  const i = t._transactionCleanups;
  let s = !1, o = null;
  t._transaction === null && (s = !0, t._transaction = new m$(t, n, r), i.push(t._transaction), i.length === 1 && t.emit("beforeAllTransactions", [t]), t.emit("beforeTransaction", [t._transaction, t]));
  try {
    o = e(t._transaction);
  } finally {
    if (s) {
      const l = t._transaction === i[0];
      t._transaction = null, l && mm(i, 0);
    }
  }
  return o;
};
function* b$(t) {
  const e = Me(t.restDecoder);
  for (let n = 0; n < e; n++) {
    const r = Me(t.restDecoder), i = t.readClient();
    let s = Me(t.restDecoder);
    for (let o = 0; o < r; o++) {
      const l = t.readInfo();
      if (l === 10) {
        const a = Me(t.restDecoder);
        yield new fr(ze(i, s), a), s += a;
      } else if (Va & l) {
        const a = (l & (ci | Xn)) === 0, c = new Yt(
          ze(i, s),
          null,
          // left
          (l & Xn) === Xn ? t.readLeftID() : null,
          // origin
          null,
          // right
          (l & ci) === ci ? t.readRightID() : null,
          // right origin
          // @ts-ignore Force writing a string here.
          a ? t.readParentInfo() ? t.readString() : t.readLeftID() : null,
          // parent
          a && (l & No) === No ? t.readString() : null,
          // parentSub
          Nm(t, l)
          // item content
        );
        yield c, s += c.length;
      } else {
        const a = t.readLen();
        yield new hr(ze(i, s), a), s += a;
      }
    }
  }
}
class Ed {
  /**
   * @param {UpdateDecoderV1 | UpdateDecoderV2} decoder
   * @param {boolean} filterSkips
   */
  constructor(e, n) {
    this.gen = b$(e), this.curr = null, this.done = !1, this.filterSkips = n, this.next();
  }
  /**
   * @return {Item | GC | Skip |null}
   */
  next() {
    do
      this.curr = this.gen.next().value || null;
    while (this.filterSkips && this.curr !== null && this.curr.constructor === fr);
    return this.curr;
  }
}
class Td {
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   */
  constructor(e) {
    this.currClient = 0, this.startClock = 0, this.written = 0, this.encoder = e, this.clientStructs = [];
  }
}
const w$ = (t) => pa(t, sm, nl), _$ = (t, e) => {
  if (t.constructor === hr) {
    const { client: n, clock: r } = t.id;
    return new hr(ze(n, r + e), t.length - e);
  } else if (t.constructor === fr) {
    const { client: n, clock: r } = t.id;
    return new fr(ze(n, r + e), t.length - e);
  } else {
    const n = (
      /** @type {Item} */
      t
    ), { client: r, clock: i } = n.id;
    return new Yt(
      ze(r, i + e),
      null,
      ze(r, i + e - 1),
      null,
      n.rightOrigin,
      n.parent,
      n.parentSub,
      n.content.splice(e)
    );
  }
}, pa = (t, e = Qs, n = rs) => {
  if (t.length === 1)
    return t[0];
  const r = t.map((u) => new e(Gi(u)));
  let i = r.map((u) => new Ed(u, !0)), s = null;
  const o = new n(), l = new Td(o);
  for (; i = i.filter((f) => f.curr !== null), i.sort(
    /** @type {function(any,any):number} */
    (f, g) => {
      if (f.curr.id.client === g.curr.id.client) {
        const p = f.curr.id.clock - g.curr.id.clock;
        return p === 0 ? f.curr.constructor === g.curr.constructor ? 0 : f.curr.constructor === fr ? 1 : -1 : p;
      } else
        return g.curr.id.client - f.curr.id.client;
    }
  ), i.length !== 0; ) {
    const u = i[0], d = (
      /** @type {Item | GC} */
      u.curr.id.client
    );
    if (s !== null) {
      let f = (
        /** @type {Item | GC | null} */
        u.curr
      ), g = !1;
      for (; f !== null && f.id.clock + f.length <= s.struct.id.clock + s.struct.length && f.id.client >= s.struct.id.client; )
        f = u.next(), g = !0;
      if (f === null || // current decoder is empty
      f.id.client !== d || // check whether there is another decoder that has has updates from `firstClient`
      g && f.id.clock > s.struct.id.clock + s.struct.length)
        continue;
      if (d !== s.struct.id.client)
        Di(l, s.struct, s.offset), s = { struct: f, offset: 0 }, u.next();
      else if (s.struct.id.clock + s.struct.length < f.id.clock)
        if (s.struct.constructor === fr)
          s.struct.length = f.id.clock + f.length - s.struct.id.clock;
        else {
          Di(l, s.struct, s.offset);
          const p = f.id.clock - s.struct.id.clock - s.struct.length;
          s = { struct: new fr(ze(d, s.struct.id.clock + s.struct.length), p), offset: 0 };
        }
      else {
        const p = s.struct.id.clock + s.struct.length - f.id.clock;
        p > 0 && (s.struct.constructor === fr ? s.struct.length -= p : f = _$(f, p)), s.struct.mergeWith(
          /** @type {any} */
          f
        ) || (Di(l, s.struct, s.offset), s = { struct: f, offset: 0 }, u.next());
      }
    } else
      s = { struct: (
        /** @type {Item | GC} */
        u.curr
      ), offset: 0 }, u.next();
    for (let f = u.curr; f !== null && f.id.client === d && f.id.clock === s.struct.id.clock + s.struct.length && f.constructor !== fr; f = u.next())
      Di(l, s.struct, s.offset), s = { struct: f, offset: 0 };
  }
  s !== null && (Di(l, s.struct, s.offset), s = null), Ad(l);
  const a = r.map((u) => xd(u)), c = JC(a);
  return oo(o, c), o.toUint8Array();
}, S$ = (t, e, n = Qs, r = rs) => {
  const i = am(e), s = new r(), o = new Td(s), l = new n(Gi(t)), a = new Ed(l, !1);
  for (; a.curr; ) {
    const u = a.curr, d = u.id.client, f = i.get(d) || 0;
    if (a.curr.constructor === fr) {
      a.next();
      continue;
    }
    if (u.id.clock + u.length > f)
      for (Di(o, u, ds(f - u.id.clock, 0)), a.next(); a.curr && a.curr.id.client === d; )
        Di(o, a.curr, 0), a.next();
    else
      for (; a.curr && a.curr.id.client === d && a.curr.id.clock + a.curr.length <= f; )
        a.next();
  }
  Ad(o);
  const c = xd(l);
  return oo(s, c), s.toUint8Array();
}, vm = (t) => {
  t.written > 0 && (t.clientStructs.push({ written: t.written, restEncoder: Qn(t.encoder.restEncoder) }), t.encoder.restEncoder = ts(), t.written = 0);
}, Di = (t, e, n) => {
  t.written > 0 && t.currClient !== e.id.client && vm(t), t.written === 0 && (t.currClient = e.id.client, t.encoder.writeClient(e.id.client), Ne(t.encoder.restEncoder, e.id.clock + n)), e.write(t.encoder, n), t.written++;
}, Ad = (t) => {
  vm(t);
  const e = t.encoder.restEncoder;
  Ne(e, t.clientStructs.length);
  for (let n = 0; n < t.clientStructs.length; n++) {
    const r = t.clientStructs[n];
    Ne(e, r.written), Ha(e, r.restEncoder);
  }
}, x$ = (t, e, n, r) => {
  const i = new n(Gi(t)), s = new Ed(i, !1), o = new r(), l = new Td(o);
  for (let c = s.curr; c !== null; c = s.next())
    Di(l, e(c), 0);
  Ad(l);
  const a = xd(i);
  return oo(o, a), o.toUint8Array();
}, C$ = (t) => x$(t, EC, Qs, nl), ff = "You must not compute changes after the event-handler fired.";
class Ja {
  /**
   * @param {T} target The changed type.
   * @param {Transaction} transaction
   */
  constructor(e, n) {
    this.target = e, this.currentTarget = e, this.transaction = n, this._changes = null, this._keys = null, this._delta = null, this._path = null;
  }
  /**
   * Computes the path from `y` to the changed type.
   *
   * @todo v14 should standardize on path: Array<{parent, index}> because that is easier to work with.
   *
   * The following property holds:
   * @example
   *   let type = y
   *   event.path.forEach(dir => {
   *     type = type.get(dir)
   *   })
   *   type === event.target // => true
   */
  get path() {
    return this._path || (this._path = $$(this.currentTarget, this.target));
  }
  /**
   * Check if a struct is deleted by this event.
   *
   * In contrast to change.deleted, this method also returns true if the struct was added and then deleted.
   *
   * @param {AbstractStruct} struct
   * @return {boolean}
   */
  deletes(e) {
    return nm(this.transaction.deleteSet, e.id);
  }
  /**
   * @type {Map<string, { action: 'add' | 'update' | 'delete', oldValue: any, newValue: any }>}
   */
  get keys() {
    if (this._keys === null) {
      if (this.transaction.doc._transactionCleanups.length === 0)
        throw Bi(ff);
      const e = /* @__PURE__ */ new Map(), n = this.target;
      /** @type Set<string|null> */
      this.transaction.changed.get(n).forEach((i) => {
        if (i !== null) {
          const s = (
            /** @type {Item} */
            n._map.get(i)
          );
          let o, l;
          if (this.adds(s)) {
            let a = s.left;
            for (; a !== null && this.adds(a); )
              a = a.left;
            if (this.deletes(s))
              if (a !== null && this.deletes(a))
                o = "delete", l = wc(a.content.getContent());
              else
                return;
            else
              a !== null && this.deletes(a) ? (o = "update", l = wc(a.content.getContent())) : (o = "add", l = void 0);
          } else if (this.deletes(s))
            o = "delete", l = wc(
              /** @type {Item} */
              s.content.getContent()
            );
          else
            return;
          e.set(i, { action: o, oldValue: l });
        }
      }), this._keys = e;
    }
    return this._keys;
  }
  /**
   * This is a computed property. Note that this can only be safely computed during the
   * event call. Computing this property after other changes happened might result in
   * unexpected behavior (incorrect computation of deltas). A safe way to collect changes
   * is to store the `changes` or the `delta` object. Avoid storing the `transaction` object.
   *
   * @type {Array<{insert?: string | Array<any> | object | AbstractType<any>, retain?: number, delete?: number, attributes?: Object<string, any>}>}
   */
  get delta() {
    return this.changes.delta;
  }
  /**
   * Check if a struct is added by this event.
   *
   * In contrast to change.deleted, this method also returns true if the struct was added and then deleted.
   *
   * @param {AbstractStruct} struct
   * @return {boolean}
   */
  adds(e) {
    return e.id.clock >= (this.transaction.beforeState.get(e.id.client) || 0);
  }
  /**
   * This is a computed property. Note that this can only be safely computed during the
   * event call. Computing this property after other changes happened might result in
   * unexpected behavior (incorrect computation of deltas). A safe way to collect changes
   * is to store the `changes` or the `delta` object. Avoid storing the `transaction` object.
   *
   * @type {{added:Set<Item>,deleted:Set<Item>,keys:Map<string,{action:'add'|'update'|'delete',oldValue:any}>,delta:Array<{insert?:Array<any>|string, delete?:number, retain?:number}>}}
   */
  get changes() {
    let e = this._changes;
    if (e === null) {
      if (this.transaction.doc._transactionCleanups.length === 0)
        throw Bi(ff);
      const n = this.target, r = es(), i = es(), s = [];
      if (e = {
        added: r,
        deleted: i,
        delta: s,
        keys: this.keys
      }, /** @type Set<string|null> */
      this.transaction.changed.get(n).has(null)) {
        let l = null;
        const a = () => {
          l && s.push(l);
        };
        for (let c = n._start; c !== null; c = c.right)
          c.deleted ? this.deletes(c) && !this.adds(c) && ((l === null || l.delete === void 0) && (a(), l = { delete: 0 }), l.delete += c.length, i.add(c)) : this.adds(c) ? ((l === null || l.insert === void 0) && (a(), l = { insert: [] }), l.insert = l.insert.concat(c.content.getContent()), r.add(c)) : ((l === null || l.retain === void 0) && (a(), l = { retain: 0 }), l.retain += c.length);
        l !== null && l.retain === void 0 && a();
      }
      this._changes = e;
    }
    return (
      /** @type {any} */
      e
    );
  }
}
const $$ = (t, e) => {
  const n = [];
  for (; e._item !== null && e !== t; ) {
    if (e._item.parentSub !== null)
      n.unshift(e._item.parentSub);
    else {
      let r = 0, i = (
        /** @type {AbstractType<any>} */
        e._item.parent._start
      );
      for (; i !== e._item && i !== null; )
        !i.deleted && i.countable && (r += i.length), i = i.right;
      n.unshift(r);
    }
    e = /** @type {AbstractType<any>} */
    e._item.parent;
  }
  return n;
}, Cn = () => {
  HC("Invalid access: Add Yjs type to a document before reading data.");
}, ym = 80;
let kd = 0;
class E$ {
  /**
   * @param {Item} p
   * @param {number} index
   */
  constructor(e, n) {
    e.marker = !0, this.p = e, this.index = n, this.timestamp = kd++;
  }
}
const T$ = (t) => {
  t.timestamp = kd++;
}, bm = (t, e, n) => {
  t.p.marker = !1, t.p = e, e.marker = !0, t.index = n, t.timestamp = kd++;
}, A$ = (t, e, n) => {
  if (t.length >= ym) {
    const r = t.reduce((i, s) => i.timestamp < s.timestamp ? i : s);
    return bm(r, e, n), r;
  } else {
    const r = new E$(e, n);
    return t.push(r), r;
  }
}, Qa = (t, e) => {
  if (t._start === null || e === 0 || t._searchMarker === null)
    return null;
  const n = t._searchMarker.length === 0 ? null : t._searchMarker.reduce((s, o) => Bl(e - s.index) < Bl(e - o.index) ? s : o);
  let r = t._start, i = 0;
  for (n !== null && (r = n.p, i = n.index, T$(n)); r.right !== null && i < e; ) {
    if (!r.deleted && r.countable) {
      if (e < i + r.length)
        break;
      i += r.length;
    }
    r = r.right;
  }
  for (; r.left !== null && i > e; )
    r = r.left, !r.deleted && r.countable && (i -= r.length);
  for (; r.left !== null && r.left.id.client === r.id.client && r.left.id.clock + r.left.length === r.id.clock; )
    r = r.left, !r.deleted && r.countable && (i -= r.length);
  return n !== null && Bl(n.index - i) < /** @type {YText|YArray<any>} */
  r.parent.length / ym ? (bm(n, r, i), n) : A$(t._searchMarker, r, i);
}, Bo = (t, e, n) => {
  for (let r = t.length - 1; r >= 0; r--) {
    const i = t[r];
    if (n > 0) {
      let s = i.p;
      for (s.marker = !1; s && (s.deleted || !s.countable); )
        s = s.left, s && !s.deleted && s.countable && (i.index -= s.length);
      if (s === null || s.marker === !0) {
        t.splice(r, 1);
        continue;
      }
      i.p = s, s.marker = !0;
    }
    (e < i.index || n > 0 && e === i.index) && (i.index = ds(e, i.index + n));
  }
}, Ka = (t, e, n) => {
  const r = t, i = e.changedParentTypes;
  for (; mi(i, t, () => []).push(n), t._item !== null; )
    t = /** @type {AbstractType<any>} */
    t._item.parent;
  um(r._eH, n, e);
};
class fn {
  constructor() {
    this._item = null, this._map = /* @__PURE__ */ new Map(), this._start = null, this.doc = null, this._length = 0, this._eH = nf(), this._dEH = nf(), this._searchMarker = null;
  }
  /**
   * @return {AbstractType<any>|null}
   */
  get parent() {
    return this._item ? (
      /** @type {AbstractType<any>} */
      this._item.parent
    ) : null;
  }
  /**
   * Integrate this type into the Yjs instance.
   *
   * * Save this struct in the os
   * * This type is sent to other client
   * * Observer functions are fired
   *
   * @param {Doc} y The Yjs instance
   * @param {Item|null} item
   */
  _integrate(e, n) {
    this.doc = e, this._item = n;
  }
  /**
   * @return {AbstractType<EventType>}
   */
  _copy() {
    throw Gr();
  }
  /**
   * Makes a copy of this data type that can be included somewhere else.
   *
   * Note that the content is only readable _after_ it has been included somewhere in the Ydoc.
   *
   * @return {AbstractType<EventType>}
   */
  clone() {
    throw Gr();
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} _encoder
   */
  _write(e) {
  }
  /**
   * The first non-deleted item
   */
  get _first() {
    let e = this._start;
    for (; e !== null && e.deleted; )
      e = e.right;
    return e;
  }
  /**
   * Creates YEvent and calls all type observers.
   * Must be implemented by each type.
   *
   * @param {Transaction} transaction
   * @param {Set<null|string>} _parentSubs Keys changed on this type. `null` if list was modified.
   */
  _callObserver(e, n) {
    !e.local && this._searchMarker && (this._searchMarker.length = 0);
  }
  /**
   * Observe all events that are created on this type.
   *
   * @param {function(EventType, Transaction):void} f Observer function
   */
  observe(e) {
    rf(this._eH, e);
  }
  /**
   * Observe all events that are created by this type and its children.
   *
   * @param {function(Array<YEvent<any>>,Transaction):void} f Observer function
   */
  observeDeep(e) {
    rf(this._dEH, e);
  }
  /**
   * Unregister an observer function.
   *
   * @param {function(EventType,Transaction):void} f Observer function
   */
  unobserve(e) {
    sf(this._eH, e);
  }
  /**
   * Unregister an observer function.
   *
   * @param {function(Array<YEvent<any>>,Transaction):void} f Observer function
   */
  unobserveDeep(e) {
    sf(this._dEH, e);
  }
  /**
   * @abstract
   * @return {any}
   */
  toJSON() {
  }
}
const wm = (t, e, n) => {
  t.doc ?? Cn(), e < 0 && (e = t._length + e), n < 0 && (n = t._length + n);
  let r = n - e;
  const i = [];
  let s = t._start;
  for (; s !== null && r > 0; ) {
    if (s.countable && !s.deleted) {
      const o = s.content.getContent();
      if (o.length <= e)
        e -= o.length;
      else {
        for (let l = e; l < o.length && r > 0; l++)
          i.push(o[l]), r--;
        e = 0;
      }
    }
    s = s.right;
  }
  return i;
}, _m = (t) => {
  t.doc ?? Cn();
  const e = [];
  let n = t._start;
  for (; n !== null; ) {
    if (n.countable && !n.deleted) {
      const r = n.content.getContent();
      for (let i = 0; i < r.length; i++)
        e.push(r[i]);
    }
    n = n.right;
  }
  return e;
}, Uo = (t, e) => {
  let n = 0, r = t._start;
  for (t.doc ?? Cn(); r !== null; ) {
    if (r.countable && !r.deleted) {
      const i = r.content.getContent();
      for (let s = 0; s < i.length; s++)
        e(i[s], n++, t);
    }
    r = r.right;
  }
}, Sm = (t, e) => {
  const n = [];
  return Uo(t, (r, i) => {
    n.push(e(r, i, t));
  }), n;
}, k$ = (t) => {
  let e = t._start, n = null, r = 0;
  return {
    [Symbol.iterator]() {
      return this;
    },
    next: () => {
      if (n === null) {
        for (; e !== null && e.deleted; )
          e = e.right;
        if (e === null)
          return {
            done: !0,
            value: void 0
          };
        n = e.content.getContent(), r = 0, e = e.right;
      }
      const i = n[r++];
      return n.length <= r && (n = null), {
        done: !1,
        value: i
      };
    }
  };
}, xm = (t, e) => {
  t.doc ?? Cn();
  const n = Qa(t, e);
  let r = t._start;
  for (n !== null && (r = n.p, e -= n.index); r !== null; r = r.right)
    if (!r.deleted && r.countable) {
      if (e < r.length)
        return r.content.getContent()[e];
      e -= r.length;
    }
}, ma = (t, e, n, r) => {
  let i = n;
  const s = t.doc, o = s.clientID, l = s.store, a = n === null ? e._start : n.right;
  let c = [];
  const u = () => {
    c.length > 0 && (i = new Yt(ze(o, Bt(l, o)), i, i && i.lastId, a, a && a.id, e, null, new ss(c)), i.integrate(t, 0), c = []);
  };
  r.forEach((d) => {
    if (d === null)
      c.push(d);
    else
      switch (d.constructor) {
        case Number:
        case Object:
        case Boolean:
        case Array:
        case String:
          c.push(d);
          break;
        default:
          switch (u(), d.constructor) {
            case Uint8Array:
            case ArrayBuffer:
              i = new Yt(ze(o, Bt(l, o)), i, i && i.lastId, a, a && a.id, e, null, new rl(new Uint8Array(
                /** @type {Uint8Array} */
                d
              ))), i.integrate(t, 0);
              break;
            case ns:
              i = new Yt(ze(o, Bt(l, o)), i, i && i.lastId, a, a && a.id, e, null, new il(
                /** @type {Doc} */
                d
              )), i.integrate(t, 0);
              break;
            default:
              if (d instanceof fn)
                i = new Yt(ze(o, Bt(l, o)), i, i && i.lastId, a, a && a.id, e, null, new Jr(d)), i.integrate(t, 0);
              else
                throw new Error("Unexpected content type in insert operation");
          }
      }
  }), u();
}, Cm = () => Bi("Length exceeded!"), $m = (t, e, n, r) => {
  if (n > e._length)
    throw Cm();
  if (n === 0)
    return e._searchMarker && Bo(e._searchMarker, n, r.length), ma(t, e, null, r);
  const i = n, s = Qa(e, n);
  let o = e._start;
  for (s !== null && (o = s.p, n -= s.index, n === 0 && (o = o.prev, n += o && o.countable && !o.deleted ? o.length : 0)); o !== null; o = o.right)
    if (!o.deleted && o.countable) {
      if (n <= o.length) {
        n < o.length && Ui(t, ze(o.id.client, o.id.clock + n));
        break;
      }
      n -= o.length;
    }
  return e._searchMarker && Bo(e._searchMarker, i, r.length), ma(t, e, o, r);
}, I$ = (t, e, n) => {
  let i = (e._searchMarker || []).reduce((s, o) => o.index > s.index ? o : s, { index: 0, p: e._start }).p;
  if (i)
    for (; i.right; )
      i = i.right;
  return ma(t, e, i, n);
}, Em = (t, e, n, r) => {
  if (r === 0)
    return;
  const i = n, s = r, o = Qa(e, n);
  let l = e._start;
  for (o !== null && (l = o.p, n -= o.index); l !== null && n > 0; l = l.right)
    !l.deleted && l.countable && (n < l.length && Ui(t, ze(l.id.client, l.id.clock + n)), n -= l.length);
  for (; r > 0 && l !== null; )
    l.deleted || (r < l.length && Ui(t, ze(l.id.client, l.id.clock + r)), l.delete(t), r -= l.length), l = l.right;
  if (r > 0)
    throw Cm();
  e._searchMarker && Bo(
    e._searchMarker,
    i,
    -s + r
    /* in case we remove the above exception */
  );
}, va = (t, e, n) => {
  const r = e._map.get(n);
  r !== void 0 && r.delete(t);
}, Id = (t, e, n, r) => {
  const i = e._map.get(n) || null, s = t.doc, o = s.clientID;
  let l;
  if (r == null)
    l = new ss([r]);
  else
    switch (r.constructor) {
      case Number:
      case Object:
      case Boolean:
      case Array:
      case String:
        l = new ss([r]);
        break;
      case Uint8Array:
        l = new rl(
          /** @type {Uint8Array} */
          r
        );
        break;
      case ns:
        l = new il(
          /** @type {Doc} */
          r
        );
        break;
      default:
        if (r instanceof fn)
          l = new Jr(r);
        else
          throw new Error("Unexpected content type");
    }
  new Yt(ze(o, Bt(s.store, o)), i, i && i.lastId, null, null, e, n, l).integrate(t, 0);
}, Od = (t, e) => {
  t.doc ?? Cn();
  const n = t._map.get(e);
  return n !== void 0 && !n.deleted ? n.content.getContent()[n.length - 1] : void 0;
}, Tm = (t) => {
  const e = {};
  return t.doc ?? Cn(), t._map.forEach((n, r) => {
    n.deleted || (e[r] = n.content.getContent()[n.length - 1]);
  }), e;
}, Am = (t, e) => {
  t.doc ?? Cn();
  const n = t._map.get(e);
  return n !== void 0 && !n.deleted;
}, O$ = (t, e) => {
  const n = {};
  return t._map.forEach((r, i) => {
    let s = r;
    for (; s !== null && (!e.sv.has(s.id.client) || s.id.clock >= (e.sv.get(s.id.client) || 0)); )
      s = s.left;
    s !== null && $s(s, e) && (n[i] = s.content.getContent()[s.length - 1]);
  }), n;
}, $l = (t) => (t.doc ?? Cn(), zC(
  t._map.entries(),
  /** @param {any} entry */
  (e) => !e[1].deleted
));
class D$ extends Ja {
}
class Ms extends fn {
  constructor() {
    super(), this._prelimContent = [], this._searchMarker = [];
  }
  /**
   * Construct a new YArray containing the specified items.
   * @template {Object<string,any>|Array<any>|number|null|string|Uint8Array} T
   * @param {Array<T>} items
   * @return {YArray<T>}
   */
  static from(e) {
    const n = new Ms();
    return n.push(e), n;
  }
  /**
   * Integrate this type into the Yjs instance.
   *
   * * Save this struct in the os
   * * This type is sent to other client
   * * Observer functions are fired
   *
   * @param {Doc} y The Yjs instance
   * @param {Item} item
   */
  _integrate(e, n) {
    super._integrate(e, n), this.insert(
      0,
      /** @type {Array<any>} */
      this._prelimContent
    ), this._prelimContent = null;
  }
  /**
   * @return {YArray<T>}
   */
  _copy() {
    return new Ms();
  }
  /**
   * Makes a copy of this data type that can be included somewhere else.
   *
   * Note that the content is only readable _after_ it has been included somewhere in the Ydoc.
   *
   * @return {YArray<T>}
   */
  clone() {
    const e = new Ms();
    return e.insert(0, this.toArray().map(
      (n) => n instanceof fn ? (
        /** @type {typeof el} */
        n.clone()
      ) : n
    )), e;
  }
  get length() {
    return this.doc ?? Cn(), this._length;
  }
  /**
   * Creates YArrayEvent and calls observers.
   *
   * @param {Transaction} transaction
   * @param {Set<null|string>} parentSubs Keys changed on this type. `null` if list was modified.
   */
  _callObserver(e, n) {
    super._callObserver(e, n), Ka(this, e, new D$(this, e));
  }
  /**
   * Inserts new content at an index.
   *
   * Important: This function expects an array of content. Not just a content
   * object. The reason for this "weirdness" is that inserting several elements
   * is very efficient when it is done as a single operation.
   *
   * @example
   *  // Insert character 'a' at position 0
   *  yarray.insert(0, ['a'])
   *  // Insert numbers 1, 2 at position 1
   *  yarray.insert(1, [1, 2])
   *
   * @param {number} index The index to insert content at.
   * @param {Array<T>} content The array of content
   */
  insert(e, n) {
    this.doc !== null ? Tt(this.doc, (r) => {
      $m(
        r,
        this,
        e,
        /** @type {any} */
        n
      );
    }) : this._prelimContent.splice(e, 0, ...n);
  }
  /**
   * Appends content to this YArray.
   *
   * @param {Array<T>} content Array of content to append.
   *
   * @todo Use the following implementation in all types.
   */
  push(e) {
    this.doc !== null ? Tt(this.doc, (n) => {
      I$(
        n,
        this,
        /** @type {any} */
        e
      );
    }) : this._prelimContent.push(...e);
  }
  /**
   * Prepends content to this YArray.
   *
   * @param {Array<T>} content Array of content to prepend.
   */
  unshift(e) {
    this.insert(0, e);
  }
  /**
   * Deletes elements starting from an index.
   *
   * @param {number} index Index at which to start deleting elements
   * @param {number} length The number of elements to remove. Defaults to 1.
   */
  delete(e, n = 1) {
    this.doc !== null ? Tt(this.doc, (r) => {
      Em(r, this, e, n);
    }) : this._prelimContent.splice(e, n);
  }
  /**
   * Returns the i-th element from a YArray.
   *
   * @param {number} index The index of the element to return from the YArray
   * @return {T}
   */
  get(e) {
    return xm(this, e);
  }
  /**
   * Transforms this YArray to a JavaScript Array.
   *
   * @return {Array<T>}
   */
  toArray() {
    return _m(this);
  }
  /**
   * Returns a portion of this YArray into a JavaScript Array selected
   * from start to end (end not included).
   *
   * @param {number} [start]
   * @param {number} [end]
   * @return {Array<T>}
   */
  slice(e = 0, n = this.length) {
    return wm(this, e, n);
  }
  /**
   * Transforms this Shared Type to a JSON object.
   *
   * @return {Array<any>}
   */
  toJSON() {
    return this.map((e) => e instanceof fn ? e.toJSON() : e);
  }
  /**
   * Returns an Array with the result of calling a provided function on every
   * element of this YArray.
   *
   * @template M
   * @param {function(T,number,YArray<T>):M} f Function that produces an element of the new Array
   * @return {Array<M>} A new array with each element being the result of the
   *                 callback function
   */
  map(e) {
    return Sm(
      this,
      /** @type {any} */
      e
    );
  }
  /**
   * Executes a provided function once on every element of this YArray.
   *
   * @param {function(T,number,YArray<T>):void} f A function to execute on every element of this YArray.
   */
  forEach(e) {
    Uo(this, e);
  }
  /**
   * @return {IterableIterator<T>}
   */
  [Symbol.iterator]() {
    return k$(this);
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   */
  _write(e) {
    e.writeTypeRef(rE);
  }
}
const L$ = (t) => new Ms();
class N$ extends Ja {
  /**
   * @param {YMap<T>} ymap The YArray that changed.
   * @param {Transaction} transaction
   * @param {Set<any>} subs The keys that changed.
   */
  constructor(e, n, r) {
    super(e, n), this.keysChanged = r;
  }
}
class Ks extends fn {
  /**
   *
   * @param {Iterable<readonly [string, any]>=} entries - an optional iterable to initialize the YMap
   */
  constructor(e) {
    super(), this._prelimContent = null, e === void 0 ? this._prelimContent = /* @__PURE__ */ new Map() : this._prelimContent = new Map(e);
  }
  /**
   * Integrate this type into the Yjs instance.
   *
   * * Save this struct in the os
   * * This type is sent to other client
   * * Observer functions are fired
   *
   * @param {Doc} y The Yjs instance
   * @param {Item} item
   */
  _integrate(e, n) {
    super._integrate(e, n), this._prelimContent.forEach((r, i) => {
      this.set(i, r);
    }), this._prelimContent = null;
  }
  /**
   * @return {YMap<MapType>}
   */
  _copy() {
    return new Ks();
  }
  /**
   * Makes a copy of this data type that can be included somewhere else.
   *
   * Note that the content is only readable _after_ it has been included somewhere in the Ydoc.
   *
   * @return {YMap<MapType>}
   */
  clone() {
    const e = new Ks();
    return this.forEach((n, r) => {
      e.set(r, n instanceof fn ? (
        /** @type {typeof value} */
        n.clone()
      ) : n);
    }), e;
  }
  /**
   * Creates YMapEvent and calls observers.
   *
   * @param {Transaction} transaction
   * @param {Set<null|string>} parentSubs Keys changed on this type. `null` if list was modified.
   */
  _callObserver(e, n) {
    Ka(this, e, new N$(this, e, n));
  }
  /**
   * Transforms this Shared Type to a JSON object.
   *
   * @return {Object<string,any>}
   */
  toJSON() {
    this.doc ?? Cn();
    const e = {};
    return this._map.forEach((n, r) => {
      if (!n.deleted) {
        const i = n.content.getContent()[n.length - 1];
        e[r] = i instanceof fn ? i.toJSON() : i;
      }
    }), e;
  }
  /**
   * Returns the size of the YMap (count of key/value pairs)
   *
   * @return {number}
   */
  get size() {
    return [...$l(this)].length;
  }
  /**
   * Returns the keys for each element in the YMap Type.
   *
   * @return {IterableIterator<string>}
   */
  keys() {
    return $c(
      $l(this),
      /** @param {any} v */
      (e) => e[0]
    );
  }
  /**
   * Returns the values for each element in the YMap Type.
   *
   * @return {IterableIterator<MapType>}
   */
  values() {
    return $c(
      $l(this),
      /** @param {any} v */
      (e) => e[1].content.getContent()[e[1].length - 1]
    );
  }
  /**
   * Returns an Iterator of [key, value] pairs
   *
   * @return {IterableIterator<[string, MapType]>}
   */
  entries() {
    return $c(
      $l(this),
      /** @param {any} v */
      (e) => (
        /** @type {any} */
        [e[0], e[1].content.getContent()[e[1].length - 1]]
      )
    );
  }
  /**
   * Executes a provided function on once on every key-value pair.
   *
   * @param {function(MapType,string,YMap<MapType>):void} f A function to execute on every element of this YArray.
   */
  forEach(e) {
    this.doc ?? Cn(), this._map.forEach((n, r) => {
      n.deleted || e(n.content.getContent()[n.length - 1], r, this);
    });
  }
  /**
   * Returns an Iterator of [key, value] pairs
   *
   * @return {IterableIterator<[string, MapType]>}
   */
  [Symbol.iterator]() {
    return this.entries();
  }
  /**
   * Remove a specified element from this YMap.
   *
   * @param {string} key The key of the element to remove.
   */
  delete(e) {
    this.doc !== null ? Tt(this.doc, (n) => {
      va(n, this, e);
    }) : this._prelimContent.delete(e);
  }
  /**
   * Adds or updates an element with a specified key and value.
   * @template {MapType} VAL
   *
   * @param {string} key The key of the element to add to this YMap
   * @param {VAL} value The value of the element to add
   * @return {VAL}
   */
  set(e, n) {
    return this.doc !== null ? Tt(this.doc, (r) => {
      Id(
        r,
        this,
        e,
        /** @type {any} */
        n
      );
    }) : this._prelimContent.set(e, n), n;
  }
  /**
   * Returns a specified element from this YMap.
   *
   * @param {string} key
   * @return {MapType|undefined}
   */
  get(e) {
    return (
      /** @type {any} */
      Od(this, e)
    );
  }
  /**
   * Returns a boolean indicating whether the specified key exists or not.
   *
   * @param {string} key The key to test.
   * @return {boolean}
   */
  has(e) {
    return Am(this, e);
  }
  /**
   * Removes all elements from this YMap.
   */
  clear() {
    this.doc !== null ? Tt(this.doc, (e) => {
      this.forEach(function(n, r, i) {
        va(e, i, r);
      });
    }) : this._prelimContent.clear();
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   */
  _write(e) {
    e.writeTypeRef(iE);
  }
}
const P$ = (t) => new Ks(), Li = (t, e) => t === e || typeof t == "object" && typeof e == "object" && t && e && CC(t, e);
class yu {
  /**
   * @param {Item|null} left
   * @param {Item|null} right
   * @param {number} index
   * @param {Map<string,any>} currentAttributes
   */
  constructor(e, n, r, i) {
    this.left = e, this.right = n, this.index = r, this.currentAttributes = i;
  }
  /**
   * Only call this if you know that this.right is defined
   */
  forward() {
    switch (this.right === null && Ar(), this.right.content.constructor) {
      case en:
        this.right.deleted || lo(
          this.currentAttributes,
          /** @type {ContentFormat} */
          this.right.content
        );
        break;
      default:
        this.right.deleted || (this.index += this.right.length);
        break;
    }
    this.left = this.right, this.right = this.right.right;
  }
}
const gf = (t, e, n) => {
  for (; e.right !== null && n > 0; ) {
    switch (e.right.content.constructor) {
      case en:
        e.right.deleted || lo(
          e.currentAttributes,
          /** @type {ContentFormat} */
          e.right.content
        );
        break;
      default:
        e.right.deleted || (n < e.right.length && Ui(t, ze(e.right.id.client, e.right.id.clock + n)), e.index += e.right.length, n -= e.right.length);
        break;
    }
    e.left = e.right, e.right = e.right.right;
  }
  return e;
}, El = (t, e, n, r) => {
  const i = /* @__PURE__ */ new Map(), s = r ? Qa(e, n) : null;
  if (s) {
    const o = new yu(s.p.left, s.p, s.index, i);
    return gf(t, o, n - s.index);
  } else {
    const o = new yu(null, e._start, 0, i);
    return gf(t, o, n);
  }
}, km = (t, e, n, r) => {
  for (; n.right !== null && (n.right.deleted === !0 || n.right.content.constructor === en && Li(
    r.get(
      /** @type {ContentFormat} */
      n.right.content.key
    ),
    /** @type {ContentFormat} */
    n.right.content.value
  )); )
    n.right.deleted || r.delete(
      /** @type {ContentFormat} */
      n.right.content.key
    ), n.forward();
  const i = t.doc, s = i.clientID;
  r.forEach((o, l) => {
    const a = n.left, c = n.right, u = new Yt(ze(s, Bt(i.store, s)), a, a && a.lastId, c, c && c.id, e, null, new en(l, o));
    u.integrate(t, 0), n.right = u, n.forward();
  });
}, lo = (t, e) => {
  const { key: n, value: r } = e;
  r === null ? t.delete(n) : t.set(n, r);
}, Im = (t, e) => {
  for (; t.right !== null; ) {
    if (!(t.right.deleted || t.right.content.constructor === en && Li(
      e[
        /** @type {ContentFormat} */
        t.right.content.key
      ] ?? null,
      /** @type {ContentFormat} */
      t.right.content.value
    ))) break;
    t.forward();
  }
}, Om = (t, e, n, r) => {
  const i = t.doc, s = i.clientID, o = /* @__PURE__ */ new Map();
  for (const l in r) {
    const a = r[l], c = n.currentAttributes.get(l) ?? null;
    if (!Li(c, a)) {
      o.set(l, c);
      const { left: u, right: d } = n;
      n.right = new Yt(ze(s, Bt(i.store, s)), u, u && u.lastId, d, d && d.id, e, null, new en(l, a)), n.right.integrate(t, 0), n.forward();
    }
  }
  return o;
}, Ec = (t, e, n, r, i) => {
  n.currentAttributes.forEach((f, g) => {
    i[g] === void 0 && (i[g] = null);
  });
  const s = t.doc, o = s.clientID;
  Im(n, i);
  const l = Om(t, e, n, i), a = r.constructor === String ? new Hr(
    /** @type {string} */
    r
  ) : r instanceof fn ? new Jr(r) : new hs(r);
  let { left: c, right: u, index: d } = n;
  e._searchMarker && Bo(e._searchMarker, n.index, a.getLength()), u = new Yt(ze(o, Bt(s.store, o)), c, c && c.lastId, u, u && u.id, e, null, a), u.integrate(t, 0), n.right = u, n.index = d, n.forward(), km(t, e, n, l);
}, pf = (t, e, n, r, i) => {
  const s = t.doc, o = s.clientID;
  Im(n, i);
  const l = Om(t, e, n, i);
  e: for (; n.right !== null && (r > 0 || l.size > 0 && (n.right.deleted || n.right.content.constructor === en)); ) {
    if (!n.right.deleted)
      switch (n.right.content.constructor) {
        case en: {
          const { key: a, value: c } = (
            /** @type {ContentFormat} */
            n.right.content
          ), u = i[a];
          if (u !== void 0) {
            if (Li(u, c))
              l.delete(a);
            else {
              if (r === 0)
                break e;
              l.set(a, c);
            }
            n.right.delete(t);
          } else
            n.currentAttributes.set(a, c);
          break;
        }
        default:
          r < n.right.length && Ui(t, ze(n.right.id.client, n.right.id.clock + r)), r -= n.right.length;
          break;
      }
    n.forward();
  }
  if (r > 0) {
    let a = "";
    for (; r > 0; r--)
      a += `
`;
    n.right = new Yt(ze(o, Bt(s.store, o)), n.left, n.left && n.left.lastId, n.right, n.right && n.right.id, e, null, new Hr(a)), n.right.integrate(t, 0), n.forward();
  }
  km(t, e, n, l);
}, Dm = (t, e, n, r, i) => {
  let s = e;
  const o = jn();
  for (; s && (!s.countable || s.deleted); ) {
    if (!s.deleted && s.content.constructor === en) {
      const c = (
        /** @type {ContentFormat} */
        s.content
      );
      o.set(c.key, c);
    }
    s = s.right;
  }
  let l = 0, a = !1;
  for (; e !== s; ) {
    if (n === e && (a = !0), !e.deleted) {
      const c = e.content;
      switch (c.constructor) {
        case en: {
          const { key: u, value: d } = (
            /** @type {ContentFormat} */
            c
          ), f = r.get(u) ?? null;
          (o.get(u) !== c || f === d) && (e.delete(t), l++, !a && (i.get(u) ?? null) === d && f !== d && (f === null ? i.delete(u) : i.set(u, f))), !a && !e.deleted && lo(
            i,
            /** @type {ContentFormat} */
            c
          );
          break;
        }
      }
    }
    e = /** @type {Item} */
    e.right;
  }
  return l;
}, R$ = (t, e) => {
  for (; e && e.right && (e.right.deleted || !e.right.countable); )
    e = e.right;
  const n = /* @__PURE__ */ new Set();
  for (; e && (e.deleted || !e.countable); ) {
    if (!e.deleted && e.content.constructor === en) {
      const r = (
        /** @type {ContentFormat} */
        e.content.key
      );
      n.has(r) ? e.delete(t) : n.add(r);
    }
    e = e.left;
  }
}, M$ = (t) => {
  let e = 0;
  return Tt(
    /** @type {Doc} */
    t.doc,
    (n) => {
      let r = (
        /** @type {Item} */
        t._start
      ), i = t._start, s = jn();
      const o = uu(s);
      for (; i; ) {
        if (i.deleted === !1)
          switch (i.content.constructor) {
            case en:
              lo(
                o,
                /** @type {ContentFormat} */
                i.content
              );
              break;
            default:
              e += Dm(n, r, i, s, o), s = uu(o), r = i;
              break;
          }
        i = i.right;
      }
    }
  ), e;
}, q$ = (t) => {
  const e = /* @__PURE__ */ new Set(), n = t.doc;
  for (const [r, i] of t.afterState.entries()) {
    const s = t.beforeState.get(r) || 0;
    i !== s && pm(
      t,
      /** @type {Array<Item|GC>} */
      n.store.clients.get(r),
      s,
      i,
      (o) => {
        !o.deleted && /** @type {Item} */
        o.content.constructor === en && o.constructor !== hr && e.add(
          /** @type {any} */
          o.parent
        );
      }
    );
  }
  Tt(n, (r) => {
    tm(t, t.deleteSet, (i) => {
      if (i instanceof hr || !/** @type {YText} */
      i.parent._hasFormatting || e.has(
        /** @type {YText} */
        i.parent
      ))
        return;
      const s = (
        /** @type {YText} */
        i.parent
      );
      i.content.constructor === en ? e.add(s) : R$(r, i);
    });
    for (const i of e)
      M$(i);
  });
}, mf = (t, e, n) => {
  const r = n, i = uu(e.currentAttributes), s = e.right;
  for (; n > 0 && e.right !== null; ) {
    if (e.right.deleted === !1)
      switch (e.right.content.constructor) {
        case Jr:
        case hs:
        case Hr:
          n < e.right.length && Ui(t, ze(e.right.id.client, e.right.id.clock + n)), n -= e.right.length, e.right.delete(t);
          break;
      }
    e.forward();
  }
  s && Dm(t, s, e.right, i, e.currentAttributes);
  const o = (
    /** @type {AbstractType<any>} */
    /** @type {Item} */
    (e.left || e.right).parent
  );
  return o._searchMarker && Bo(o._searchMarker, e.index, -r + n), e;
};
class B$ extends Ja {
  /**
   * @param {YText} ytext
   * @param {Transaction} transaction
   * @param {Set<any>} subs The keys that changed
   */
  constructor(e, n, r) {
    super(e, n), this.childListChanged = !1, this.keysChanged = /* @__PURE__ */ new Set(), r.forEach((i) => {
      i === null ? this.childListChanged = !0 : this.keysChanged.add(i);
    });
  }
  /**
   * @type {{added:Set<Item>,deleted:Set<Item>,keys:Map<string,{action:'add'|'update'|'delete',oldValue:any}>,delta:Array<{insert?:Array<any>|string, delete?:number, retain?:number}>}}
   */
  get changes() {
    if (this._changes === null) {
      const e = {
        keys: this.keys,
        delta: this.delta,
        added: /* @__PURE__ */ new Set(),
        deleted: /* @__PURE__ */ new Set()
      };
      this._changes = e;
    }
    return (
      /** @type {any} */
      this._changes
    );
  }
  /**
   * Compute the changes in the delta format.
   * A {@link https://quilljs.com/docs/delta/|Quill Delta}) that represents the changes on the document.
   *
   * @type {Array<{insert?:string|object|AbstractType<any>, delete?:number, retain?:number, attributes?: Object<string,any>}>}
   *
   * @public
   */
  get delta() {
    if (this._delta === null) {
      const e = (
        /** @type {Doc} */
        this.target.doc
      ), n = [];
      Tt(e, (r) => {
        const i = /* @__PURE__ */ new Map(), s = /* @__PURE__ */ new Map();
        let o = this.target._start, l = null;
        const a = {};
        let c = "", u = 0, d = 0;
        const f = () => {
          if (l !== null) {
            let g = null;
            switch (l) {
              case "delete":
                d > 0 && (g = { delete: d }), d = 0;
                break;
              case "insert":
                (typeof c == "object" || c.length > 0) && (g = { insert: c }, i.size > 0 && (g.attributes = {}, i.forEach((p, S) => {
                  p !== null && (g.attributes[S] = p);
                }))), c = "";
                break;
              case "retain":
                u > 0 && (g = { retain: u }, SC(a) || (g.attributes = wC({}, a))), u = 0;
                break;
            }
            g && n.push(g), l = null;
          }
        };
        for (; o !== null; ) {
          switch (o.content.constructor) {
            case Jr:
            case hs:
              this.adds(o) ? this.deletes(o) || (f(), l = "insert", c = o.content.getContent()[0], f()) : this.deletes(o) ? (l !== "delete" && (f(), l = "delete"), d += 1) : o.deleted || (l !== "retain" && (f(), l = "retain"), u += 1);
              break;
            case Hr:
              this.adds(o) ? this.deletes(o) || (l !== "insert" && (f(), l = "insert"), c += /** @type {ContentString} */
              o.content.str) : this.deletes(o) ? (l !== "delete" && (f(), l = "delete"), d += o.length) : o.deleted || (l !== "retain" && (f(), l = "retain"), u += o.length);
              break;
            case en: {
              const { key: g, value: p } = (
                /** @type {ContentFormat} */
                o.content
              );
              if (this.adds(o)) {
                if (!this.deletes(o)) {
                  const S = i.get(g) ?? null;
                  Li(S, p) ? p !== null && o.delete(r) : (l === "retain" && f(), Li(p, s.get(g) ?? null) ? delete a[g] : a[g] = p);
                }
              } else if (this.deletes(o)) {
                s.set(g, p);
                const S = i.get(g) ?? null;
                Li(S, p) || (l === "retain" && f(), a[g] = S);
              } else if (!o.deleted) {
                s.set(g, p);
                const S = a[g];
                S !== void 0 && (Li(S, p) ? S !== null && o.delete(r) : (l === "retain" && f(), p === null ? delete a[g] : a[g] = p));
              }
              o.deleted || (l === "insert" && f(), lo(
                i,
                /** @type {ContentFormat} */
                o.content
              ));
              break;
            }
          }
          o = o.right;
        }
        for (f(); n.length > 0; ) {
          const g = n[n.length - 1];
          if (g.retain !== void 0 && g.attributes === void 0)
            n.pop();
          else
            break;
        }
      }), this._delta = n;
    }
    return (
      /** @type {any} */
      this._delta
    );
  }
}
class Ys extends fn {
  /**
   * @param {String} [string] The initial value of the YText.
   */
  constructor(e) {
    super(), this._pending = e !== void 0 ? [() => this.insert(0, e)] : [], this._searchMarker = [], this._hasFormatting = !1;
  }
  /**
   * Number of characters of this text type.
   *
   * @type {number}
   */
  get length() {
    return this.doc ?? Cn(), this._length;
  }
  /**
   * @param {Doc} y
   * @param {Item} item
   */
  _integrate(e, n) {
    super._integrate(e, n);
    try {
      this._pending.forEach((r) => r());
    } catch (r) {
      console.error(r);
    }
    this._pending = null;
  }
  _copy() {
    return new Ys();
  }
  /**
   * Makes a copy of this data type that can be included somewhere else.
   *
   * Note that the content is only readable _after_ it has been included somewhere in the Ydoc.
   *
   * @return {YText}
   */
  clone() {
    const e = new Ys();
    return e.applyDelta(this.toDelta()), e;
  }
  /**
   * Creates YTextEvent and calls observers.
   *
   * @param {Transaction} transaction
   * @param {Set<null|string>} parentSubs Keys changed on this type. `null` if list was modified.
   */
  _callObserver(e, n) {
    super._callObserver(e, n);
    const r = new B$(this, e, n);
    Ka(this, e, r), !e.local && this._hasFormatting && (e._needFormattingCleanup = !0);
  }
  /**
   * Returns the unformatted string representation of this YText type.
   *
   * @public
   */
  toString() {
    this.doc ?? Cn();
    let e = "", n = this._start;
    for (; n !== null; )
      !n.deleted && n.countable && n.content.constructor === Hr && (e += /** @type {ContentString} */
      n.content.str), n = n.right;
    return e;
  }
  /**
   * Returns the unformatted string representation of this YText type.
   *
   * @return {string}
   * @public
   */
  toJSON() {
    return this.toString();
  }
  /**
   * Apply a {@link Delta} on this shared YText type.
   *
   * @param {Array<any>} delta The changes to apply on this element.
   * @param {object}  opts
   * @param {boolean} [opts.sanitize] Sanitize input delta. Removes ending newlines if set to true.
   *
   *
   * @public
   */
  applyDelta(e, { sanitize: n = !0 } = {}) {
    this.doc !== null ? Tt(this.doc, (r) => {
      const i = new yu(null, this._start, 0, /* @__PURE__ */ new Map());
      for (let s = 0; s < e.length; s++) {
        const o = e[s];
        if (o.insert !== void 0) {
          const l = !n && typeof o.insert == "string" && s === e.length - 1 && i.right === null && o.insert.slice(-1) === `
` ? o.insert.slice(0, -1) : o.insert;
          (typeof l != "string" || l.length > 0) && Ec(r, this, i, l, o.attributes || {});
        } else o.retain !== void 0 ? pf(r, this, i, o.retain, o.attributes || {}) : o.delete !== void 0 && mf(r, i, o.delete);
      }
    }) : this._pending.push(() => this.applyDelta(e));
  }
  /**
   * Returns the Delta representation of this YText type.
   *
   * @param {Snapshot} [snapshot]
   * @param {Snapshot} [prevSnapshot]
   * @param {function('removed' | 'added', ID):any} [computeYChange]
   * @return {any} The Delta representation of this type.
   *
   * @public
   */
  toDelta(e, n, r) {
    this.doc ?? Cn();
    const i = [], s = /* @__PURE__ */ new Map(), o = (
      /** @type {Doc} */
      this.doc
    );
    let l = "", a = this._start;
    function c() {
      if (l.length > 0) {
        const d = {};
        let f = !1;
        s.forEach((p, S) => {
          f = !0, d[S] = p;
        });
        const g = { insert: l };
        f && (g.attributes = d), i.push(g), l = "";
      }
    }
    const u = () => {
      for (; a !== null; ) {
        if ($s(a, e) || n !== void 0 && $s(a, n))
          switch (a.content.constructor) {
            case Hr: {
              const d = s.get("ychange");
              e !== void 0 && !$s(a, e) ? (d === void 0 || d.user !== a.id.client || d.type !== "removed") && (c(), s.set("ychange", r ? r("removed", a.id) : { type: "removed" })) : n !== void 0 && !$s(a, n) ? (d === void 0 || d.user !== a.id.client || d.type !== "added") && (c(), s.set("ychange", r ? r("added", a.id) : { type: "added" })) : d !== void 0 && (c(), s.delete("ychange")), l += /** @type {ContentString} */
              a.content.str;
              break;
            }
            case Jr:
            case hs: {
              c();
              const d = {
                insert: a.content.getContent()[0]
              };
              if (s.size > 0) {
                const f = (
                  /** @type {Object<string,any>} */
                  {}
                );
                d.attributes = f, s.forEach((g, p) => {
                  f[p] = g;
                });
              }
              i.push(d);
              break;
            }
            case en:
              $s(a, e) && (c(), lo(
                s,
                /** @type {ContentFormat} */
                a.content
              ));
              break;
          }
        a = a.right;
      }
      c();
    };
    return e || n ? Tt(o, (d) => {
      e && mu(d, e), n && mu(d, n), u();
    }, "cleanup") : u(), i;
  }
  /**
   * Insert text at a given index.
   *
   * @param {number} index The index at which to start inserting.
   * @param {String} text The text to insert at the specified position.
   * @param {TextAttributes} [attributes] Optionally define some formatting
   *                                    information to apply on the inserted
   *                                    Text.
   * @public
   */
  insert(e, n, r) {
    if (n.length <= 0)
      return;
    const i = this.doc;
    i !== null ? Tt(i, (s) => {
      const o = El(s, this, e, !r);
      r || (r = {}, o.currentAttributes.forEach((l, a) => {
        r[a] = l;
      })), Ec(s, this, o, n, r);
    }) : this._pending.push(() => this.insert(e, n, r));
  }
  /**
   * Inserts an embed at a index.
   *
   * @param {number} index The index to insert the embed at.
   * @param {Object | AbstractType<any>} embed The Object that represents the embed.
   * @param {TextAttributes} [attributes] Attribute information to apply on the
   *                                    embed
   *
   * @public
   */
  insertEmbed(e, n, r) {
    const i = this.doc;
    i !== null ? Tt(i, (s) => {
      const o = El(s, this, e, !r);
      Ec(s, this, o, n, r || {});
    }) : this._pending.push(() => this.insertEmbed(e, n, r || {}));
  }
  /**
   * Deletes text starting from an index.
   *
   * @param {number} index Index at which to start deleting.
   * @param {number} length The number of characters to remove. Defaults to 1.
   *
   * @public
   */
  delete(e, n) {
    if (n === 0)
      return;
    const r = this.doc;
    r !== null ? Tt(r, (i) => {
      mf(i, El(i, this, e, !0), n);
    }) : this._pending.push(() => this.delete(e, n));
  }
  /**
   * Assigns properties to a range of text.
   *
   * @param {number} index The position where to start formatting.
   * @param {number} length The amount of characters to assign properties to.
   * @param {TextAttributes} attributes Attribute information to apply on the
   *                                    text.
   *
   * @public
   */
  format(e, n, r) {
    if (n === 0)
      return;
    const i = this.doc;
    i !== null ? Tt(i, (s) => {
      const o = El(s, this, e, !1);
      o.right !== null && pf(s, this, o, n, r);
    }) : this._pending.push(() => this.format(e, n, r));
  }
  /**
   * Removes an attribute.
   *
   * @note Xml-Text nodes don't have attributes. You can use this feature to assign properties to complete text-blocks.
   *
   * @param {String} attributeName The attribute name that is to be removed.
   *
   * @public
   */
  removeAttribute(e) {
    this.doc !== null ? Tt(this.doc, (n) => {
      va(n, this, e);
    }) : this._pending.push(() => this.removeAttribute(e));
  }
  /**
   * Sets or updates an attribute.
   *
   * @note Xml-Text nodes don't have attributes. You can use this feature to assign properties to complete text-blocks.
   *
   * @param {String} attributeName The attribute name that is to be set.
   * @param {any} attributeValue The attribute value that is to be set.
   *
   * @public
   */
  setAttribute(e, n) {
    this.doc !== null ? Tt(this.doc, (r) => {
      Id(r, this, e, n);
    }) : this._pending.push(() => this.setAttribute(e, n));
  }
  /**
   * Returns an attribute value that belongs to the attribute name.
   *
   * @note Xml-Text nodes don't have attributes. You can use this feature to assign properties to complete text-blocks.
   *
   * @param {String} attributeName The attribute name that identifies the
   *                               queried value.
   * @return {any} The queried attribute value.
   *
   * @public
   */
  getAttribute(e) {
    return (
      /** @type {any} */
      Od(this, e)
    );
  }
  /**
   * Returns all attribute name/value pairs in a JSON Object.
   *
   * @note Xml-Text nodes don't have attributes. You can use this feature to assign properties to complete text-blocks.
   *
   * @return {Object<string, any>} A JSON Object that describes the attributes.
   *
   * @public
   */
  getAttributes() {
    return Tm(this);
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   */
  _write(e) {
    e.writeTypeRef(sE);
  }
}
const U$ = (t) => new Ys();
class Tc {
  /**
   * @param {YXmlFragment | YXmlElement} root
   * @param {function(AbstractType<any>):boolean} [f]
   */
  constructor(e, n = () => !0) {
    this._filter = n, this._root = e, this._currentNode = /** @type {Item} */
    e._start, this._firstCall = !0, e.doc ?? Cn();
  }
  [Symbol.iterator]() {
    return this;
  }
  /**
   * Get the next node.
   *
   * @return {IteratorResult<YXmlElement|YXmlText|YXmlHook>} The next node.
   *
   * @public
   */
  next() {
    let e = this._currentNode, n = e && e.content && /** @type {any} */
    e.content.type;
    if (e !== null && (!this._firstCall || e.deleted || !this._filter(n)))
      do
        if (n = /** @type {any} */
        e.content.type, !e.deleted && (n.constructor === Xs || n.constructor === is) && n._start !== null)
          e = n._start;
        else
          for (; e !== null; ) {
            const r = e.next;
            if (r !== null) {
              e = r;
              break;
            } else e.parent === this._root ? e = null : e = /** @type {AbstractType<any>} */
            e.parent._item;
          }
      while (e !== null && (e.deleted || !this._filter(
        /** @type {ContentType} */
        e.content.type
      )));
    return this._firstCall = !1, e === null ? { value: void 0, done: !0 } : (this._currentNode = e, { value: (
      /** @type {any} */
      e.content.type
    ), done: !1 });
  }
}
class is extends fn {
  constructor() {
    super(), this._prelimContent = [];
  }
  /**
   * @type {YXmlElement|YXmlText|null}
   */
  get firstChild() {
    const e = this._first;
    return e ? e.content.getContent()[0] : null;
  }
  /**
   * Integrate this type into the Yjs instance.
   *
   * * Save this struct in the os
   * * This type is sent to other client
   * * Observer functions are fired
   *
   * @param {Doc} y The Yjs instance
   * @param {Item} item
   */
  _integrate(e, n) {
    super._integrate(e, n), this.insert(
      0,
      /** @type {Array<any>} */
      this._prelimContent
    ), this._prelimContent = null;
  }
  _copy() {
    return new is();
  }
  /**
   * Makes a copy of this data type that can be included somewhere else.
   *
   * Note that the content is only readable _after_ it has been included somewhere in the Ydoc.
   *
   * @return {YXmlFragment}
   */
  clone() {
    const e = new is();
    return e.insert(0, this.toArray().map((n) => n instanceof fn ? n.clone() : n)), e;
  }
  get length() {
    return this.doc ?? Cn(), this._prelimContent === null ? this._length : this._prelimContent.length;
  }
  /**
   * Create a subtree of childNodes.
   *
   * @example
   * const walker = elem.createTreeWalker(dom => dom.nodeName === 'div')
   * for (let node in walker) {
   *   // `node` is a div node
   *   nop(node)
   * }
   *
   * @param {function(AbstractType<any>):boolean} filter Function that is called on each child element and
   *                          returns a Boolean indicating whether the child
   *                          is to be included in the subtree.
   * @return {YXmlTreeWalker} A subtree and a position within it.
   *
   * @public
   */
  createTreeWalker(e) {
    return new Tc(this, e);
  }
  /**
   * Returns the first YXmlElement that matches the query.
   * Similar to DOM's {@link querySelector}.
   *
   * Query support:
   *   - tagname
   * TODO:
   *   - id
   *   - attribute
   *
   * @param {CSS_Selector} query The query on the children.
   * @return {YXmlElement|YXmlText|YXmlHook|null} The first element that matches the query or null.
   *
   * @public
   */
  querySelector(e) {
    e = e.toUpperCase();
    const r = new Tc(this, (i) => i.nodeName && i.nodeName.toUpperCase() === e).next();
    return r.done ? null : r.value;
  }
  /**
   * Returns all YXmlElements that match the query.
   * Similar to Dom's {@link querySelectorAll}.
   *
   * @todo Does not yet support all queries. Currently only query by tagName.
   *
   * @param {CSS_Selector} query The query on the children
   * @return {Array<YXmlElement|YXmlText|YXmlHook|null>} The elements that match this query.
   *
   * @public
   */
  querySelectorAll(e) {
    return e = e.toUpperCase(), hi(new Tc(this, (n) => n.nodeName && n.nodeName.toUpperCase() === e));
  }
  /**
   * Creates YXmlEvent and calls observers.
   *
   * @param {Transaction} transaction
   * @param {Set<null|string>} parentSubs Keys changed on this type. `null` if list was modified.
   */
  _callObserver(e, n) {
    Ka(this, e, new F$(this, n, e));
  }
  /**
   * Get the string representation of all the children of this YXmlFragment.
   *
   * @return {string} The string representation of all children.
   */
  toString() {
    return Sm(this, (e) => e.toString()).join("");
  }
  /**
   * @return {string}
   */
  toJSON() {
    return this.toString();
  }
  /**
   * Creates a Dom Element that mirrors this YXmlElement.
   *
   * @param {Document} [_document=document] The document object (you must define
   *                                        this when calling this method in
   *                                        nodejs)
   * @param {Object<string, any>} [hooks={}] Optional property to customize how hooks
   *                                             are presented in the DOM
   * @param {any} [binding] You should not set this property. This is
   *                               used if DomBinding wants to create a
   *                               association to the created DOM type.
   * @return {Node} The {@link https://developer.mozilla.org/en-US/docs/Web/API/Element|Dom Element}
   *
   * @public
   */
  toDOM(e = document, n = {}, r) {
    const i = e.createDocumentFragment();
    return r !== void 0 && r._createAssociation(i, this), Uo(this, (s) => {
      i.insertBefore(s.toDOM(e, n, r), null);
    }), i;
  }
  /**
   * Inserts new content at an index.
   *
   * @example
   *  // Insert character 'a' at position 0
   *  xml.insert(0, [new Y.XmlText('text')])
   *
   * @param {number} index The index to insert content at
   * @param {Array<YXmlElement|YXmlText>} content The array of content
   */
  insert(e, n) {
    this.doc !== null ? Tt(this.doc, (r) => {
      $m(r, this, e, n);
    }) : this._prelimContent.splice(e, 0, ...n);
  }
  /**
   * Inserts new content at an index.
   *
   * @example
   *  // Insert character 'a' at position 0
   *  xml.insert(0, [new Y.XmlText('text')])
   *
   * @param {null|Item|YXmlElement|YXmlText} ref The index to insert content at
   * @param {Array<YXmlElement|YXmlText>} content The array of content
   */
  insertAfter(e, n) {
    if (this.doc !== null)
      Tt(this.doc, (r) => {
        const i = e && e instanceof fn ? e._item : e;
        ma(r, this, i, n);
      });
    else {
      const r = (
        /** @type {Array<any>} */
        this._prelimContent
      ), i = e === null ? 0 : r.findIndex((s) => s === e) + 1;
      if (i === 0 && e !== null)
        throw Bi("Reference item not found");
      r.splice(i, 0, ...n);
    }
  }
  /**
   * Deletes elements starting from an index.
   *
   * @param {number} index Index at which to start deleting elements
   * @param {number} [length=1] The number of elements to remove. Defaults to 1.
   */
  delete(e, n = 1) {
    this.doc !== null ? Tt(this.doc, (r) => {
      Em(r, this, e, n);
    }) : this._prelimContent.splice(e, n);
  }
  /**
   * Transforms this YArray to a JavaScript Array.
   *
   * @return {Array<YXmlElement|YXmlText|YXmlHook>}
   */
  toArray() {
    return _m(this);
  }
  /**
   * Appends content to this YArray.
   *
   * @param {Array<YXmlElement|YXmlText>} content Array of content to append.
   */
  push(e) {
    this.insert(this.length, e);
  }
  /**
   * Prepends content to this YArray.
   *
   * @param {Array<YXmlElement|YXmlText>} content Array of content to prepend.
   */
  unshift(e) {
    this.insert(0, e);
  }
  /**
   * Returns the i-th element from a YArray.
   *
   * @param {number} index The index of the element to return from the YArray
   * @return {YXmlElement|YXmlText}
   */
  get(e) {
    return xm(this, e);
  }
  /**
   * Returns a portion of this YXmlFragment into a JavaScript Array selected
   * from start to end (end not included).
   *
   * @param {number} [start]
   * @param {number} [end]
   * @return {Array<YXmlElement|YXmlText>}
   */
  slice(e = 0, n = this.length) {
    return wm(this, e, n);
  }
  /**
   * Executes a provided function on once on every child element.
   *
   * @param {function(YXmlElement|YXmlText,number, typeof self):void} f A function to execute on every element of this YArray.
   */
  forEach(e) {
    Uo(this, e);
  }
  /**
   * Transform the properties of this type to binary and write it to an
   * BinaryEncoder.
   *
   * This is called when this Item is sent to a remote peer.
   *
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder The encoder to write data to.
   */
  _write(e) {
    e.writeTypeRef(lE);
  }
}
const j$ = (t) => new is();
class Xs extends is {
  constructor(e = "UNDEFINED") {
    super(), this.nodeName = e, this._prelimAttrs = /* @__PURE__ */ new Map();
  }
  /**
   * @type {YXmlElement|YXmlText|null}
   */
  get nextSibling() {
    const e = this._item ? this._item.next : null;
    return e ? (
      /** @type {YXmlElement|YXmlText} */
      /** @type {ContentType} */
      e.content.type
    ) : null;
  }
  /**
   * @type {YXmlElement|YXmlText|null}
   */
  get prevSibling() {
    const e = this._item ? this._item.prev : null;
    return e ? (
      /** @type {YXmlElement|YXmlText} */
      /** @type {ContentType} */
      e.content.type
    ) : null;
  }
  /**
   * Integrate this type into the Yjs instance.
   *
   * * Save this struct in the os
   * * This type is sent to other client
   * * Observer functions are fired
   *
   * @param {Doc} y The Yjs instance
   * @param {Item} item
   */
  _integrate(e, n) {
    super._integrate(e, n), this._prelimAttrs.forEach((r, i) => {
      this.setAttribute(i, r);
    }), this._prelimAttrs = null;
  }
  /**
   * Creates an Item with the same effect as this Item (without position effect)
   *
   * @return {YXmlElement}
   */
  _copy() {
    return new Xs(this.nodeName);
  }
  /**
   * Makes a copy of this data type that can be included somewhere else.
   *
   * Note that the content is only readable _after_ it has been included somewhere in the Ydoc.
   *
   * @return {YXmlElement<KV>}
   */
  clone() {
    const e = new Xs(this.nodeName), n = this.getAttributes();
    return _C(n, (r, i) => {
      typeof r == "string" && e.setAttribute(i, r);
    }), e.insert(0, this.toArray().map((r) => r instanceof fn ? r.clone() : r)), e;
  }
  /**
   * Returns the XML serialization of this YXmlElement.
   * The attributes are ordered by attribute-name, so you can easily use this
   * method to compare YXmlElements
   *
   * @return {string} The string representation of this type.
   *
   * @public
   */
  toString() {
    const e = this.getAttributes(), n = [], r = [];
    for (const l in e)
      r.push(l);
    r.sort();
    const i = r.length;
    for (let l = 0; l < i; l++) {
      const a = r[l];
      n.push(a + '="' + e[a] + '"');
    }
    const s = this.nodeName.toLocaleLowerCase(), o = n.length > 0 ? " " + n.join(" ") : "";
    return `<${s}${o}>${super.toString()}</${s}>`;
  }
  /**
   * Removes an attribute from this YXmlElement.
   *
   * @param {string} attributeName The attribute name that is to be removed.
   *
   * @public
   */
  removeAttribute(e) {
    this.doc !== null ? Tt(this.doc, (n) => {
      va(n, this, e);
    }) : this._prelimAttrs.delete(e);
  }
  /**
   * Sets or updates an attribute.
   *
   * @template {keyof KV & string} KEY
   *
   * @param {KEY} attributeName The attribute name that is to be set.
   * @param {KV[KEY]} attributeValue The attribute value that is to be set.
   *
   * @public
   */
  setAttribute(e, n) {
    this.doc !== null ? Tt(this.doc, (r) => {
      Id(r, this, e, n);
    }) : this._prelimAttrs.set(e, n);
  }
  /**
   * Returns an attribute value that belongs to the attribute name.
   *
   * @template {keyof KV & string} KEY
   *
   * @param {KEY} attributeName The attribute name that identifies the
   *                               queried value.
   * @return {KV[KEY]|undefined} The queried attribute value.
   *
   * @public
   */
  getAttribute(e) {
    return (
      /** @type {any} */
      Od(this, e)
    );
  }
  /**
   * Returns whether an attribute exists
   *
   * @param {string} attributeName The attribute name to check for existence.
   * @return {boolean} whether the attribute exists.
   *
   * @public
   */
  hasAttribute(e) {
    return (
      /** @type {any} */
      Am(this, e)
    );
  }
  /**
   * Returns all attribute name/value pairs in a JSON Object.
   *
   * @param {Snapshot} [snapshot]
   * @return {{ [Key in Extract<keyof KV,string>]?: KV[Key]}} A JSON Object that describes the attributes.
   *
   * @public
   */
  getAttributes(e) {
    return (
      /** @type {any} */
      e ? O$(this, e) : Tm(this)
    );
  }
  /**
   * Creates a Dom Element that mirrors this YXmlElement.
   *
   * @param {Document} [_document=document] The document object (you must define
   *                                        this when calling this method in
   *                                        nodejs)
   * @param {Object<string, any>} [hooks={}] Optional property to customize how hooks
   *                                             are presented in the DOM
   * @param {any} [binding] You should not set this property. This is
   *                               used if DomBinding wants to create a
   *                               association to the created DOM type.
   * @return {Node} The {@link https://developer.mozilla.org/en-US/docs/Web/API/Element|Dom Element}
   *
   * @public
   */
  toDOM(e = document, n = {}, r) {
    const i = e.createElement(this.nodeName), s = this.getAttributes();
    for (const o in s) {
      const l = s[o];
      typeof l == "string" && i.setAttribute(o, l);
    }
    return Uo(this, (o) => {
      i.appendChild(o.toDOM(e, n, r));
    }), r !== void 0 && r._createAssociation(i, this), i;
  }
  /**
   * Transform the properties of this type to binary and write it to an
   * BinaryEncoder.
   *
   * This is called when this Item is sent to a remote peer.
   *
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder The encoder to write data to.
   */
  _write(e) {
    e.writeTypeRef(oE), e.writeKey(this.nodeName);
  }
}
const G$ = (t) => new Xs(t.readKey());
class F$ extends Ja {
  /**
   * @param {YXmlElement|YXmlText|YXmlFragment} target The target on which the event is created.
   * @param {Set<string|null>} subs The set of changed attributes. `null` is included if the
   *                   child list changed.
   * @param {Transaction} transaction The transaction instance with which the
   *                                  change was created.
   */
  constructor(e, n, r) {
    super(e, r), this.childListChanged = !1, this.attributesChanged = /* @__PURE__ */ new Set(), n.forEach((i) => {
      i === null ? this.childListChanged = !0 : this.attributesChanged.add(i);
    });
  }
}
class ya extends Ks {
  /**
   * @param {string} hookName nodeName of the Dom Node.
   */
  constructor(e) {
    super(), this.hookName = e;
  }
  /**
   * Creates an Item with the same effect as this Item (without position effect)
   */
  _copy() {
    return new ya(this.hookName);
  }
  /**
   * Makes a copy of this data type that can be included somewhere else.
   *
   * Note that the content is only readable _after_ it has been included somewhere in the Ydoc.
   *
   * @return {YXmlHook}
   */
  clone() {
    const e = new ya(this.hookName);
    return this.forEach((n, r) => {
      e.set(r, n);
    }), e;
  }
  /**
   * Creates a Dom Element that mirrors this YXmlElement.
   *
   * @param {Document} [_document=document] The document object (you must define
   *                                        this when calling this method in
   *                                        nodejs)
   * @param {Object.<string, any>} [hooks] Optional property to customize how hooks
   *                                             are presented in the DOM
   * @param {any} [binding] You should not set this property. This is
   *                               used if DomBinding wants to create a
   *                               association to the created DOM type
   * @return {Element} The {@link https://developer.mozilla.org/en-US/docs/Web/API/Element|Dom Element}
   *
   * @public
   */
  toDOM(e = document, n = {}, r) {
    const i = n[this.hookName];
    let s;
    return i !== void 0 ? s = i.createDom(this) : s = document.createElement(this.hookName), s.setAttribute("data-yjs-hook", this.hookName), r !== void 0 && r._createAssociation(s, this), s;
  }
  /**
   * Transform the properties of this type to binary and write it to an
   * BinaryEncoder.
   *
   * This is called when this Item is sent to a remote peer.
   *
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder The encoder to write data to.
   */
  _write(e) {
    e.writeTypeRef(aE), e.writeKey(this.hookName);
  }
}
const V$ = (t) => new ya(t.readKey());
class ba extends Ys {
  /**
   * @type {YXmlElement|YXmlText|null}
   */
  get nextSibling() {
    const e = this._item ? this._item.next : null;
    return e ? (
      /** @type {YXmlElement|YXmlText} */
      /** @type {ContentType} */
      e.content.type
    ) : null;
  }
  /**
   * @type {YXmlElement|YXmlText|null}
   */
  get prevSibling() {
    const e = this._item ? this._item.prev : null;
    return e ? (
      /** @type {YXmlElement|YXmlText} */
      /** @type {ContentType} */
      e.content.type
    ) : null;
  }
  _copy() {
    return new ba();
  }
  /**
   * Makes a copy of this data type that can be included somewhere else.
   *
   * Note that the content is only readable _after_ it has been included somewhere in the Ydoc.
   *
   * @return {YXmlText}
   */
  clone() {
    const e = new ba();
    return e.applyDelta(this.toDelta()), e;
  }
  /**
   * Creates a Dom Element that mirrors this YXmlText.
   *
   * @param {Document} [_document=document] The document object (you must define
   *                                        this when calling this method in
   *                                        nodejs)
   * @param {Object<string, any>} [hooks] Optional property to customize how hooks
   *                                             are presented in the DOM
   * @param {any} [binding] You should not set this property. This is
   *                               used if DomBinding wants to create a
   *                               association to the created DOM type.
   * @return {Text} The {@link https://developer.mozilla.org/en-US/docs/Web/API/Element|Dom Element}
   *
   * @public
   */
  toDOM(e = document, n, r) {
    const i = e.createTextNode(this.toString());
    return r !== void 0 && r._createAssociation(i, this), i;
  }
  toString() {
    return this.toDelta().map((e) => {
      const n = [];
      for (const i in e.attributes) {
        const s = [];
        for (const o in e.attributes[i])
          s.push({ key: o, value: e.attributes[i][o] });
        s.sort((o, l) => o.key < l.key ? -1 : 1), n.push({ nodeName: i, attrs: s });
      }
      n.sort((i, s) => i.nodeName < s.nodeName ? -1 : 1);
      let r = "";
      for (let i = 0; i < n.length; i++) {
        const s = n[i];
        r += `<${s.nodeName}`;
        for (let o = 0; o < s.attrs.length; o++) {
          const l = s.attrs[o];
          r += ` ${l.key}="${l.value}"`;
        }
        r += ">";
      }
      r += e.insert;
      for (let i = n.length - 1; i >= 0; i--)
        r += `</${n[i].nodeName}>`;
      return r;
    }).join("");
  }
  /**
   * @return {string}
   */
  toJSON() {
    return this.toString();
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   */
  _write(e) {
    e.writeTypeRef(cE);
  }
}
const H$ = (t) => new ba();
class Dd {
  /**
   * @param {ID} id
   * @param {number} length
   */
  constructor(e, n) {
    this.id = e, this.length = n;
  }
  /**
   * @type {boolean}
   */
  get deleted() {
    throw Gr();
  }
  /**
   * Merge this struct with the item to the right.
   * This method is already assuming that `this.id.clock + this.length === this.id.clock`.
   * Also this method does *not* remove right from StructStore!
   * @param {AbstractStruct} right
   * @return {boolean} whether this merged with right
   */
  mergeWith(e) {
    return !1;
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder The encoder to write data to.
   * @param {number} offset
   * @param {number} encodingRef
   */
  write(e, n, r) {
    throw Gr();
  }
  /**
   * @param {Transaction} transaction
   * @param {number} offset
   */
  integrate(e, n) {
    throw Gr();
  }
}
const z$ = 0;
class hr extends Dd {
  get deleted() {
    return !0;
  }
  delete() {
  }
  /**
   * @param {GC} right
   * @return {boolean}
   */
  mergeWith(e) {
    return this.constructor !== e.constructor ? !1 : (this.length += e.length, !0);
  }
  /**
   * @param {Transaction} transaction
   * @param {number} offset
   */
  integrate(e, n) {
    n > 0 && (this.id.clock += n, this.length -= n), gm(e.doc.store, this);
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    e.writeInfo(z$), e.writeLen(this.length - n);
  }
  /**
   * @param {Transaction} transaction
   * @param {StructStore} store
   * @return {null | number}
   */
  getMissing(e, n) {
    return null;
  }
}
class rl {
  /**
   * @param {Uint8Array} content
   */
  constructor(e) {
    this.content = e;
  }
  /**
   * @return {number}
   */
  getLength() {
    return 1;
  }
  /**
   * @return {Array<any>}
   */
  getContent() {
    return [this.content];
  }
  /**
   * @return {boolean}
   */
  isCountable() {
    return !0;
  }
  /**
   * @return {ContentBinary}
   */
  copy() {
    return new rl(this.content);
  }
  /**
   * @param {number} offset
   * @return {ContentBinary}
   */
  splice(e) {
    throw Gr();
  }
  /**
   * @param {ContentBinary} right
   * @return {boolean}
   */
  mergeWith(e) {
    return !1;
  }
  /**
   * @param {Transaction} transaction
   * @param {Item} item
   */
  integrate(e, n) {
  }
  /**
   * @param {Transaction} transaction
   */
  delete(e) {
  }
  /**
   * @param {StructStore} store
   */
  gc(e) {
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    e.writeBuf(this.content);
  }
  /**
   * @return {number}
   */
  getRef() {
    return 3;
  }
}
const W$ = (t) => new rl(t.readBuf());
class jo {
  /**
   * @param {number} len
   */
  constructor(e) {
    this.len = e;
  }
  /**
   * @return {number}
   */
  getLength() {
    return this.len;
  }
  /**
   * @return {Array<any>}
   */
  getContent() {
    return [];
  }
  /**
   * @return {boolean}
   */
  isCountable() {
    return !1;
  }
  /**
   * @return {ContentDeleted}
   */
  copy() {
    return new jo(this.len);
  }
  /**
   * @param {number} offset
   * @return {ContentDeleted}
   */
  splice(e) {
    const n = new jo(this.len - e);
    return this.len = e, n;
  }
  /**
   * @param {ContentDeleted} right
   * @return {boolean}
   */
  mergeWith(e) {
    return this.len += e.len, !0;
  }
  /**
   * @param {Transaction} transaction
   * @param {Item} item
   */
  integrate(e, n) {
    ga(e.deleteSet, n.id.client, n.id.clock, this.len), n.markDeleted();
  }
  /**
   * @param {Transaction} transaction
   */
  delete(e) {
  }
  /**
   * @param {StructStore} store
   */
  gc(e) {
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    e.writeLen(this.len - n);
  }
  /**
   * @return {number}
   */
  getRef() {
    return 1;
  }
}
const J$ = (t) => new jo(t.readLen()), Lm = (t, e) => new ns({ guid: t, ...e, shouldLoad: e.shouldLoad || e.autoLoad || !1 });
class il {
  /**
   * @param {Doc} doc
   */
  constructor(e) {
    e._item && console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."), this.doc = e;
    const n = {};
    this.opts = n, e.gc || (n.gc = !1), e.autoLoad && (n.autoLoad = !0), e.meta !== null && (n.meta = e.meta);
  }
  /**
   * @return {number}
   */
  getLength() {
    return 1;
  }
  /**
   * @return {Array<any>}
   */
  getContent() {
    return [this.doc];
  }
  /**
   * @return {boolean}
   */
  isCountable() {
    return !0;
  }
  /**
   * @return {ContentDoc}
   */
  copy() {
    return new il(Lm(this.doc.guid, this.opts));
  }
  /**
   * @param {number} offset
   * @return {ContentDoc}
   */
  splice(e) {
    throw Gr();
  }
  /**
   * @param {ContentDoc} right
   * @return {boolean}
   */
  mergeWith(e) {
    return !1;
  }
  /**
   * @param {Transaction} transaction
   * @param {Item} item
   */
  integrate(e, n) {
    this.doc._item = n, e.subdocsAdded.add(this.doc), this.doc.shouldLoad && e.subdocsLoaded.add(this.doc);
  }
  /**
   * @param {Transaction} transaction
   */
  delete(e) {
    e.subdocsAdded.has(this.doc) ? e.subdocsAdded.delete(this.doc) : e.subdocsRemoved.add(this.doc);
  }
  /**
   * @param {StructStore} store
   */
  gc(e) {
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    e.writeString(this.doc.guid), e.writeAny(this.opts);
  }
  /**
   * @return {number}
   */
  getRef() {
    return 9;
  }
}
const Q$ = (t) => new il(Lm(t.readString(), t.readAny()));
class hs {
  /**
   * @param {Object} embed
   */
  constructor(e) {
    this.embed = e;
  }
  /**
   * @return {number}
   */
  getLength() {
    return 1;
  }
  /**
   * @return {Array<any>}
   */
  getContent() {
    return [this.embed];
  }
  /**
   * @return {boolean}
   */
  isCountable() {
    return !0;
  }
  /**
   * @return {ContentEmbed}
   */
  copy() {
    return new hs(this.embed);
  }
  /**
   * @param {number} offset
   * @return {ContentEmbed}
   */
  splice(e) {
    throw Gr();
  }
  /**
   * @param {ContentEmbed} right
   * @return {boolean}
   */
  mergeWith(e) {
    return !1;
  }
  /**
   * @param {Transaction} transaction
   * @param {Item} item
   */
  integrate(e, n) {
  }
  /**
   * @param {Transaction} transaction
   */
  delete(e) {
  }
  /**
   * @param {StructStore} store
   */
  gc(e) {
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    e.writeJSON(this.embed);
  }
  /**
   * @return {number}
   */
  getRef() {
    return 5;
  }
}
const K$ = (t) => new hs(t.readJSON());
class en {
  /**
   * @param {string} key
   * @param {Object} value
   */
  constructor(e, n) {
    this.key = e, this.value = n;
  }
  /**
   * @return {number}
   */
  getLength() {
    return 1;
  }
  /**
   * @return {Array<any>}
   */
  getContent() {
    return [];
  }
  /**
   * @return {boolean}
   */
  isCountable() {
    return !1;
  }
  /**
   * @return {ContentFormat}
   */
  copy() {
    return new en(this.key, this.value);
  }
  /**
   * @param {number} _offset
   * @return {ContentFormat}
   */
  splice(e) {
    throw Gr();
  }
  /**
   * @param {ContentFormat} _right
   * @return {boolean}
   */
  mergeWith(e) {
    return !1;
  }
  /**
   * @param {Transaction} _transaction
   * @param {Item} item
   */
  integrate(e, n) {
    const r = (
      /** @type {YText} */
      n.parent
    );
    r._searchMarker = null, r._hasFormatting = !0;
  }
  /**
   * @param {Transaction} transaction
   */
  delete(e) {
  }
  /**
   * @param {StructStore} store
   */
  gc(e) {
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    e.writeKey(this.key), e.writeJSON(this.value);
  }
  /**
   * @return {number}
   */
  getRef() {
    return 6;
  }
}
const Y$ = (t) => new en(t.readKey(), t.readJSON());
class wa {
  /**
   * @param {Array<any>} arr
   */
  constructor(e) {
    this.arr = e;
  }
  /**
   * @return {number}
   */
  getLength() {
    return this.arr.length;
  }
  /**
   * @return {Array<any>}
   */
  getContent() {
    return this.arr;
  }
  /**
   * @return {boolean}
   */
  isCountable() {
    return !0;
  }
  /**
   * @return {ContentJSON}
   */
  copy() {
    return new wa(this.arr);
  }
  /**
   * @param {number} offset
   * @return {ContentJSON}
   */
  splice(e) {
    const n = new wa(this.arr.slice(e));
    return this.arr = this.arr.slice(0, e), n;
  }
  /**
   * @param {ContentJSON} right
   * @return {boolean}
   */
  mergeWith(e) {
    return this.arr = this.arr.concat(e.arr), !0;
  }
  /**
   * @param {Transaction} transaction
   * @param {Item} item
   */
  integrate(e, n) {
  }
  /**
   * @param {Transaction} transaction
   */
  delete(e) {
  }
  /**
   * @param {StructStore} store
   */
  gc(e) {
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    const r = this.arr.length;
    e.writeLen(r - n);
    for (let i = n; i < r; i++) {
      const s = this.arr[i];
      e.writeString(s === void 0 ? "undefined" : JSON.stringify(s));
    }
  }
  /**
   * @return {number}
   */
  getRef() {
    return 2;
  }
}
const X$ = (t) => {
  const e = t.readLen(), n = [];
  for (let r = 0; r < e; r++) {
    const i = t.readString();
    i === "undefined" ? n.push(void 0) : n.push(JSON.parse(i));
  }
  return new wa(n);
}, Z$ = fa("node_env") === "development";
class ss {
  /**
   * @param {Array<any>} arr
   */
  constructor(e) {
    this.arr = e, Z$ && Wp(e);
  }
  /**
   * @return {number}
   */
  getLength() {
    return this.arr.length;
  }
  /**
   * @return {Array<any>}
   */
  getContent() {
    return this.arr;
  }
  /**
   * @return {boolean}
   */
  isCountable() {
    return !0;
  }
  /**
   * @return {ContentAny}
   */
  copy() {
    return new ss(this.arr);
  }
  /**
   * @param {number} offset
   * @return {ContentAny}
   */
  splice(e) {
    const n = new ss(this.arr.slice(e));
    return this.arr = this.arr.slice(0, e), n;
  }
  /**
   * @param {ContentAny} right
   * @return {boolean}
   */
  mergeWith(e) {
    return this.arr = this.arr.concat(e.arr), !0;
  }
  /**
   * @param {Transaction} transaction
   * @param {Item} item
   */
  integrate(e, n) {
  }
  /**
   * @param {Transaction} transaction
   */
  delete(e) {
  }
  /**
   * @param {StructStore} store
   */
  gc(e) {
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    const r = this.arr.length;
    e.writeLen(r - n);
    for (let i = n; i < r; i++) {
      const s = this.arr[i];
      e.writeAny(s);
    }
  }
  /**
   * @return {number}
   */
  getRef() {
    return 8;
  }
}
const eE = (t) => {
  const e = t.readLen(), n = [];
  for (let r = 0; r < e; r++)
    n.push(t.readAny());
  return new ss(n);
};
class Hr {
  /**
   * @param {string} str
   */
  constructor(e) {
    this.str = e;
  }
  /**
   * @return {number}
   */
  getLength() {
    return this.str.length;
  }
  /**
   * @return {Array<any>}
   */
  getContent() {
    return this.str.split("");
  }
  /**
   * @return {boolean}
   */
  isCountable() {
    return !0;
  }
  /**
   * @return {ContentString}
   */
  copy() {
    return new Hr(this.str);
  }
  /**
   * @param {number} offset
   * @return {ContentString}
   */
  splice(e) {
    const n = new Hr(this.str.slice(e));
    this.str = this.str.slice(0, e);
    const r = this.str.charCodeAt(e - 1);
    return r >= 55296 && r <= 56319 && (this.str = this.str.slice(0, e - 1) + "ï¿½", n.str = "ï¿½" + n.str.slice(1)), n;
  }
  /**
   * @param {ContentString} right
   * @return {boolean}
   */
  mergeWith(e) {
    return this.str += e.str, !0;
  }
  /**
   * @param {Transaction} transaction
   * @param {Item} item
   */
  integrate(e, n) {
  }
  /**
   * @param {Transaction} transaction
   */
  delete(e) {
  }
  /**
   * @param {StructStore} store
   */
  gc(e) {
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    e.writeString(n === 0 ? this.str : this.str.slice(n));
  }
  /**
   * @return {number}
   */
  getRef() {
    return 4;
  }
}
const tE = (t) => new Hr(t.readString()), nE = [
  L$,
  P$,
  U$,
  G$,
  j$,
  V$,
  H$
], rE = 0, iE = 1, sE = 2, oE = 3, lE = 4, aE = 5, cE = 6;
class Jr {
  /**
   * @param {AbstractType<any>} type
   */
  constructor(e) {
    this.type = e;
  }
  /**
   * @return {number}
   */
  getLength() {
    return 1;
  }
  /**
   * @return {Array<any>}
   */
  getContent() {
    return [this.type];
  }
  /**
   * @return {boolean}
   */
  isCountable() {
    return !0;
  }
  /**
   * @return {ContentType}
   */
  copy() {
    return new Jr(this.type._copy());
  }
  /**
   * @param {number} offset
   * @return {ContentType}
   */
  splice(e) {
    throw Gr();
  }
  /**
   * @param {ContentType} right
   * @return {boolean}
   */
  mergeWith(e) {
    return !1;
  }
  /**
   * @param {Transaction} transaction
   * @param {Item} item
   */
  integrate(e, n) {
    this.type._integrate(e.doc, n);
  }
  /**
   * @param {Transaction} transaction
   */
  delete(e) {
    let n = this.type._start;
    for (; n !== null; )
      n.deleted ? n.id.clock < (e.beforeState.get(n.id.client) || 0) && e._mergeStructs.push(n) : n.delete(e), n = n.right;
    this.type._map.forEach((r) => {
      r.deleted ? r.id.clock < (e.beforeState.get(r.id.client) || 0) && e._mergeStructs.push(r) : r.delete(e);
    }), e.changed.delete(this.type);
  }
  /**
   * @param {StructStore} store
   */
  gc(e) {
    let n = this.type._start;
    for (; n !== null; )
      n.gc(e, !0), n = n.right;
    this.type._start = null, this.type._map.forEach(
      /** @param {Item | null} item */
      (r) => {
        for (; r !== null; )
          r.gc(e, !0), r = r.left;
      }
    ), this.type._map = /* @__PURE__ */ new Map();
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    this.type._write(e);
  }
  /**
   * @return {number}
   */
  getRef() {
    return 7;
  }
}
const uE = (t) => new Jr(nE[t.readTypeRef()](t)), vf = (t, e) => {
  let n = e, r = 0, i;
  do
    r > 0 && (n = ze(n.client, n.clock + r)), i = Rs(t, n), r = n.clock - i.id.clock, n = i.redone;
  while (n !== null && i instanceof Yt);
  return {
    item: i,
    diff: r
  };
}, _a = (t, e, n) => {
  const { client: r, clock: i } = e.id, s = new Yt(
    ze(r, i + n),
    e,
    ze(r, i + n - 1),
    e.right,
    e.rightOrigin,
    e.parent,
    e.parentSub,
    e.content.splice(n)
  );
  return e.deleted && s.markDeleted(), e.keep && (s.keep = !0), e.redone !== null && (s.redone = ze(e.redone.client, e.redone.clock + n)), e.right = s, s.right !== null && (s.right.left = s), t._mergeStructs.push(s), s.parentSub !== null && s.right === null && s.parent._map.set(s.parentSub, s), e.length = n, s;
};
let Yt = class bu extends Dd {
  /**
   * @param {ID} id
   * @param {Item | null} left
   * @param {ID | null} origin
   * @param {Item | null} right
   * @param {ID | null} rightOrigin
   * @param {AbstractType<any>|ID|null} parent Is a type if integrated, is null if it is possible to copy parent from left or right, is ID before integration to search for it.
   * @param {string | null} parentSub
   * @param {AbstractContent} content
   */
  constructor(e, n, r, i, s, o, l, a) {
    super(e, a.getLength()), this.origin = r, this.left = n, this.right = i, this.rightOrigin = s, this.parent = o, this.parentSub = l, this.redone = null, this.content = a, this.info = this.content.isCountable() ? Vh : 0;
  }
  /**
   * This is used to mark the item as an indexed fast-search marker
   *
   * @type {boolean}
   */
  set marker(e) {
    (this.info & Sc) > 0 !== e && (this.info ^= Sc);
  }
  get marker() {
    return (this.info & Sc) > 0;
  }
  /**
   * If true, do not garbage collect this Item.
   */
  get keep() {
    return (this.info & Fh) > 0;
  }
  set keep(e) {
    this.keep !== e && (this.info ^= Fh);
  }
  get countable() {
    return (this.info & Vh) > 0;
  }
  /**
   * Whether this item was deleted or not.
   * @type {Boolean}
   */
  get deleted() {
    return (this.info & _c) > 0;
  }
  set deleted(e) {
    this.deleted !== e && (this.info ^= _c);
  }
  markDeleted() {
    this.info |= _c;
  }
  /**
   * Return the creator clientID of the missing op or define missing items and return null.
   *
   * @param {Transaction} transaction
   * @param {StructStore} store
   * @return {null | number}
   */
  getMissing(e, n) {
    if (this.origin && this.origin.client !== this.id.client && this.origin.clock >= Bt(n, this.origin.client))
      return this.origin.client;
    if (this.rightOrigin && this.rightOrigin.client !== this.id.client && this.rightOrigin.clock >= Bt(n, this.rightOrigin.client))
      return this.rightOrigin.client;
    if (this.parent && this.parent.constructor === Ps && this.id.client !== this.parent.client && this.parent.clock >= Bt(n, this.parent.client))
      return this.parent.client;
    if (this.origin && (this.left = uf(e, n, this.origin), this.origin = this.left.lastId), this.rightOrigin && (this.right = Ui(e, this.rightOrigin), this.rightOrigin = this.right.id), this.left && this.left.constructor === hr || this.right && this.right.constructor === hr)
      this.parent = null;
    else if (!this.parent)
      this.left && this.left.constructor === bu ? (this.parent = this.left.parent, this.parentSub = this.left.parentSub) : this.right && this.right.constructor === bu && (this.parent = this.right.parent, this.parentSub = this.right.parentSub);
    else if (this.parent.constructor === Ps) {
      const r = Rs(n, this.parent);
      r.constructor === hr ? this.parent = null : this.parent = /** @type {ContentType} */
      r.content.type;
    }
    return null;
  }
  /**
   * @param {Transaction} transaction
   * @param {number} offset
   */
  integrate(e, n) {
    if (n > 0 && (this.id.clock += n, this.left = uf(e, e.doc.store, ze(this.id.client, this.id.clock - 1)), this.origin = this.left.lastId, this.content = this.content.splice(n), this.length -= n), this.parent) {
      if (!this.left && (!this.right || this.right.left !== null) || this.left && this.left.right !== this.right) {
        let r = this.left, i;
        if (r !== null)
          i = r.right;
        else if (this.parentSub !== null)
          for (i = /** @type {AbstractType<any>} */
          this.parent._map.get(this.parentSub) || null; i !== null && i.left !== null; )
            i = i.left;
        else
          i = /** @type {AbstractType<any>} */
          this.parent._start;
        const s = /* @__PURE__ */ new Set(), o = /* @__PURE__ */ new Set();
        for (; i !== null && i !== this.right; ) {
          if (o.add(i), s.add(i), Os(this.origin, i.origin)) {
            if (i.id.client < this.id.client)
              r = i, s.clear();
            else if (Os(this.rightOrigin, i.rightOrigin))
              break;
          } else if (i.origin !== null && o.has(Rs(e.doc.store, i.origin)))
            s.has(Rs(e.doc.store, i.origin)) || (r = i, s.clear());
          else
            break;
          i = i.right;
        }
        this.left = r;
      }
      if (this.left !== null) {
        const r = this.left.right;
        this.right = r, this.left.right = this;
      } else {
        let r;
        if (this.parentSub !== null)
          for (r = /** @type {AbstractType<any>} */
          this.parent._map.get(this.parentSub) || null; r !== null && r.left !== null; )
            r = r.left;
        else
          r = /** @type {AbstractType<any>} */
          this.parent._start, this.parent._start = this;
        this.right = r;
      }
      this.right !== null ? this.right.left = this : this.parentSub !== null && (this.parent._map.set(this.parentSub, this), this.left !== null && this.left.delete(e)), this.parentSub === null && this.countable && !this.deleted && (this.parent._length += this.length), gm(e.doc.store, this), this.content.integrate(e, this), hf(
        e,
        /** @type {AbstractType<any>} */
        this.parent,
        this.parentSub
      ), /** @type {AbstractType<any>} */
      (this.parent._item !== null && /** @type {AbstractType<any>} */
      this.parent._item.deleted || this.parentSub !== null && this.right !== null) && this.delete(e);
    } else
      new hr(this.id, this.length).integrate(e, 0);
  }
  /**
   * Returns the next non-deleted item
   */
  get next() {
    let e = this.right;
    for (; e !== null && e.deleted; )
      e = e.right;
    return e;
  }
  /**
   * Returns the previous non-deleted item
   */
  get prev() {
    let e = this.left;
    for (; e !== null && e.deleted; )
      e = e.left;
    return e;
  }
  /**
   * Computes the last content address of this Item.
   */
  get lastId() {
    return this.length === 1 ? this.id : ze(this.id.client, this.id.clock + this.length - 1);
  }
  /**
   * Try to merge two items
   *
   * @param {Item} right
   * @return {boolean}
   */
  mergeWith(e) {
    if (this.constructor === e.constructor && Os(e.origin, this.lastId) && this.right === e && Os(this.rightOrigin, e.rightOrigin) && this.id.client === e.id.client && this.id.clock + this.length === e.id.clock && this.deleted === e.deleted && this.redone === null && e.redone === null && this.content.constructor === e.content.constructor && this.content.mergeWith(e.content)) {
      const n = (
        /** @type {AbstractType<any>} */
        this.parent._searchMarker
      );
      return n && n.forEach((r) => {
        r.p === e && (r.p = this, !this.deleted && this.countable && (r.index -= this.length));
      }), e.keep && (this.keep = !0), this.right = e.right, this.right !== null && (this.right.left = this), this.length += e.length, !0;
    }
    return !1;
  }
  /**
   * Mark this Item as deleted.
   *
   * @param {Transaction} transaction
   */
  delete(e) {
    if (!this.deleted) {
      const n = (
        /** @type {AbstractType<any>} */
        this.parent
      );
      this.countable && this.parentSub === null && (n._length -= this.length), this.markDeleted(), ga(e.deleteSet, this.id.client, this.id.clock, this.length), hf(e, n, this.parentSub), this.content.delete(e);
    }
  }
  /**
   * @param {StructStore} store
   * @param {boolean} parentGCd
   */
  gc(e, n) {
    if (!this.deleted)
      throw Ar();
    this.content.gc(e), n ? p$(e, this, new hr(this.id, this.length)) : this.content = new jo(this.length);
  }
  /**
   * Transform the properties of this type to binary and write it to an
   * BinaryEncoder.
   *
   * This is called when this Item is sent to a remote peer.
   *
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder The encoder to write data to.
   * @param {number} offset
   */
  write(e, n) {
    const r = n > 0 ? ze(this.id.client, this.id.clock + n - 1) : this.origin, i = this.rightOrigin, s = this.parentSub, o = this.content.getRef() & Va | (r === null ? 0 : Xn) | // origin is defined
    (i === null ? 0 : ci) | // right origin is defined
    (s === null ? 0 : No);
    if (e.writeInfo(o), r !== null && e.writeLeftID(r), i !== null && e.writeRightID(i), r === null && i === null) {
      const l = (
        /** @type {AbstractType<any>} */
        this.parent
      );
      if (l._item !== void 0) {
        const a = l._item;
        if (a === null) {
          const c = dm(l);
          e.writeParentInfo(!0), e.writeString(c);
        } else
          e.writeParentInfo(!1), e.writeLeftID(a.id);
      } else l.constructor === String ? (e.writeParentInfo(!0), e.writeString(l)) : l.constructor === Ps ? (e.writeParentInfo(!1), e.writeLeftID(l)) : Ar();
      s !== null && e.writeString(s);
    }
    this.content.write(e, n);
  }
};
const Nm = (t, e) => dE[e & Va](t), dE = [
  () => {
    Ar();
  },
  // GC is not ItemContent
  J$,
  // 1
  X$,
  // 2
  W$,
  // 3
  tE,
  // 4
  K$,
  // 5
  Y$,
  // 6
  uE,
  // 7
  eE,
  // 8
  Q$,
  // 9
  () => {
    Ar();
  }
  // 10 - Skip is not ItemContent
], hE = 10;
class fr extends Dd {
  get deleted() {
    return !0;
  }
  delete() {
  }
  /**
   * @param {Skip} right
   * @return {boolean}
   */
  mergeWith(e) {
    return this.constructor !== e.constructor ? !1 : (this.length += e.length, !0);
  }
  /**
   * @param {Transaction} transaction
   * @param {number} offset
   */
  integrate(e, n) {
    Ar();
  }
  /**
   * @param {UpdateEncoderV1 | UpdateEncoderV2} encoder
   * @param {number} offset
   */
  write(e, n) {
    e.writeInfo(hE), Ne(e.restEncoder, this.length - n);
  }
  /**
   * @param {Transaction} transaction
   * @param {StructStore} store
   * @return {null | number}
   */
  getMissing(e, n) {
    return null;
  }
}
const Pm = (
  /** @type {any} */
  typeof globalThis < "u" ? globalThis : typeof window < "u" || typeof window < "u" ? window : {}
), Rm = "__ $YJS$ __";
Pm[Rm] === !0 && console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438");
Pm[Rm] = !0;
const Tl = (t, e, n, r, i) => {
  try {
    if (e && e.cursor && n !== r.clientID) {
      const s = e.user || {}, o = s.color || "#ffa500", l = s.name || `User: ${n}`;
      t.createCursor(n.toString(), l, o);
      const a = af(of(e.cursor.anchor), r), c = af(of(e.cursor.head), r);
      a && c && a.type === i && t.moveCursor(n.toString(), { index: a.index, length: c.index - a.index });
    } else
      t.removeCursor(n.toString());
  } catch (s) {
    console.error(s);
  }
};
class fE {
  /**
   * @param {Y.Text} type
   * @param {any} quill
   * @param {Awareness} [awareness]
   */
  constructor(e, n, r) {
    const i = (
      /** @type {Y.Doc} */
      e.doc
    );
    this.type = e, this.doc = i, this.quill = n;
    const s = n.getModule("cursors") || null;
    this.quillCursors = s, this._negatedUsedFormats = {}, this.awareness = r, this._awarenessChange = ({ added: o, removed: l, updated: a }) => {
      const c = (
        /** @type {Awareness} */
        r.getStates()
      );
      o.forEach((u) => {
        Tl(s, c.get(u), u, i, e);
      }), a.forEach((u) => {
        Tl(s, c.get(u), u, i, e);
      }), l.forEach((u) => {
        s.removeCursor(u.toString());
      });
    }, this._typeObserver = (o) => {
      if (o.transaction.origin !== this) {
        const l = o.delta, a = [];
        for (let c = 0; c < l.length; c++) {
          const u = l[c];
          u.insert !== void 0 ? a.push(Object.assign({}, u, { attributes: Object.assign({}, this._negatedUsedFormats, u.attributes || {}) })) : a.push(u);
        }
        n.updateContents(a, this);
      }
    }, e.observe(this._typeObserver), this._quillObserver = (o, l, a, c) => {
      if (l && l.ops) {
        const u = l.ops;
        u.forEach((d) => {
          if (d.attributes !== void 0)
            for (const f in d.attributes)
              this._negatedUsedFormats[f] === void 0 && (this._negatedUsedFormats[f] = !1);
        }), c !== this && i.transact(() => {
          e.applyDelta(u);
        }, this);
      }
      if (r && s) {
        const u = n.getSelection(), d = (
          /** @type {any} */
          r.getLocalState()
        );
        if (u === null)
          r.getLocalState() !== null && r.setLocalStateField(
            "cursor",
            /** @type {any} */
            null
          );
        else {
          const f = lf(e, u.index), g = lf(e, u.index + u.length);
          (!d || !d.cursor || !cf(f, d.cursor.anchor) || !cf(g, d.cursor.head)) && r.setLocalStateField("cursor", {
            anchor: f,
            head: g
          });
        }
        r.getStates().forEach((f, g) => {
          Tl(s, f, g, i, e);
        });
      }
    }, n.on("editor-change", this._quillObserver), n.setContents(e.toDelta(), this), s !== null && r && (r.getStates().forEach((o, l) => {
      Tl(s, o, l, i, e);
    }), r.on("change", this._awarenessChange));
  }
  destroy() {
    this.type.unobserve(this._typeObserver), this.quill.off("editor-change", this._quillObserver), this.awareness && this.awareness.off("change", this._awarenessChange);
  }
}
const Ac = 3e4;
class gE extends Ux {
  /**
   * @param {Y.Doc} doc
   */
  constructor(e) {
    super(), this.doc = e, this.clientID = e.clientID, this.states = /* @__PURE__ */ new Map(), this.meta = /* @__PURE__ */ new Map(), this._checkInterval = /** @type {any} */
    setInterval(() => {
      const n = ha();
      this.getLocalState() !== null && Ac / 2 <= n - /** @type {{lastUpdated:number}} */
      this.meta.get(this.clientID).lastUpdated && this.setLocalState(this.getLocalState());
      const r = [];
      this.meta.forEach((i, s) => {
        s !== this.clientID && Ac <= n - i.lastUpdated && this.states.has(s) && r.push(s);
      }), r.length > 0 && pE(this, r, "timeout");
    }, fi(Ac / 10)), e.on("destroy", () => {
      this.destroy();
    }), this.setLocalState({});
  }
  destroy() {
    this.emit("destroy", [this]), this.setLocalState(null), super.destroy(), clearInterval(this._checkInterval);
  }
  /**
   * @return {Object<string,any>|null}
   */
  getLocalState() {
    return this.states.get(this.clientID) || null;
  }
  /**
   * @param {Object<string,any>|null} state
   */
  setLocalState(e) {
    const n = this.clientID, r = this.meta.get(n), i = r === void 0 ? 0 : r.clock + 1, s = this.states.get(n);
    e === null ? this.states.delete(n) : this.states.set(n, e), this.meta.set(n, {
      clock: i,
      lastUpdated: ha()
    });
    const o = [], l = [], a = [], c = [];
    e === null ? c.push(n) : s == null ? e != null && o.push(n) : (l.push(n), Co(s, e) || a.push(n)), (o.length > 0 || a.length > 0 || c.length > 0) && this.emit("change", [{ added: o, updated: a, removed: c }, "local"]), this.emit("update", [{ added: o, updated: l, removed: c }, "local"]);
  }
  /**
   * @param {string} field
   * @param {any} value
   */
  setLocalStateField(e, n) {
    const r = this.getLocalState();
    r !== null && this.setLocalState({
      ...r,
      [e]: n
    });
  }
  /**
   * @return {Map<number,Object<string,any>>}
   */
  getStates() {
    return this.states;
  }
}
const pE = (t, e, n) => {
  const r = [];
  for (let i = 0; i < e.length; i++) {
    const s = e[i];
    if (t.states.has(s)) {
      if (t.states.delete(s), s === t.clientID) {
        const o = (
          /** @type {MetaClientState} */
          t.meta.get(s)
        );
        t.meta.set(s, {
          clock: o.clock + 1,
          lastUpdated: ha()
        });
      }
      r.push(s);
    }
  }
  r.length > 0 && (t.emit("change", [{ added: [], updated: [], removed: r }, n]), t.emit("update", [{ added: [], updated: [], removed: r }, n]));
}, Fl = (t, e, n = t.states) => {
  const r = e.length, i = ts();
  Ne(i, r);
  for (let s = 0; s < r; s++) {
    const o = e[s], l = n.get(o) || null, a = (
      /** @type {MetaClientState} */
      t.meta.get(o).clock
    );
    Ne(i, o), Ne(i, a), Yi(i, JSON.stringify(l));
  }
  return Qn(i);
}, mE = (t, e, n) => {
  const r = Gi(e), i = ha(), s = [], o = [], l = [], a = [], c = Me(r);
  for (let u = 0; u < c; u++) {
    const d = Me(r);
    let f = Me(r);
    const g = JSON.parse(Pi(r)), p = t.meta.get(d), S = t.states.get(d), _ = p === void 0 ? 0 : p.clock;
    (_ < f || _ === f && g === null && t.states.has(d)) && (g === null ? d === t.clientID && t.getLocalState() != null ? f++ : t.states.delete(d) : t.states.set(d, g), t.meta.set(d, {
      clock: f,
      lastUpdated: i
    }), p === void 0 && g !== null ? s.push(d) : p !== void 0 && g === null ? a.push(d) : g !== null && (Co(g, S) || l.push(d), o.push(d)));
  }
  (s.length > 0 || l.length > 0 || a.length > 0) && t.emit("change", [{
    added: s,
    updated: l,
    removed: a
  }, n]), (s.length > 0 || o.length > 0 || a.length > 0) && t.emit("update", [{
    added: s,
    updated: o,
    removed: a
  }, n]);
}, Mm = 0, Ld = 1, qm = 2, yf = (t, e) => {
  Ne(t, Mm);
  const n = c$(e);
  qt(t, n);
}, vE = (t, e, n) => {
  Ne(t, Ld), qt(t, s$(e, n));
}, yE = (t, e, n) => vE(e, n, _n(t)), Bm = (t, e, n) => {
  try {
    r$(e, _n(t), n);
  } catch (r) {
    console.error("Caught error while handling a Yjs update", r);
  }
}, bE = (t, e) => {
  Ne(t, qm), qt(t, e);
}, wE = Bm, _E = (t, e, n, r) => {
  const i = Me(t);
  switch (i) {
    case Mm:
      yE(t, e, n);
      break;
    case Ld:
      Bm(t, n, r);
      break;
    case qm:
      wE(t, n, r);
      break;
    default:
      throw new Error("Unknown message type");
  }
  return i;
}, SE = 0, xE = (t, e, n) => {
  switch (Me(t)) {
    case SE:
      n(e, Pi(t));
  }
}, sl = [];
sl[
  0
  /* SYNC */
] = (t, e, n, r, i) => {
  Ne(t, i);
  const s = _E(e, t, n.doc, n);
  r && s === Ld && !n.synced && (n.synced = !0, n.emit("sync", [n.synced]));
};
sl[
  3
  /* QUERY_AWARENESS */
] = (t, e, n, r, i) => {
  Ne(
    t,
    1
    /* AWARENESS */
  ), qt(t, Fl(n.awareness, [...n.awareness.getStates().keys()]));
};
sl[
  1
  /* AWARENESS */
] = (t, e, n, r, i) => {
  mE(n.awareness, _n(e), n);
};
sl[
  2
  /* AUTH */
] = (t, e, n, r, i) => {
  xE(e, n.doc, (s, o) => CE(n, o));
};
const CE = (t, e) => {
  console.warn(`Permission denied.
${e}`);
}, ki = {};
class $E extends Rp {
  id;
  doc;
  synced = !1;
  awareness;
  connected = !1;
  key;
  resyncInterval = null;
  boundUpdateHandler = this.updateHandler.bind(this);
  boundAwarenessUpdateHandler = this.awarenessUpdateHandler.bind(this);
  constructor(e, n, r) {
    super(), this.id = r?.id ?? -1, this.key = e, this.doc = n, this.awareness = new gE(this.doc), this.doc.on("update", this.boundUpdateHandler), this.awareness.on("update", this.boundAwarenessUpdateHandler), this.connect();
  }
  resync() {
    this.broadcastMessage(0, (e) => yf(e, this.doc));
  }
  broadcast(e) {
    if (this.connected) {
      const n = String.fromCharCode.apply(null, [...e]), r = btoa(n);
      EE(this.key, r, this.doc.clientID.toString());
    }
  }
  processSSE(e) {
    if (e.Key !== this.key || e.SourceClientID === String(this.doc.clientID))
      return;
    const n = atob(e.MessageBase64), r = new Uint8Array(n.length);
    for (let s = 0; s < n.length; s++)
      r[s] = n.charCodeAt(s);
    const i = this.readMessage(r, !0);
    Up(i) > 1 && this.broadcast(Qn(i));
  }
  readMessage = (e, n) => {
    const r = Gi(e), i = ts(), s = Me(r), o = sl[s];
    return o ? o(i, r, this, n, s) : console.warn(`Unknown message type: ${s}`), i;
  };
  updatePresence(e) {
    this.awareness.setLocalStateField("user", e);
  }
  updateHandler(e, n) {
    n !== this && this.broadcastMessage(0, (r) => bE(r, e));
  }
  awarenessUpdateHandler({ added: e, updated: n, removed: r }, i) {
    if (i === this) return;
    const s = [...e, ...n, ...r];
    this.broadcastMessage(1, (o) => qt(o, Fl(this.awareness, s)));
  }
  broadcastMessage(e, n) {
    const r = this.buildMessage(e, n);
    this.broadcast(r);
  }
  buildMessage(e, n) {
    const r = ts();
    return Ne(r, e), n && n(r), Qn(r);
  }
  connect() {
    this.connected || (this.connected = !0, ki[this.key] = [...ki[this.key] || [], this]), this.broadcastMessage(0, (e) => yf(e, this.doc)), this.broadcastMessage(
      3
      /* QUERY_AWARENESS */
    ), this.broadcastMessage(1, (e) => qt(e, Fl(this.awareness, [this.doc.clientID]))), this.resyncInterval = window.setInterval(this.resync.bind(this), 3e4);
  }
  disconnect() {
    this.broadcastMessage(1, (e) => qt(e, Fl(this.awareness, [this.doc.clientID], /* @__PURE__ */ new Map()))), this.connected && (this.connected = !1, ki[this.key] = ki[this.key].filter((e) => e !== this), ki[this.key].length === 0 && delete ki[this.key]), this.resyncInterval !== null && (window.clearInterval(this.resyncInterval), this.resyncInterval = null);
  }
  destroy() {
    this.disconnect(), this.awareness.off("update", this.boundAwarenessUpdateHandler), this.doc.off("update", this.boundUpdateHandler), super.destroy();
  }
}
const Vl = [];
function EE(t, e, n) {
  Vl.push({ key: t, messageBase64: e, sourceClientId: n });
}
setInterval(() => {
  if (Vl.length === 0) return;
  const t = Vl.splice(0, Vl.length);
  try {
    Oi.Broadcast(t);
  } catch (e) {
    console.error("Error broadcasting collaborative edit messages", e);
  }
}, 200);
Fg("CollaborativeEditBroadcastMessage", (t) => {
  if (ki[t.Key])
    for (const e of ki[t.Key])
      e.processSSE(t);
});
var Um = typeof window == "object" && window && window.Object === Object && window, TE = typeof self == "object" && self && self.Object === Object && self, Qr = Um || TE || Function("return this")(), ji = Qr.Symbol, jm = Object.prototype, AE = jm.hasOwnProperty, kE = jm.toString, mo = ji ? ji.toStringTag : void 0;
function IE(t) {
  var e = AE.call(t, mo), n = t[mo];
  try {
    t[mo] = void 0;
    var r = !0;
  } catch {
  }
  var i = kE.call(t);
  return r && (e ? t[mo] = n : delete t[mo]), i;
}
var OE = Object.prototype, DE = OE.toString;
function LE(t) {
  return DE.call(t);
}
var NE = "[object Null]", PE = "[object Undefined]", bf = ji ? ji.toStringTag : void 0;
function ao(t) {
  return t == null ? t === void 0 ? PE : NE : bf && bf in Object(t) ? IE(t) : LE(t);
}
function gi(t) {
  return t != null && typeof t == "object";
}
var os = Array.isArray;
function Fi(t) {
  var e = typeof t;
  return t != null && (e == "object" || e == "function");
}
function Gm(t) {
  return t;
}
var RE = "[object AsyncFunction]", ME = "[object Function]", qE = "[object GeneratorFunction]", BE = "[object Proxy]";
function Nd(t) {
  if (!Fi(t))
    return !1;
  var e = ao(t);
  return e == ME || e == qE || e == RE || e == BE;
}
var kc = Qr["__core-js_shared__"], wf = function() {
  var t = /[^.]+$/.exec(kc && kc.keys && kc.keys.IE_PROTO || "");
  return t ? "Symbol(src)_1." + t : "";
}();
function UE(t) {
  return !!wf && wf in t;
}
var jE = Function.prototype, GE = jE.toString;
function fs(t) {
  if (t != null) {
    try {
      return GE.call(t);
    } catch {
    }
    try {
      return t + "";
    } catch {
    }
  }
  return "";
}
var FE = /[\\^$.*+?()[\]{}|]/g, VE = /^\[object .+?Constructor\]$/, HE = Function.prototype, zE = Object.prototype, WE = HE.toString, JE = zE.hasOwnProperty, QE = RegExp(
  "^" + WE.call(JE).replace(FE, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
);
function KE(t) {
  if (!Fi(t) || UE(t))
    return !1;
  var e = Nd(t) ? QE : VE;
  return e.test(fs(t));
}
function YE(t, e) {
  return t?.[e];
}
function gs(t, e) {
  var n = YE(t, e);
  return KE(n) ? n : void 0;
}
var wu = gs(Qr, "WeakMap"), _f = Object.create, XE = /* @__PURE__ */ function() {
  function t() {
  }
  return function(e) {
    if (!Fi(e))
      return {};
    if (_f)
      return _f(e);
    t.prototype = e;
    var n = new t();
    return t.prototype = void 0, n;
  };
}();
function ZE(t, e, n) {
  switch (n.length) {
    case 0:
      return t.call(e);
    case 1:
      return t.call(e, n[0]);
    case 2:
      return t.call(e, n[0], n[1]);
    case 3:
      return t.call(e, n[0], n[1], n[2]);
  }
  return t.apply(e, n);
}
function Fm(t, e) {
  var n = -1, r = t.length;
  for (e || (e = Array(r)); ++n < r; )
    e[n] = t[n];
  return e;
}
var eT = 800, tT = 16, nT = Date.now;
function rT(t) {
  var e = 0, n = 0;
  return function() {
    var r = nT(), i = tT - (r - n);
    if (n = r, i > 0) {
      if (++e >= eT)
        return arguments[0];
    } else
      e = 0;
    return t.apply(void 0, arguments);
  };
}
function iT(t) {
  return function() {
    return t;
  };
}
var Sa = function() {
  try {
    var t = gs(Object, "defineProperty");
    return t({}, "", {}), t;
  } catch {
  }
}(), sT = Sa ? function(t, e) {
  return Sa(t, "toString", {
    configurable: !0,
    enumerable: !1,
    value: iT(e),
    writable: !0
  });
} : Gm, oT = rT(sT);
function lT(t, e) {
  for (var n = -1, r = t == null ? 0 : t.length; ++n < r && e(t[n], n, t) !== !1; )
    ;
  return t;
}
var aT = 9007199254740991, cT = /^(?:0|[1-9]\d*)$/;
function Vm(t, e) {
  var n = typeof t;
  return e = e ?? aT, !!e && (n == "number" || n != "symbol" && cT.test(t)) && t > -1 && t % 1 == 0 && t < e;
}
function Pd(t, e, n) {
  e == "__proto__" && Sa ? Sa(t, e, {
    configurable: !0,
    enumerable: !0,
    value: n,
    writable: !0
  }) : t[e] = n;
}
function ol(t, e) {
  return t === e || t !== t && e !== e;
}
var uT = Object.prototype, dT = uT.hasOwnProperty;
function Hm(t, e, n) {
  var r = t[e];
  (!(dT.call(t, e) && ol(r, n)) || n === void 0 && !(e in t)) && Pd(t, e, n);
}
function ll(t, e, n, r) {
  var i = !n;
  n || (n = {});
  for (var s = -1, o = e.length; ++s < o; ) {
    var l = e[s], a = void 0;
    a === void 0 && (a = t[l]), i ? Pd(n, l, a) : Hm(n, l, a);
  }
  return n;
}
var Sf = Math.max;
function hT(t, e, n) {
  return e = Sf(e === void 0 ? t.length - 1 : e, 0), function() {
    for (var r = arguments, i = -1, s = Sf(r.length - e, 0), o = Array(s); ++i < s; )
      o[i] = r[e + i];
    i = -1;
    for (var l = Array(e + 1); ++i < e; )
      l[i] = r[i];
    return l[e] = n(o), ZE(t, this, l);
  };
}
function fT(t, e) {
  return oT(hT(t, e, Gm), t + "");
}
var gT = 9007199254740991;
function zm(t) {
  return typeof t == "number" && t > -1 && t % 1 == 0 && t <= gT;
}
function Ya(t) {
  return t != null && zm(t.length) && !Nd(t);
}
function pT(t, e, n) {
  if (!Fi(n))
    return !1;
  var r = typeof e;
  return (r == "number" ? Ya(n) && Vm(e, n.length) : r == "string" && e in n) ? ol(n[e], t) : !1;
}
function mT(t) {
  return fT(function(e, n) {
    var r = -1, i = n.length, s = i > 1 ? n[i - 1] : void 0, o = i > 2 ? n[2] : void 0;
    for (s = t.length > 3 && typeof s == "function" ? (i--, s) : void 0, o && pT(n[0], n[1], o) && (s = i < 3 ? void 0 : s, i = 1), e = Object(e); ++r < i; ) {
      var l = n[r];
      l && t(e, l, r, s);
    }
    return e;
  });
}
var vT = Object.prototype;
function Rd(t) {
  var e = t && t.constructor, n = typeof e == "function" && e.prototype || vT;
  return t === n;
}
function yT(t, e) {
  for (var n = -1, r = Array(t); ++n < t; )
    r[n] = e(n);
  return r;
}
var bT = "[object Arguments]";
function xf(t) {
  return gi(t) && ao(t) == bT;
}
var Wm = Object.prototype, wT = Wm.hasOwnProperty, _T = Wm.propertyIsEnumerable, _u = xf(/* @__PURE__ */ function() {
  return arguments;
}()) ? xf : function(t) {
  return gi(t) && wT.call(t, "callee") && !_T.call(t, "callee");
};
function xT() {
  return !1;
}
var Jm = typeof exports == "object" && exports && !exports.nodeType && exports, Cf = Jm && typeof module == "object" && module && !module.nodeType && module, CT = Cf && Cf.exports === Jm, $f = CT ? Qr.Buffer : void 0, $T = $f ? $f.isBuffer : void 0, Go = $T || xT, ET = "[object Arguments]", TT = "[object Array]", AT = "[object Boolean]", kT = "[object Date]", IT = "[object Error]", OT = "[object Function]", DT = "[object Map]", LT = "[object Number]", NT = "[object Object]", PT = "[object RegExp]", RT = "[object Set]", MT = "[object String]", qT = "[object WeakMap]", BT = "[object ArrayBuffer]", UT = "[object DataView]", jT = "[object Float32Array]", GT = "[object Float64Array]", FT = "[object Int8Array]", VT = "[object Int16Array]", HT = "[object Int32Array]", zT = "[object Uint8Array]", WT = "[object Uint8ClampedArray]", JT = "[object Uint16Array]", QT = "[object Uint32Array]", kt = {};
kt[jT] = kt[GT] = kt[FT] = kt[VT] = kt[HT] = kt[zT] = kt[WT] = kt[JT] = kt[QT] = !0;
kt[ET] = kt[TT] = kt[BT] = kt[AT] = kt[UT] = kt[kT] = kt[IT] = kt[OT] = kt[DT] = kt[LT] = kt[NT] = kt[PT] = kt[RT] = kt[MT] = kt[qT] = !1;
function KT(t) {
  return gi(t) && zm(t.length) && !!kt[ao(t)];
}
function Md(t) {
  return function(e) {
    return t(e);
  };
}
var Qm = typeof exports == "object" && exports && !exports.nodeType && exports, $o = Qm && typeof module == "object" && module && !module.nodeType && module, YT = $o && $o.exports === Qm, Ic = YT && Um.process, Zs = function() {
  try {
    var t = $o && $o.require && $o.require("util").types;
    return t || Ic && Ic.binding && Ic.binding("util");
  } catch {
  }
}(), Ef = Zs && Zs.isTypedArray, qd = Ef ? Md(Ef) : KT, XT = Object.prototype, ZT = XT.hasOwnProperty;
function Km(t, e) {
  var n = os(t), r = !n && _u(t), i = !n && !r && Go(t), s = !n && !r && !i && qd(t), o = n || r || i || s, l = o ? yT(t.length, String) : [], a = l.length;
  for (var c in t)
    (e || ZT.call(t, c)) && !(o && // Safari 9 has enumerable `arguments.length` in strict mode.
    (c == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
    i && (c == "offset" || c == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
    s && (c == "buffer" || c == "byteLength" || c == "byteOffset") || // Skip index properties.
    Vm(c, a))) && l.push(c);
  return l;
}
function Ym(t, e) {
  return function(n) {
    return t(e(n));
  };
}
var eA = Ym(Object.keys, Object), tA = Object.prototype, nA = tA.hasOwnProperty;
function rA(t) {
  if (!Rd(t))
    return eA(t);
  var e = [];
  for (var n in Object(t))
    nA.call(t, n) && n != "constructor" && e.push(n);
  return e;
}
function Bd(t) {
  return Ya(t) ? Km(t) : rA(t);
}
function iA(t) {
  var e = [];
  if (t != null)
    for (var n in Object(t))
      e.push(n);
  return e;
}
var sA = Object.prototype, oA = sA.hasOwnProperty;
function lA(t) {
  if (!Fi(t))
    return iA(t);
  var e = Rd(t), n = [];
  for (var r in t)
    r == "constructor" && (e || !oA.call(t, r)) || n.push(r);
  return n;
}
function al(t) {
  return Ya(t) ? Km(t, !0) : lA(t);
}
var Fo = gs(Object, "create");
function aA() {
  this.__data__ = Fo ? Fo(null) : {}, this.size = 0;
}
function cA(t) {
  var e = this.has(t) && delete this.__data__[t];
  return this.size -= e ? 1 : 0, e;
}
var uA = "__lodash_hash_undefined__", dA = Object.prototype, hA = dA.hasOwnProperty;
function fA(t) {
  var e = this.__data__;
  if (Fo) {
    var n = e[t];
    return n === uA ? void 0 : n;
  }
  return hA.call(e, t) ? e[t] : void 0;
}
var gA = Object.prototype, pA = gA.hasOwnProperty;
function mA(t) {
  var e = this.__data__;
  return Fo ? e[t] !== void 0 : pA.call(e, t);
}
var vA = "__lodash_hash_undefined__";
function yA(t, e) {
  var n = this.__data__;
  return this.size += this.has(t) ? 0 : 1, n[t] = Fo && e === void 0 ? vA : e, this;
}
function ls(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.clear(); ++e < n; ) {
    var r = t[e];
    this.set(r[0], r[1]);
  }
}
ls.prototype.clear = aA;
ls.prototype.delete = cA;
ls.prototype.get = fA;
ls.prototype.has = mA;
ls.prototype.set = yA;
function bA() {
  this.__data__ = [], this.size = 0;
}
function Xa(t, e) {
  for (var n = t.length; n--; )
    if (ol(t[n][0], e))
      return n;
  return -1;
}
var wA = Array.prototype, _A = wA.splice;
function SA(t) {
  var e = this.__data__, n = Xa(e, t);
  if (n < 0)
    return !1;
  var r = e.length - 1;
  return n == r ? e.pop() : _A.call(e, n, 1), --this.size, !0;
}
function xA(t) {
  var e = this.__data__, n = Xa(e, t);
  return n < 0 ? void 0 : e[n][1];
}
function CA(t) {
  return Xa(this.__data__, t) > -1;
}
function $A(t, e) {
  var n = this.__data__, r = Xa(n, t);
  return r < 0 ? (++this.size, n.push([t, e])) : n[r][1] = e, this;
}
function yi(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.clear(); ++e < n; ) {
    var r = t[e];
    this.set(r[0], r[1]);
  }
}
yi.prototype.clear = bA;
yi.prototype.delete = SA;
yi.prototype.get = xA;
yi.prototype.has = CA;
yi.prototype.set = $A;
var Vo = gs(Qr, "Map");
function EA() {
  this.size = 0, this.__data__ = {
    hash: new ls(),
    map: new (Vo || yi)(),
    string: new ls()
  };
}
function TA(t) {
  var e = typeof t;
  return e == "string" || e == "number" || e == "symbol" || e == "boolean" ? t !== "__proto__" : t === null;
}
function Za(t, e) {
  var n = t.__data__;
  return TA(e) ? n[typeof e == "string" ? "string" : "hash"] : n.map;
}
function AA(t) {
  var e = Za(this, t).delete(t);
  return this.size -= e ? 1 : 0, e;
}
function kA(t) {
  return Za(this, t).get(t);
}
function IA(t) {
  return Za(this, t).has(t);
}
function OA(t, e) {
  var n = Za(this, t), r = n.size;
  return n.set(t, e), this.size += n.size == r ? 0 : 1, this;
}
function ps(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.clear(); ++e < n; ) {
    var r = t[e];
    this.set(r[0], r[1]);
  }
}
ps.prototype.clear = EA;
ps.prototype.delete = AA;
ps.prototype.get = kA;
ps.prototype.has = IA;
ps.prototype.set = OA;
function Xm(t, e) {
  for (var n = -1, r = e.length, i = t.length; ++n < r; )
    t[i + n] = e[n];
  return t;
}
var Ud = Ym(Object.getPrototypeOf, Object), DA = "[object Object]", LA = Function.prototype, NA = Object.prototype, Zm = LA.toString, PA = NA.hasOwnProperty, RA = Zm.call(Object);
function MA(t) {
  if (!gi(t) || ao(t) != DA)
    return !1;
  var e = Ud(t);
  if (e === null)
    return !0;
  var n = PA.call(e, "constructor") && e.constructor;
  return typeof n == "function" && n instanceof n && Zm.call(n) == RA;
}
function qA() {
  this.__data__ = new yi(), this.size = 0;
}
function BA(t) {
  var e = this.__data__, n = e.delete(t);
  return this.size = e.size, n;
}
function UA(t) {
  return this.__data__.get(t);
}
function jA(t) {
  return this.__data__.has(t);
}
var GA = 200;
function FA(t, e) {
  var n = this.__data__;
  if (n instanceof yi) {
    var r = n.__data__;
    if (!Vo || r.length < GA - 1)
      return r.push([t, e]), this.size = ++n.size, this;
    n = this.__data__ = new ps(r);
  }
  return n.set(t, e), this.size = n.size, this;
}
function Fr(t) {
  var e = this.__data__ = new yi(t);
  this.size = e.size;
}
Fr.prototype.clear = qA;
Fr.prototype.delete = BA;
Fr.prototype.get = UA;
Fr.prototype.has = jA;
Fr.prototype.set = FA;
function VA(t, e) {
  return t && ll(e, Bd(e), t);
}
function HA(t, e) {
  return t && ll(e, al(e), t);
}
var ev = typeof exports == "object" && exports && !exports.nodeType && exports, Tf = ev && typeof module == "object" && module && !module.nodeType && module, zA = Tf && Tf.exports === ev, Af = zA ? Qr.Buffer : void 0, kf = Af ? Af.allocUnsafe : void 0;
function tv(t, e) {
  if (e)
    return t.slice();
  var n = t.length, r = kf ? kf(n) : new t.constructor(n);
  return t.copy(r), r;
}
function WA(t, e) {
  for (var n = -1, r = t == null ? 0 : t.length, i = 0, s = []; ++n < r; ) {
    var o = t[n];
    e(o, n, t) && (s[i++] = o);
  }
  return s;
}
function nv() {
  return [];
}
var JA = Object.prototype, QA = JA.propertyIsEnumerable, If = Object.getOwnPropertySymbols, jd = If ? function(t) {
  return t == null ? [] : (t = Object(t), WA(If(t), function(e) {
    return QA.call(t, e);
  }));
} : nv;
function KA(t, e) {
  return ll(t, jd(t), e);
}
var YA = Object.getOwnPropertySymbols, rv = YA ? function(t) {
  for (var e = []; t; )
    Xm(e, jd(t)), t = Ud(t);
  return e;
} : nv;
function XA(t, e) {
  return ll(t, rv(t), e);
}
function iv(t, e, n) {
  var r = e(t);
  return os(t) ? r : Xm(r, n(t));
}
function Su(t) {
  return iv(t, Bd, jd);
}
function ZA(t) {
  return iv(t, al, rv);
}
var xu = gs(Qr, "DataView"), Cu = gs(Qr, "Promise"), $u = gs(Qr, "Set"), Of = "[object Map]", ek = "[object Object]", Df = "[object Promise]", Lf = "[object Set]", Nf = "[object WeakMap]", Pf = "[object DataView]", tk = fs(xu), nk = fs(Vo), rk = fs(Cu), ik = fs($u), sk = fs(wu), br = ao;
(xu && br(new xu(new ArrayBuffer(1))) != Pf || Vo && br(new Vo()) != Of || Cu && br(Cu.resolve()) != Df || $u && br(new $u()) != Lf || wu && br(new wu()) != Nf) && (br = function(t) {
  var e = ao(t), n = e == ek ? t.constructor : void 0, r = n ? fs(n) : "";
  if (r)
    switch (r) {
      case tk:
        return Pf;
      case nk:
        return Of;
      case rk:
        return Df;
      case ik:
        return Lf;
      case sk:
        return Nf;
    }
  return e;
});
var ok = Object.prototype, lk = ok.hasOwnProperty;
function ak(t) {
  var e = t.length, n = new t.constructor(e);
  return e && typeof t[0] == "string" && lk.call(t, "index") && (n.index = t.index, n.input = t.input), n;
}
var xa = Qr.Uint8Array;
function Gd(t) {
  var e = new t.constructor(t.byteLength);
  return new xa(e).set(new xa(t)), e;
}
function ck(t, e) {
  var n = e ? Gd(t.buffer) : t.buffer;
  return new t.constructor(n, t.byteOffset, t.byteLength);
}
var uk = /\w*$/;
function dk(t) {
  var e = new t.constructor(t.source, uk.exec(t));
  return e.lastIndex = t.lastIndex, e;
}
var Rf = ji ? ji.prototype : void 0, Mf = Rf ? Rf.valueOf : void 0;
function hk(t) {
  return Mf ? Object(Mf.call(t)) : {};
}
function sv(t, e) {
  var n = e ? Gd(t.buffer) : t.buffer;
  return new t.constructor(n, t.byteOffset, t.length);
}
var fk = "[object Boolean]", gk = "[object Date]", pk = "[object Map]", mk = "[object Number]", vk = "[object RegExp]", yk = "[object Set]", bk = "[object String]", wk = "[object Symbol]", _k = "[object ArrayBuffer]", Sk = "[object DataView]", xk = "[object Float32Array]", Ck = "[object Float64Array]", $k = "[object Int8Array]", Ek = "[object Int16Array]", Tk = "[object Int32Array]", Ak = "[object Uint8Array]", kk = "[object Uint8ClampedArray]", Ik = "[object Uint16Array]", Ok = "[object Uint32Array]";
function Dk(t, e, n) {
  var r = t.constructor;
  switch (e) {
    case _k:
      return Gd(t);
    case fk:
    case gk:
      return new r(+t);
    case Sk:
      return ck(t, n);
    case xk:
    case Ck:
    case $k:
    case Ek:
    case Tk:
    case Ak:
    case kk:
    case Ik:
    case Ok:
      return sv(t, n);
    case pk:
      return new r();
    case mk:
    case bk:
      return new r(t);
    case vk:
      return dk(t);
    case yk:
      return new r();
    case wk:
      return hk(t);
  }
}
function ov(t) {
  return typeof t.constructor == "function" && !Rd(t) ? XE(Ud(t)) : {};
}
var Lk = "[object Map]";
function Nk(t) {
  return gi(t) && br(t) == Lk;
}
var qf = Zs && Zs.isMap, Pk = qf ? Md(qf) : Nk, Rk = "[object Set]";
function Mk(t) {
  return gi(t) && br(t) == Rk;
}
var Bf = Zs && Zs.isSet, qk = Bf ? Md(Bf) : Mk, Bk = 1, Uk = 2, jk = 4, lv = "[object Arguments]", Gk = "[object Array]", Fk = "[object Boolean]", Vk = "[object Date]", Hk = "[object Error]", av = "[object Function]", zk = "[object GeneratorFunction]", Wk = "[object Map]", Jk = "[object Number]", cv = "[object Object]", Qk = "[object RegExp]", Kk = "[object Set]", Yk = "[object String]", Xk = "[object Symbol]", Zk = "[object WeakMap]", eI = "[object ArrayBuffer]", tI = "[object DataView]", nI = "[object Float32Array]", rI = "[object Float64Array]", iI = "[object Int8Array]", sI = "[object Int16Array]", oI = "[object Int32Array]", lI = "[object Uint8Array]", aI = "[object Uint8ClampedArray]", cI = "[object Uint16Array]", uI = "[object Uint32Array]", Et = {};
Et[lv] = Et[Gk] = Et[eI] = Et[tI] = Et[Fk] = Et[Vk] = Et[nI] = Et[rI] = Et[iI] = Et[sI] = Et[oI] = Et[Wk] = Et[Jk] = Et[cv] = Et[Qk] = Et[Kk] = Et[Yk] = Et[Xk] = Et[lI] = Et[aI] = Et[cI] = Et[uI] = !0;
Et[Hk] = Et[av] = Et[Zk] = !1;
function Hl(t, e, n, r, i, s) {
  var o, l = e & Bk, a = e & Uk, c = e & jk;
  if (o !== void 0)
    return o;
  if (!Fi(t))
    return t;
  var u = os(t);
  if (u) {
    if (o = ak(t), !l)
      return Fm(t, o);
  } else {
    var d = br(t), f = d == av || d == zk;
    if (Go(t))
      return tv(t, l);
    if (d == cv || d == lv || f && !i) {
      if (o = a || f ? {} : ov(t), !l)
        return a ? XA(t, HA(o, t)) : KA(t, VA(o, t));
    } else {
      if (!Et[d])
        return i ? t : {};
      o = Dk(t, d, l);
    }
  }
  s || (s = new Fr());
  var g = s.get(t);
  if (g)
    return g;
  s.set(t, o), qk(t) ? t.forEach(function(_) {
    o.add(Hl(_, e, n, _, t, s));
  }) : Pk(t) && t.forEach(function(_, m) {
    o.set(m, Hl(_, e, n, m, t, s));
  });
  var p = c ? a ? ZA : Su : a ? al : Bd, S = u ? void 0 : p(t);
  return lT(S || t, function(_, m) {
    S && (m = _, _ = t[m]), Hm(o, m, Hl(_, e, n, m, t, s));
  }), o;
}
var dI = 1, hI = 4;
function qs(t) {
  return Hl(t, dI | hI);
}
var fI = "__lodash_hash_undefined__";
function gI(t) {
  return this.__data__.set(t, fI), this;
}
function pI(t) {
  return this.__data__.has(t);
}
function Ca(t) {
  var e = -1, n = t == null ? 0 : t.length;
  for (this.__data__ = new ps(); ++e < n; )
    this.add(t[e]);
}
Ca.prototype.add = Ca.prototype.push = gI;
Ca.prototype.has = pI;
function mI(t, e) {
  for (var n = -1, r = t == null ? 0 : t.length; ++n < r; )
    if (e(t[n], n, t))
      return !0;
  return !1;
}
function vI(t, e) {
  return t.has(e);
}
var yI = 1, bI = 2;
function uv(t, e, n, r, i, s) {
  var o = n & yI, l = t.length, a = e.length;
  if (l != a && !(o && a > l))
    return !1;
  var c = s.get(t), u = s.get(e);
  if (c && u)
    return c == e && u == t;
  var d = -1, f = !0, g = n & bI ? new Ca() : void 0;
  for (s.set(t, e), s.set(e, t); ++d < l; ) {
    var p = t[d], S = e[d];
    if (r)
      var _ = o ? r(S, p, d, e, t, s) : r(p, S, d, t, e, s);
    if (_ !== void 0) {
      if (_)
        continue;
      f = !1;
      break;
    }
    if (g) {
      if (!mI(e, function(m, y) {
        if (!vI(g, y) && (p === m || i(p, m, n, r, s)))
          return g.push(y);
      })) {
        f = !1;
        break;
      }
    } else if (!(p === S || i(p, S, n, r, s))) {
      f = !1;
      break;
    }
  }
  return s.delete(t), s.delete(e), f;
}
function wI(t) {
  var e = -1, n = Array(t.size);
  return t.forEach(function(r, i) {
    n[++e] = [i, r];
  }), n;
}
function _I(t) {
  var e = -1, n = Array(t.size);
  return t.forEach(function(r) {
    n[++e] = r;
  }), n;
}
var SI = 1, xI = 2, CI = "[object Boolean]", $I = "[object Date]", EI = "[object Error]", TI = "[object Map]", AI = "[object Number]", kI = "[object RegExp]", II = "[object Set]", OI = "[object String]", DI = "[object Symbol]", LI = "[object ArrayBuffer]", NI = "[object DataView]", Uf = ji ? ji.prototype : void 0, Oc = Uf ? Uf.valueOf : void 0;
function PI(t, e, n, r, i, s, o) {
  switch (n) {
    case NI:
      if (t.byteLength != e.byteLength || t.byteOffset != e.byteOffset)
        return !1;
      t = t.buffer, e = e.buffer;
    case LI:
      return !(t.byteLength != e.byteLength || !s(new xa(t), new xa(e)));
    case CI:
    case $I:
    case AI:
      return ol(+t, +e);
    case EI:
      return t.name == e.name && t.message == e.message;
    case kI:
    case OI:
      return t == e + "";
    case TI:
      var l = wI;
    case II:
      var a = r & SI;
      if (l || (l = _I), t.size != e.size && !a)
        return !1;
      var c = o.get(t);
      if (c)
        return c == e;
      r |= xI, o.set(t, e);
      var u = uv(l(t), l(e), r, i, s, o);
      return o.delete(t), u;
    case DI:
      if (Oc)
        return Oc.call(t) == Oc.call(e);
  }
  return !1;
}
var RI = 1, MI = Object.prototype, qI = MI.hasOwnProperty;
function BI(t, e, n, r, i, s) {
  var o = n & RI, l = Su(t), a = l.length, c = Su(e), u = c.length;
  if (a != u && !o)
    return !1;
  for (var d = a; d--; ) {
    var f = l[d];
    if (!(o ? f in e : qI.call(e, f)))
      return !1;
  }
  var g = s.get(t), p = s.get(e);
  if (g && p)
    return g == e && p == t;
  var S = !0;
  s.set(t, e), s.set(e, t);
  for (var _ = o; ++d < a; ) {
    f = l[d];
    var m = t[f], y = e[f];
    if (r)
      var v = o ? r(y, m, f, e, t, s) : r(m, y, f, t, e, s);
    if (!(v === void 0 ? m === y || i(m, y, n, r, s) : v)) {
      S = !1;
      break;
    }
    _ || (_ = f == "constructor");
  }
  if (S && !_) {
    var x = t.constructor, C = e.constructor;
    x != C && "constructor" in t && "constructor" in e && !(typeof x == "function" && x instanceof x && typeof C == "function" && C instanceof C) && (S = !1);
  }
  return s.delete(t), s.delete(e), S;
}
var UI = 1, jf = "[object Arguments]", Gf = "[object Array]", Al = "[object Object]", jI = Object.prototype, Ff = jI.hasOwnProperty;
function GI(t, e, n, r, i, s) {
  var o = os(t), l = os(e), a = o ? Gf : br(t), c = l ? Gf : br(e);
  a = a == jf ? Al : a, c = c == jf ? Al : c;
  var u = a == Al, d = c == Al, f = a == c;
  if (f && Go(t)) {
    if (!Go(e))
      return !1;
    o = !0, u = !1;
  }
  if (f && !u)
    return s || (s = new Fr()), o || qd(t) ? uv(t, e, n, r, i, s) : PI(t, e, a, n, r, i, s);
  if (!(n & UI)) {
    var g = u && Ff.call(t, "__wrapped__"), p = d && Ff.call(e, "__wrapped__");
    if (g || p) {
      var S = g ? t.value() : t, _ = p ? e.value() : e;
      return s || (s = new Fr()), i(S, _, n, r, s);
    }
  }
  return f ? (s || (s = new Fr()), BI(t, e, n, r, i, s)) : !1;
}
function dv(t, e, n, r, i) {
  return t === e ? !0 : t == null || e == null || !gi(t) && !gi(e) ? t !== t && e !== e : GI(t, e, n, r, dv, i);
}
function FI(t) {
  return function(e, n, r) {
    for (var i = -1, s = Object(e), o = r(e), l = o.length; l--; ) {
      var a = o[++i];
      if (n(s[a], a, s) === !1)
        break;
    }
    return e;
  };
}
var VI = FI();
function Eu(t, e, n) {
  (n !== void 0 && !ol(t[e], n) || n === void 0 && !(e in t)) && Pd(t, e, n);
}
function HI(t) {
  return gi(t) && Ya(t);
}
function Tu(t, e) {
  if (!(e === "constructor" && typeof t[e] == "function") && e != "__proto__")
    return t[e];
}
function zI(t) {
  return ll(t, al(t));
}
function WI(t, e, n, r, i, s, o) {
  var l = Tu(t, n), a = Tu(e, n), c = o.get(a);
  if (c) {
    Eu(t, n, c);
    return;
  }
  var u = s ? s(l, a, n + "", t, e, o) : void 0, d = u === void 0;
  if (d) {
    var f = os(a), g = !f && Go(a), p = !f && !g && qd(a);
    u = a, f || g || p ? os(l) ? u = l : HI(l) ? u = Fm(l) : g ? (d = !1, u = tv(a, !0)) : p ? (d = !1, u = sv(a, !0)) : u = [] : MA(a) || _u(a) ? (u = l, _u(l) ? u = zI(l) : (!Fi(l) || Nd(l)) && (u = ov(a))) : d = !1;
  }
  d && (o.set(a, u), i(u, a, r, s, o), o.delete(a)), Eu(t, n, u);
}
function hv(t, e, n, r, i) {
  t !== e && VI(e, function(s, o) {
    if (i || (i = new Fr()), Fi(s))
      WI(t, e, o, n, hv, r, i);
    else {
      var l = r ? r(Tu(t, o), s, o + "", t, e, i) : void 0;
      l === void 0 && (l = s), Eu(t, o, l);
    }
  }, al);
}
function Fd(t, e) {
  return dv(t, e);
}
var Ri = mT(function(t, e, n) {
  hv(t, e, n);
}), Se = /* @__PURE__ */ ((t) => (t[t.TYPE = 3] = "TYPE", t[t.LEVEL = 12] = "LEVEL", t[t.ATTRIBUTE = 13] = "ATTRIBUTE", t[t.BLOT = 14] = "BLOT", t[t.INLINE = 7] = "INLINE", t[t.BLOCK = 11] = "BLOCK", t[t.BLOCK_BLOT = 10] = "BLOCK_BLOT", t[t.INLINE_BLOT = 6] = "INLINE_BLOT", t[t.BLOCK_ATTRIBUTE = 9] = "BLOCK_ATTRIBUTE", t[t.INLINE_ATTRIBUTE = 5] = "INLINE_ATTRIBUTE", t[t.ANY = 15] = "ANY", t))(Se || {});
class zr {
  constructor(e, n, r = {}) {
    this.attrName = e, this.keyName = n;
    const i = Se.TYPE & Se.ATTRIBUTE;
    this.scope = r.scope != null ? (
      // Ignore type bits, force attribute bit
      r.scope & Se.LEVEL | i
    ) : Se.ATTRIBUTE, r.whitelist != null && (this.whitelist = r.whitelist);
  }
  static keys(e) {
    return Array.from(e.attributes).map((n) => n.name);
  }
  add(e, n) {
    return this.canAdd(e, n) ? (e.setAttribute(this.keyName, n), !0) : !1;
  }
  canAdd(e, n) {
    return this.whitelist == null ? !0 : typeof n == "string" ? this.whitelist.indexOf(n.replace(/["']/g, "")) > -1 : this.whitelist.indexOf(n) > -1;
  }
  remove(e) {
    e.removeAttribute(this.keyName);
  }
  value(e) {
    const n = e.getAttribute(this.keyName);
    return this.canAdd(e, n) && n ? n : "";
  }
}
class Bs extends Error {
  constructor(e) {
    e = "[Parchment] " + e, super(e), this.message = e, this.name = this.constructor.name;
  }
}
const fv = class Au {
  constructor() {
    this.attributes = {}, this.classes = {}, this.tags = {}, this.types = {};
  }
  static find(e, n = !1) {
    if (e == null)
      return null;
    if (this.blots.has(e))
      return this.blots.get(e) || null;
    if (n) {
      let r = null;
      try {
        r = e.parentNode;
      } catch {
        return null;
      }
      return this.find(r, n);
    }
    return null;
  }
  create(e, n, r) {
    const i = this.query(n);
    if (i == null)
      throw new Bs(`Unable to create ${n} blot`);
    const s = i, o = (
      // @ts-expect-error Fix me later
      n instanceof Node || n.nodeType === Node.TEXT_NODE ? n : s.create(r)
    ), l = new s(e, o, r);
    return Au.blots.set(l.domNode, l), l;
  }
  find(e, n = !1) {
    return Au.find(e, n);
  }
  query(e, n = Se.ANY) {
    let r;
    return typeof e == "string" ? r = this.types[e] || this.attributes[e] : e instanceof Text || e.nodeType === Node.TEXT_NODE ? r = this.types.text : typeof e == "number" ? e & Se.LEVEL & Se.BLOCK ? r = this.types.block : e & Se.LEVEL & Se.INLINE && (r = this.types.inline) : e instanceof Element && ((e.getAttribute("class") || "").split(/\s+/).some((i) => (r = this.classes[i], !!r)), r = r || this.tags[e.tagName]), r == null ? null : "scope" in r && n & Se.LEVEL & r.scope && n & Se.TYPE & r.scope ? r : null;
  }
  register(...e) {
    return e.map((n) => {
      const r = "blotName" in n, i = "attrName" in n;
      if (!r && !i)
        throw new Bs("Invalid definition");
      if (r && n.blotName === "abstract")
        throw new Bs("Cannot register abstract class");
      const s = r ? n.blotName : i ? n.attrName : void 0;
      return this.types[s] = n, i ? typeof n.keyName == "string" && (this.attributes[n.keyName] = n) : r && (n.className && (this.classes[n.className] = n), n.tagName && (Array.isArray(n.tagName) ? n.tagName = n.tagName.map((o) => o.toUpperCase()) : n.tagName = n.tagName.toUpperCase(), (Array.isArray(n.tagName) ? n.tagName : [n.tagName]).forEach((o) => {
        (this.tags[o] == null || n.className == null) && (this.tags[o] = n);
      }))), n;
    });
  }
};
fv.blots = /* @__PURE__ */ new WeakMap();
let eo = fv;
function Vf(t, e) {
  return (t.getAttribute("class") || "").split(/\s+/).filter((n) => n.indexOf(`${e}-`) === 0);
}
class JI extends zr {
  static keys(e) {
    return (e.getAttribute("class") || "").split(/\s+/).map((n) => n.split("-").slice(0, -1).join("-"));
  }
  add(e, n) {
    return this.canAdd(e, n) ? (this.remove(e), e.classList.add(`${this.keyName}-${n}`), !0) : !1;
  }
  remove(e) {
    Vf(e, this.keyName).forEach((n) => {
      e.classList.remove(n);
    }), e.classList.length === 0 && e.removeAttribute("class");
  }
  value(e) {
    const n = (Vf(e, this.keyName)[0] || "").slice(this.keyName.length + 1);
    return this.canAdd(e, n) ? n : "";
  }
}
const Or = JI;
function Dc(t) {
  const e = t.split("-"), n = e.slice(1).map((r) => r[0].toUpperCase() + r.slice(1)).join("");
  return e[0] + n;
}
class QI extends zr {
  static keys(e) {
    return (e.getAttribute("style") || "").split(";").map((n) => n.split(":")[0].trim());
  }
  add(e, n) {
    return this.canAdd(e, n) ? (e.style[Dc(this.keyName)] = n, !0) : !1;
  }
  remove(e) {
    e.style[Dc(this.keyName)] = "", e.getAttribute("style") || e.removeAttribute("style");
  }
  value(e) {
    const n = e.style[Dc(this.keyName)];
    return this.canAdd(e, n) ? n : "";
  }
}
const Vi = QI;
class KI {
  constructor(e) {
    this.attributes = {}, this.domNode = e, this.build();
  }
  attribute(e, n) {
    n ? e.add(this.domNode, n) && (e.value(this.domNode) != null ? this.attributes[e.attrName] = e : delete this.attributes[e.attrName]) : (e.remove(this.domNode), delete this.attributes[e.attrName]);
  }
  build() {
    this.attributes = {};
    const e = eo.find(this.domNode);
    if (e == null)
      return;
    const n = zr.keys(this.domNode), r = Or.keys(this.domNode), i = Vi.keys(this.domNode);
    n.concat(r).concat(i).forEach((s) => {
      const o = e.scroll.query(s, Se.ATTRIBUTE);
      o instanceof zr && (this.attributes[o.attrName] = o);
    });
  }
  copy(e) {
    Object.keys(this.attributes).forEach((n) => {
      const r = this.attributes[n].value(this.domNode);
      e.format(n, r);
    });
  }
  move(e) {
    this.copy(e), Object.keys(this.attributes).forEach((n) => {
      this.attributes[n].remove(this.domNode);
    }), this.attributes = {};
  }
  values() {
    return Object.keys(this.attributes).reduce(
      (e, n) => (e[n] = this.attributes[n].value(this.domNode), e),
      {}
    );
  }
}
const ec = KI, gv = class {
  constructor(e, n) {
    this.scroll = e, this.domNode = n, eo.blots.set(n, this), this.prev = null, this.next = null;
  }
  static create(e) {
    if (this.tagName == null)
      throw new Bs("Blot definition missing tagName");
    let n, r;
    return Array.isArray(this.tagName) ? (typeof e == "string" ? (r = e.toUpperCase(), parseInt(r, 10).toString() === r && (r = parseInt(r, 10))) : typeof e == "number" && (r = e), typeof r == "number" ? n = document.createElement(this.tagName[r - 1]) : r && this.tagName.indexOf(r) > -1 ? n = document.createElement(r) : n = document.createElement(this.tagName[0])) : n = document.createElement(this.tagName), this.className && n.classList.add(this.className), n;
  }
  // Hack for accessing inherited static methods
  get statics() {
    return this.constructor;
  }
  attach() {
  }
  clone() {
    const e = this.domNode.cloneNode(!1);
    return this.scroll.create(e);
  }
  detach() {
    this.parent != null && this.parent.removeChild(this), eo.blots.delete(this.domNode);
  }
  deleteAt(e, n) {
    this.isolate(e, n).remove();
  }
  formatAt(e, n, r, i) {
    const s = this.isolate(e, n);
    if (this.scroll.query(r, Se.BLOT) != null && i)
      s.wrap(r, i);
    else if (this.scroll.query(r, Se.ATTRIBUTE) != null) {
      const o = this.scroll.create(this.statics.scope);
      s.wrap(o), o.format(r, i);
    }
  }
  insertAt(e, n, r) {
    const i = r == null ? this.scroll.create("text", n) : this.scroll.create(n, r), s = this.split(e);
    this.parent.insertBefore(i, s || void 0);
  }
  isolate(e, n) {
    const r = this.split(e);
    if (r == null)
      throw new Error("Attempt to isolate at end");
    return r.split(n), r;
  }
  length() {
    return 1;
  }
  offset(e = this.parent) {
    return this.parent == null || this === e ? 0 : this.parent.children.offset(this) + this.parent.offset(e);
  }
  optimize(e) {
    this.statics.requiredContainer && !(this.parent instanceof this.statics.requiredContainer) && this.wrap(this.statics.requiredContainer.blotName);
  }
  remove() {
    this.domNode.parentNode != null && this.domNode.parentNode.removeChild(this.domNode), this.detach();
  }
  replaceWith(e, n) {
    const r = typeof e == "string" ? this.scroll.create(e, n) : e;
    return this.parent != null && (this.parent.insertBefore(r, this.next || void 0), this.remove()), r;
  }
  split(e, n) {
    return e === 0 ? this : this.next;
  }
  update(e, n) {
  }
  wrap(e, n) {
    const r = typeof e == "string" ? this.scroll.create(e, n) : e;
    if (this.parent != null && this.parent.insertBefore(r, this.next || void 0), typeof r.appendChild != "function")
      throw new Bs(`Cannot wrap ${e}`);
    return r.appendChild(this), r;
  }
};
gv.blotName = "abstract";
let pv = gv;
const mv = class extends pv {
  /**
   * Returns the value represented by domNode if it is this Blot's type
   * No checking that domNode can represent this Blot type is required so
   * applications needing it should check externally before calling.
   */
  static value(e) {
    return !0;
  }
  /**
   * Given location represented by node and offset from DOM Selection Range,
   * return index to that location.
   */
  index(e, n) {
    return this.domNode === e || this.domNode.compareDocumentPosition(e) & Node.DOCUMENT_POSITION_CONTAINED_BY ? Math.min(n, 1) : -1;
  }
  /**
   * Given index to location within blot, return node and offset representing
   * that location, consumable by DOM Selection Range
   */
  position(e, n) {
    let r = Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);
    return e > 0 && (r += 1), [this.parent.domNode, r];
  }
  /**
   * Return value represented by this blot
   * Should not change without interaction from API or
   * user change detectable by update()
   */
  value() {
    return {
      [this.statics.blotName]: this.statics.value(this.domNode) || !0
    };
  }
};
mv.scope = Se.INLINE_BLOT;
let YI = mv;
const xn = YI;
class XI {
  constructor() {
    this.head = null, this.tail = null, this.length = 0;
  }
  append(...e) {
    if (this.insertBefore(e[0], null), e.length > 1) {
      const n = e.slice(1);
      this.append(...n);
    }
  }
  at(e) {
    const n = this.iterator();
    let r = n();
    for (; r && e > 0; )
      e -= 1, r = n();
    return r;
  }
  contains(e) {
    const n = this.iterator();
    let r = n();
    for (; r; ) {
      if (r === e)
        return !0;
      r = n();
    }
    return !1;
  }
  indexOf(e) {
    const n = this.iterator();
    let r = n(), i = 0;
    for (; r; ) {
      if (r === e)
        return i;
      i += 1, r = n();
    }
    return -1;
  }
  insertBefore(e, n) {
    e != null && (this.remove(e), e.next = n, n != null ? (e.prev = n.prev, n.prev != null && (n.prev.next = e), n.prev = e, n === this.head && (this.head = e)) : this.tail != null ? (this.tail.next = e, e.prev = this.tail, this.tail = e) : (e.prev = null, this.head = this.tail = e), this.length += 1);
  }
  offset(e) {
    let n = 0, r = this.head;
    for (; r != null; ) {
      if (r === e)
        return n;
      n += r.length(), r = r.next;
    }
    return -1;
  }
  remove(e) {
    this.contains(e) && (e.prev != null && (e.prev.next = e.next), e.next != null && (e.next.prev = e.prev), e === this.head && (this.head = e.next), e === this.tail && (this.tail = e.prev), this.length -= 1);
  }
  iterator(e = this.head) {
    return () => {
      const n = e;
      return e != null && (e = e.next), n;
    };
  }
  find(e, n = !1) {
    const r = this.iterator();
    let i = r();
    for (; i; ) {
      const s = i.length();
      if (e < s || n && e === s && (i.next == null || i.next.length() !== 0))
        return [i, e];
      e -= s, i = r();
    }
    return [null, 0];
  }
  forEach(e) {
    const n = this.iterator();
    let r = n();
    for (; r; )
      e(r), r = n();
  }
  forEachAt(e, n, r) {
    if (n <= 0)
      return;
    const [i, s] = this.find(e);
    let o = e - s;
    const l = this.iterator(i);
    let a = l();
    for (; a && o < e + n; ) {
      const c = a.length();
      e > o ? r(
        a,
        e - o,
        Math.min(n, o + c - e)
      ) : r(a, 0, Math.min(c, e + n - o)), o += c, a = l();
    }
  }
  map(e) {
    return this.reduce((n, r) => (n.push(e(r)), n), []);
  }
  reduce(e, n) {
    const r = this.iterator();
    let i = r();
    for (; i; )
      n = e(n, i), i = r();
    return n;
  }
}
function Hf(t, e) {
  const n = e.find(t);
  if (n)
    return n;
  try {
    return e.create(t);
  } catch {
    const r = e.create(Se.INLINE);
    return Array.from(t.childNodes).forEach((i) => {
      r.domNode.appendChild(i);
    }), t.parentNode && t.parentNode.replaceChild(r.domNode, t), r.attach(), r;
  }
}
const vv = class Ai extends pv {
  constructor(e, n) {
    super(e, n), this.uiNode = null, this.build();
  }
  appendChild(e) {
    this.insertBefore(e);
  }
  attach() {
    super.attach(), this.children.forEach((e) => {
      e.attach();
    });
  }
  attachUI(e) {
    this.uiNode != null && this.uiNode.remove(), this.uiNode = e, Ai.uiClass && this.uiNode.classList.add(Ai.uiClass), this.uiNode.setAttribute("contenteditable", "false"), this.domNode.insertBefore(this.uiNode, this.domNode.firstChild);
  }
  /**
   * Called during construction, should fill its own children LinkedList.
   */
  build() {
    this.children = new XI(), Array.from(this.domNode.childNodes).filter((e) => e !== this.uiNode).reverse().forEach((e) => {
      try {
        const n = Hf(e, this.scroll);
        this.insertBefore(n, this.children.head || void 0);
      } catch (n) {
        if (n instanceof Bs)
          return;
        throw n;
      }
    });
  }
  deleteAt(e, n) {
    if (e === 0 && n === this.length())
      return this.remove();
    this.children.forEachAt(e, n, (r, i, s) => {
      r.deleteAt(i, s);
    });
  }
  descendant(e, n = 0) {
    const [r, i] = this.children.find(n);
    return e.blotName == null && e(r) || e.blotName != null && r instanceof e ? [r, i] : r instanceof Ai ? r.descendant(e, i) : [null, -1];
  }
  descendants(e, n = 0, r = Number.MAX_VALUE) {
    let i = [], s = r;
    return this.children.forEachAt(
      n,
      r,
      (o, l, a) => {
        (e.blotName == null && e(o) || e.blotName != null && o instanceof e) && i.push(o), o instanceof Ai && (i = i.concat(
          o.descendants(e, l, s)
        )), s -= a;
      }
    ), i;
  }
  detach() {
    this.children.forEach((e) => {
      e.detach();
    }), super.detach();
  }
  enforceAllowedChildren() {
    let e = !1;
    this.children.forEach((n) => {
      e || this.statics.allowedChildren.some(
        (r) => n instanceof r
      ) || (n.statics.scope === Se.BLOCK_BLOT ? (n.next != null && this.splitAfter(n), n.prev != null && this.splitAfter(n.prev), n.parent.unwrap(), e = !0) : n instanceof Ai ? n.unwrap() : n.remove());
    });
  }
  formatAt(e, n, r, i) {
    this.children.forEachAt(e, n, (s, o, l) => {
      s.formatAt(o, l, r, i);
    });
  }
  insertAt(e, n, r) {
    const [i, s] = this.children.find(e);
    if (i)
      i.insertAt(s, n, r);
    else {
      const o = r == null ? this.scroll.create("text", n) : this.scroll.create(n, r);
      this.appendChild(o);
    }
  }
  insertBefore(e, n) {
    e.parent != null && e.parent.children.remove(e);
    let r = null;
    this.children.insertBefore(e, n || null), e.parent = this, n != null && (r = n.domNode), (this.domNode.parentNode !== e.domNode || this.domNode.nextSibling !== r) && this.domNode.insertBefore(e.domNode, r), e.attach();
  }
  length() {
    return this.children.reduce((e, n) => e + n.length(), 0);
  }
  moveChildren(e, n) {
    this.children.forEach((r) => {
      e.insertBefore(r, n);
    });
  }
  optimize(e) {
    if (super.optimize(e), this.enforceAllowedChildren(), this.uiNode != null && this.uiNode !== this.domNode.firstChild && this.domNode.insertBefore(this.uiNode, this.domNode.firstChild), this.children.length === 0)
      if (this.statics.defaultChild != null) {
        const n = this.scroll.create(this.statics.defaultChild.blotName);
        this.appendChild(n);
      } else
        this.remove();
  }
  path(e, n = !1) {
    const [r, i] = this.children.find(e, n), s = [[this, e]];
    return r instanceof Ai ? s.concat(r.path(i, n)) : (r != null && s.push([r, i]), s);
  }
  removeChild(e) {
    this.children.remove(e);
  }
  replaceWith(e, n) {
    const r = typeof e == "string" ? this.scroll.create(e, n) : e;
    return r instanceof Ai && this.moveChildren(r), super.replaceWith(r);
  }
  split(e, n = !1) {
    if (!n) {
      if (e === 0)
        return this;
      if (e === this.length())
        return this.next;
    }
    const r = this.clone();
    return this.parent && this.parent.insertBefore(r, this.next || void 0), this.children.forEachAt(e, this.length(), (i, s, o) => {
      const l = i.split(s, n);
      l != null && r.appendChild(l);
    }), r;
  }
  splitAfter(e) {
    const n = this.clone();
    for (; e.next != null; )
      n.appendChild(e.next);
    return this.parent && this.parent.insertBefore(n, this.next || void 0), n;
  }
  unwrap() {
    this.parent && this.moveChildren(this.parent, this.next || void 0), this.remove();
  }
  update(e, n) {
    const r = [], i = [];
    e.forEach((s) => {
      s.target === this.domNode && s.type === "childList" && (r.push(...s.addedNodes), i.push(...s.removedNodes));
    }), i.forEach((s) => {
      if (s.parentNode != null && // @ts-expect-error Fix me later
      s.tagName !== "IFRAME" && document.body.compareDocumentPosition(s) & Node.DOCUMENT_POSITION_CONTAINED_BY)
        return;
      const o = this.scroll.find(s);
      o != null && (o.domNode.parentNode == null || o.domNode.parentNode === this.domNode) && o.detach();
    }), r.filter((s) => s.parentNode === this.domNode && s !== this.uiNode).sort((s, o) => s === o ? 0 : s.compareDocumentPosition(o) & Node.DOCUMENT_POSITION_FOLLOWING ? 1 : -1).forEach((s) => {
      let o = null;
      s.nextSibling != null && (o = this.scroll.find(s.nextSibling));
      const l = Hf(s, this.scroll);
      (l.next !== o || l.next == null) && (l.parent != null && l.parent.removeChild(this), this.insertBefore(l, o || void 0));
    }), this.enforceAllowedChildren();
  }
};
vv.uiClass = "";
let ZI = vv;
const Er = ZI;
function eO(t, e) {
  if (Object.keys(t).length !== Object.keys(e).length)
    return !1;
  for (const n in t)
    if (t[n] !== e[n])
      return !1;
  return !0;
}
const Es = class Ts extends Er {
  static create(e) {
    return super.create(e);
  }
  static formats(e, n) {
    const r = n.query(Ts.blotName);
    if (!(r != null && e.tagName === r.tagName)) {
      if (typeof this.tagName == "string")
        return !0;
      if (Array.isArray(this.tagName))
        return e.tagName.toLowerCase();
    }
  }
  constructor(e, n) {
    super(e, n), this.attributes = new ec(this.domNode);
  }
  format(e, n) {
    if (e === this.statics.blotName && !n)
      this.children.forEach((r) => {
        r instanceof Ts || (r = r.wrap(Ts.blotName, !0)), this.attributes.copy(r);
      }), this.unwrap();
    else {
      const r = this.scroll.query(e, Se.INLINE);
      if (r == null)
        return;
      r instanceof zr ? this.attributes.attribute(r, n) : n && (e !== this.statics.blotName || this.formats()[e] !== n) && this.replaceWith(e, n);
    }
  }
  formats() {
    const e = this.attributes.values(), n = this.statics.formats(this.domNode, this.scroll);
    return n != null && (e[this.statics.blotName] = n), e;
  }
  formatAt(e, n, r, i) {
    this.formats()[r] != null || this.scroll.query(r, Se.ATTRIBUTE) ? this.isolate(e, n).format(r, i) : super.formatAt(e, n, r, i);
  }
  optimize(e) {
    super.optimize(e);
    const n = this.formats();
    if (Object.keys(n).length === 0)
      return this.unwrap();
    const r = this.next;
    r instanceof Ts && r.prev === this && eO(n, r.formats()) && (r.moveChildren(this), r.remove());
  }
  replaceWith(e, n) {
    const r = super.replaceWith(e, n);
    return this.attributes.copy(r), r;
  }
  update(e, n) {
    super.update(e, n), e.some(
      (r) => r.target === this.domNode && r.type === "attributes"
    ) && this.attributes.build();
  }
  wrap(e, n) {
    const r = super.wrap(e, n);
    return r instanceof Ts && this.attributes.move(r), r;
  }
};
Es.allowedChildren = [Es, xn], Es.blotName = "inline", Es.scope = Se.INLINE_BLOT, Es.tagName = "SPAN";
let tO = Es;
const Vd = tO, As = class ku extends Er {
  static create(e) {
    return super.create(e);
  }
  static formats(e, n) {
    const r = n.query(ku.blotName);
    if (!(r != null && e.tagName === r.tagName)) {
      if (typeof this.tagName == "string")
        return !0;
      if (Array.isArray(this.tagName))
        return e.tagName.toLowerCase();
    }
  }
  constructor(e, n) {
    super(e, n), this.attributes = new ec(this.domNode);
  }
  format(e, n) {
    const r = this.scroll.query(e, Se.BLOCK);
    r != null && (r instanceof zr ? this.attributes.attribute(r, n) : e === this.statics.blotName && !n ? this.replaceWith(ku.blotName) : n && (e !== this.statics.blotName || this.formats()[e] !== n) && this.replaceWith(e, n));
  }
  formats() {
    const e = this.attributes.values(), n = this.statics.formats(this.domNode, this.scroll);
    return n != null && (e[this.statics.blotName] = n), e;
  }
  formatAt(e, n, r, i) {
    this.scroll.query(r, Se.BLOCK) != null ? this.format(r, i) : super.formatAt(e, n, r, i);
  }
  insertAt(e, n, r) {
    if (r == null || this.scroll.query(n, Se.INLINE) != null)
      super.insertAt(e, n, r);
    else {
      const i = this.split(e);
      if (i != null) {
        const s = this.scroll.create(n, r);
        i.parent.insertBefore(s, i);
      } else
        throw new Error("Attempt to insertAt after block boundaries");
    }
  }
  replaceWith(e, n) {
    const r = super.replaceWith(e, n);
    return this.attributes.copy(r), r;
  }
  update(e, n) {
    super.update(e, n), e.some(
      (r) => r.target === this.domNode && r.type === "attributes"
    ) && this.attributes.build();
  }
};
As.blotName = "block", As.scope = Se.BLOCK_BLOT, As.tagName = "P", As.allowedChildren = [
  Vd,
  As,
  xn
];
let nO = As;
const Ho = nO, Iu = class extends Er {
  checkMerge() {
    return this.next !== null && this.next.statics.blotName === this.statics.blotName;
  }
  deleteAt(e, n) {
    super.deleteAt(e, n), this.enforceAllowedChildren();
  }
  formatAt(e, n, r, i) {
    super.formatAt(e, n, r, i), this.enforceAllowedChildren();
  }
  insertAt(e, n, r) {
    super.insertAt(e, n, r), this.enforceAllowedChildren();
  }
  optimize(e) {
    super.optimize(e), this.children.length > 0 && this.next != null && this.checkMerge() && (this.next.moveChildren(this), this.next.remove());
  }
};
Iu.blotName = "container", Iu.scope = Se.BLOCK_BLOT;
let rO = Iu;
const tc = rO;
class iO extends xn {
  static formats(e, n) {
  }
  format(e, n) {
    super.formatAt(0, this.length(), e, n);
  }
  formatAt(e, n, r, i) {
    e === 0 && n === this.length() ? this.format(r, i) : super.formatAt(e, n, r, i);
  }
  formats() {
    return this.statics.formats(this.domNode, this.scroll);
  }
}
const tr = iO, sO = {
  attributes: !0,
  characterData: !0,
  characterDataOldValue: !0,
  childList: !0,
  subtree: !0
}, oO = 100, ks = class extends Er {
  constructor(e, n) {
    super(null, n), this.registry = e, this.scroll = this, this.build(), this.observer = new MutationObserver((r) => {
      this.update(r);
    }), this.observer.observe(this.domNode, sO), this.attach();
  }
  create(e, n) {
    return this.registry.create(this, e, n);
  }
  find(e, n = !1) {
    const r = this.registry.find(e, n);
    return r ? r.scroll === this ? r : n ? this.find(r.scroll.domNode.parentNode, !0) : null : null;
  }
  query(e, n = Se.ANY) {
    return this.registry.query(e, n);
  }
  register(...e) {
    return this.registry.register(...e);
  }
  build() {
    this.scroll != null && super.build();
  }
  detach() {
    super.detach(), this.observer.disconnect();
  }
  deleteAt(e, n) {
    this.update(), e === 0 && n === this.length() ? this.children.forEach((r) => {
      r.remove();
    }) : super.deleteAt(e, n);
  }
  formatAt(e, n, r, i) {
    this.update(), super.formatAt(e, n, r, i);
  }
  insertAt(e, n, r) {
    this.update(), super.insertAt(e, n, r);
  }
  optimize(e = [], n = {}) {
    super.optimize(n);
    const r = n.mutationsMap || /* @__PURE__ */ new WeakMap();
    let i = Array.from(this.observer.takeRecords());
    for (; i.length > 0; )
      e.push(i.pop());
    const s = (a, c = !0) => {
      a == null || a === this || a.domNode.parentNode != null && (r.has(a.domNode) || r.set(a.domNode, []), c && s(a.parent));
    }, o = (a) => {
      r.has(a.domNode) && (a instanceof Er && a.children.forEach(o), r.delete(a.domNode), a.optimize(n));
    };
    let l = e;
    for (let a = 0; l.length > 0; a += 1) {
      if (a >= oO)
        throw new Error("[Parchment] Maximum optimize iterations reached");
      for (l.forEach((c) => {
        const u = this.find(c.target, !0);
        u != null && (u.domNode === c.target && (c.type === "childList" ? (s(this.find(c.previousSibling, !1)), Array.from(c.addedNodes).forEach((d) => {
          const f = this.find(d, !1);
          s(f, !1), f instanceof Er && f.children.forEach((g) => {
            s(g, !1);
          });
        })) : c.type === "attributes" && s(u.prev)), s(u));
      }), this.children.forEach(o), l = Array.from(this.observer.takeRecords()), i = l.slice(); i.length > 0; )
        e.push(i.pop());
    }
  }
  update(e, n = {}) {
    e = e || this.observer.takeRecords();
    const r = /* @__PURE__ */ new WeakMap();
    e.map((i) => {
      const s = this.find(i.target, !0);
      return s == null ? null : r.has(s.domNode) ? (r.get(s.domNode).push(i), null) : (r.set(s.domNode, [i]), s);
    }).forEach((i) => {
      i != null && i !== this && r.has(i.domNode) && i.update(r.get(i.domNode) || [], n);
    }), n.mutationsMap = r, r.has(this.domNode) && super.update(r.get(this.domNode), n), this.optimize(e, n);
  }
};
ks.blotName = "scroll", ks.defaultChild = Ho, ks.allowedChildren = [Ho, tc], ks.scope = Se.BLOCK_BLOT, ks.tagName = "DIV";
let lO = ks;
const Hd = lO, Ou = class yv extends xn {
  static create(e) {
    return document.createTextNode(e);
  }
  static value(e) {
    return e.data;
  }
  constructor(e, n) {
    super(e, n), this.text = this.statics.value(this.domNode);
  }
  deleteAt(e, n) {
    this.domNode.data = this.text = this.text.slice(0, e) + this.text.slice(e + n);
  }
  index(e, n) {
    return this.domNode === e ? n : -1;
  }
  insertAt(e, n, r) {
    r == null ? (this.text = this.text.slice(0, e) + n + this.text.slice(e), this.domNode.data = this.text) : super.insertAt(e, n, r);
  }
  length() {
    return this.text.length;
  }
  optimize(e) {
    super.optimize(e), this.text = this.statics.value(this.domNode), this.text.length === 0 ? this.remove() : this.next instanceof yv && this.next.prev === this && (this.insertAt(this.length(), this.next.value()), this.next.remove());
  }
  position(e, n = !1) {
    return [this.domNode, e];
  }
  split(e, n = !1) {
    if (!n) {
      if (e === 0)
        return this;
      if (e === this.length())
        return this.next;
    }
    const r = this.scroll.create(this.domNode.splitText(e));
    return this.parent.insertBefore(r, this.next || void 0), this.text = this.statics.value(this.domNode), r;
  }
  update(e, n) {
    e.some((r) => r.type === "characterData" && r.target === this.domNode) && (this.text = this.statics.value(this.domNode));
  }
  value() {
    return this.text;
  }
};
Ou.blotName = "text", Ou.scope = Se.INLINE_BLOT;
let aO = Ou;
const $a = aO, cO = /* @__PURE__ */ Object.freeze(/* @__PURE__ */ Object.defineProperty({
  __proto__: null,
  Attributor: zr,
  AttributorStore: ec,
  BlockBlot: Ho,
  ClassAttributor: Or,
  ContainerBlot: tc,
  EmbedBlot: tr,
  InlineBlot: Vd,
  LeafBlot: xn,
  ParentBlot: Er,
  Registry: eo,
  Scope: Se,
  ScrollBlot: Hd,
  StyleAttributor: Vi,
  TextBlot: $a
}, Symbol.toStringTag, { value: "Module" }));
function zd(t) {
  return t && t.__esModule && Object.prototype.hasOwnProperty.call(t, "default") ? t.default : t;
}
var Du = { exports: {} }, Kn = -1, On = 1, Kt = 0;
function zo(t, e, n, r, i) {
  if (t === e)
    return t ? [[Kt, t]] : [];
  if (n != null) {
    var s = yO(t, e, n);
    if (s)
      return s;
  }
  var o = Wd(t, e), l = t.substring(0, o);
  t = t.substring(o), e = e.substring(o), o = nc(t, e);
  var a = t.substring(t.length - o);
  t = t.substring(0, t.length - o), e = e.substring(0, e.length - o);
  var c = uO(t, e);
  return l && c.unshift([Kt, l]), a && c.push([Kt, a]), Jd(c, i), r && fO(c), c;
}
function uO(t, e) {
  var n;
  if (!t)
    return [[On, e]];
  if (!e)
    return [[Kn, t]];
  var r = t.length > e.length ? t : e, i = t.length > e.length ? e : t, s = r.indexOf(i);
  if (s !== -1)
    return n = [
      [On, r.substring(0, s)],
      [Kt, i],
      [On, r.substring(s + i.length)]
    ], t.length > e.length && (n[0][0] = n[2][0] = Kn), n;
  if (i.length === 1)
    return [
      [Kn, t],
      [On, e]
    ];
  var o = hO(t, e);
  if (o) {
    var l = o[0], a = o[1], c = o[2], u = o[3], d = o[4], f = zo(l, c), g = zo(a, u);
    return f.concat([[Kt, d]], g);
  }
  return dO(t, e);
}
function dO(t, e) {
  for (var n = t.length, r = e.length, i = Math.ceil((n + r) / 2), s = i, o = 2 * i, l = new Array(o), a = new Array(o), c = 0; c < o; c++)
    l[c] = -1, a[c] = -1;
  l[s + 1] = 0, a[s + 1] = 0;
  for (var u = n - r, d = u % 2 !== 0, f = 0, g = 0, p = 0, S = 0, _ = 0; _ < i; _++) {
    for (var m = -_ + f; m <= _ - g; m += 2) {
      var y = s + m, v;
      m === -_ || m !== _ && l[y - 1] < l[y + 1] ? v = l[y + 1] : v = l[y - 1] + 1;
      for (var x = v - m; v < n && x < r && t.charAt(v) === e.charAt(x); )
        v++, x++;
      if (l[y] = v, v > n)
        g += 2;
      else if (x > r)
        f += 2;
      else if (d) {
        var C = s + u - m;
        if (C >= 0 && C < o && a[C] !== -1) {
          var E = n - a[C];
          if (v >= E)
            return zf(t, e, v, x);
        }
      }
    }
    for (var k = -_ + p; k <= _ - S; k += 2) {
      var C = s + k, E;
      k === -_ || k !== _ && a[C - 1] < a[C + 1] ? E = a[C + 1] : E = a[C - 1] + 1;
      for (var L = E - k; E < n && L < r && t.charAt(n - E - 1) === e.charAt(r - L - 1); )
        E++, L++;
      if (a[C] = E, E > n)
        S += 2;
      else if (L > r)
        p += 2;
      else if (!d) {
        var y = s + u - k;
        if (y >= 0 && y < o && l[y] !== -1) {
          var v = l[y], x = s + v - y;
          if (E = n - E, v >= E)
            return zf(t, e, v, x);
        }
      }
    }
  }
  return [
    [Kn, t],
    [On, e]
  ];
}
function zf(t, e, n, r) {
  var i = t.substring(0, n), s = e.substring(0, r), o = t.substring(n), l = e.substring(r), a = zo(i, s), c = zo(o, l);
  return a.concat(c);
}
function Wd(t, e) {
  if (!t || !e || t.charAt(0) !== e.charAt(0))
    return 0;
  for (var n = 0, r = Math.min(t.length, e.length), i = r, s = 0; n < i; )
    t.substring(s, i) == e.substring(s, i) ? (n = i, s = n) : r = i, i = Math.floor((r - n) / 2 + n);
  return bv(t.charCodeAt(i - 1)) && i--, i;
}
function Wf(t, e) {
  var n = t.length, r = e.length;
  if (n == 0 || r == 0)
    return 0;
  n > r ? t = t.substring(n - r) : n < r && (e = e.substring(0, n));
  var i = Math.min(n, r);
  if (t == e)
    return i;
  for (var s = 0, o = 1; ; ) {
    var l = t.substring(i - o), a = e.indexOf(l);
    if (a == -1)
      return s;
    o += a, (a == 0 || t.substring(i - o) == e.substring(0, o)) && (s = o, o++);
  }
}
function nc(t, e) {
  if (!t || !e || t.slice(-1) !== e.slice(-1))
    return 0;
  for (var n = 0, r = Math.min(t.length, e.length), i = r, s = 0; n < i; )
    t.substring(t.length - i, t.length - s) == e.substring(e.length - i, e.length - s) ? (n = i, s = n) : r = i, i = Math.floor((r - n) / 2 + n);
  return wv(t.charCodeAt(t.length - i)) && i--, i;
}
function hO(t, e) {
  var n = t.length > e.length ? t : e, r = t.length > e.length ? e : t;
  if (n.length < 4 || r.length * 2 < n.length)
    return null;
  function i(g, p, S) {
    for (var _ = g.substring(S, S + Math.floor(g.length / 4)), m = -1, y = "", v, x, C, E; (m = p.indexOf(_, m + 1)) !== -1; ) {
      var k = Wd(
        g.substring(S),
        p.substring(m)
      ), L = nc(
        g.substring(0, S),
        p.substring(0, m)
      );
      y.length < L + k && (y = p.substring(m - L, m) + p.substring(m, m + k), v = g.substring(0, S - L), x = g.substring(S + k), C = p.substring(0, m - L), E = p.substring(m + k));
    }
    return y.length * 2 >= g.length ? [
      v,
      x,
      C,
      E,
      y
    ] : null;
  }
  var s = i(
    n,
    r,
    Math.ceil(n.length / 4)
  ), o = i(
    n,
    r,
    Math.ceil(n.length / 2)
  ), l;
  if (!s && !o)
    return null;
  o ? s ? l = s[4].length > o[4].length ? s : o : l = o : l = s;
  var a, c, u, d;
  t.length > e.length ? (a = l[0], c = l[1], u = l[2], d = l[3]) : (u = l[0], d = l[1], a = l[2], c = l[3]);
  var f = l[4];
  return [a, c, u, d, f];
}
function fO(t) {
  for (var e = !1, n = [], r = 0, i = null, s = 0, o = 0, l = 0, a = 0, c = 0; s < t.length; )
    t[s][0] == Kt ? (n[r++] = s, o = a, l = c, a = 0, c = 0, i = t[s][1]) : (t[s][0] == On ? a += t[s][1].length : c += t[s][1].length, i && i.length <= Math.max(o, l) && i.length <= Math.max(a, c) && (t.splice(n[r - 1], 0, [
      Kn,
      i
    ]), t[n[r - 1] + 1][0] = On, r--, r--, s = r > 0 ? n[r - 1] : -1, o = 0, l = 0, a = 0, c = 0, i = null, e = !0)), s++;
  for (e && Jd(t), mO(t), s = 1; s < t.length; ) {
    if (t[s - 1][0] == Kn && t[s][0] == On) {
      var u = t[s - 1][1], d = t[s][1], f = Wf(u, d), g = Wf(d, u);
      f >= g ? (f >= u.length / 2 || f >= d.length / 2) && (t.splice(s, 0, [
        Kt,
        d.substring(0, f)
      ]), t[s - 1][1] = u.substring(
        0,
        u.length - f
      ), t[s + 1][1] = d.substring(f), s++) : (g >= u.length / 2 || g >= d.length / 2) && (t.splice(s, 0, [
        Kt,
        u.substring(0, g)
      ]), t[s - 1][0] = On, t[s - 1][1] = d.substring(
        0,
        d.length - g
      ), t[s + 1][0] = Kn, t[s + 1][1] = u.substring(g), s++), s++;
    }
    s++;
  }
}
var Jf = /[^a-zA-Z0-9]/, Qf = /\s/, Kf = /[\r\n]/, gO = /\n\r?\n$/, pO = /^\r?\n\r?\n/;
function mO(t) {
  function e(g, p) {
    if (!g || !p)
      return 6;
    var S = g.charAt(g.length - 1), _ = p.charAt(0), m = S.match(Jf), y = _.match(Jf), v = m && S.match(Qf), x = y && _.match(Qf), C = v && S.match(Kf), E = x && _.match(Kf), k = C && g.match(gO), L = E && p.match(pO);
    return k || L ? 5 : C || E ? 4 : m && !v && x ? 3 : v || x ? 2 : m || y ? 1 : 0;
  }
  for (var n = 1; n < t.length - 1; ) {
    if (t[n - 1][0] == Kt && t[n + 1][0] == Kt) {
      var r = t[n - 1][1], i = t[n][1], s = t[n + 1][1], o = nc(r, i);
      if (o) {
        var l = i.substring(i.length - o);
        r = r.substring(0, r.length - o), i = l + i.substring(0, i.length - o), s = l + s;
      }
      for (var a = r, c = i, u = s, d = e(r, i) + e(i, s); i.charAt(0) === s.charAt(0); ) {
        r += i.charAt(0), i = i.substring(1) + s.charAt(0), s = s.substring(1);
        var f = e(r, i) + e(i, s);
        f >= d && (d = f, a = r, c = i, u = s);
      }
      t[n - 1][1] != a && (a ? t[n - 1][1] = a : (t.splice(n - 1, 1), n--), t[n][1] = c, u ? t[n + 1][1] = u : (t.splice(n + 1, 1), n--));
    }
    n++;
  }
}
function Jd(t, e) {
  t.push([Kt, ""]);
  for (var n = 0, r = 0, i = 0, s = "", o = "", l; n < t.length; ) {
    if (n < t.length - 1 && !t[n][1]) {
      t.splice(n, 1);
      continue;
    }
    switch (t[n][0]) {
      case On:
        i++, o += t[n][1], n++;
        break;
      case Kn:
        r++, s += t[n][1], n++;
        break;
      case Kt:
        var a = n - i - r - 1;
        if (e) {
          if (a >= 0 && Sv(t[a][1])) {
            var c = t[a][1].slice(-1);
            if (t[a][1] = t[a][1].slice(
              0,
              -1
            ), s = c + s, o = c + o, !t[a][1]) {
              t.splice(a, 1), n--;
              var u = a - 1;
              t[u] && t[u][0] === On && (i++, o = t[u][1] + o, u--), t[u] && t[u][0] === Kn && (r++, s = t[u][1] + s, u--), a = u;
            }
          }
          if (_v(t[n][1])) {
            var c = t[n][1].charAt(0);
            t[n][1] = t[n][1].slice(1), s += c, o += c;
          }
        }
        if (n < t.length - 1 && !t[n][1]) {
          t.splice(n, 1);
          break;
        }
        if (s.length > 0 || o.length > 0) {
          s.length > 0 && o.length > 0 && (l = Wd(o, s), l !== 0 && (a >= 0 ? t[a][1] += o.substring(
            0,
            l
          ) : (t.splice(0, 0, [
            Kt,
            o.substring(0, l)
          ]), n++), o = o.substring(l), s = s.substring(l)), l = nc(o, s), l !== 0 && (t[n][1] = o.substring(o.length - l) + t[n][1], o = o.substring(
            0,
            o.length - l
          ), s = s.substring(
            0,
            s.length - l
          )));
          var d = i + r;
          s.length === 0 && o.length === 0 ? (t.splice(n - d, d), n = n - d) : s.length === 0 ? (t.splice(n - d, d, [On, o]), n = n - d + 1) : o.length === 0 ? (t.splice(n - d, d, [Kn, s]), n = n - d + 1) : (t.splice(
            n - d,
            d,
            [Kn, s],
            [On, o]
          ), n = n - d + 2);
        }
        n !== 0 && t[n - 1][0] === Kt ? (t[n - 1][1] += t[n][1], t.splice(n, 1)) : n++, i = 0, r = 0, s = "", o = "";
        break;
    }
  }
  t[t.length - 1][1] === "" && t.pop();
  var f = !1;
  for (n = 1; n < t.length - 1; )
    t[n - 1][0] === Kt && t[n + 1][0] === Kt && (t[n][1].substring(
      t[n][1].length - t[n - 1][1].length
    ) === t[n - 1][1] ? (t[n][1] = t[n - 1][1] + t[n][1].substring(
      0,
      t[n][1].length - t[n - 1][1].length
    ), t[n + 1][1] = t[n - 1][1] + t[n + 1][1], t.splice(n - 1, 1), f = !0) : t[n][1].substring(0, t[n + 1][1].length) == t[n + 1][1] && (t[n - 1][1] += t[n + 1][1], t[n][1] = t[n][1].substring(t[n + 1][1].length) + t[n + 1][1], t.splice(n + 1, 1), f = !0)), n++;
  f && Jd(t, e);
}
function bv(t) {
  return t >= 55296 && t <= 56319;
}
function wv(t) {
  return t >= 56320 && t <= 57343;
}
function _v(t) {
  return wv(t.charCodeAt(0));
}
function Sv(t) {
  return bv(t.charCodeAt(t.length - 1));
}
function vO(t) {
  for (var e = [], n = 0; n < t.length; n++)
    t[n][1].length > 0 && e.push(t[n]);
  return e;
}
function Lc(t, e, n, r) {
  return Sv(t) || _v(r) ? null : vO([
    [Kt, t],
    [Kn, e],
    [On, n],
    [Kt, r]
  ]);
}
function yO(t, e, n) {
  var r = typeof n == "number" ? { index: n, length: 0 } : n.oldRange, i = typeof n == "number" ? null : n.newRange, s = t.length, o = e.length;
  if (r.length === 0 && (i === null || i.length === 0)) {
    var l = r.index, a = t.slice(0, l), c = t.slice(l), u = i ? i.index : null;
    e: {
      var d = l + o - s;
      if (u !== null && u !== d || d < 0 || d > o)
        break e;
      var f = e.slice(0, d), g = e.slice(d);
      if (g !== c)
        break e;
      var p = Math.min(l, d), S = a.slice(0, p), _ = f.slice(0, p);
      if (S !== _)
        break e;
      var m = a.slice(p), y = f.slice(p);
      return Lc(S, m, y, c);
    }
    e: {
      if (u !== null && u !== l)
        break e;
      var v = l, f = e.slice(0, v), g = e.slice(v);
      if (f !== a)
        break e;
      var x = Math.min(s - v, o - v), C = c.slice(c.length - x), E = g.slice(g.length - x);
      if (C !== E)
        break e;
      var m = c.slice(0, c.length - x), y = g.slice(0, g.length - x);
      return Lc(a, m, y, C);
    }
  }
  if (r.length > 0 && i && i.length === 0)
    e: {
      var S = t.slice(0, r.index), C = t.slice(r.index + r.length), p = S.length, x = C.length;
      if (o < p + x)
        break e;
      var _ = e.slice(0, p), E = e.slice(o - x);
      if (S !== _ || C !== E)
        break e;
      var m = t.slice(p, s - x), y = e.slice(p, o - x);
      return Lc(S, m, y, C);
    }
  return null;
}
function rc(t, e, n, r) {
  return zo(t, e, n, r, !0);
}
rc.INSERT = On;
rc.DELETE = Kn;
rc.EQUAL = Kt;
var bO = rc, Ea = { exports: {} };
Ea.exports;
(function(t, e) {
  var n = 200, r = "__lodash_hash_undefined__", i = 9007199254740991, s = "[object Arguments]", o = "[object Array]", l = "[object Boolean]", a = "[object Date]", c = "[object Error]", u = "[object Function]", d = "[object GeneratorFunction]", f = "[object Map]", g = "[object Number]", p = "[object Object]", S = "[object Promise]", _ = "[object RegExp]", m = "[object Set]", y = "[object String]", v = "[object Symbol]", x = "[object WeakMap]", C = "[object ArrayBuffer]", E = "[object DataView]", k = "[object Float32Array]", L = "[object Float64Array]", M = "[object Int8Array]", G = "[object Int16Array]", Y = "[object Int32Array]", ie = "[object Uint8Array]", X = "[object Uint8ClampedArray]", V = "[object Uint16Array]", U = "[object Uint32Array]", W = /[\\^$.*+?()[\]{}|]/g, ce = /\w*$/, ue = /^\[object .+?Constructor\]$/, xe = /^(?:0|[1-9]\d*)$/, H = {};
  H[s] = H[o] = H[C] = H[E] = H[l] = H[a] = H[k] = H[L] = H[M] = H[G] = H[Y] = H[f] = H[g] = H[p] = H[_] = H[m] = H[y] = H[v] = H[ie] = H[X] = H[V] = H[U] = !0, H[c] = H[u] = H[x] = !1;
  var ee = typeof window == "object" && window && window.Object === Object && window, se = typeof self == "object" && self && self.Object === Object && self, K = ee || se || Function("return this")(), re = e && !e.nodeType && e, J = re && !0 && t && !t.nodeType && t, he = J && J.exports === re;
  function be(b, A) {
    return b.set(A[0], A[1]), b;
  }
  function me(b, A) {
    return b.add(A), b;
  }
  function oe(b, A) {
    for (var O = -1, z = b ? b.length : 0; ++O < z && A(b[O], O, b) !== !1; )
      ;
    return b;
  }
  function Qe(b, A) {
    for (var O = -1, z = A.length, je = b.length; ++O < z; )
      b[je + O] = A[O];
    return b;
  }
  function Ae(b, A, O, z) {
    for (var je = -1, $e = b ? b.length : 0; ++je < $e; )
      O = A(O, b[je], je, b);
    return O;
  }
  function Ye(b, A) {
    for (var O = -1, z = Array(b); ++O < b; )
      z[O] = A(O);
    return z;
  }
  function De(b, A) {
    return b?.[A];
  }
  function Oe(b) {
    var A = !1;
    if (b != null && typeof b.toString != "function")
      try {
        A = !!(b + "");
      } catch {
      }
    return A;
  }
  function nt(b) {
    var A = -1, O = Array(b.size);
    return b.forEach(function(z, je) {
      O[++A] = [je, z];
    }), O;
  }
  function We(b, A) {
    return function(O) {
      return b(A(O));
    };
  }
  function gt(b) {
    var A = -1, O = Array(b.size);
    return b.forEach(function(z) {
      O[++A] = z;
    }), O;
  }
  var ht = Array.prototype, it = Function.prototype, ot = Object.prototype, wt = K["__core-js_shared__"], pt = function() {
    var b = /[^.]+$/.exec(wt && wt.keys && wt.keys.IE_PROTO || "");
    return b ? "Symbol(src)_1." + b : "";
  }(), lt = it.toString, Ge = ot.hasOwnProperty, yt = ot.toString, at = RegExp(
    "^" + lt.call(Ge).replace(W, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
  ), te = he ? K.Buffer : void 0, pe = K.Symbol, tt = K.Uint8Array, Be = We(Object.getPrototypeOf, Object), It = Object.create, nn = ot.propertyIsEnumerable, Lr = ht.splice, Ln = Object.getOwnPropertySymbols, Nr = te ? te.isBuffer : void 0, wi = We(Object.keys, Object), nr = un(K, "DataView"), pn = un(K, "Map"), Ft = un(K, "Promise"), rn = un(K, "Set"), Vt = un(K, "WeakMap"), Lt = un(Object, "create"), rr = Rt(nr), sn = Rt(pn), ir = Rt(Ft), Fn = Rt(rn), Pr = Rt(Vt), Nn = pe ? pe.prototype : void 0, Rr = Nn ? Nn.valueOf : void 0;
  function Pt(b) {
    var A = -1, O = b ? b.length : 0;
    for (this.clear(); ++A < O; ) {
      var z = b[A];
      this.set(z[0], z[1]);
    }
  }
  function on() {
    this.__data__ = Lt ? Lt(null) : {};
  }
  function cn(b) {
    return this.has(b) && delete this.__data__[b];
  }
  function sr(b) {
    var A = this.__data__;
    if (Lt) {
      var O = A[b];
      return O === r ? void 0 : O;
    }
    return Ge.call(A, b) ? A[b] : void 0;
  }
  function mn(b) {
    var A = this.__data__;
    return Lt ? A[b] !== void 0 : Ge.call(A, b);
  }
  function or(b, A) {
    var O = this.__data__;
    return O[b] = Lt && A === void 0 ? r : A, this;
  }
  Pt.prototype.clear = on, Pt.prototype.delete = cn, Pt.prototype.get = sr, Pt.prototype.has = mn, Pt.prototype.set = or;
  function mt(b) {
    var A = -1, O = b ? b.length : 0;
    for (this.clear(); ++A < O; ) {
      var z = b[A];
      this.set(z[0], z[1]);
    }
  }
  function Mr() {
    this.__data__ = [];
  }
  function _i(b) {
    var A = this.__data__, O = ge(A, b);
    if (O < 0)
      return !1;
    var z = A.length - 1;
    return O == z ? A.pop() : Lr.call(A, O, 1), !0;
  }
  function Vn(b) {
    var A = this.__data__, O = ge(A, b);
    return O < 0 ? void 0 : A[O][1];
  }
  function Pn(b) {
    return ge(this.__data__, b) > -1;
  }
  function Yr(b, A) {
    var O = this.__data__, z = ge(O, b);
    return z < 0 ? O.push([b, A]) : O[z][1] = A, this;
  }
  mt.prototype.clear = Mr, mt.prototype.delete = _i, mt.prototype.get = Vn, mt.prototype.has = Pn, mt.prototype.set = Yr;
  function _t(b) {
    var A = -1, O = b ? b.length : 0;
    for (this.clear(); ++A < O; ) {
      var z = b[A];
      this.set(z[0], z[1]);
    }
  }
  function Si() {
    this.__data__ = {
      hash: new Pt(),
      map: new (pn || mt)(),
      string: new Pt()
    };
  }
  function lr(b) {
    return yn(this, b).delete(b);
  }
  function Rn(b) {
    return yn(this, b).get(b);
  }
  function xi(b) {
    return yn(this, b).has(b);
  }
  function q(b, A) {
    return yn(this, b).set(b, A), this;
  }
  _t.prototype.clear = Si, _t.prototype.delete = lr, _t.prototype.get = Rn, _t.prototype.has = xi, _t.prototype.set = q;
  function j(b) {
    this.__data__ = new mt(b);
  }
  function le() {
    this.__data__ = new mt();
  }
  function ve(b) {
    return this.__data__.delete(b);
  }
  function Ke(b) {
    return this.__data__.get(b);
  }
  function Re(b) {
    return this.__data__.has(b);
  }
  function N(b, A) {
    var O = this.__data__;
    if (O instanceof mt) {
      var z = O.__data__;
      if (!pn || z.length < n - 1)
        return z.push([b, A]), this;
      O = this.__data__ = new _t(z);
    }
    return O.set(b, A), this;
  }
  j.prototype.clear = le, j.prototype.delete = ve, j.prototype.get = Ke, j.prototype.has = Re, j.prototype.set = N;
  function F(b, A) {
    var O = uo(b) || _s(b) ? Ye(b.length, String) : [], z = O.length, je = !!z;
    for (var $e in b)
      Ge.call(b, $e) && !(je && ($e == "length" || Ci($e, z))) && O.push($e);
    return O;
  }
  function ae(b, A, O) {
    var z = b[A];
    (!(Ge.call(b, A) && gl(z, O)) || O === void 0 && !(A in b)) && (b[A] = O);
  }
  function ge(b, A) {
    for (var O = b.length; O--; )
      if (gl(b[O][0], A))
        return O;
    return -1;
  }
  function ke(b, A) {
    return b && Ot(A, fo(A), b);
  }
  function Ze(b, A, O, z, je, $e, ct) {
    var st;
    if (z && (st = $e ? z(b, je, $e, ct) : z(b)), st !== void 0)
      return st;
    if (!qr(b))
      return b;
    var Mt = uo(b);
    if (Mt) {
      if (st = bs(b), !A)
        return He(b, st);
    } else {
      var ft = Ht(b), bn = ft == u || ft == d;
      if (pl(b))
        return vn(b, A);
      if (ft == p || ft == s || bn && !$e) {
        if (Oe(b))
          return $e ? b : {};
        if (st = Tn(bn ? {} : b), !A)
          return $t(b, ke(st, b));
      } else {
        if (!H[ft])
          return $e ? b : {};
        st = Hi(b, ft, Ze, A);
      }
    }
    ct || (ct = new j());
    var Bn = ct.get(b);
    if (Bn)
      return Bn;
    if (ct.set(b, st), !Mt)
      var zt = O ? En(b) : fo(b);
    return oe(zt || b, function(wn, hn) {
      zt && (hn = wn, wn = b[hn]), ae(st, hn, Ze(wn, A, O, z, hn, b, ct));
    }), st;
  }
  function St(b) {
    return qr(b) ? It(b) : {};
  }
  function Fe(b, A, O) {
    var z = A(b);
    return uo(b) ? z : Qe(z, O(b));
  }
  function At(b) {
    return yt.call(b);
  }
  function xt(b) {
    if (!qr(b) || ws(b))
      return !1;
    var A = ho(b) || Oe(b) ? at : ue;
    return A.test(Rt(b));
  }
  function Mn(b) {
    if (!Xr(b))
      return wi(b);
    var A = [];
    for (var O in Object(b))
      Ge.call(b, O) && O != "constructor" && A.push(O);
    return A;
  }
  function vn(b, A) {
    if (A)
      return b.slice();
    var O = new b.constructor(b.length);
    return b.copy(O), O;
  }
  function qn(b) {
    var A = new b.constructor(b.byteLength);
    return new tt(A).set(new tt(b)), A;
  }
  function Ce(b, A) {
    var O = A ? qn(b.buffer) : b.buffer;
    return new b.constructor(O, b.byteOffset, b.byteLength);
  }
  function et(b, A, O) {
    var z = A ? O(nt(b), !0) : nt(b);
    return Ae(z, be, new b.constructor());
  }
  function Ct(b) {
    var A = new b.constructor(b.source, ce.exec(b));
    return A.lastIndex = b.lastIndex, A;
  }
  function Ue(b, A, O) {
    var z = A ? O(gt(b), !0) : gt(b);
    return Ae(z, me, new b.constructor());
  }
  function Je(b) {
    return Rr ? Object(Rr.call(b)) : {};
  }
  function $n(b, A) {
    var O = A ? qn(b.buffer) : b.buffer;
    return new b.constructor(O, b.byteOffset, b.length);
  }
  function He(b, A) {
    var O = -1, z = b.length;
    for (A || (A = Array(z)); ++O < z; )
      A[O] = b[O];
    return A;
  }
  function Ot(b, A, O, z) {
    O || (O = {});
    for (var je = -1, $e = A.length; ++je < $e; ) {
      var ct = A[je], st = void 0;
      ae(O, ct, st === void 0 ? b[ct] : st);
    }
    return O;
  }
  function $t(b, A) {
    return Ot(b, dn(b), A);
  }
  function En(b) {
    return Fe(b, fo, dn);
  }
  function yn(b, A) {
    var O = b.__data__;
    return $i(A) ? O[typeof A == "string" ? "string" : "hash"] : O.map;
  }
  function un(b, A) {
    var O = De(b, A);
    return xt(O) ? O : void 0;
  }
  var dn = Ln ? We(Ln, Object) : hc, Ht = At;
  (nr && Ht(new nr(new ArrayBuffer(1))) != E || pn && Ht(new pn()) != f || Ft && Ht(Ft.resolve()) != S || rn && Ht(new rn()) != m || Vt && Ht(new Vt()) != x) && (Ht = function(b) {
    var A = yt.call(b), O = A == p ? b.constructor : void 0, z = O ? Rt(O) : void 0;
    if (z)
      switch (z) {
        case rr:
          return E;
        case sn:
          return f;
        case ir:
          return S;
        case Fn:
          return m;
        case Pr:
          return x;
      }
    return A;
  });
  function bs(b) {
    var A = b.length, O = b.constructor(A);
    return A && typeof b[0] == "string" && Ge.call(b, "index") && (O.index = b.index, O.input = b.input), O;
  }
  function Tn(b) {
    return typeof b.constructor == "function" && !Xr(b) ? St(Be(b)) : {};
  }
  function Hi(b, A, O, z) {
    var je = b.constructor;
    switch (A) {
      case C:
        return qn(b);
      case l:
      case a:
        return new je(+b);
      case E:
        return Ce(b, z);
      case k:
      case L:
      case M:
      case G:
      case Y:
      case ie:
      case X:
      case V:
      case U:
        return $n(b, z);
      case f:
        return et(b, z, O);
      case g:
      case y:
        return new je(b);
      case _:
        return Ct(b);
      case m:
        return Ue(b, z, O);
      case v:
        return Je(b);
    }
  }
  function Ci(b, A) {
    return A = A ?? i, !!A && (typeof b == "number" || xe.test(b)) && b > -1 && b % 1 == 0 && b < A;
  }
  function $i(b) {
    var A = typeof b;
    return A == "string" || A == "number" || A == "symbol" || A == "boolean" ? b !== "__proto__" : b === null;
  }
  function ws(b) {
    return !!pt && pt in b;
  }
  function Xr(b) {
    var A = b && b.constructor, O = typeof A == "function" && A.prototype || ot;
    return b === O;
  }
  function Rt(b) {
    if (b != null) {
      try {
        return lt.call(b);
      } catch {
      }
      try {
        return b + "";
      } catch {
      }
    }
    return "";
  }
  function fl(b) {
    return Ze(b, !0, !0);
  }
  function gl(b, A) {
    return b === A || b !== b && A !== A;
  }
  function _s(b) {
    return dc(b) && Ge.call(b, "callee") && (!nn.call(b, "callee") || yt.call(b) == s);
  }
  var uo = Array.isArray;
  function Ss(b) {
    return b != null && ml(b.length) && !ho(b);
  }
  function dc(b) {
    return vl(b) && Ss(b);
  }
  var pl = Nr || fc;
  function ho(b) {
    var A = qr(b) ? yt.call(b) : "";
    return A == u || A == d;
  }
  function ml(b) {
    return typeof b == "number" && b > -1 && b % 1 == 0 && b <= i;
  }
  function qr(b) {
    var A = typeof b;
    return !!b && (A == "object" || A == "function");
  }
  function vl(b) {
    return !!b && typeof b == "object";
  }
  function fo(b) {
    return Ss(b) ? F(b) : Mn(b);
  }
  function hc() {
    return [];
  }
  function fc() {
    return !1;
  }
  t.exports = fl;
})(Ea, Ea.exports);
var xv = Ea.exports, Ta = { exports: {} };
Ta.exports;
(function(t, e) {
  var n = 200, r = "__lodash_hash_undefined__", i = 1, s = 2, o = 9007199254740991, l = "[object Arguments]", a = "[object Array]", c = "[object AsyncFunction]", u = "[object Boolean]", d = "[object Date]", f = "[object Error]", g = "[object Function]", p = "[object GeneratorFunction]", S = "[object Map]", _ = "[object Number]", m = "[object Null]", y = "[object Object]", v = "[object Promise]", x = "[object Proxy]", C = "[object RegExp]", E = "[object Set]", k = "[object String]", L = "[object Symbol]", M = "[object Undefined]", G = "[object WeakMap]", Y = "[object ArrayBuffer]", ie = "[object DataView]", X = "[object Float32Array]", V = "[object Float64Array]", U = "[object Int8Array]", W = "[object Int16Array]", ce = "[object Int32Array]", ue = "[object Uint8Array]", xe = "[object Uint8ClampedArray]", H = "[object Uint16Array]", ee = "[object Uint32Array]", se = /[\\^$.*+?()[\]{}|]/g, K = /^\[object .+?Constructor\]$/, re = /^(?:0|[1-9]\d*)$/, J = {};
  J[X] = J[V] = J[U] = J[W] = J[ce] = J[ue] = J[xe] = J[H] = J[ee] = !0, J[l] = J[a] = J[Y] = J[u] = J[ie] = J[d] = J[f] = J[g] = J[S] = J[_] = J[y] = J[C] = J[E] = J[k] = J[G] = !1;
  var he = typeof window == "object" && window && window.Object === Object && window, be = typeof self == "object" && self && self.Object === Object && self, me = he || be || Function("return this")(), oe = e && !e.nodeType && e, Qe = oe && !0 && t && !t.nodeType && t, Ae = Qe && Qe.exports === oe, Ye = Ae && he.process, De = function() {
    try {
      return Ye && Ye.binding && Ye.binding("util");
    } catch {
    }
  }(), Oe = De && De.isTypedArray;
  function nt(b, A) {
    for (var O = -1, z = b == null ? 0 : b.length, je = 0, $e = []; ++O < z; ) {
      var ct = b[O];
      A(ct, O, b) && ($e[je++] = ct);
    }
    return $e;
  }
  function We(b, A) {
    for (var O = -1, z = A.length, je = b.length; ++O < z; )
      b[je + O] = A[O];
    return b;
  }
  function gt(b, A) {
    for (var O = -1, z = b == null ? 0 : b.length; ++O < z; )
      if (A(b[O], O, b))
        return !0;
    return !1;
  }
  function ht(b, A) {
    for (var O = -1, z = Array(b); ++O < b; )
      z[O] = A(O);
    return z;
  }
  function it(b) {
    return function(A) {
      return b(A);
    };
  }
  function ot(b, A) {
    return b.has(A);
  }
  function wt(b, A) {
    return b?.[A];
  }
  function pt(b) {
    var A = -1, O = Array(b.size);
    return b.forEach(function(z, je) {
      O[++A] = [je, z];
    }), O;
  }
  function lt(b, A) {
    return function(O) {
      return b(A(O));
    };
  }
  function Ge(b) {
    var A = -1, O = Array(b.size);
    return b.forEach(function(z) {
      O[++A] = z;
    }), O;
  }
  var yt = Array.prototype, at = Function.prototype, te = Object.prototype, pe = me["__core-js_shared__"], tt = at.toString, Be = te.hasOwnProperty, It = function() {
    var b = /[^.]+$/.exec(pe && pe.keys && pe.keys.IE_PROTO || "");
    return b ? "Symbol(src)_1." + b : "";
  }(), nn = te.toString, Lr = RegExp(
    "^" + tt.call(Be).replace(se, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"
  ), Ln = Ae ? me.Buffer : void 0, Nr = me.Symbol, wi = me.Uint8Array, nr = te.propertyIsEnumerable, pn = yt.splice, Ft = Nr ? Nr.toStringTag : void 0, rn = Object.getOwnPropertySymbols, Vt = Ln ? Ln.isBuffer : void 0, Lt = lt(Object.keys, Object), rr = dn(me, "DataView"), sn = dn(me, "Map"), ir = dn(me, "Promise"), Fn = dn(me, "Set"), Pr = dn(me, "WeakMap"), Nn = dn(Object, "create"), Rr = Rt(rr), Pt = Rt(sn), on = Rt(ir), cn = Rt(Fn), sr = Rt(Pr), mn = Nr ? Nr.prototype : void 0, or = mn ? mn.valueOf : void 0;
  function mt(b) {
    var A = -1, O = b == null ? 0 : b.length;
    for (this.clear(); ++A < O; ) {
      var z = b[A];
      this.set(z[0], z[1]);
    }
  }
  function Mr() {
    this.__data__ = Nn ? Nn(null) : {}, this.size = 0;
  }
  function _i(b) {
    var A = this.has(b) && delete this.__data__[b];
    return this.size -= A ? 1 : 0, A;
  }
  function Vn(b) {
    var A = this.__data__;
    if (Nn) {
      var O = A[b];
      return O === r ? void 0 : O;
    }
    return Be.call(A, b) ? A[b] : void 0;
  }
  function Pn(b) {
    var A = this.__data__;
    return Nn ? A[b] !== void 0 : Be.call(A, b);
  }
  function Yr(b, A) {
    var O = this.__data__;
    return this.size += this.has(b) ? 0 : 1, O[b] = Nn && A === void 0 ? r : A, this;
  }
  mt.prototype.clear = Mr, mt.prototype.delete = _i, mt.prototype.get = Vn, mt.prototype.has = Pn, mt.prototype.set = Yr;
  function _t(b) {
    var A = -1, O = b == null ? 0 : b.length;
    for (this.clear(); ++A < O; ) {
      var z = b[A];
      this.set(z[0], z[1]);
    }
  }
  function Si() {
    this.__data__ = [], this.size = 0;
  }
  function lr(b) {
    var A = this.__data__, O = vn(A, b);
    if (O < 0)
      return !1;
    var z = A.length - 1;
    return O == z ? A.pop() : pn.call(A, O, 1), --this.size, !0;
  }
  function Rn(b) {
    var A = this.__data__, O = vn(A, b);
    return O < 0 ? void 0 : A[O][1];
  }
  function xi(b) {
    return vn(this.__data__, b) > -1;
  }
  function q(b, A) {
    var O = this.__data__, z = vn(O, b);
    return z < 0 ? (++this.size, O.push([b, A])) : O[z][1] = A, this;
  }
  _t.prototype.clear = Si, _t.prototype.delete = lr, _t.prototype.get = Rn, _t.prototype.has = xi, _t.prototype.set = q;
  function j(b) {
    var A = -1, O = b == null ? 0 : b.length;
    for (this.clear(); ++A < O; ) {
      var z = b[A];
      this.set(z[0], z[1]);
    }
  }
  function le() {
    this.size = 0, this.__data__ = {
      hash: new mt(),
      map: new (sn || _t)(),
      string: new mt()
    };
  }
  function ve(b) {
    var A = un(this, b).delete(b);
    return this.size -= A ? 1 : 0, A;
  }
  function Ke(b) {
    return un(this, b).get(b);
  }
  function Re(b) {
    return un(this, b).has(b);
  }
  function N(b, A) {
    var O = un(this, b), z = O.size;
    return O.set(b, A), this.size += O.size == z ? 0 : 1, this;
  }
  j.prototype.clear = le, j.prototype.delete = ve, j.prototype.get = Ke, j.prototype.has = Re, j.prototype.set = N;
  function F(b) {
    var A = -1, O = b == null ? 0 : b.length;
    for (this.__data__ = new j(); ++A < O; )
      this.add(b[A]);
  }
  function ae(b) {
    return this.__data__.set(b, r), this;
  }
  function ge(b) {
    return this.__data__.has(b);
  }
  F.prototype.add = F.prototype.push = ae, F.prototype.has = ge;
  function ke(b) {
    var A = this.__data__ = new _t(b);
    this.size = A.size;
  }
  function Ze() {
    this.__data__ = new _t(), this.size = 0;
  }
  function St(b) {
    var A = this.__data__, O = A.delete(b);
    return this.size = A.size, O;
  }
  function Fe(b) {
    return this.__data__.get(b);
  }
  function At(b) {
    return this.__data__.has(b);
  }
  function xt(b, A) {
    var O = this.__data__;
    if (O instanceof _t) {
      var z = O.__data__;
      if (!sn || z.length < n - 1)
        return z.push([b, A]), this.size = ++O.size, this;
      O = this.__data__ = new j(z);
    }
    return O.set(b, A), this.size = O.size, this;
  }
  ke.prototype.clear = Ze, ke.prototype.delete = St, ke.prototype.get = Fe, ke.prototype.has = At, ke.prototype.set = xt;
  function Mn(b, A) {
    var O = _s(b), z = !O && gl(b), je = !O && !z && Ss(b), $e = !O && !z && !je && vl(b), ct = O || z || je || $e, st = ct ? ht(b.length, String) : [], Mt = st.length;
    for (var ft in b)
      Be.call(b, ft) && !(ct && // Safari 9 has enumerable `arguments.length` in strict mode.
      (ft == "length" || // Node.js 0.10 has enumerable non-index properties on buffers.
      je && (ft == "offset" || ft == "parent") || // PhantomJS 2 has enumerable non-index properties on typed arrays.
      $e && (ft == "buffer" || ft == "byteLength" || ft == "byteOffset") || // Skip index properties.
      Hi(ft, Mt))) && st.push(ft);
    return st;
  }
  function vn(b, A) {
    for (var O = b.length; O--; )
      if (fl(b[O][0], A))
        return O;
    return -1;
  }
  function qn(b, A, O) {
    var z = A(b);
    return _s(b) ? z : We(z, O(b));
  }
  function Ce(b) {
    return b == null ? b === void 0 ? M : m : Ft && Ft in Object(b) ? Ht(b) : Xr(b);
  }
  function et(b) {
    return qr(b) && Ce(b) == l;
  }
  function Ct(b, A, O, z, je) {
    return b === A ? !0 : b == null || A == null || !qr(b) && !qr(A) ? b !== b && A !== A : Ue(b, A, O, z, Ct, je);
  }
  function Ue(b, A, O, z, je, $e) {
    var ct = _s(b), st = _s(A), Mt = ct ? a : Tn(b), ft = st ? a : Tn(A);
    Mt = Mt == l ? y : Mt, ft = ft == l ? y : ft;
    var bn = Mt == y, Bn = ft == y, zt = Mt == ft;
    if (zt && Ss(b)) {
      if (!Ss(A))
        return !1;
      ct = !0, bn = !1;
    }
    if (zt && !bn)
      return $e || ($e = new ke()), ct || vl(b) ? Ot(b, A, O, z, je, $e) : $t(b, A, Mt, O, z, je, $e);
    if (!(O & i)) {
      var wn = bn && Be.call(b, "__wrapped__"), hn = Bn && Be.call(A, "__wrapped__");
      if (wn || hn) {
        var Ei = wn ? b.value() : b, Zr = hn ? A.value() : A;
        return $e || ($e = new ke()), je(Ei, Zr, O, z, $e);
      }
    }
    return zt ? ($e || ($e = new ke()), En(b, A, O, z, je, $e)) : !1;
  }
  function Je(b) {
    if (!ml(b) || $i(b))
      return !1;
    var A = pl(b) ? Lr : K;
    return A.test(Rt(b));
  }
  function $n(b) {
    return qr(b) && ho(b.length) && !!J[Ce(b)];
  }
  function He(b) {
    if (!ws(b))
      return Lt(b);
    var A = [];
    for (var O in Object(b))
      Be.call(b, O) && O != "constructor" && A.push(O);
    return A;
  }
  function Ot(b, A, O, z, je, $e) {
    var ct = O & i, st = b.length, Mt = A.length;
    if (st != Mt && !(ct && Mt > st))
      return !1;
    var ft = $e.get(b);
    if (ft && $e.get(A))
      return ft == A;
    var bn = -1, Bn = !0, zt = O & s ? new F() : void 0;
    for ($e.set(b, A), $e.set(A, b); ++bn < st; ) {
      var wn = b[bn], hn = A[bn];
      if (z)
        var Ei = ct ? z(hn, wn, bn, A, b, $e) : z(wn, hn, bn, b, A, $e);
      if (Ei !== void 0) {
        if (Ei)
          continue;
        Bn = !1;
        break;
      }
      if (zt) {
        if (!gt(A, function(Zr, zi) {
          if (!ot(zt, zi) && (wn === Zr || je(wn, Zr, O, z, $e)))
            return zt.push(zi);
        })) {
          Bn = !1;
          break;
        }
      } else if (!(wn === hn || je(wn, hn, O, z, $e))) {
        Bn = !1;
        break;
      }
    }
    return $e.delete(b), $e.delete(A), Bn;
  }
  function $t(b, A, O, z, je, $e, ct) {
    switch (O) {
      case ie:
        if (b.byteLength != A.byteLength || b.byteOffset != A.byteOffset)
          return !1;
        b = b.buffer, A = A.buffer;
      case Y:
        return !(b.byteLength != A.byteLength || !$e(new wi(b), new wi(A)));
      case u:
      case d:
      case _:
        return fl(+b, +A);
      case f:
        return b.name == A.name && b.message == A.message;
      case C:
      case k:
        return b == A + "";
      case S:
        var st = pt;
      case E:
        var Mt = z & i;
        if (st || (st = Ge), b.size != A.size && !Mt)
          return !1;
        var ft = ct.get(b);
        if (ft)
          return ft == A;
        z |= s, ct.set(b, A);
        var bn = Ot(st(b), st(A), z, je, $e, ct);
        return ct.delete(b), bn;
      case L:
        if (or)
          return or.call(b) == or.call(A);
    }
    return !1;
  }
  function En(b, A, O, z, je, $e) {
    var ct = O & i, st = yn(b), Mt = st.length, ft = yn(A), bn = ft.length;
    if (Mt != bn && !ct)
      return !1;
    for (var Bn = Mt; Bn--; ) {
      var zt = st[Bn];
      if (!(ct ? zt in A : Be.call(A, zt)))
        return !1;
    }
    var wn = $e.get(b);
    if (wn && $e.get(A))
      return wn == A;
    var hn = !0;
    $e.set(b, A), $e.set(A, b);
    for (var Ei = ct; ++Bn < Mt; ) {
      zt = st[Bn];
      var Zr = b[zt], zi = A[zt];
      if (z)
        var vh = ct ? z(zi, Zr, zt, A, b, $e) : z(Zr, zi, zt, b, A, $e);
      if (!(vh === void 0 ? Zr === zi || je(Zr, zi, O, z, $e) : vh)) {
        hn = !1;
        break;
      }
      Ei || (Ei = zt == "constructor");
    }
    if (hn && !Ei) {
      var yl = b.constructor, bl = A.constructor;
      yl != bl && "constructor" in b && "constructor" in A && !(typeof yl == "function" && yl instanceof yl && typeof bl == "function" && bl instanceof bl) && (hn = !1);
    }
    return $e.delete(b), $e.delete(A), hn;
  }
  function yn(b) {
    return qn(b, fo, bs);
  }
  function un(b, A) {
    var O = b.__data__;
    return Ci(A) ? O[typeof A == "string" ? "string" : "hash"] : O.map;
  }
  function dn(b, A) {
    var O = wt(b, A);
    return Je(O) ? O : void 0;
  }
  function Ht(b) {
    var A = Be.call(b, Ft), O = b[Ft];
    try {
      b[Ft] = void 0;
      var z = !0;
    } catch {
    }
    var je = nn.call(b);
    return z && (A ? b[Ft] = O : delete b[Ft]), je;
  }
  var bs = rn ? function(b) {
    return b == null ? [] : (b = Object(b), nt(rn(b), function(A) {
      return nr.call(b, A);
    }));
  } : hc, Tn = Ce;
  (rr && Tn(new rr(new ArrayBuffer(1))) != ie || sn && Tn(new sn()) != S || ir && Tn(ir.resolve()) != v || Fn && Tn(new Fn()) != E || Pr && Tn(new Pr()) != G) && (Tn = function(b) {
    var A = Ce(b), O = A == y ? b.constructor : void 0, z = O ? Rt(O) : "";
    if (z)
      switch (z) {
        case Rr:
          return ie;
        case Pt:
          return S;
        case on:
          return v;
        case cn:
          return E;
        case sr:
          return G;
      }
    return A;
  });
  function Hi(b, A) {
    return A = A ?? o, !!A && (typeof b == "number" || re.test(b)) && b > -1 && b % 1 == 0 && b < A;
  }
  function Ci(b) {
    var A = typeof b;
    return A == "string" || A == "number" || A == "symbol" || A == "boolean" ? b !== "__proto__" : b === null;
  }
  function $i(b) {
    return !!It && It in b;
  }
  function ws(b) {
    var A = b && b.constructor, O = typeof A == "function" && A.prototype || te;
    return b === O;
  }
  function Xr(b) {
    return nn.call(b);
  }
  function Rt(b) {
    if (b != null) {
      try {
        return tt.call(b);
      } catch {
      }
      try {
        return b + "";
      } catch {
      }
    }
    return "";
  }
  function fl(b, A) {
    return b === A || b !== b && A !== A;
  }
  var gl = et(/* @__PURE__ */ function() {
    return arguments;
  }()) ? et : function(b) {
    return qr(b) && Be.call(b, "callee") && !nr.call(b, "callee");
  }, _s = Array.isArray;
  function uo(b) {
    return b != null && ho(b.length) && !pl(b);
  }
  var Ss = Vt || fc;
  function dc(b, A) {
    return Ct(b, A);
  }
  function pl(b) {
    if (!ml(b))
      return !1;
    var A = Ce(b);
    return A == g || A == p || A == c || A == x;
  }
  function ho(b) {
    return typeof b == "number" && b > -1 && b % 1 == 0 && b <= o;
  }
  function ml(b) {
    var A = typeof b;
    return b != null && (A == "object" || A == "function");
  }
  function qr(b) {
    return b != null && typeof b == "object";
  }
  var vl = Oe ? it(Oe) : $n;
  function fo(b) {
    return uo(b) ? Mn(b) : He(b);
  }
  function hc() {
    return [];
  }
  function fc() {
    return !1;
  }
  t.exports = dc;
})(Ta, Ta.exports);
var Cv = Ta.exports, Qd = {};
Object.defineProperty(Qd, "__esModule", { value: !0 });
const wO = xv, _O = Cv;
var Lu;
(function(t) {
  function e(s = {}, o = {}, l = !1) {
    typeof s != "object" && (s = {}), typeof o != "object" && (o = {});
    let a = wO(o);
    l || (a = Object.keys(a).reduce((c, u) => (a[u] != null && (c[u] = a[u]), c), {}));
    for (const c in s)
      s[c] !== void 0 && o[c] === void 0 && (a[c] = s[c]);
    return Object.keys(a).length > 0 ? a : void 0;
  }
  t.compose = e;
  function n(s = {}, o = {}) {
    typeof s != "object" && (s = {}), typeof o != "object" && (o = {});
    const l = Object.keys(s).concat(Object.keys(o)).reduce((a, c) => (_O(s[c], o[c]) || (a[c] = o[c] === void 0 ? null : o[c]), a), {});
    return Object.keys(l).length > 0 ? l : void 0;
  }
  t.diff = n;
  function r(s = {}, o = {}) {
    s = s || {};
    const l = Object.keys(o).reduce((a, c) => (o[c] !== s[c] && s[c] !== void 0 && (a[c] = o[c]), a), {});
    return Object.keys(s).reduce((a, c) => (s[c] !== o[c] && o[c] === void 0 && (a[c] = null), a), l);
  }
  t.invert = r;
  function i(s, o, l = !1) {
    if (typeof s != "object")
      return o;
    if (typeof o != "object")
      return;
    if (!l)
      return o;
    const a = Object.keys(o).reduce((c, u) => (s[u] === void 0 && (c[u] = o[u]), c), {});
    return Object.keys(a).length > 0 ? a : void 0;
  }
  t.transform = i;
})(Lu || (Lu = {}));
Qd.default = Lu;
var ic = {};
Object.defineProperty(ic, "__esModule", { value: !0 });
var Nu;
(function(t) {
  function e(n) {
    return typeof n.delete == "number" ? n.delete : typeof n.retain == "number" ? n.retain : typeof n.retain == "object" && n.retain !== null ? 1 : typeof n.insert == "string" ? n.insert.length : 1;
  }
  t.length = e;
})(Nu || (Nu = {}));
ic.default = Nu;
var Kd = {};
Object.defineProperty(Kd, "__esModule", { value: !0 });
const Yf = ic;
class SO {
  constructor(e) {
    this.ops = e, this.index = 0, this.offset = 0;
  }
  hasNext() {
    return this.peekLength() < 1 / 0;
  }
  next(e) {
    e || (e = 1 / 0);
    const n = this.ops[this.index];
    if (n) {
      const r = this.offset, i = Yf.default.length(n);
      if (e >= i - r ? (e = i - r, this.index += 1, this.offset = 0) : this.offset += e, typeof n.delete == "number")
        return { delete: e };
      {
        const s = {};
        return n.attributes && (s.attributes = n.attributes), typeof n.retain == "number" ? s.retain = e : typeof n.retain == "object" && n.retain !== null ? s.retain = n.retain : typeof n.insert == "string" ? s.insert = n.insert.substr(r, e) : s.insert = n.insert, s;
      }
    } else
      return { retain: 1 / 0 };
  }
  peek() {
    return this.ops[this.index];
  }
  peekLength() {
    return this.ops[this.index] ? Yf.default.length(this.ops[this.index]) - this.offset : 1 / 0;
  }
  peekType() {
    const e = this.ops[this.index];
    return e ? typeof e.delete == "number" ? "delete" : typeof e.retain == "number" || typeof e.retain == "object" && e.retain !== null ? "retain" : "insert" : "retain";
  }
  rest() {
    if (this.hasNext()) {
      if (this.offset === 0)
        return this.ops.slice(this.index);
      {
        const e = this.offset, n = this.index, r = this.next(), i = this.ops.slice(this.index);
        return this.offset = e, this.index = n, [r].concat(i);
      }
    } else return [];
  }
}
Kd.default = SO;
(function(t, e) {
  Object.defineProperty(e, "__esModule", { value: !0 }), e.AttributeMap = e.OpIterator = e.Op = void 0;
  const n = bO, r = xv, i = Cv, s = Qd;
  e.AttributeMap = s.default;
  const o = ic;
  e.Op = o.default;
  const l = Kd;
  e.OpIterator = l.default;
  const a = "\0", c = (d, f) => {
    if (typeof d != "object" || d === null)
      throw new Error(`cannot retain a ${typeof d}`);
    if (typeof f != "object" || f === null)
      throw new Error(`cannot retain a ${typeof f}`);
    const g = Object.keys(d)[0];
    if (!g || g !== Object.keys(f)[0])
      throw new Error(`embed types not matched: ${g} != ${Object.keys(f)[0]}`);
    return [g, d[g], f[g]];
  };
  class u {
    constructor(f) {
      Array.isArray(f) ? this.ops = f : f != null && Array.isArray(f.ops) ? this.ops = f.ops : this.ops = [];
    }
    static registerEmbed(f, g) {
      this.handlers[f] = g;
    }
    static unregisterEmbed(f) {
      delete this.handlers[f];
    }
    static getHandler(f) {
      const g = this.handlers[f];
      if (!g)
        throw new Error(`no handlers for embed type "${f}"`);
      return g;
    }
    insert(f, g) {
      const p = {};
      return typeof f == "string" && f.length === 0 ? this : (p.insert = f, g != null && typeof g == "object" && Object.keys(g).length > 0 && (p.attributes = g), this.push(p));
    }
    delete(f) {
      return f <= 0 ? this : this.push({ delete: f });
    }
    retain(f, g) {
      if (typeof f == "number" && f <= 0)
        return this;
      const p = { retain: f };
      return g != null && typeof g == "object" && Object.keys(g).length > 0 && (p.attributes = g), this.push(p);
    }
    push(f) {
      let g = this.ops.length, p = this.ops[g - 1];
      if (f = r(f), typeof p == "object") {
        if (typeof f.delete == "number" && typeof p.delete == "number")
          return this.ops[g - 1] = { delete: p.delete + f.delete }, this;
        if (typeof p.delete == "number" && f.insert != null && (g -= 1, p = this.ops[g - 1], typeof p != "object"))
          return this.ops.unshift(f), this;
        if (i(f.attributes, p.attributes)) {
          if (typeof f.insert == "string" && typeof p.insert == "string")
            return this.ops[g - 1] = { insert: p.insert + f.insert }, typeof f.attributes == "object" && (this.ops[g - 1].attributes = f.attributes), this;
          if (typeof f.retain == "number" && typeof p.retain == "number")
            return this.ops[g - 1] = { retain: p.retain + f.retain }, typeof f.attributes == "object" && (this.ops[g - 1].attributes = f.attributes), this;
        }
      }
      return g === this.ops.length ? this.ops.push(f) : this.ops.splice(g, 0, f), this;
    }
    chop() {
      const f = this.ops[this.ops.length - 1];
      return f && typeof f.retain == "number" && !f.attributes && this.ops.pop(), this;
    }
    filter(f) {
      return this.ops.filter(f);
    }
    forEach(f) {
      this.ops.forEach(f);
    }
    map(f) {
      return this.ops.map(f);
    }
    partition(f) {
      const g = [], p = [];
      return this.forEach((S) => {
        (f(S) ? g : p).push(S);
      }), [g, p];
    }
    reduce(f, g) {
      return this.ops.reduce(f, g);
    }
    changeLength() {
      return this.reduce((f, g) => g.insert ? f + o.default.length(g) : g.delete ? f - g.delete : f, 0);
    }
    length() {
      return this.reduce((f, g) => f + o.default.length(g), 0);
    }
    slice(f = 0, g = 1 / 0) {
      const p = [], S = new l.default(this.ops);
      let _ = 0;
      for (; _ < g && S.hasNext(); ) {
        let m;
        _ < f ? m = S.next(f - _) : (m = S.next(g - _), p.push(m)), _ += o.default.length(m);
      }
      return new u(p);
    }
    compose(f) {
      const g = new l.default(this.ops), p = new l.default(f.ops), S = [], _ = p.peek();
      if (_ != null && typeof _.retain == "number" && _.attributes == null) {
        let y = _.retain;
        for (; g.peekType() === "insert" && g.peekLength() <= y; )
          y -= g.peekLength(), S.push(g.next());
        _.retain - y > 0 && p.next(_.retain - y);
      }
      const m = new u(S);
      for (; g.hasNext() || p.hasNext(); )
        if (p.peekType() === "insert")
          m.push(p.next());
        else if (g.peekType() === "delete")
          m.push(g.next());
        else {
          const y = Math.min(g.peekLength(), p.peekLength()), v = g.next(y), x = p.next(y);
          if (x.retain) {
            const C = {};
            if (typeof v.retain == "number")
              C.retain = typeof x.retain == "number" ? y : x.retain;
            else if (typeof x.retain == "number")
              v.retain == null ? C.insert = v.insert : C.retain = v.retain;
            else {
              const k = v.retain == null ? "insert" : "retain", [L, M, G] = c(v[k], x.retain), Y = u.getHandler(L);
              C[k] = {
                [L]: Y.compose(M, G, k === "retain")
              };
            }
            const E = s.default.compose(v.attributes, x.attributes, typeof v.retain == "number");
            if (E && (C.attributes = E), m.push(C), !p.hasNext() && i(m.ops[m.ops.length - 1], C)) {
              const k = new u(g.rest());
              return m.concat(k).chop();
            }
          } else typeof x.delete == "number" && (typeof v.retain == "number" || typeof v.retain == "object" && v.retain !== null) && m.push(x);
        }
      return m.chop();
    }
    concat(f) {
      const g = new u(this.ops.slice());
      return f.ops.length > 0 && (g.push(f.ops[0]), g.ops = g.ops.concat(f.ops.slice(1))), g;
    }
    diff(f, g) {
      if (this.ops === f.ops)
        return new u();
      const p = [this, f].map((v) => v.map((x) => {
        if (x.insert != null)
          return typeof x.insert == "string" ? x.insert : a;
        const C = v === f ? "on" : "with";
        throw new Error("diff() called " + C + " non-document");
      }).join("")), S = new u(), _ = n(p[0], p[1], g, !0), m = new l.default(this.ops), y = new l.default(f.ops);
      return _.forEach((v) => {
        let x = v[1].length;
        for (; x > 0; ) {
          let C = 0;
          switch (v[0]) {
            case n.INSERT:
              C = Math.min(y.peekLength(), x), S.push(y.next(C));
              break;
            case n.DELETE:
              C = Math.min(x, m.peekLength()), m.next(C), S.delete(C);
              break;
            case n.EQUAL:
              C = Math.min(m.peekLength(), y.peekLength(), x);
              const E = m.next(C), k = y.next(C);
              i(E.insert, k.insert) ? S.retain(C, s.default.diff(E.attributes, k.attributes)) : S.push(k).delete(C);
              break;
          }
          x -= C;
        }
      }), S.chop();
    }
    eachLine(f, g = `
`) {
      const p = new l.default(this.ops);
      let S = new u(), _ = 0;
      for (; p.hasNext(); ) {
        if (p.peekType() !== "insert")
          return;
        const m = p.peek(), y = o.default.length(m) - p.peekLength(), v = typeof m.insert == "string" ? m.insert.indexOf(g, y) - y : -1;
        if (v < 0)
          S.push(p.next());
        else if (v > 0)
          S.push(p.next(v));
        else {
          if (f(S, p.next(1).attributes || {}, _) === !1)
            return;
          _ += 1, S = new u();
        }
      }
      S.length() > 0 && f(S, {}, _);
    }
    invert(f) {
      const g = new u();
      return this.reduce((p, S) => {
        if (S.insert)
          g.delete(o.default.length(S));
        else {
          if (typeof S.retain == "number" && S.attributes == null)
            return g.retain(S.retain), p + S.retain;
          if (S.delete || typeof S.retain == "number") {
            const _ = S.delete || S.retain;
            return f.slice(p, p + _).forEach((y) => {
              S.delete ? g.push(y) : S.retain && S.attributes && g.retain(o.default.length(y), s.default.invert(S.attributes, y.attributes));
            }), p + _;
          } else if (typeof S.retain == "object" && S.retain !== null) {
            const _ = f.slice(p, p + 1), m = new l.default(_.ops).next(), [y, v, x] = c(S.retain, m.insert), C = u.getHandler(y);
            return g.retain({ [y]: C.invert(v, x) }, s.default.invert(S.attributes, m.attributes)), p + 1;
          }
        }
        return p;
      }, 0), g.chop();
    }
    transform(f, g = !1) {
      if (g = !!g, typeof f == "number")
        return this.transformPosition(f, g);
      const p = f, S = new l.default(this.ops), _ = new l.default(p.ops), m = new u();
      for (; S.hasNext() || _.hasNext(); )
        if (S.peekType() === "insert" && (g || _.peekType() !== "insert"))
          m.retain(o.default.length(S.next()));
        else if (_.peekType() === "insert")
          m.push(_.next());
        else {
          const y = Math.min(S.peekLength(), _.peekLength()), v = S.next(y), x = _.next(y);
          if (v.delete)
            continue;
          if (x.delete)
            m.push(x);
          else {
            const C = v.retain, E = x.retain;
            let k = typeof E == "object" && E !== null ? E : y;
            if (typeof C == "object" && C !== null && typeof E == "object" && E !== null) {
              const L = Object.keys(C)[0];
              if (L === Object.keys(E)[0]) {
                const M = u.getHandler(L);
                M && (k = {
                  [L]: M.transform(C[L], E[L], g)
                });
              }
            }
            m.retain(k, s.default.transform(v.attributes, x.attributes, g));
          }
        }
      return m.chop();
    }
    transformPosition(f, g = !1) {
      g = !!g;
      const p = new l.default(this.ops);
      let S = 0;
      for (; p.hasNext() && S <= f; ) {
        const _ = p.peekLength(), m = p.peekType();
        if (p.next(), m === "delete") {
          f -= Math.min(_, f - S);
          continue;
        } else m === "insert" && (S < f || !g) && (f += _);
        S += _;
      }
      return f;
    }
  }
  u.Op = o.default, u.OpIterator = l.default, u.AttributeMap = s.default, u.handlers = {}, e.default = u, t.exports = u, t.exports.default = u;
})(Du, Du.exports);
var mr = Du.exports;
const _e = /* @__PURE__ */ zd(mr);
class Dr extends tr {
  static value() {
  }
  optimize() {
    (this.prev || this.next) && this.remove();
  }
  length() {
    return 0;
  }
  value() {
    return "";
  }
}
Dr.blotName = "break";
Dr.tagName = "BR";
let kr = class extends $a {
};
function sc(t) {
  return t.replace(/[&<>"']/g, (e) => ({
    "&": "&amp;",
    "<": "&lt;",
    ">": "&gt;",
    '"': "&quot;",
    "'": "&#39;"
  })[e]);
}
class In extends Vd {
  static allowedChildren = [In, Dr, tr, kr];
  // Lower index means deeper in the DOM tree, since not found (-1) is for embeds
  static order = [
    "cursor",
    "inline",
    // Must be lower
    "link",
    // Chrome wants <a> to be lower
    "underline",
    "strike",
    "italic",
    "bold",
    "script",
    "code"
    // Must be higher
  ];
  static compare(e, n) {
    const r = In.order.indexOf(e), i = In.order.indexOf(n);
    return r >= 0 || i >= 0 ? r - i : e === n ? 0 : e < n ? -1 : 1;
  }
  formatAt(e, n, r, i) {
    if (In.compare(this.statics.blotName, r) < 0 && this.scroll.query(r, Se.BLOT)) {
      const s = this.isolate(e, n);
      i && s.wrap(r, i);
    } else
      super.formatAt(e, n, r, i);
  }
  optimize(e) {
    if (super.optimize(e), this.parent instanceof In && In.compare(this.statics.blotName, this.parent.statics.blotName) > 0) {
      const n = this.parent.isolate(this.offset(), this.length());
      this.moveChildren(n), n.wrap(this);
    }
  }
}
const Xf = 1;
class gn extends Ho {
  cache = {};
  delta() {
    return this.cache.delta == null && (this.cache.delta = $v(this)), this.cache.delta;
  }
  deleteAt(e, n) {
    super.deleteAt(e, n), this.cache = {};
  }
  formatAt(e, n, r, i) {
    n <= 0 || (this.scroll.query(r, Se.BLOCK) ? e + n === this.length() && this.format(r, i) : super.formatAt(e, Math.min(n, this.length() - e - 1), r, i), this.cache = {});
  }
  insertAt(e, n, r) {
    if (r != null) {
      super.insertAt(e, n, r), this.cache = {};
      return;
    }
    if (n.length === 0) return;
    const i = n.split(`
`), s = i.shift();
    s.length > 0 && (e < this.length() - 1 || this.children.tail == null ? super.insertAt(Math.min(e, this.length() - 1), s) : this.children.tail.insertAt(this.children.tail.length(), s), this.cache = {});
    let o = this;
    i.reduce((l, a) => (o = o.split(l, !0), o.insertAt(0, a), a.length), e + s.length);
  }
  insertBefore(e, n) {
    const {
      head: r
    } = this.children;
    super.insertBefore(e, n), r instanceof Dr && r.remove(), this.cache = {};
  }
  length() {
    return this.cache.length == null && (this.cache.length = super.length() + Xf), this.cache.length;
  }
  moveChildren(e, n) {
    super.moveChildren(e, n), this.cache = {};
  }
  optimize(e) {
    super.optimize(e), this.cache = {};
  }
  path(e) {
    return super.path(e, !0);
  }
  removeChild(e) {
    super.removeChild(e), this.cache = {};
  }
  split(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !1;
    if (n && (e === 0 || e >= this.length() - Xf)) {
      const i = this.clone();
      return e === 0 ? (this.parent.insertBefore(i, this), this) : (this.parent.insertBefore(i, this.next), i);
    }
    const r = super.split(e, n);
    return this.cache = {}, r;
  }
}
gn.blotName = "block";
gn.tagName = "P";
gn.defaultChild = Dr;
gn.allowedChildren = [Dr, In, tr, kr];
class gr extends tr {
  attach() {
    super.attach(), this.attributes = new ec(this.domNode);
  }
  delta() {
    return new _e().insert(this.value(), {
      ...this.formats(),
      ...this.attributes.values()
    });
  }
  format(e, n) {
    const r = this.scroll.query(e, Se.BLOCK_ATTRIBUTE);
    r != null && this.attributes.attribute(r, n);
  }
  formatAt(e, n, r, i) {
    this.format(r, i);
  }
  insertAt(e, n, r) {
    if (r != null) {
      super.insertAt(e, n, r);
      return;
    }
    const i = n.split(`
`), s = i.pop(), o = i.map((a) => {
      const c = this.scroll.create(gn.blotName);
      return c.insertAt(0, a), c;
    }), l = this.split(e);
    o.forEach((a) => {
      this.parent.insertBefore(a, l);
    }), s && this.parent.insertBefore(this.scroll.create("text", s), l);
  }
}
gr.scope = Se.BLOCK_BLOT;
function $v(t) {
  let e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !0;
  return t.descendants(xn).reduce((n, r) => r.length() === 0 ? n : n.insert(r.value(), ur(r, {}, e)), new _e()).insert(`
`, ur(t));
}
function ur(t) {
  let e = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {}, n = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !0;
  return t == null || ("formats" in t && typeof t.formats == "function" && (e = {
    ...e,
    ...t.formats()
  }, n && delete e["code-token"]), t.parent == null || t.parent.statics.blotName === "scroll" || t.parent.statics.scope !== t.statics.scope) ? e : ur(t.parent, e, n);
}
class wr extends tr {
  static blotName = "cursor";
  static className = "ql-cursor";
  static tagName = "span";
  static CONTENTS = "\uFEFF";
  // Zero width no break space
  static value() {
  }
  constructor(e, n, r) {
    super(e, n), this.selection = r, this.textNode = document.createTextNode(wr.CONTENTS), this.domNode.appendChild(this.textNode), this.savedLength = 0;
  }
  detach() {
    this.parent != null && this.parent.removeChild(this);
  }
  format(e, n) {
    if (this.savedLength !== 0) {
      super.format(e, n);
      return;
    }
    let r = this, i = 0;
    for (; r != null && r.statics.scope !== Se.BLOCK_BLOT; )
      i += r.offset(r.parent), r = r.parent;
    r != null && (this.savedLength = wr.CONTENTS.length, r.optimize(), r.formatAt(i, wr.CONTENTS.length, e, n), this.savedLength = 0);
  }
  index(e, n) {
    return e === this.textNode ? 0 : super.index(e, n);
  }
  length() {
    return this.savedLength;
  }
  position() {
    return [this.textNode, this.textNode.data.length];
  }
  remove() {
    super.remove(), this.parent = null;
  }
  restore() {
    if (this.selection.composing || this.parent == null) return null;
    const e = this.selection.getNativeRange();
    for (; this.domNode.lastChild != null && this.domNode.lastChild !== this.textNode; )
      this.domNode.parentNode.insertBefore(this.domNode.lastChild, this.domNode);
    const n = this.prev instanceof kr ? this.prev : null, r = n ? n.length() : 0, i = this.next instanceof kr ? this.next : null, s = i ? i.text : "", {
      textNode: o
    } = this, l = o.data.split(wr.CONTENTS).join("");
    o.data = wr.CONTENTS;
    let a;
    if (n)
      a = n, (l || i) && (n.insertAt(n.length(), l + s), i && i.remove());
    else if (i)
      a = i, i.insertAt(0, l);
    else {
      const c = document.createTextNode(l);
      a = this.scroll.create(c), this.parent.insertBefore(a, this);
    }
    if (this.remove(), e) {
      const c = (f, g) => n && f === n.domNode ? g : f === o ? r + g - 1 : i && f === i.domNode ? r + l.length + g : null, u = c(e.start.node, e.start.offset), d = c(e.end.node, e.end.offset);
      if (u !== null && d !== null)
        return {
          startNode: a.domNode,
          startOffset: u,
          endNode: a.domNode,
          endOffset: d
        };
    }
    return null;
  }
  update(e, n) {
    if (e.some((r) => r.type === "characterData" && r.target === this.textNode)) {
      const r = this.restore();
      r && (n.range = r);
    }
  }
  // Avoid .ql-cursor being a descendant of `<a/>`.
  // The reason is Safari pushes down `<a/>` on text insertion.
  // That will cause DOM nodes not sync with the model.
  //
  // For example ({I} is the caret), given the markup:
  //    <a><span class="ql-cursor">\uFEFF{I}</span></a>
  // When typing a char "x", `<a/>` will be pushed down inside the `<span>` first:
  //    <span class="ql-cursor"><a>\uFEFF{I}</a></span>
  // And then "x" will be inserted after `<a/>`:
  //    <span class="ql-cursor"><a>\uFEFF</a>d{I}</span>
  optimize(e) {
    super.optimize(e);
    let {
      parent: n
    } = this;
    for (; n; ) {
      if (n.domNode.tagName === "A") {
        this.savedLength = wr.CONTENTS.length, n.isolate(this.offset(n), this.length()).unwrap(), this.savedLength = 0;
        break;
      }
      n = n.parent;
    }
  }
  value() {
    return "";
  }
}
var Ev = { exports: {} };
(function(t) {
  var e = Object.prototype.hasOwnProperty, n = "~";
  function r() {
  }
  Object.create && (r.prototype = /* @__PURE__ */ Object.create(null), new r().__proto__ || (n = !1));
  function i(a, c, u) {
    this.fn = a, this.context = c, this.once = u || !1;
  }
  function s(a, c, u, d, f) {
    if (typeof u != "function")
      throw new TypeError("The listener must be a function");
    var g = new i(u, d || a, f), p = n ? n + c : c;
    return a._events[p] ? a._events[p].fn ? a._events[p] = [a._events[p], g] : a._events[p].push(g) : (a._events[p] = g, a._eventsCount++), a;
  }
  function o(a, c) {
    --a._eventsCount === 0 ? a._events = new r() : delete a._events[c];
  }
  function l() {
    this._events = new r(), this._eventsCount = 0;
  }
  l.prototype.eventNames = function() {
    var c = [], u, d;
    if (this._eventsCount === 0) return c;
    for (d in u = this._events)
      e.call(u, d) && c.push(n ? d.slice(1) : d);
    return Object.getOwnPropertySymbols ? c.concat(Object.getOwnPropertySymbols(u)) : c;
  }, l.prototype.listeners = function(c) {
    var u = n ? n + c : c, d = this._events[u];
    if (!d) return [];
    if (d.fn) return [d.fn];
    for (var f = 0, g = d.length, p = new Array(g); f < g; f++)
      p[f] = d[f].fn;
    return p;
  }, l.prototype.listenerCount = function(c) {
    var u = n ? n + c : c, d = this._events[u];
    return d ? d.fn ? 1 : d.length : 0;
  }, l.prototype.emit = function(c, u, d, f, g, p) {
    var S = n ? n + c : c;
    if (!this._events[S]) return !1;
    var _ = this._events[S], m = arguments.length, y, v;
    if (_.fn) {
      switch (_.once && this.removeListener(c, _.fn, void 0, !0), m) {
        case 1:
          return _.fn.call(_.context), !0;
        case 2:
          return _.fn.call(_.context, u), !0;
        case 3:
          return _.fn.call(_.context, u, d), !0;
        case 4:
          return _.fn.call(_.context, u, d, f), !0;
        case 5:
          return _.fn.call(_.context, u, d, f, g), !0;
        case 6:
          return _.fn.call(_.context, u, d, f, g, p), !0;
      }
      for (v = 1, y = new Array(m - 1); v < m; v++)
        y[v - 1] = arguments[v];
      _.fn.apply(_.context, y);
    } else {
      var x = _.length, C;
      for (v = 0; v < x; v++)
        switch (_[v].once && this.removeListener(c, _[v].fn, void 0, !0), m) {
          case 1:
            _[v].fn.call(_[v].context);
            break;
          case 2:
            _[v].fn.call(_[v].context, u);
            break;
          case 3:
            _[v].fn.call(_[v].context, u, d);
            break;
          case 4:
            _[v].fn.call(_[v].context, u, d, f);
            break;
          default:
            if (!y) for (C = 1, y = new Array(m - 1); C < m; C++)
              y[C - 1] = arguments[C];
            _[v].fn.apply(_[v].context, y);
        }
    }
    return !0;
  }, l.prototype.on = function(c, u, d) {
    return s(this, c, u, d, !1);
  }, l.prototype.once = function(c, u, d) {
    return s(this, c, u, d, !0);
  }, l.prototype.removeListener = function(c, u, d, f) {
    var g = n ? n + c : c;
    if (!this._events[g]) return this;
    if (!u)
      return o(this, g), this;
    var p = this._events[g];
    if (p.fn)
      p.fn === u && (!f || p.once) && (!d || p.context === d) && o(this, g);
    else {
      for (var S = 0, _ = [], m = p.length; S < m; S++)
        (p[S].fn !== u || f && !p[S].once || d && p[S].context !== d) && _.push(p[S]);
      _.length ? this._events[g] = _.length === 1 ? _[0] : _ : o(this, g);
    }
    return this;
  }, l.prototype.removeAllListeners = function(c) {
    var u;
    return c ? (u = n ? n + c : c, this._events[u] && o(this, u)) : (this._events = new r(), this._eventsCount = 0), this;
  }, l.prototype.off = l.prototype.removeListener, l.prototype.addListener = l.prototype.on, l.prefixed = n, l.EventEmitter = l, t.exports = l;
})(Ev);
var xO = Ev.exports;
const CO = /* @__PURE__ */ zd(xO), Pu = /* @__PURE__ */ new WeakMap(), Ru = ["error", "warn", "log", "info"];
let Mu = "warn";
function Tv(t) {
  if (Mu && Ru.indexOf(t) <= Ru.indexOf(Mu)) {
    for (var e = arguments.length, n = new Array(e > 1 ? e - 1 : 0), r = 1; r < e; r++)
      n[r - 1] = arguments[r];
    console[t](...n);
  }
}
function bi(t) {
  return Ru.reduce((e, n) => (e[n] = Tv.bind(console, n, t), e), {});
}
bi.level = (t) => {
  Mu = t;
};
Tv.level = bi.level;
const Nc = bi("quill:events"), $O = ["selectionchange", "mousedown", "mouseup", "click"];
$O.forEach((t) => {
  document.addEventListener(t, function() {
    for (var e = arguments.length, n = new Array(e), r = 0; r < e; r++)
      n[r] = arguments[r];
    Array.from(document.querySelectorAll(".ql-container")).forEach((i) => {
      const s = Pu.get(i);
      s && s.emitter && s.emitter.handleDOM(...n);
    });
  });
});
class we extends CO {
  static events = {
    EDITOR_CHANGE: "editor-change",
    SCROLL_BEFORE_UPDATE: "scroll-before-update",
    SCROLL_BLOT_MOUNT: "scroll-blot-mount",
    SCROLL_BLOT_UNMOUNT: "scroll-blot-unmount",
    SCROLL_OPTIMIZE: "scroll-optimize",
    SCROLL_UPDATE: "scroll-update",
    SCROLL_EMBED_UPDATE: "scroll-embed-update",
    SELECTION_CHANGE: "selection-change",
    TEXT_CHANGE: "text-change",
    COMPOSITION_BEFORE_START: "composition-before-start",
    COMPOSITION_START: "composition-start",
    COMPOSITION_BEFORE_END: "composition-before-end",
    COMPOSITION_END: "composition-end"
  };
  static sources = {
    API: "api",
    SILENT: "silent",
    USER: "user"
  };
  constructor() {
    super(), this.domListeners = {}, this.on("error", Nc.error);
  }
  emit() {
    for (var e = arguments.length, n = new Array(e), r = 0; r < e; r++)
      n[r] = arguments[r];
    return Nc.log.call(Nc, ...n), super.emit(...n);
  }
  handleDOM(e) {
    for (var n = arguments.length, r = new Array(n > 1 ? n - 1 : 0), i = 1; i < n; i++)
      r[i - 1] = arguments[i];
    (this.domListeners[e.type] || []).forEach((s) => {
      let {
        node: o,
        handler: l
      } = s;
      (e.target === o || o.contains(e.target)) && l(e, ...r);
    });
  }
  listenDOM(e, n, r) {
    this.domListeners[e] || (this.domListeners[e] = []), this.domListeners[e].push({
      node: n,
      handler: r
    });
  }
}
const Pc = bi("quill:selection");
class as {
  constructor(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
    this.index = e, this.length = n;
  }
}
class EO {
  constructor(e, n) {
    this.emitter = n, this.scroll = e, this.composing = !1, this.mouseDown = !1, this.root = this.scroll.domNode, this.cursor = this.scroll.create("cursor", this), this.savedRange = new as(0, 0), this.lastRange = this.savedRange, this.lastNative = null, this.handleComposition(), this.handleDragging(), this.emitter.listenDOM("selectionchange", document, () => {
      !this.mouseDown && !this.composing && setTimeout(this.update.bind(this, we.sources.USER), 1);
    }), this.emitter.on(we.events.SCROLL_BEFORE_UPDATE, () => {
      if (!this.hasFocus()) return;
      const r = this.getNativeRange();
      r != null && r.start.node !== this.cursor.textNode && this.emitter.once(we.events.SCROLL_UPDATE, (i, s) => {
        try {
          this.root.contains(r.start.node) && this.root.contains(r.end.node) && this.setNativeRange(r.start.node, r.start.offset, r.end.node, r.end.offset);
          const o = s.some((l) => l.type === "characterData" || l.type === "childList" || l.type === "attributes" && l.target === this.root);
          this.update(o ? we.sources.SILENT : i);
        } catch {
        }
      });
    }), this.emitter.on(we.events.SCROLL_OPTIMIZE, (r, i) => {
      if (i.range) {
        const {
          startNode: s,
          startOffset: o,
          endNode: l,
          endOffset: a
        } = i.range;
        this.setNativeRange(s, o, l, a), this.update(we.sources.SILENT);
      }
    }), this.update(we.sources.SILENT);
  }
  handleComposition() {
    this.emitter.on(we.events.COMPOSITION_BEFORE_START, () => {
      this.composing = !0;
    }), this.emitter.on(we.events.COMPOSITION_END, () => {
      if (this.composing = !1, this.cursor.parent) {
        const e = this.cursor.restore();
        if (!e) return;
        setTimeout(() => {
          this.setNativeRange(e.startNode, e.startOffset, e.endNode, e.endOffset);
        }, 1);
      }
    });
  }
  handleDragging() {
    this.emitter.listenDOM("mousedown", document.body, () => {
      this.mouseDown = !0;
    }), this.emitter.listenDOM("mouseup", document.body, () => {
      this.mouseDown = !1, this.update(we.sources.USER);
    });
  }
  focus() {
    this.hasFocus() || (this.root.focus({
      preventScroll: !0
    }), this.setRange(this.savedRange));
  }
  format(e, n) {
    this.scroll.update();
    const r = this.getNativeRange();
    if (!(r == null || !r.native.collapsed || this.scroll.query(e, Se.BLOCK))) {
      if (r.start.node !== this.cursor.textNode) {
        const i = this.scroll.find(r.start.node, !1);
        if (i == null) return;
        if (i instanceof xn) {
          const s = i.split(r.start.offset);
          i.parent.insertBefore(this.cursor, s);
        } else
          i.insertBefore(this.cursor, r.start.node);
        this.cursor.attach();
      }
      this.cursor.format(e, n), this.scroll.optimize(), this.setNativeRange(this.cursor.textNode, this.cursor.textNode.data.length), this.update();
    }
  }
  getBounds(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
    const r = this.scroll.length();
    e = Math.min(e, r - 1), n = Math.min(e + n, r - 1) - e;
    let i, [s, o] = this.scroll.leaf(e);
    if (s == null) return null;
    if (n > 0 && o === s.length()) {
      const [u] = this.scroll.leaf(e + 1);
      if (u) {
        const [d] = this.scroll.line(e), [f] = this.scroll.line(e + 1);
        d === f && (s = u, o = 0);
      }
    }
    [i, o] = s.position(o, !0);
    const l = document.createRange();
    if (n > 0)
      return l.setStart(i, o), [s, o] = this.scroll.leaf(e + n), s == null ? null : ([i, o] = s.position(o, !0), l.setEnd(i, o), l.getBoundingClientRect());
    let a = "left", c;
    if (i instanceof Text) {
      if (!i.data.length)
        return null;
      o < i.data.length ? (l.setStart(i, o), l.setEnd(i, o + 1)) : (l.setStart(i, o - 1), l.setEnd(i, o), a = "right"), c = l.getBoundingClientRect();
    } else {
      if (!(s.domNode instanceof Element)) return null;
      c = s.domNode.getBoundingClientRect(), o > 0 && (a = "right");
    }
    return {
      bottom: c.top + c.height,
      height: c.height,
      left: c[a],
      right: c[a],
      top: c.top,
      width: 0
    };
  }
  getNativeRange() {
    const e = document.getSelection();
    if (e == null || e.rangeCount <= 0) return null;
    const n = e.getRangeAt(0);
    if (n == null) return null;
    const r = this.normalizeNative(n);
    return Pc.info("getNativeRange", r), r;
  }
  getRange() {
    const e = this.scroll.domNode;
    if ("isConnected" in e && !e.isConnected)
      return [null, null];
    const n = this.getNativeRange();
    return n == null ? [null, null] : [this.normalizedToRange(n), n];
  }
  hasFocus() {
    return document.activeElement === this.root || document.activeElement != null && Rc(this.root, document.activeElement);
  }
  normalizedToRange(e) {
    const n = [[e.start.node, e.start.offset]];
    e.native.collapsed || n.push([e.end.node, e.end.offset]);
    const r = n.map((o) => {
      const [l, a] = o, c = this.scroll.find(l, !0), u = c.offset(this.scroll);
      return a === 0 ? u : c instanceof xn ? u + c.index(l, a) : u + c.length();
    }), i = Math.min(Math.max(...r), this.scroll.length() - 1), s = Math.min(i, ...r);
    return new as(s, i - s);
  }
  normalizeNative(e) {
    if (!Rc(this.root, e.startContainer) || !e.collapsed && !Rc(this.root, e.endContainer))
      return null;
    const n = {
      start: {
        node: e.startContainer,
        offset: e.startOffset
      },
      end: {
        node: e.endContainer,
        offset: e.endOffset
      },
      native: e
    };
    return [n.start, n.end].forEach((r) => {
      let {
        node: i,
        offset: s
      } = r;
      for (; !(i instanceof Text) && i.childNodes.length > 0; )
        if (i.childNodes.length > s)
          i = i.childNodes[s], s = 0;
        else if (i.childNodes.length === s)
          i = i.lastChild, i instanceof Text ? s = i.data.length : i.childNodes.length > 0 ? s = i.childNodes.length : s = i.childNodes.length + 1;
        else
          break;
      r.node = i, r.offset = s;
    }), n;
  }
  rangeToNative(e) {
    const n = this.scroll.length(), r = (i, s) => {
      i = Math.min(n - 1, i);
      const [o, l] = this.scroll.leaf(i);
      return o ? o.position(l, s) : [null, -1];
    };
    return [...r(e.index, !1), ...r(e.index + e.length, !0)];
  }
  setNativeRange(e, n) {
    let r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : e, i = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : n, s = arguments.length > 4 && arguments[4] !== void 0 ? arguments[4] : !1;
    if (Pc.info("setNativeRange", e, n, r, i), e != null && (this.root.parentNode == null || e.parentNode == null || // @ts-expect-error Fix me later
    r.parentNode == null))
      return;
    const o = document.getSelection();
    if (o != null)
      if (e != null) {
        this.hasFocus() || this.root.focus({
          preventScroll: !0
        });
        const {
          native: l
        } = this.getNativeRange() || {};
        if (l == null || s || e !== l.startContainer || n !== l.startOffset || r !== l.endContainer || i !== l.endOffset) {
          e instanceof Element && e.tagName === "BR" && (n = Array.from(e.parentNode.childNodes).indexOf(e), e = e.parentNode), r instanceof Element && r.tagName === "BR" && (i = Array.from(r.parentNode.childNodes).indexOf(r), r = r.parentNode);
          const a = document.createRange();
          a.setStart(e, n), a.setEnd(r, i), o.removeAllRanges(), o.addRange(a);
        }
      } else
        o.removeAllRanges(), this.root.blur();
  }
  setRange(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !1, r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : we.sources.API;
    if (typeof n == "string" && (r = n, n = !1), Pc.info("setRange", e), e != null) {
      const i = this.rangeToNative(e);
      this.setNativeRange(...i, n);
    } else
      this.setNativeRange(null);
    this.update(r);
  }
  update() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : we.sources.USER;
    const n = this.lastRange, [r, i] = this.getRange();
    if (this.lastRange = r, this.lastNative = i, this.lastRange != null && (this.savedRange = this.lastRange), !Fd(n, this.lastRange)) {
      if (!this.composing && i != null && i.native.collapsed && i.start.node !== this.cursor.textNode) {
        const o = this.cursor.restore();
        o && this.setNativeRange(o.startNode, o.startOffset, o.endNode, o.endOffset);
      }
      const s = [we.events.SELECTION_CHANGE, qs(this.lastRange), qs(n), e];
      this.emitter.emit(we.events.EDITOR_CHANGE, ...s), e !== we.sources.SILENT && this.emitter.emit(...s);
    }
  }
}
function Rc(t, e) {
  try {
    e.parentNode;
  } catch {
    return !1;
  }
  return t.contains(e);
}
const TO = /^[ -~]*$/;
class AO {
  constructor(e) {
    this.scroll = e, this.delta = this.getDelta();
  }
  applyDelta(e) {
    this.scroll.update();
    let n = this.scroll.length();
    this.scroll.batchStart();
    const r = Zf(e), i = new _e();
    return IO(r.ops.slice()).reduce((o, l) => {
      const a = mr.Op.length(l);
      let c = l.attributes || {}, u = !1, d = !1;
      if (l.insert != null) {
        if (i.retain(a), typeof l.insert == "string") {
          const p = l.insert;
          d = !p.endsWith(`
`) && (n <= o || !!this.scroll.descendant(gr, o)[0]), this.scroll.insertAt(o, p);
          const [S, _] = this.scroll.line(o);
          let m = Ri({}, ur(S));
          if (S instanceof gn) {
            const [y] = S.descendant(xn, _);
            y && (m = Ri(m, ur(y)));
          }
          c = mr.AttributeMap.diff(m, c) || {};
        } else if (typeof l.insert == "object") {
          const p = Object.keys(l.insert)[0];
          if (p == null) return o;
          const S = this.scroll.query(p, Se.INLINE) != null;
          if (S)
            (n <= o || this.scroll.descendant(gr, o)[0]) && (d = !0);
          else if (o > 0) {
            const [_, m] = this.scroll.descendant(xn, o - 1);
            _ instanceof kr ? _.value()[m] !== `
` && (u = !0) : _ instanceof tr && _.statics.scope === Se.INLINE_BLOT && (u = !0);
          }
          if (this.scroll.insertAt(o, p, l.insert[p]), S) {
            const [_] = this.scroll.descendant(xn, o);
            if (_) {
              const m = Ri({}, ur(_));
              c = mr.AttributeMap.diff(m, c) || {};
            }
          }
        }
        n += a;
      } else if (i.push(l), l.retain !== null && typeof l.retain == "object") {
        const p = Object.keys(l.retain)[0];
        if (p == null) return o;
        this.scroll.updateEmbedAt(o, p, l.retain[p]);
      }
      Object.keys(c).forEach((p) => {
        this.scroll.formatAt(o, a, p, c[p]);
      });
      const f = u ? 1 : 0, g = d ? 1 : 0;
      return n += f + g, i.retain(f), i.delete(g), o + a + f + g;
    }, 0), i.reduce((o, l) => typeof l.delete == "number" ? (this.scroll.deleteAt(o, l.delete), o) : o + mr.Op.length(l), 0), this.scroll.batchEnd(), this.scroll.optimize(), this.update(r);
  }
  deleteText(e, n) {
    return this.scroll.deleteAt(e, n), this.update(new _e().retain(e).delete(n));
  }
  formatLine(e, n) {
    let r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
    this.scroll.update(), Object.keys(r).forEach((s) => {
      this.scroll.lines(e, Math.max(n, 1)).forEach((o) => {
        o.format(s, r[s]);
      });
    }), this.scroll.optimize();
    const i = new _e().retain(e).retain(n, qs(r));
    return this.update(i);
  }
  formatText(e, n) {
    let r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
    Object.keys(r).forEach((s) => {
      this.scroll.formatAt(e, n, s, r[s]);
    });
    const i = new _e().retain(e).retain(n, qs(r));
    return this.update(i);
  }
  getContents(e, n) {
    return this.delta.slice(e, e + n);
  }
  getDelta() {
    return this.scroll.lines().reduce((e, n) => e.concat(n.delta()), new _e());
  }
  getFormat(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0, r = [], i = [];
    n === 0 ? this.scroll.path(e).forEach((l) => {
      const [a] = l;
      a instanceof gn ? r.push(a) : a instanceof xn && i.push(a);
    }) : (r = this.scroll.lines(e, n), i = this.scroll.descendants(xn, e, n));
    const [s, o] = [r, i].map((l) => {
      const a = l.shift();
      if (a == null) return {};
      let c = ur(a);
      for (; Object.keys(c).length > 0; ) {
        const u = l.shift();
        if (u == null) return c;
        c = kO(ur(u), c);
      }
      return c;
    });
    return {
      ...s,
      ...o
    };
  }
  getHTML(e, n) {
    const [r, i] = this.scroll.line(e);
    if (r) {
      const s = r.length();
      return r.length() >= i + n && !(i === 0 && n === s) ? Wo(r, i, n, !0) : Wo(this.scroll, e, n, !0);
    }
    return "";
  }
  getText(e, n) {
    return this.getContents(e, n).filter((r) => typeof r.insert == "string").map((r) => r.insert).join("");
  }
  insertContents(e, n) {
    const r = Zf(n), i = new _e().retain(e).concat(r);
    return this.scroll.insertContents(e, r), this.update(i);
  }
  insertEmbed(e, n, r) {
    return this.scroll.insertAt(e, n, r), this.update(new _e().retain(e).insert({
      [n]: r
    }));
  }
  insertText(e, n) {
    let r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
    return n = n.replace(/\r\n/g, `
`).replace(/\r/g, `
`), this.scroll.insertAt(e, n), Object.keys(r).forEach((i) => {
      this.scroll.formatAt(e, n.length, i, r[i]);
    }), this.update(new _e().retain(e).insert(n, qs(r)));
  }
  isBlank() {
    if (this.scroll.children.length === 0) return !0;
    if (this.scroll.children.length > 1) return !1;
    const e = this.scroll.children.head;
    if (e?.statics.blotName !== gn.blotName) return !1;
    const n = e;
    return n.children.length > 1 ? !1 : n.children.head instanceof Dr;
  }
  removeFormat(e, n) {
    const r = this.getText(e, n), [i, s] = this.scroll.line(e + n);
    let o = 0, l = new _e();
    i != null && (o = i.length() - s, l = i.delta().slice(s, s + o - 1).insert(`
`));
    const c = this.getContents(e, n + o).diff(new _e().insert(r).concat(l)), u = new _e().retain(e).concat(c);
    return this.applyDelta(u);
  }
  update(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : [], r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : void 0;
    const i = this.delta;
    if (n.length === 1 && n[0].type === "characterData" && // @ts-expect-error Fix me later
    n[0].target.data.match(TO) && this.scroll.find(n[0].target)) {
      const s = this.scroll.find(n[0].target), o = ur(s), l = s.offset(this.scroll), a = n[0].oldValue.replace(wr.CONTENTS, ""), c = new _e().insert(a), u = new _e().insert(s.value()), d = r && {
        oldRange: eg(r.oldRange, -l),
        newRange: eg(r.newRange, -l)
      };
      e = new _e().retain(l).concat(c.diff(u, d)).reduce((g, p) => p.insert ? g.insert(p.insert, o) : g.push(p), new _e()), this.delta = i.compose(e);
    } else
      this.delta = this.getDelta(), (!e || !Fd(i.compose(e), this.delta)) && (e = i.diff(this.delta, r));
    return e;
  }
}
function Is(t, e, n) {
  if (t.length === 0) {
    const [g] = Mc(n.pop());
    return e <= 0 ? `</li></${g}>` : `</li></${g}>${Is([], e - 1, n)}`;
  }
  const [{
    child: r,
    offset: i,
    length: s,
    indent: o,
    type: l
  }, ...a] = t, [c, u] = Mc(l);
  if (o > e)
    return n.push(l), o === e + 1 ? `<${c}><li${u}>${Wo(r, i, s)}${Is(a, o, n)}` : `<${c}><li>${Is(t, e + 1, n)}`;
  const d = n[n.length - 1];
  if (o === e && l === d)
    return `</li><li${u}>${Wo(r, i, s)}${Is(a, o, n)}`;
  const [f] = Mc(n.pop());
  return `</li></${f}>${Is(t, e - 1, n)}`;
}
function Wo(t, e, n) {
  let r = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : !1;
  if ("html" in t && typeof t.html == "function")
    return t.html(e, n);
  if (t instanceof kr)
    return sc(t.value().slice(e, e + n));
  if (t instanceof Er) {
    if (t.statics.blotName === "list-container") {
      const c = [];
      return t.children.forEachAt(e, n, (u, d, f) => {
        const g = "formats" in u && typeof u.formats == "function" ? u.formats() : {};
        c.push({
          child: u,
          offset: d,
          length: f,
          indent: g.indent || 0,
          type: g.list
        });
      }), Is(c, -1, []);
    }
    const i = [];
    if (t.children.forEachAt(e, n, (c, u, d) => {
      i.push(Wo(c, u, d));
    }), r || t.statics.blotName === "list")
      return i.join("");
    const {
      outerHTML: s,
      innerHTML: o
    } = t.domNode, [l, a] = s.split(`>${o}<`);
    return l === "<table" ? `<table style="border: 1px solid #000;">${i.join("")}<${a}` : `${l}>${i.join("")}<${a}`;
  }
  return t.domNode instanceof Element ? t.domNode.outerHTML : "";
}
function kO(t, e) {
  return Object.keys(e).reduce((n, r) => {
    if (t[r] == null) return n;
    const i = e[r];
    return i === t[r] ? n[r] = i : Array.isArray(i) ? i.indexOf(t[r]) < 0 ? n[r] = i.concat([t[r]]) : n[r] = i : n[r] = [i, t[r]], n;
  }, {});
}
function Mc(t) {
  const e = t === "ordered" ? "ol" : "ul";
  switch (t) {
    case "checked":
      return [e, ' data-list="checked"'];
    case "unchecked":
      return [e, ' data-list="unchecked"'];
    default:
      return [e, ""];
  }
}
function Zf(t) {
  return t.reduce((e, n) => {
    if (typeof n.insert == "string") {
      const r = n.insert.replace(/\r\n/g, `
`).replace(/\r/g, `
`);
      return e.insert(r, n.attributes);
    }
    return e.push(n);
  }, new _e());
}
function eg(t, e) {
  let {
    index: n,
    length: r
  } = t;
  return new as(n + e, r);
}
function IO(t) {
  const e = [];
  return t.forEach((n) => {
    typeof n.insert == "string" ? n.insert.split(`
`).forEach((i, s) => {
      s && e.push({
        insert: `
`,
        attributes: n.attributes
      }), i && e.push({
        insert: i,
        attributes: n.attributes
      });
    }) : e.push(n);
  }), e;
}
class Kr {
  static DEFAULTS = {};
  constructor(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
    this.quill = e, this.options = n;
  }
}
const kl = "\uFEFF";
class Yd extends tr {
  constructor(e, n) {
    super(e, n), this.contentNode = document.createElement("span"), this.contentNode.setAttribute("contenteditable", "false"), Array.from(this.domNode.childNodes).forEach((r) => {
      this.contentNode.appendChild(r);
    }), this.leftGuard = document.createTextNode(kl), this.rightGuard = document.createTextNode(kl), this.domNode.appendChild(this.leftGuard), this.domNode.appendChild(this.contentNode), this.domNode.appendChild(this.rightGuard);
  }
  index(e, n) {
    return e === this.leftGuard ? 0 : e === this.rightGuard ? 1 : super.index(e, n);
  }
  restore(e) {
    let n = null, r;
    const i = e.data.split(kl).join("");
    if (e === this.leftGuard)
      if (this.prev instanceof kr) {
        const s = this.prev.length();
        this.prev.insertAt(s, i), n = {
          startNode: this.prev.domNode,
          startOffset: s + i.length
        };
      } else
        r = document.createTextNode(i), this.parent.insertBefore(this.scroll.create(r), this), n = {
          startNode: r,
          startOffset: i.length
        };
    else e === this.rightGuard && (this.next instanceof kr ? (this.next.insertAt(0, i), n = {
      startNode: this.next.domNode,
      startOffset: i.length
    }) : (r = document.createTextNode(i), this.parent.insertBefore(this.scroll.create(r), this.next), n = {
      startNode: r,
      startOffset: i.length
    }));
    return e.data = kl, n;
  }
  update(e, n) {
    e.forEach((r) => {
      if (r.type === "characterData" && (r.target === this.leftGuard || r.target === this.rightGuard)) {
        const i = this.restore(r.target);
        i && (n.range = i);
      }
    });
  }
}
class OO {
  isComposing = !1;
  constructor(e, n) {
    this.scroll = e, this.emitter = n, this.setupListeners();
  }
  setupListeners() {
    this.scroll.domNode.addEventListener("compositionstart", (e) => {
      this.isComposing || this.handleCompositionStart(e);
    }), this.scroll.domNode.addEventListener("compositionend", (e) => {
      this.isComposing && queueMicrotask(() => {
        this.handleCompositionEnd(e);
      });
    });
  }
  handleCompositionStart(e) {
    const n = e.target instanceof Node ? this.scroll.find(e.target, !0) : null;
    n && !(n instanceof Yd) && (this.emitter.emit(we.events.COMPOSITION_BEFORE_START, e), this.scroll.batchStart(), this.emitter.emit(we.events.COMPOSITION_START, e), this.isComposing = !0);
  }
  handleCompositionEnd(e) {
    this.emitter.emit(we.events.COMPOSITION_BEFORE_END, e), this.scroll.batchEnd(), this.emitter.emit(we.events.COMPOSITION_END, e), this.isComposing = !1;
  }
}
class co {
  static DEFAULTS = {
    modules: {}
  };
  static themes = {
    default: co
  };
  modules = {};
  constructor(e, n) {
    this.quill = e, this.options = n;
  }
  init() {
    Object.keys(this.options.modules).forEach((e) => {
      this.modules[e] == null && this.addModule(e);
    });
  }
  addModule(e) {
    const n = this.quill.constructor.import(`modules/${e}`);
    return this.modules[e] = new n(this.quill, this.options.modules[e] || {}), this.modules[e];
  }
}
const DO = (t) => t.parentElement || t.getRootNode().host || null, LO = (t) => {
  const e = t.getBoundingClientRect(), n = "offsetWidth" in t && Math.abs(e.width) / t.offsetWidth || 1, r = "offsetHeight" in t && Math.abs(e.height) / t.offsetHeight || 1;
  return {
    top: e.top,
    right: e.left + t.clientWidth * n,
    bottom: e.top + t.clientHeight * r,
    left: e.left
  };
}, Il = (t) => {
  const e = parseInt(t, 10);
  return Number.isNaN(e) ? 0 : e;
}, tg = (t, e, n, r, i, s) => t < n && e > r ? 0 : t < n ? -(n - t + i) : e > r ? e - t > r - n ? t + i - n : e - r + s : 0, NO = (t, e) => {
  const n = t.ownerDocument;
  let r = e, i = t;
  for (; i; ) {
    const s = i === n.body, o = s ? {
      top: 0,
      right: window.visualViewport?.width ?? n.documentElement.clientWidth,
      bottom: window.visualViewport?.height ?? n.documentElement.clientHeight,
      left: 0
    } : LO(i), l = getComputedStyle(i), a = tg(r.left, r.right, o.left, o.right, Il(l.scrollPaddingLeft), Il(l.scrollPaddingRight)), c = tg(r.top, r.bottom, o.top, o.bottom, Il(l.scrollPaddingTop), Il(l.scrollPaddingBottom));
    if (a || c)
      if (s)
        n.defaultView?.scrollBy(a, c);
      else {
        const {
          scrollLeft: u,
          scrollTop: d
        } = i;
        c && (i.scrollTop += c), a && (i.scrollLeft += a);
        const f = i.scrollLeft - u, g = i.scrollTop - d;
        r = {
          left: r.left - f,
          top: r.top - g,
          right: r.right - f,
          bottom: r.bottom - g
        };
      }
    i = s || l.position === "fixed" ? null : DO(i);
  }
}, PO = 100, RO = ["block", "break", "cursor", "inline", "scroll", "text"], MO = (t, e, n) => {
  const r = new eo();
  return RO.forEach((i) => {
    const s = e.query(i);
    s && r.register(s);
  }), t.forEach((i) => {
    let s = e.query(i);
    s || n.error(`Cannot register "${i}" specified in "formats" config. Are you sure it was registered?`);
    let o = 0;
    for (; s; )
      if (r.register(s), s = "blotName" in s ? s.requiredContainer ?? null : null, o += 1, o > PO) {
        n.error(`Cycle detected in registering blot requiredContainer: "${i}"`);
        break;
      }
  }), r;
}, Us = bi("quill"), Ol = new eo();
Er.uiClass = "ql-ui";
class Q {
  static DEFAULTS = {
    bounds: null,
    modules: {
      clipboard: !0,
      keyboard: !0,
      history: !0,
      uploader: !0
    },
    placeholder: "",
    readOnly: !1,
    registry: Ol,
    theme: "default"
  };
  static events = we.events;
  static sources = we.sources;
  static version = "2.0.2";
  static imports = {
    delta: _e,
    parchment: cO,
    "core/module": Kr,
    "core/theme": co
  };
  static debug(e) {
    e === !0 && (e = "log"), bi.level(e);
  }
  static find(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !1;
    return Pu.get(e) || Ol.find(e, n);
  }
  static import(e) {
    return this.imports[e] == null && Us.error(`Cannot import ${e}. Are you sure it was registered?`), this.imports[e];
  }
  static register() {
    if (typeof (arguments.length <= 0 ? void 0 : arguments[0]) != "string") {
      const e = arguments.length <= 0 ? void 0 : arguments[0], n = !!(!(arguments.length <= 1) && arguments[1]), r = "attrName" in e ? e.attrName : e.blotName;
      typeof r == "string" ? this.register(`formats/${r}`, e, n) : Object.keys(e).forEach((i) => {
        this.register(i, e[i], n);
      });
    } else {
      const e = arguments.length <= 0 ? void 0 : arguments[0], n = arguments.length <= 1 ? void 0 : arguments[1], r = !!(!(arguments.length <= 2) && arguments[2]);
      this.imports[e] != null && !r && Us.warn(`Overwriting ${e} with`, n), this.imports[e] = n, (e.startsWith("blots/") || e.startsWith("formats/")) && n && typeof n != "boolean" && n.blotName !== "abstract" && Ol.register(n), typeof n.register == "function" && n.register(Ol);
    }
  }
  constructor(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
    if (this.options = qO(e, n), this.container = this.options.container, this.container == null) {
      Us.error("Invalid Quill container", e);
      return;
    }
    this.options.debug && Q.debug(this.options.debug);
    const r = this.container.innerHTML.trim();
    this.container.classList.add("ql-container"), this.container.innerHTML = "", Pu.set(this.container, this), this.root = this.addContainer("ql-editor"), this.root.classList.add("ql-blank"), this.emitter = new we();
    const i = Hd.blotName, s = this.options.registry.query(i);
    if (!s || !("blotName" in s))
      throw new Error(`Cannot initialize Quill without "${i}" blot`);
    if (this.scroll = new s(this.options.registry, this.root, {
      emitter: this.emitter
    }), this.editor = new AO(this.scroll), this.selection = new EO(this.scroll, this.emitter), this.composition = new OO(this.scroll, this.emitter), this.theme = new this.options.theme(this, this.options), this.keyboard = this.theme.addModule("keyboard"), this.clipboard = this.theme.addModule("clipboard"), this.history = this.theme.addModule("history"), this.uploader = this.theme.addModule("uploader"), this.theme.addModule("input"), this.theme.addModule("uiNode"), this.theme.init(), this.emitter.on(we.events.EDITOR_CHANGE, (o) => {
      o === we.events.TEXT_CHANGE && this.root.classList.toggle("ql-blank", this.editor.isBlank());
    }), this.emitter.on(we.events.SCROLL_UPDATE, (o, l) => {
      const a = this.selection.lastRange, [c] = this.selection.getRange(), u = a && c ? {
        oldRange: a,
        newRange: c
      } : void 0;
      yr.call(this, () => this.editor.update(null, l, u), o);
    }), this.emitter.on(we.events.SCROLL_EMBED_UPDATE, (o, l) => {
      const a = this.selection.lastRange, [c] = this.selection.getRange(), u = a && c ? {
        oldRange: a,
        newRange: c
      } : void 0;
      yr.call(this, () => {
        const d = new _e().retain(o.offset(this)).retain({
          [o.statics.blotName]: l
        });
        return this.editor.update(d, [], u);
      }, Q.sources.USER);
    }), r) {
      const o = this.clipboard.convert({
        html: `${r}<p><br></p>`,
        text: `
`
      });
      this.setContents(o);
    }
    this.history.clear(), this.options.placeholder && this.root.setAttribute("data-placeholder", this.options.placeholder), this.options.readOnly && this.disable(), this.allowReadOnlyEdits = !1;
  }
  addContainer(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : null;
    if (typeof e == "string") {
      const r = e;
      e = document.createElement("div"), e.classList.add(r);
    }
    return this.container.insertBefore(e, n), e;
  }
  blur() {
    this.selection.setRange(null);
  }
  deleteText(e, n, r) {
    return [e, n, , r] = ni(e, n, r), yr.call(this, () => this.editor.deleteText(e, n), r, e, -1 * n);
  }
  disable() {
    this.enable(!1);
  }
  editReadOnly(e) {
    this.allowReadOnlyEdits = !0;
    const n = e();
    return this.allowReadOnlyEdits = !1, n;
  }
  enable() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0;
    this.scroll.enable(e), this.container.classList.toggle("ql-disabled", !e);
  }
  focus() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : {};
    this.selection.focus(), e.preventScroll || this.scrollSelectionIntoView();
  }
  format(e, n) {
    let r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : we.sources.API;
    return yr.call(this, () => {
      const i = this.getSelection(!0);
      let s = new _e();
      if (i == null) return s;
      if (this.scroll.query(e, Se.BLOCK))
        s = this.editor.formatLine(i.index, i.length, {
          [e]: n
        });
      else {
        if (i.length === 0)
          return this.selection.format(e, n), s;
        s = this.editor.formatText(i.index, i.length, {
          [e]: n
        });
      }
      return this.setSelection(i, we.sources.SILENT), s;
    }, r);
  }
  formatLine(e, n, r, i, s) {
    let o;
    return [e, n, o, s] = ni(
      e,
      n,
      // @ts-expect-error
      r,
      i,
      s
    ), yr.call(this, () => this.editor.formatLine(e, n, o), s, e, 0);
  }
  formatText(e, n, r, i, s) {
    let o;
    return [e, n, o, s] = ni(
      // @ts-expect-error
      e,
      n,
      r,
      i,
      s
    ), yr.call(this, () => this.editor.formatText(e, n, o), s, e, 0);
  }
  getBounds(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0, r = null;
    if (typeof e == "number" ? r = this.selection.getBounds(e, n) : r = this.selection.getBounds(e.index, e.length), !r) return null;
    const i = this.container.getBoundingClientRect();
    return {
      bottom: r.bottom - i.top,
      height: r.height,
      left: r.left - i.left,
      right: r.right - i.left,
      top: r.top - i.top,
      width: r.width
    };
  }
  getContents() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0, n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : this.getLength() - e;
    return [e, n] = ni(e, n), this.editor.getContents(e, n);
  }
  getFormat() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : this.getSelection(!0), n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : 0;
    return typeof e == "number" ? this.editor.getFormat(e, n) : this.editor.getFormat(e.index, e.length);
  }
  getIndex(e) {
    return e.offset(this.scroll);
  }
  getLength() {
    return this.scroll.length();
  }
  getLeaf(e) {
    return this.scroll.leaf(e);
  }
  getLine(e) {
    return this.scroll.line(e);
  }
  getLines() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0, n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : Number.MAX_VALUE;
    return typeof e != "number" ? this.scroll.lines(e.index, e.length) : this.scroll.lines(e, n);
  }
  getModule(e) {
    return this.theme.modules[e];
  }
  getSelection() {
    return (arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !1) && this.focus(), this.update(), this.selection.getRange()[0];
  }
  getSemanticHTML() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0, n = arguments.length > 1 ? arguments[1] : void 0;
    return typeof e == "number" && (n = n ?? this.getLength() - e), [e, n] = ni(e, n), this.editor.getHTML(e, n);
  }
  getText() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0, n = arguments.length > 1 ? arguments[1] : void 0;
    return typeof e == "number" && (n = n ?? this.getLength() - e), [e, n] = ni(e, n), this.editor.getText(e, n);
  }
  hasFocus() {
    return this.selection.hasFocus();
  }
  insertEmbed(e, n, r) {
    let i = arguments.length > 3 && arguments[3] !== void 0 ? arguments[3] : Q.sources.API;
    return yr.call(this, () => this.editor.insertEmbed(e, n, r), i, e);
  }
  insertText(e, n, r, i, s) {
    let o;
    return [e, , o, s] = ni(e, 0, r, i, s), yr.call(this, () => this.editor.insertText(e, n, o), s, e, n.length);
  }
  isEnabled() {
    return this.scroll.isEnabled();
  }
  off() {
    return this.emitter.off(...arguments);
  }
  on() {
    return this.emitter.on(...arguments);
  }
  once() {
    return this.emitter.once(...arguments);
  }
  removeFormat(e, n, r) {
    return [e, n, , r] = ni(e, n, r), yr.call(this, () => this.editor.removeFormat(e, n), r, e);
  }
  scrollRectIntoView(e) {
    NO(this.root, e);
  }
  /**
   * @deprecated Use Quill#scrollSelectionIntoView() instead.
   */
  scrollIntoView() {
    console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."), this.scrollSelectionIntoView();
  }
  /**
   * Scroll the current selection into the visible area.
   * If the selection is already visible, no scrolling will occur.
   */
  scrollSelectionIntoView() {
    const e = this.selection.lastRange, n = e && this.selection.getBounds(e.index, e.length);
    n && this.scrollRectIntoView(n);
  }
  setContents(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : we.sources.API;
    return yr.call(this, () => {
      e = new _e(e);
      const r = this.getLength(), i = this.editor.deleteText(0, r), s = this.editor.insertContents(0, e), o = this.editor.deleteText(this.getLength() - 1, 1);
      return i.compose(s).compose(o);
    }, n);
  }
  setSelection(e, n, r) {
    e == null ? this.selection.setRange(null, n || Q.sources.API) : ([e, n, , r] = ni(e, n, r), this.selection.setRange(new as(Math.max(0, e), n), r), r !== we.sources.SILENT && this.scrollSelectionIntoView());
  }
  setText(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : we.sources.API;
    const r = new _e().insert(e);
    return this.setContents(r, n);
  }
  update() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : we.sources.USER;
    const n = this.scroll.update(e);
    return this.selection.update(e), n;
  }
  updateContents(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : we.sources.API;
    return yr.call(this, () => (e = new _e(e), this.editor.applyDelta(e)), n, !0);
  }
}
function ng(t) {
  return typeof t == "string" ? document.querySelector(t) : t;
}
function qc(t) {
  return Object.entries(t ?? {}).reduce((e, n) => {
    let [r, i] = n;
    return {
      ...e,
      [r]: i === !0 ? {} : i
    };
  }, {});
}
function rg(t) {
  return Object.fromEntries(Object.entries(t).filter((e) => e[1] !== void 0));
}
function qO(t, e) {
  const n = ng(t);
  if (!n)
    throw new Error("Invalid Quill container");
  const i = !e.theme || e.theme === Q.DEFAULTS.theme ? co : Q.import(`themes/${e.theme}`);
  if (!i)
    throw new Error(`Invalid theme ${e.theme}. Did you register it?`);
  const {
    modules: s,
    ...o
  } = Q.DEFAULTS, {
    modules: l,
    ...a
  } = i.DEFAULTS;
  let c = qc(e.modules);
  c != null && c.toolbar && c.toolbar.constructor !== Object && (c = {
    ...c,
    toolbar: {
      container: c.toolbar
    }
  });
  const u = Ri({}, qc(s), qc(l), c), d = {
    ...o,
    ...rg(a),
    ...rg(e)
  };
  let f = e.registry;
  return f ? e.formats && Us.warn('Ignoring "formats" option because "registry" is specified') : f = e.formats ? MO(e.formats, d.registry, Us) : d.registry, {
    ...d,
    registry: f,
    container: n,
    theme: i,
    modules: Object.entries(u).reduce((g, p) => {
      let [S, _] = p;
      if (!_) return g;
      const m = Q.import(`modules/${S}`);
      return m == null ? (Us.error(`Cannot load ${S} module. Are you sure you registered it?`), g) : {
        ...g,
        // @ts-expect-error
        [S]: Ri({}, m.DEFAULTS || {}, _)
      };
    }, {}),
    bounds: ng(d.bounds)
  };
}
function yr(t, e, n, r) {
  if (!this.isEnabled() && e === we.sources.USER && !this.allowReadOnlyEdits)
    return new _e();
  let i = n == null ? null : this.getSelection();
  const s = this.editor.delta, o = t();
  if (i != null && (n === !0 && (n = i.index), r == null ? i = ig(i, o, e) : r !== 0 && (i = ig(i, n, r, e)), this.setSelection(i, we.sources.SILENT)), o.length() > 0) {
    const l = [we.events.TEXT_CHANGE, o, s, e];
    this.emitter.emit(we.events.EDITOR_CHANGE, ...l), e !== we.sources.SILENT && this.emitter.emit(...l);
  }
  return o;
}
function ni(t, e, n, r, i) {
  let s = {};
  return typeof t.index == "number" && typeof t.length == "number" ? typeof e != "number" ? (i = r, r = n, n = e, e = t.length, t = t.index) : (e = t.length, t = t.index) : typeof e != "number" && (i = r, r = n, n = e, e = 0), typeof n == "object" ? (s = n, i = r) : typeof n == "string" && (r != null ? s[n] = r : i = n), i = i || we.sources.API, [t, e, s, i];
}
function ig(t, e, n, r) {
  const i = typeof n == "number" ? n : 0;
  if (t == null) return null;
  let s, o;
  return e && typeof e.transformPosition == "function" ? [s, o] = [t.index, t.index + t.length].map((l) => (
    // @ts-expect-error -- TODO: add a better type guard around `index`
    e.transformPosition(l, r !== we.sources.USER)
  )) : [s, o] = [t.index, t.index + t.length].map((l) => l < e || l === e && r === we.sources.USER ? l : i >= 0 ? l + i : Math.max(e, l + i)), new as(s, o - s);
}
class ms extends tc {
}
function sg(t) {
  return t instanceof gn || t instanceof gr;
}
function og(t) {
  return typeof t.updateContent == "function";
}
class BO extends Hd {
  static blotName = "scroll";
  static className = "ql-editor";
  static tagName = "DIV";
  static defaultChild = gn;
  static allowedChildren = [gn, gr, ms];
  constructor(e, n, r) {
    let {
      emitter: i
    } = r;
    super(e, n), this.emitter = i, this.batch = !1, this.optimize(), this.enable(), this.domNode.addEventListener("dragstart", (s) => this.handleDragStart(s));
  }
  batchStart() {
    Array.isArray(this.batch) || (this.batch = []);
  }
  batchEnd() {
    if (!this.batch) return;
    const e = this.batch;
    this.batch = !1, this.update(e);
  }
  emitMount(e) {
    this.emitter.emit(we.events.SCROLL_BLOT_MOUNT, e);
  }
  emitUnmount(e) {
    this.emitter.emit(we.events.SCROLL_BLOT_UNMOUNT, e);
  }
  emitEmbedUpdate(e, n) {
    this.emitter.emit(we.events.SCROLL_EMBED_UPDATE, e, n);
  }
  deleteAt(e, n) {
    const [r, i] = this.line(e), [s] = this.line(e + n);
    if (super.deleteAt(e, n), s != null && r !== s && i > 0) {
      if (r instanceof gr || s instanceof gr) {
        this.optimize();
        return;
      }
      const o = s.children.head instanceof Dr ? null : s.children.head;
      r.moveChildren(s, o), r.remove();
    }
    this.optimize();
  }
  enable() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : !0;
    this.domNode.setAttribute("contenteditable", e ? "true" : "false");
  }
  formatAt(e, n, r, i) {
    super.formatAt(e, n, r, i), this.optimize();
  }
  insertAt(e, n, r) {
    if (e >= this.length())
      if (r == null || this.scroll.query(n, Se.BLOCK) == null) {
        const i = this.scroll.create(this.statics.defaultChild.blotName);
        this.appendChild(i), r == null && n.endsWith(`
`) ? i.insertAt(0, n.slice(0, -1), r) : i.insertAt(0, n, r);
      } else {
        const i = this.scroll.create(n, r);
        this.appendChild(i);
      }
    else
      super.insertAt(e, n, r);
    this.optimize();
  }
  insertBefore(e, n) {
    if (e.statics.scope === Se.INLINE_BLOT) {
      const r = this.scroll.create(this.statics.defaultChild.blotName);
      r.appendChild(e), super.insertBefore(r, n);
    } else
      super.insertBefore(e, n);
  }
  insertContents(e, n) {
    const r = this.deltaToRenderBlocks(n.concat(new _e().insert(`
`))), i = r.pop();
    if (i == null) return;
    this.batchStart();
    const s = r.shift();
    if (s) {
      const a = s.type === "block" && (s.delta.length() === 0 || !this.descendant(gr, e)[0] && e < this.length()), c = s.type === "block" ? s.delta : new _e().insert({
        [s.key]: s.value
      });
      Bc(this, e, c);
      const u = s.type === "block" ? 1 : 0, d = e + c.length() + u;
      a && this.insertAt(d - 1, `
`);
      const f = ur(this.line(e)[0]), g = mr.AttributeMap.diff(f, s.attributes) || {};
      Object.keys(g).forEach((p) => {
        this.formatAt(d - 1, 1, p, g[p]);
      }), e = d;
    }
    let [o, l] = this.children.find(e);
    if (r.length && (o && (o = o.split(l), l = 0), r.forEach((a) => {
      if (a.type === "block") {
        const c = this.createBlock(a.attributes, o || void 0);
        Bc(c, 0, a.delta);
      } else {
        const c = this.create(a.key, a.value);
        this.insertBefore(c, o || void 0), Object.keys(a.attributes).forEach((u) => {
          c.format(u, a.attributes[u]);
        });
      }
    })), i.type === "block" && i.delta.length()) {
      const a = o ? o.offset(o.scroll) + l : this.length();
      Bc(this, a, i.delta);
    }
    this.batchEnd(), this.optimize();
  }
  isEnabled() {
    return this.domNode.getAttribute("contenteditable") === "true";
  }
  leaf(e) {
    const n = this.path(e).pop();
    if (!n)
      return [null, -1];
    const [r, i] = n;
    return r instanceof xn ? [r, i] : [null, -1];
  }
  line(e) {
    return e === this.length() ? this.line(e - 1) : this.descendant(sg, e);
  }
  lines() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : 0, n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : Number.MAX_VALUE;
    const r = (i, s, o) => {
      let l = [], a = o;
      return i.children.forEachAt(s, o, (c, u, d) => {
        sg(c) ? l.push(c) : c instanceof tc && (l = l.concat(r(c, u, a))), a -= d;
      }), l;
    };
    return r(this, e, n);
  }
  optimize() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : [], n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
    this.batch || (super.optimize(e, n), e.length > 0 && this.emitter.emit(we.events.SCROLL_OPTIMIZE, e, n));
  }
  path(e) {
    return super.path(e).slice(1);
  }
  remove() {
  }
  update(e) {
    if (this.batch) {
      Array.isArray(e) && (this.batch = this.batch.concat(e));
      return;
    }
    let n = we.sources.USER;
    typeof e == "string" && (n = e), Array.isArray(e) || (e = this.observer.takeRecords()), e = e.filter((r) => {
      let {
        target: i
      } = r;
      const s = this.find(i, !0);
      return s && !og(s);
    }), e.length > 0 && this.emitter.emit(we.events.SCROLL_BEFORE_UPDATE, n, e), super.update(e.concat([])), e.length > 0 && this.emitter.emit(we.events.SCROLL_UPDATE, n, e);
  }
  updateEmbedAt(e, n, r) {
    const [i] = this.descendant((s) => s instanceof gr, e);
    i && i.statics.blotName === n && og(i) && i.updateContent(r);
  }
  handleDragStart(e) {
    e.preventDefault();
  }
  deltaToRenderBlocks(e) {
    const n = [];
    let r = new _e();
    return e.forEach((i) => {
      const s = i?.insert;
      if (s)
        if (typeof s == "string") {
          const o = s.split(`
`);
          o.slice(0, -1).forEach((a) => {
            r.insert(a, i.attributes), n.push({
              type: "block",
              delta: r,
              attributes: i.attributes ?? {}
            }), r = new _e();
          });
          const l = o[o.length - 1];
          l && r.insert(l, i.attributes);
        } else {
          const o = Object.keys(s)[0];
          if (!o) return;
          this.query(o, Se.INLINE) ? r.push(i) : (r.length() && n.push({
            type: "block",
            delta: r,
            attributes: {}
          }), r = new _e(), n.push({
            type: "blockEmbed",
            key: o,
            value: s[o],
            attributes: i.attributes ?? {}
          }));
        }
    }), r.length() && n.push({
      type: "block",
      delta: r,
      attributes: {}
    }), n;
  }
  createBlock(e, n) {
    let r;
    const i = {};
    Object.entries(e).forEach((l) => {
      let [a, c] = l;
      this.query(a, Se.BLOCK & Se.BLOT) != null ? r = a : i[a] = c;
    });
    const s = this.create(r || this.statics.defaultChild.blotName, r ? e[r] : void 0);
    this.insertBefore(s, n || void 0);
    const o = s.length();
    return Object.entries(i).forEach((l) => {
      let [a, c] = l;
      s.formatAt(0, o, a, c);
    }), s;
  }
}
function Bc(t, e, n) {
  n.reduce((r, i) => {
    const s = mr.Op.length(i);
    let o = i.attributes || {};
    if (i.insert != null) {
      if (typeof i.insert == "string") {
        const l = i.insert;
        t.insertAt(r, l);
        const [a] = t.descendant(xn, r), c = ur(a);
        o = mr.AttributeMap.diff(c, o) || {};
      } else if (typeof i.insert == "object") {
        const l = Object.keys(i.insert)[0];
        if (l == null) return r;
        if (t.insertAt(r, l, i.insert[l]), t.scroll.query(l, Se.INLINE) != null) {
          const [c] = t.descendant(xn, r), u = ur(c);
          o = mr.AttributeMap.diff(u, o) || {};
        }
      }
    }
    return Object.keys(o).forEach((l) => {
      t.formatAt(r, s, l, o[l]);
    }), r + s;
  }, e);
}
const Xd = {
  scope: Se.BLOCK,
  whitelist: ["right", "center", "justify"]
}, UO = new zr("align", "align", Xd), Av = new Or("align", "ql-align", Xd), kv = new Vi("align", "text-align", Xd);
class Iv extends Vi {
  value(e) {
    let n = super.value(e);
    return n.startsWith("rgb(") ? (n = n.replace(/^[^\d]+/, "").replace(/[^\d]+$/, ""), `#${n.split(",").map((i) => `00${parseInt(i, 10).toString(16)}`.slice(-2)).join("")}`) : n;
  }
}
const jO = new Or("color", "ql-color", {
  scope: Se.INLINE
}), Zd = new Iv("color", "color", {
  scope: Se.INLINE
}), GO = new Or("background", "ql-bg", {
  scope: Se.INLINE
}), eh = new Iv("background", "background-color", {
  scope: Se.INLINE
});
class vs extends ms {
  static create(e) {
    const n = super.create(e);
    return n.setAttribute("spellcheck", "false"), n;
  }
  code(e, n) {
    return this.children.map((r) => r.length() <= 1 ? "" : r.domNode.innerText).join(`
`).slice(e, e + n);
  }
  html(e, n) {
    return `<pre>
${sc(this.code(e, n))}
</pre>`;
  }
}
class Dn extends gn {
  static TAB = "  ";
  static register() {
    Q.register(vs);
  }
}
class th extends In {
}
th.blotName = "code";
th.tagName = "CODE";
Dn.blotName = "code-block";
Dn.className = "ql-code-block";
Dn.tagName = "DIV";
vs.blotName = "code-block-container";
vs.className = "ql-code-block-container";
vs.tagName = "DIV";
vs.allowedChildren = [Dn];
Dn.allowedChildren = [kr, Dr, wr];
Dn.requiredContainer = vs;
const nh = {
  scope: Se.BLOCK,
  whitelist: ["rtl"]
}, Ov = new zr("direction", "dir", nh), Dv = new Or("direction", "ql-direction", nh), Lv = new Vi("direction", "direction", nh), Nv = {
  scope: Se.INLINE,
  whitelist: ["serif", "monospace"]
}, Pv = new Or("font", "ql-font", Nv);
class FO extends Vi {
  value(e) {
    return super.value(e).replace(/["']/g, "");
  }
}
const Rv = new FO("font", "font-family", Nv), Mv = new Or("size", "ql-size", {
  scope: Se.INLINE,
  whitelist: ["small", "large", "huge"]
}), qv = new Vi("size", "font-size", {
  scope: Se.INLINE,
  whitelist: ["10px", "18px", "32px"]
}), VO = bi("quill:keyboard"), HO = /Mac/i.test(navigator.platform) ? "metaKey" : "ctrlKey";
class oc extends Kr {
  static match(e, n) {
    return ["altKey", "ctrlKey", "metaKey", "shiftKey"].some((r) => !!n[r] !== e[r] && n[r] !== null) ? !1 : n.key === e.key || n.key === e.which;
  }
  constructor(e, n) {
    super(e, n), this.bindings = {}, Object.keys(this.options.bindings).forEach((r) => {
      this.options.bindings[r] && this.addBinding(this.options.bindings[r]);
    }), this.addBinding({
      key: "Enter",
      shiftKey: null
    }, this.handleEnter), this.addBinding({
      key: "Enter",
      metaKey: null,
      ctrlKey: null,
      altKey: null
    }, () => {
    }), /Firefox/i.test(navigator.userAgent) ? (this.addBinding({
      key: "Backspace"
    }, {
      collapsed: !0
    }, this.handleBackspace), this.addBinding({
      key: "Delete"
    }, {
      collapsed: !0
    }, this.handleDelete)) : (this.addBinding({
      key: "Backspace"
    }, {
      collapsed: !0,
      prefix: /^.?$/
    }, this.handleBackspace), this.addBinding({
      key: "Delete"
    }, {
      collapsed: !0,
      suffix: /^.?$/
    }, this.handleDelete)), this.addBinding({
      key: "Backspace"
    }, {
      collapsed: !1
    }, this.handleDeleteRange), this.addBinding({
      key: "Delete"
    }, {
      collapsed: !1
    }, this.handleDeleteRange), this.addBinding({
      key: "Backspace",
      altKey: null,
      ctrlKey: null,
      metaKey: null,
      shiftKey: null
    }, {
      collapsed: !0,
      offset: 0
    }, this.handleBackspace), this.listen();
  }
  addBinding(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {}, r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : {};
    const i = WO(e);
    if (i == null) {
      VO.warn("Attempted to add invalid keyboard binding", i);
      return;
    }
    typeof n == "function" && (n = {
      handler: n
    }), typeof r == "function" && (r = {
      handler: r
    }), (Array.isArray(i.key) ? i.key : [i.key]).forEach((o) => {
      const l = {
        ...i,
        key: o,
        ...n,
        ...r
      };
      this.bindings[l.key] = this.bindings[l.key] || [], this.bindings[l.key].push(l);
    });
  }
  listen() {
    this.quill.root.addEventListener("keydown", (e) => {
      if (e.defaultPrevented || e.isComposing || e.keyCode === 229 && (e.key === "Enter" || e.key === "Backspace")) return;
      const i = (this.bindings[e.key] || []).concat(this.bindings[e.which] || []).filter((m) => oc.match(e, m));
      if (i.length === 0) return;
      const s = Q.find(e.target, !0);
      if (s && s.scroll !== this.quill.scroll) return;
      const o = this.quill.getSelection();
      if (o == null || !this.quill.hasFocus()) return;
      const [l, a] = this.quill.getLine(o.index), [c, u] = this.quill.getLeaf(o.index), [d, f] = o.length === 0 ? [c, u] : this.quill.getLeaf(o.index + o.length), g = c instanceof $a ? c.value().slice(0, u) : "", p = d instanceof $a ? d.value().slice(f) : "", S = {
        collapsed: o.length === 0,
        // @ts-expect-error Fix me later
        empty: o.length === 0 && l.length() <= 1,
        format: this.quill.getFormat(o),
        line: l,
        offset: a,
        prefix: g,
        suffix: p,
        event: e
      };
      i.some((m) => {
        if (m.collapsed != null && m.collapsed !== S.collapsed || m.empty != null && m.empty !== S.empty || m.offset != null && m.offset !== S.offset)
          return !1;
        if (Array.isArray(m.format)) {
          if (m.format.every((y) => S.format[y] == null))
            return !1;
        } else if (typeof m.format == "object" && !Object.keys(m.format).every((y) => m.format[y] === !0 ? S.format[y] != null : m.format[y] === !1 ? S.format[y] == null : Fd(m.format[y], S.format[y])))
          return !1;
        return m.prefix != null && !m.prefix.test(S.prefix) || m.suffix != null && !m.suffix.test(S.suffix) ? !1 : m.handler.call(this, o, S, m) !== !0;
      }) && e.preventDefault();
    });
  }
  handleBackspace(e, n) {
    const r = /[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(n.prefix) ? 2 : 1;
    if (e.index === 0 || this.quill.getLength() <= 1) return;
    let i = {};
    const [s] = this.quill.getLine(e.index);
    let o = new _e().retain(e.index - r).delete(r);
    if (n.offset === 0) {
      const [l] = this.quill.getLine(e.index - 1);
      if (l && !(l.statics.blotName === "block" && l.length() <= 1)) {
        const c = s.formats(), u = this.quill.getFormat(e.index - 1, 1);
        if (i = mr.AttributeMap.diff(c, u) || {}, Object.keys(i).length > 0) {
          const d = new _e().retain(e.index + s.length() - 2).retain(1, i);
          o = o.compose(d);
        }
      }
    }
    this.quill.updateContents(o, Q.sources.USER), this.quill.focus();
  }
  handleDelete(e, n) {
    const r = /^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(n.suffix) ? 2 : 1;
    if (e.index >= this.quill.getLength() - r) return;
    let i = {};
    const [s] = this.quill.getLine(e.index);
    let o = new _e().retain(e.index).delete(r);
    if (n.offset >= s.length() - 1) {
      const [l] = this.quill.getLine(e.index + 1);
      if (l) {
        const a = s.formats(), c = this.quill.getFormat(e.index, 1);
        i = mr.AttributeMap.diff(a, c) || {}, Object.keys(i).length > 0 && (o = o.retain(l.length() - 1).retain(1, i));
      }
    }
    this.quill.updateContents(o, Q.sources.USER), this.quill.focus();
  }
  handleDeleteRange(e) {
    rh({
      range: e,
      quill: this.quill
    }), this.quill.focus();
  }
  handleEnter(e, n) {
    const r = Object.keys(n.format).reduce((s, o) => (this.quill.scroll.query(o, Se.BLOCK) && !Array.isArray(n.format[o]) && (s[o] = n.format[o]), s), {}), i = new _e().retain(e.index).delete(e.length).insert(`
`, r);
    this.quill.updateContents(i, Q.sources.USER), this.quill.setSelection(e.index + 1, Q.sources.SILENT), this.quill.focus();
  }
}
const zO = {
  bindings: {
    bold: Uc("bold"),
    italic: Uc("italic"),
    underline: Uc("underline"),
    indent: {
      // highlight tab or tab at beginning of list, indent or blockquote
      key: "Tab",
      format: ["blockquote", "indent", "list"],
      handler(t, e) {
        return e.collapsed && e.offset !== 0 ? !0 : (this.quill.format("indent", "+1", Q.sources.USER), !1);
      }
    },
    outdent: {
      key: "Tab",
      shiftKey: !0,
      format: ["blockquote", "indent", "list"],
      // highlight tab or tab at beginning of list, indent or blockquote
      handler(t, e) {
        return e.collapsed && e.offset !== 0 ? !0 : (this.quill.format("indent", "-1", Q.sources.USER), !1);
      }
    },
    "outdent backspace": {
      key: "Backspace",
      collapsed: !0,
      shiftKey: null,
      metaKey: null,
      ctrlKey: null,
      altKey: null,
      format: ["indent", "list"],
      offset: 0,
      handler(t, e) {
        e.format.indent != null ? this.quill.format("indent", "-1", Q.sources.USER) : e.format.list != null && this.quill.format("list", !1, Q.sources.USER);
      }
    },
    "indent code-block": lg(!0),
    "outdent code-block": lg(!1),
    "remove tab": {
      key: "Tab",
      shiftKey: !0,
      collapsed: !0,
      prefix: /\t$/,
      handler(t) {
        this.quill.deleteText(t.index - 1, 1, Q.sources.USER);
      }
    },
    tab: {
      key: "Tab",
      handler(t, e) {
        if (e.format.table) return !0;
        this.quill.history.cutoff();
        const n = new _e().retain(t.index).delete(t.length).insert("	");
        return this.quill.updateContents(n, Q.sources.USER), this.quill.history.cutoff(), this.quill.setSelection(t.index + 1, Q.sources.SILENT), !1;
      }
    },
    "blockquote empty enter": {
      key: "Enter",
      collapsed: !0,
      format: ["blockquote"],
      empty: !0,
      handler() {
        this.quill.format("blockquote", !1, Q.sources.USER);
      }
    },
    "list empty enter": {
      key: "Enter",
      collapsed: !0,
      format: ["list"],
      empty: !0,
      handler(t, e) {
        const n = {
          list: !1
        };
        e.format.indent && (n.indent = !1), this.quill.formatLine(t.index, t.length, n, Q.sources.USER);
      }
    },
    "checklist enter": {
      key: "Enter",
      collapsed: !0,
      format: {
        list: "checked"
      },
      handler(t) {
        const [e, n] = this.quill.getLine(t.index), r = {
          // @ts-expect-error Fix me later
          ...e.formats(),
          list: "checked"
        }, i = new _e().retain(t.index).insert(`
`, r).retain(e.length() - n - 1).retain(1, {
          list: "unchecked"
        });
        this.quill.updateContents(i, Q.sources.USER), this.quill.setSelection(t.index + 1, Q.sources.SILENT), this.quill.scrollSelectionIntoView();
      }
    },
    "header enter": {
      key: "Enter",
      collapsed: !0,
      format: ["header"],
      suffix: /^$/,
      handler(t, e) {
        const [n, r] = this.quill.getLine(t.index), i = new _e().retain(t.index).insert(`
`, e.format).retain(n.length() - r - 1).retain(1, {
          header: null
        });
        this.quill.updateContents(i, Q.sources.USER), this.quill.setSelection(t.index + 1, Q.sources.SILENT), this.quill.scrollSelectionIntoView();
      }
    },
    "table backspace": {
      key: "Backspace",
      format: ["table"],
      collapsed: !0,
      offset: 0,
      handler() {
      }
    },
    "table delete": {
      key: "Delete",
      format: ["table"],
      collapsed: !0,
      suffix: /^$/,
      handler() {
      }
    },
    "table enter": {
      key: "Enter",
      shiftKey: null,
      format: ["table"],
      handler(t) {
        const e = this.quill.getModule("table");
        if (e) {
          const [n, r, i, s] = e.getTable(t), o = JO(n, r, i, s);
          if (o == null) return;
          let l = n.offset();
          if (o < 0) {
            const a = new _e().retain(l).insert(`
`);
            this.quill.updateContents(a, Q.sources.USER), this.quill.setSelection(t.index + 1, t.length, Q.sources.SILENT);
          } else if (o > 0) {
            l += n.length();
            const a = new _e().retain(l).insert(`
`);
            this.quill.updateContents(a, Q.sources.USER), this.quill.setSelection(l, Q.sources.USER);
          }
        }
      }
    },
    "table tab": {
      key: "Tab",
      shiftKey: null,
      format: ["table"],
      handler(t, e) {
        const {
          event: n,
          line: r
        } = e, i = r.offset(this.quill.scroll);
        n.shiftKey ? this.quill.setSelection(i - 1, Q.sources.USER) : this.quill.setSelection(i + r.length(), Q.sources.USER);
      }
    },
    "list autofill": {
      key: " ",
      shiftKey: null,
      collapsed: !0,
      format: {
        "code-block": !1,
        blockquote: !1,
        table: !1
      },
      prefix: /^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,
      handler(t, e) {
        if (this.quill.scroll.query("list") == null) return !0;
        const {
          length: n
        } = e.prefix, [r, i] = this.quill.getLine(t.index);
        if (i > n) return !0;
        let s;
        switch (e.prefix.trim()) {
          case "[]":
          case "[ ]":
            s = "unchecked";
            break;
          case "[x]":
            s = "checked";
            break;
          case "-":
          case "*":
            s = "bullet";
            break;
          default:
            s = "ordered";
        }
        this.quill.insertText(t.index, " ", Q.sources.USER), this.quill.history.cutoff();
        const o = new _e().retain(t.index - i).delete(n + 1).retain(r.length() - 2 - i).retain(1, {
          list: s
        });
        return this.quill.updateContents(o, Q.sources.USER), this.quill.history.cutoff(), this.quill.setSelection(t.index - n, Q.sources.SILENT), !1;
      }
    },
    "code exit": {
      key: "Enter",
      collapsed: !0,
      format: ["code-block"],
      prefix: /^$/,
      suffix: /^\s*$/,
      handler(t) {
        const [e, n] = this.quill.getLine(t.index);
        let r = 2, i = e;
        for (; i != null && i.length() <= 1 && i.formats()["code-block"]; )
          if (i = i.prev, r -= 1, r <= 0) {
            const s = new _e().retain(t.index + e.length() - n - 2).retain(1, {
              "code-block": null
            }).delete(1);
            return this.quill.updateContents(s, Q.sources.USER), this.quill.setSelection(t.index - 1, Q.sources.SILENT), !1;
          }
        return !0;
      }
    },
    "embed left": Dl("ArrowLeft", !1),
    "embed left shift": Dl("ArrowLeft", !0),
    "embed right": Dl("ArrowRight", !1),
    "embed right shift": Dl("ArrowRight", !0),
    "table down": ag(!1),
    "table up": ag(!0)
  }
};
oc.DEFAULTS = zO;
function lg(t) {
  return {
    key: "Tab",
    shiftKey: !t,
    format: {
      "code-block": !0
    },
    handler(e, n) {
      let {
        event: r
      } = n;
      const i = this.quill.scroll.query("code-block"), {
        TAB: s
      } = i;
      if (e.length === 0 && !r.shiftKey) {
        this.quill.insertText(e.index, s, Q.sources.USER), this.quill.setSelection(e.index + s.length, Q.sources.SILENT);
        return;
      }
      const o = e.length === 0 ? this.quill.getLines(e.index, 1) : this.quill.getLines(e);
      let {
        index: l,
        length: a
      } = e;
      o.forEach((c, u) => {
        t ? (c.insertAt(0, s), u === 0 ? l += s.length : a += s.length) : c.domNode.textContent.startsWith(s) && (c.deleteAt(0, s.length), u === 0 ? l -= s.length : a -= s.length);
      }), this.quill.update(Q.sources.USER), this.quill.setSelection(l, a, Q.sources.SILENT);
    }
  };
}
function Dl(t, e) {
  return {
    key: t,
    shiftKey: e,
    altKey: null,
    [t === "ArrowLeft" ? "prefix" : "suffix"]: /^$/,
    handler(r) {
      let {
        index: i
      } = r;
      t === "ArrowRight" && (i += r.length + 1);
      const [s] = this.quill.getLeaf(i);
      return s instanceof tr ? (t === "ArrowLeft" ? e ? this.quill.setSelection(r.index - 1, r.length + 1, Q.sources.USER) : this.quill.setSelection(r.index - 1, Q.sources.USER) : e ? this.quill.setSelection(r.index, r.length + 1, Q.sources.USER) : this.quill.setSelection(r.index + r.length + 1, Q.sources.USER), !1) : !0;
    }
  };
}
function Uc(t) {
  return {
    key: t[0],
    shortKey: !0,
    handler(e, n) {
      this.quill.format(t, !n.format[t], Q.sources.USER);
    }
  };
}
function ag(t) {
  return {
    key: t ? "ArrowUp" : "ArrowDown",
    collapsed: !0,
    format: ["table"],
    handler(e, n) {
      const r = t ? "prev" : "next", i = n.line, s = i.parent[r];
      if (s != null) {
        if (s.statics.blotName === "table-row") {
          let o = s.children.head, l = i;
          for (; l.prev != null; )
            l = l.prev, o = o.next;
          const a = o.offset(this.quill.scroll) + Math.min(n.offset, o.length() - 1);
          this.quill.setSelection(a, 0, Q.sources.USER);
        }
      } else {
        const o = i.table()[r];
        o != null && (t ? this.quill.setSelection(o.offset(this.quill.scroll) + o.length() - 1, 0, Q.sources.USER) : this.quill.setSelection(o.offset(this.quill.scroll), 0, Q.sources.USER));
      }
      return !1;
    }
  };
}
function WO(t) {
  if (typeof t == "string" || typeof t == "number")
    t = {
      key: t
    };
  else if (typeof t == "object")
    t = qs(t);
  else
    return null;
  return t.shortKey && (t[HO] = t.shortKey, delete t.shortKey), t;
}
function rh(t) {
  let {
    quill: e,
    range: n
  } = t;
  const r = e.getLines(n);
  let i = {};
  if (r.length > 1) {
    const s = r[0].formats(), o = r[r.length - 1].formats();
    i = mr.AttributeMap.diff(o, s) || {};
  }
  e.deleteText(n, Q.sources.USER), Object.keys(i).length > 0 && e.formatLine(n.index, 1, i, Q.sources.USER), e.setSelection(n.index, Q.sources.SILENT);
}
function JO(t, e, n, r) {
  return e.prev == null && e.next == null ? n.prev == null && n.next == null ? r === 0 ? -1 : 1 : n.prev == null ? -1 : 1 : e.prev == null ? -1 : e.next == null ? 1 : null;
}
const QO = /font-weight:\s*normal/, KO = ["P", "OL", "UL"], cg = (t) => t && KO.includes(t.tagName), YO = (t) => {
  Array.from(t.querySelectorAll("br")).filter((e) => cg(e.previousElementSibling) && cg(e.nextElementSibling)).forEach((e) => {
    e.parentNode?.removeChild(e);
  });
}, XO = (t) => {
  Array.from(t.querySelectorAll('b[style*="font-weight"]')).filter((e) => e.getAttribute("style")?.match(QO)).forEach((e) => {
    const n = t.createDocumentFragment();
    n.append(...e.childNodes), e.parentNode?.replaceChild(n, e);
  });
};
function ZO(t) {
  t.querySelector('[id^="docs-internal-guid-"]') && (XO(t), YO(t));
}
const eD = /\bmso-list:[^;]*ignore/i, tD = /\bmso-list:[^;]*\bl(\d+)/i, nD = /\bmso-list:[^;]*\blevel(\d+)/i, rD = (t, e) => {
  const n = t.getAttribute("style"), r = n?.match(tD);
  if (!r)
    return null;
  const i = Number(r[1]), s = n?.match(nD), o = s ? Number(s[1]) : 1, l = new RegExp(`@list l${i}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`, "i"), a = e.match(l), c = a && a[1] === "bullet" ? "bullet" : "ordered";
  return {
    id: i,
    indent: o,
    type: c,
    element: t
  };
}, iD = (t) => {
  const e = Array.from(t.querySelectorAll("[style*=mso-list]")), n = [], r = [];
  e.forEach((o) => {
    (o.getAttribute("style") || "").match(eD) ? n.push(o) : r.push(o);
  }), n.forEach((o) => o.parentNode?.removeChild(o));
  const i = t.documentElement.innerHTML, s = r.map((o) => rD(o, i)).filter((o) => o);
  for (; s.length; ) {
    const o = [];
    let l = s.shift();
    for (; l; )
      o.push(l), l = s.length && s[0]?.element === l.element.nextElementSibling && // Different id means the next item doesn't belong to this group.
      s[0].id === l.id ? s.shift() : null;
    const a = document.createElement("ul");
    o.forEach((d) => {
      const f = document.createElement("li");
      f.setAttribute("data-list", d.type), d.indent > 1 && f.setAttribute("class", `ql-indent-${d.indent - 1}`), f.innerHTML = d.element.innerHTML, a.appendChild(f);
    });
    const c = o[0]?.element, {
      parentNode: u
    } = c ?? {};
    c && u?.replaceChild(a, c), o.slice(1).forEach((d) => {
      let {
        element: f
      } = d;
      u?.removeChild(f);
    });
  }
};
function sD(t) {
  t.documentElement.getAttribute("xmlns:w") === "urn:schemas-microsoft-com:office:word" && iD(t);
}
const oD = [sD, ZO], lD = (t) => {
  t.documentElement && oD.forEach((e) => {
    e(t);
  });
}, aD = bi("quill:clipboard"), cD = [[Node.TEXT_NODE, SD], [Node.TEXT_NODE, dg], ["br", pD], [Node.ELEMENT_NODE, dg], [Node.ELEMENT_NODE, gD], [Node.ELEMENT_NODE, fD], [Node.ELEMENT_NODE, wD], ["li", yD], ["ol, ul", bD], ["pre", mD], ["tr", _D], ["b", jc("bold")], ["i", jc("italic")], ["strike", jc("strike")], ["style", vD]], uD = [UO, Ov].reduce((t, e) => (t[e.keyName] = e, t), {}), ug = [kv, eh, Zd, Lv, Rv, qv].reduce((t, e) => (t[e.keyName] = e, t), {});
class dD extends Kr {
  static DEFAULTS = {
    matchers: []
  };
  constructor(e, n) {
    super(e, n), this.quill.root.addEventListener("copy", (r) => this.onCaptureCopy(r, !1)), this.quill.root.addEventListener("cut", (r) => this.onCaptureCopy(r, !0)), this.quill.root.addEventListener("paste", this.onCapturePaste.bind(this)), this.matchers = [], cD.concat(this.options.matchers ?? []).forEach((r) => {
      let [i, s] = r;
      this.addMatcher(i, s);
    });
  }
  addMatcher(e, n) {
    this.matchers.push([e, n]);
  }
  convert(e) {
    let {
      html: n,
      text: r
    } = e, i = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : {};
    if (i[Dn.blotName])
      return new _e().insert(r || "", {
        [Dn.blotName]: i[Dn.blotName]
      });
    if (!n)
      return new _e().insert(r || "", i);
    const s = this.convertHTML(n);
    return cl(s, `
`) && (s.ops[s.ops.length - 1].attributes == null || i.table) ? s.compose(new _e().retain(s.length() - 1).delete(1)) : s;
  }
  normalizeHTML(e) {
    lD(e);
  }
  convertHTML(e) {
    const n = new DOMParser().parseFromString(e, "text/html");
    this.normalizeHTML(n);
    const r = n.body, i = /* @__PURE__ */ new WeakMap(), [s, o] = this.prepareMatching(r, i);
    return ih(this.quill.scroll, r, s, o, i);
  }
  dangerouslyPasteHTML(e, n) {
    let r = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : Q.sources.API;
    if (typeof e == "string") {
      const i = this.convert({
        html: e,
        text: ""
      });
      this.quill.setContents(i, n), this.quill.setSelection(0, Q.sources.SILENT);
    } else {
      const i = this.convert({
        html: n,
        text: ""
      });
      this.quill.updateContents(new _e().retain(e).concat(i), r), this.quill.setSelection(e + i.length(), Q.sources.SILENT);
    }
  }
  onCaptureCopy(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !1;
    if (e.defaultPrevented) return;
    e.preventDefault();
    const [r] = this.quill.selection.getRange();
    if (r == null) return;
    const {
      html: i,
      text: s
    } = this.onCopy(r, n);
    e.clipboardData?.setData("text/plain", s), e.clipboardData?.setData("text/html", i), n && rh({
      range: r,
      quill: this.quill
    });
  }
  /*
   * https://www.iana.org/assignments/media-types/text/uri-list
   */
  normalizeURIList(e) {
    return e.split(/\r?\n/).filter((n) => n[0] !== "#").join(`
`);
  }
  onCapturePaste(e) {
    if (e.defaultPrevented || !this.quill.isEnabled()) return;
    e.preventDefault();
    const n = this.quill.getSelection(!0);
    if (n == null) return;
    const r = e.clipboardData?.getData("text/html");
    let i = e.clipboardData?.getData("text/plain");
    if (!r && !i) {
      const o = e.clipboardData?.getData("text/uri-list");
      o && (i = this.normalizeURIList(o));
    }
    const s = Array.from(e.clipboardData?.files || []);
    if (!r && s.length > 0) {
      this.quill.uploader.upload(n, s);
      return;
    }
    if (r && s.length > 0) {
      const o = new DOMParser().parseFromString(r, "text/html");
      if (o.body.childElementCount === 1 && o.body.firstElementChild?.tagName === "IMG") {
        this.quill.uploader.upload(n, s);
        return;
      }
    }
    this.onPaste(n, {
      html: r,
      text: i
    });
  }
  onCopy(e) {
    const n = this.quill.getText(e);
    return {
      html: this.quill.getSemanticHTML(e),
      text: n
    };
  }
  onPaste(e, n) {
    let {
      text: r,
      html: i
    } = n;
    const s = this.quill.getFormat(e.index), o = this.convert({
      text: r,
      html: i
    }, s);
    aD.log("onPaste", o, {
      text: r,
      html: i
    });
    const l = new _e().retain(e.index).delete(e.length).concat(o);
    this.quill.updateContents(l, Q.sources.USER), this.quill.setSelection(l.length() - e.length, Q.sources.SILENT), this.quill.scrollSelectionIntoView();
  }
  prepareMatching(e, n) {
    const r = [], i = [];
    return this.matchers.forEach((s) => {
      const [o, l] = s;
      switch (o) {
        case Node.TEXT_NODE:
          i.push(l);
          break;
        case Node.ELEMENT_NODE:
          r.push(l);
          break;
        default:
          Array.from(e.querySelectorAll(o)).forEach((a) => {
            n.has(a) ? n.get(a)?.push(l) : n.set(a, [l]);
          });
          break;
      }
    }), [r, i];
  }
}
function ys(t, e, n, r) {
  return r.query(e) ? t.reduce((i, s) => {
    if (!s.insert) return i;
    if (s.attributes && s.attributes[e])
      return i.push(s);
    const o = n ? {
      [e]: n
    } : {};
    return i.insert(s.insert, {
      ...o,
      ...s.attributes
    });
  }, new _e()) : t;
}
function cl(t, e) {
  let n = "";
  for (let r = t.ops.length - 1; r >= 0 && n.length < e.length; --r) {
    const i = t.ops[r];
    if (typeof i.insert != "string") break;
    n = i.insert + n;
  }
  return n.slice(-1 * e.length) === e;
}
function Ni(t, e) {
  if (!(t instanceof Element)) return !1;
  const n = e.query(t);
  return n && n.prototype instanceof tr ? !1 : ["address", "article", "blockquote", "canvas", "dd", "div", "dl", "dt", "fieldset", "figcaption", "figure", "footer", "form", "h1", "h2", "h3", "h4", "h5", "h6", "header", "iframe", "li", "main", "nav", "ol", "output", "p", "pre", "section", "table", "td", "tr", "ul", "video"].includes(t.tagName.toLowerCase());
}
function hD(t, e) {
  return t.previousElementSibling && t.nextElementSibling && !Ni(t.previousElementSibling, e) && !Ni(t.nextElementSibling, e);
}
const Ll = /* @__PURE__ */ new WeakMap();
function Bv(t) {
  return t == null ? !1 : (Ll.has(t) || (t.tagName === "PRE" ? Ll.set(t, !0) : Ll.set(t, Bv(t.parentNode))), Ll.get(t));
}
function ih(t, e, n, r, i) {
  return e.nodeType === e.TEXT_NODE ? r.reduce((s, o) => o(e, s, t), new _e()) : e.nodeType === e.ELEMENT_NODE ? Array.from(e.childNodes || []).reduce((s, o) => {
    let l = ih(t, o, n, r, i);
    return o.nodeType === e.ELEMENT_NODE && (l = n.reduce((a, c) => c(o, a, t), l), l = (i.get(o) || []).reduce((a, c) => c(o, a, t), l)), s.concat(l);
  }, new _e()) : new _e();
}
function jc(t) {
  return (e, n, r) => ys(n, t, !0, r);
}
function fD(t, e, n) {
  const r = zr.keys(t), i = Or.keys(t), s = Vi.keys(t), o = {};
  return r.concat(i).concat(s).forEach((l) => {
    let a = n.query(l, Se.ATTRIBUTE);
    a != null && (o[a.attrName] = a.value(t), o[a.attrName]) || (a = uD[l], a != null && (a.attrName === l || a.keyName === l) && (o[a.attrName] = a.value(t) || void 0), a = ug[l], a != null && (a.attrName === l || a.keyName === l) && (a = ug[l], o[a.attrName] = a.value(t) || void 0));
  }), Object.entries(o).reduce((l, a) => {
    let [c, u] = a;
    return ys(l, c, u, n);
  }, e);
}
function gD(t, e, n) {
  const r = n.query(t);
  if (r == null) return e;
  if (r.prototype instanceof tr) {
    const i = {}, s = r.value(t);
    if (s != null)
      return i[r.blotName] = s, new _e().insert(i, r.formats(t, n));
  } else if (r.prototype instanceof Ho && !cl(e, `
`) && e.insert(`
`), "blotName" in r && "formats" in r && typeof r.formats == "function")
    return ys(e, r.blotName, r.formats(t, n), n);
  return e;
}
function pD(t, e) {
  return cl(e, `
`) || e.insert(`
`), e;
}
function mD(t, e, n) {
  const r = n.query("code-block"), i = r && "formats" in r && typeof r.formats == "function" ? r.formats(t, n) : !0;
  return ys(e, "code-block", i, n);
}
function vD() {
  return new _e();
}
function yD(t, e, n) {
  const r = n.query(t);
  if (r == null || // @ts-expect-error
  r.blotName !== "list" || !cl(e, `
`))
    return e;
  let i = -1, s = t.parentNode;
  for (; s != null; )
    ["OL", "UL"].includes(s.tagName) && (i += 1), s = s.parentNode;
  return i <= 0 ? e : e.reduce((o, l) => l.insert ? l.attributes && typeof l.attributes.indent == "number" ? o.push(l) : o.insert(l.insert, {
    indent: i,
    ...l.attributes || {}
  }) : o, new _e());
}
function bD(t, e, n) {
  const r = t;
  let i = r.tagName === "OL" ? "ordered" : "bullet";
  const s = r.getAttribute("data-checked");
  return s && (i = s === "true" ? "checked" : "unchecked"), ys(e, "list", i, n);
}
function dg(t, e, n) {
  if (!cl(e, `
`)) {
    if (Ni(t, n) && (t.childNodes.length > 0 || t instanceof HTMLParagraphElement))
      return e.insert(`
`);
    if (e.length() > 0 && t.nextSibling) {
      let r = t.nextSibling;
      for (; r != null; ) {
        if (Ni(r, n))
          return e.insert(`
`);
        const i = n.query(r);
        if (i && i.prototype instanceof gr)
          return e.insert(`
`);
        r = r.firstChild;
      }
    }
  }
  return e;
}
function wD(t, e, n) {
  const r = {}, i = t.style || {};
  return i.fontStyle === "italic" && (r.italic = !0), i.textDecoration === "underline" && (r.underline = !0), i.textDecoration === "line-through" && (r.strike = !0), (i.fontWeight?.startsWith("bold") || // @ts-expect-error Fix me later
  parseInt(i.fontWeight, 10) >= 700) && (r.bold = !0), e = Object.entries(r).reduce((s, o) => {
    let [l, a] = o;
    return ys(s, l, a, n);
  }, e), parseFloat(i.textIndent || 0) > 0 ? new _e().insert("	").concat(e) : e;
}
function _D(t, e, n) {
  const r = t.parentElement?.tagName === "TABLE" ? t.parentElement : t.parentElement?.parentElement;
  if (r != null) {
    const s = Array.from(r.querySelectorAll("tr")).indexOf(t) + 1;
    return ys(e, "table", s, n);
  }
  return e;
}
function SD(t, e, n) {
  let r = t.data;
  if (t.parentElement?.tagName === "O:P")
    return e.insert(r.trim());
  if (!Bv(t)) {
    if (r.trim().length === 0 && r.includes(`
`) && !hD(t, n))
      return e;
    const i = (s, o) => {
      const l = o.replace(/[^\u00a0]/g, "");
      return l.length < 1 && s ? " " : l;
    };
    r = r.replace(/\r\n/g, " ").replace(/\n/g, " "), r = r.replace(/\s\s+/g, i.bind(i, !0)), (t.previousSibling == null && t.parentElement != null && Ni(t.parentElement, n) || t.previousSibling instanceof Element && Ni(t.previousSibling, n)) && (r = r.replace(/^\s+/, i.bind(i, !1))), (t.nextSibling == null && t.parentElement != null && Ni(t.parentElement, n) || t.nextSibling instanceof Element && Ni(t.nextSibling, n)) && (r = r.replace(/\s+$/, i.bind(i, !1)));
  }
  return e.insert(r);
}
class xD extends Kr {
  static DEFAULTS = {
    delay: 1e3,
    maxStack: 100,
    userOnly: !1
  };
  lastRecorded = 0;
  ignoreChange = !1;
  stack = {
    undo: [],
    redo: []
  };
  currentRange = null;
  constructor(e, n) {
    super(e, n), this.quill.on(Q.events.EDITOR_CHANGE, (r, i, s, o) => {
      r === Q.events.SELECTION_CHANGE ? i && o !== Q.sources.SILENT && (this.currentRange = i) : r === Q.events.TEXT_CHANGE && (this.ignoreChange || (!this.options.userOnly || o === Q.sources.USER ? this.record(i, s) : this.transform(i)), this.currentRange = qu(this.currentRange, i));
    }), this.quill.keyboard.addBinding({
      key: "z",
      shortKey: !0
    }, this.undo.bind(this)), this.quill.keyboard.addBinding({
      key: ["z", "Z"],
      shortKey: !0,
      shiftKey: !0
    }, this.redo.bind(this)), /Win/i.test(navigator.platform) && this.quill.keyboard.addBinding({
      key: "y",
      shortKey: !0
    }, this.redo.bind(this)), this.quill.root.addEventListener("beforeinput", (r) => {
      r.inputType === "historyUndo" ? (this.undo(), r.preventDefault()) : r.inputType === "historyRedo" && (this.redo(), r.preventDefault());
    });
  }
  change(e, n) {
    if (this.stack[e].length === 0) return;
    const r = this.stack[e].pop();
    if (!r) return;
    const i = this.quill.getContents(), s = r.delta.invert(i);
    this.stack[n].push({
      delta: s,
      range: qu(r.range, s)
    }), this.lastRecorded = 0, this.ignoreChange = !0, this.quill.updateContents(r.delta, Q.sources.USER), this.ignoreChange = !1, this.restoreSelection(r);
  }
  clear() {
    this.stack = {
      undo: [],
      redo: []
    };
  }
  cutoff() {
    this.lastRecorded = 0;
  }
  record(e, n) {
    if (e.ops.length === 0) return;
    this.stack.redo = [];
    let r = e.invert(n), i = this.currentRange;
    const s = Date.now();
    if (
      // @ts-expect-error Fix me later
      this.lastRecorded + this.options.delay > s && this.stack.undo.length > 0
    ) {
      const o = this.stack.undo.pop();
      o && (r = r.compose(o.delta), i = o.range);
    } else
      this.lastRecorded = s;
    r.length() !== 0 && (this.stack.undo.push({
      delta: r,
      range: i
    }), this.stack.undo.length > this.options.maxStack && this.stack.undo.shift());
  }
  redo() {
    this.change("redo", "undo");
  }
  transform(e) {
    hg(this.stack.undo, e), hg(this.stack.redo, e);
  }
  undo() {
    this.change("undo", "redo");
  }
  restoreSelection(e) {
    if (e.range)
      this.quill.setSelection(e.range, Q.sources.USER);
    else {
      const n = $D(this.quill.scroll, e.delta);
      this.quill.setSelection(n, Q.sources.USER);
    }
  }
}
function hg(t, e) {
  let n = e;
  for (let r = t.length - 1; r >= 0; r -= 1) {
    const i = t[r];
    t[r] = {
      delta: n.transform(i.delta, !0),
      range: i.range && qu(i.range, n)
    }, n = i.delta.transform(n), t[r].delta.length() === 0 && t.splice(r, 1);
  }
}
function CD(t, e) {
  const n = e.ops[e.ops.length - 1];
  return n == null ? !1 : n.insert != null ? typeof n.insert == "string" && n.insert.endsWith(`
`) : n.attributes != null ? Object.keys(n.attributes).some((r) => t.query(r, Se.BLOCK) != null) : !1;
}
function $D(t, e) {
  const n = e.reduce((i, s) => i + (s.delete || 0), 0);
  let r = e.length() - n;
  return CD(t, e) && (r -= 1), r;
}
function qu(t, e) {
  if (!t) return t;
  const n = e.transformPosition(t.index), r = e.transformPosition(t.index + t.length);
  return {
    index: n,
    length: r - n
  };
}
class Uv extends Kr {
  constructor(e, n) {
    super(e, n), e.root.addEventListener("drop", (r) => {
      r.preventDefault();
      let i = null;
      if (document.caretRangeFromPoint)
        i = document.caretRangeFromPoint(r.clientX, r.clientY);
      else if (document.caretPositionFromPoint) {
        const o = document.caretPositionFromPoint(r.clientX, r.clientY);
        i = document.createRange(), i.setStart(o.offsetNode, o.offset), i.setEnd(o.offsetNode, o.offset);
      }
      const s = i && e.selection.normalizeNative(i);
      if (s) {
        const o = e.selection.normalizedToRange(s);
        r.dataTransfer?.files && this.upload(o, r.dataTransfer.files);
      }
    });
  }
  upload(e, n) {
    const r = [];
    Array.from(n).forEach((i) => {
      i && this.options.mimetypes?.includes(i.type) && r.push(i);
    }), r.length > 0 && this.options.handler.call(this, e, r);
  }
}
Uv.DEFAULTS = {
  mimetypes: ["image/png", "image/jpeg"],
  handler(t, e) {
    if (!this.quill.scroll.query("image"))
      return;
    const n = e.map((r) => new Promise((i) => {
      const s = new FileReader();
      s.onload = () => {
        i(s.result);
      }, s.readAsDataURL(r);
    }));
    Promise.all(n).then((r) => {
      const i = r.reduce((s, o) => s.insert({
        image: o
      }), new _e().retain(t.index).delete(t.length));
      this.quill.updateContents(i, we.sources.USER), this.quill.setSelection(t.index + r.length, we.sources.SILENT);
    });
  }
};
const ED = ["insertText", "insertReplacementText"];
class TD extends Kr {
  constructor(e, n) {
    super(e, n), e.root.addEventListener("beforeinput", (r) => {
      this.handleBeforeInput(r);
    }), /Android/i.test(navigator.userAgent) || e.on(Q.events.COMPOSITION_BEFORE_START, () => {
      this.handleCompositionStart();
    });
  }
  deleteRange(e) {
    rh({
      range: e,
      quill: this.quill
    });
  }
  replaceText(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "";
    if (e.length === 0) return !1;
    if (n) {
      const r = this.quill.getFormat(e.index, 1);
      this.deleteRange(e), this.quill.updateContents(new _e().retain(e.index).insert(n, r), Q.sources.USER);
    } else
      this.deleteRange(e);
    return this.quill.setSelection(e.index + n.length, 0, Q.sources.SILENT), !0;
  }
  handleBeforeInput(e) {
    if (this.quill.composition.isComposing || e.defaultPrevented || !ED.includes(e.inputType))
      return;
    const n = e.getTargetRanges ? e.getTargetRanges()[0] : null;
    if (!n || n.collapsed === !0)
      return;
    const r = AD(e);
    if (r == null)
      return;
    const i = this.quill.selection.normalizeNative(n), s = i ? this.quill.selection.normalizedToRange(i) : null;
    s && this.replaceText(s, r) && e.preventDefault();
  }
  handleCompositionStart() {
    const e = this.quill.getSelection();
    e && this.replaceText(e);
  }
}
function AD(t) {
  return typeof t.data == "string" ? t.data : t.dataTransfer?.types.includes("text/plain") ? t.dataTransfer.getData("text/plain") : null;
}
const kD = /Mac/i.test(navigator.platform), ID = 100, OD = (t) => !!(t.key === "ArrowLeft" || t.key === "ArrowRight" || // RTL scripts or moving from the end of the previous line
t.key === "ArrowUp" || t.key === "ArrowDown" || t.key === "Home" || kD && t.key === "a" && t.ctrlKey === !0);
class DD extends Kr {
  isListening = !1;
  selectionChangeDeadline = 0;
  constructor(e, n) {
    super(e, n), this.handleArrowKeys(), this.handleNavigationShortcuts();
  }
  handleArrowKeys() {
    this.quill.keyboard.addBinding({
      key: ["ArrowLeft", "ArrowRight"],
      offset: 0,
      shiftKey: null,
      handler(e, n) {
        let {
          line: r,
          event: i
        } = n;
        if (!(r instanceof Er) || !r.uiNode)
          return !0;
        const s = getComputedStyle(r.domNode).direction === "rtl";
        return s && i.key !== "ArrowRight" || !s && i.key !== "ArrowLeft" ? !0 : (this.quill.setSelection(e.index - 1, e.length + (i.shiftKey ? 1 : 0), Q.sources.USER), !1);
      }
    });
  }
  handleNavigationShortcuts() {
    this.quill.root.addEventListener("keydown", (e) => {
      !e.defaultPrevented && OD(e) && this.ensureListeningToSelectionChange();
    });
  }
  /**
   * We only listen to the `selectionchange` event when
   * there is an intention of moving the caret to the beginning using shortcuts.
   * This is primarily implemented to prevent infinite loops, as we are changing
   * the selection within the handler of a `selectionchange` event.
   */
  ensureListeningToSelectionChange() {
    if (this.selectionChangeDeadline = Date.now() + ID, this.isListening) return;
    this.isListening = !0;
    const e = () => {
      this.isListening = !1, Date.now() <= this.selectionChangeDeadline && this.handleSelectionChange();
    };
    document.addEventListener("selectionchange", e, {
      once: !0
    });
  }
  handleSelectionChange() {
    const e = document.getSelection();
    if (!e) return;
    const n = e.getRangeAt(0);
    if (n.collapsed !== !0 || n.startOffset !== 0) return;
    const r = this.quill.scroll.find(n.startContainer);
    if (!(r instanceof Er) || !r.uiNode) return;
    const i = document.createRange();
    i.setStartAfter(r.uiNode), i.setEndAfter(r.uiNode), e.removeAllRanges(), e.addRange(i);
  }
}
Q.register({
  "blots/block": gn,
  "blots/block/embed": gr,
  "blots/break": Dr,
  "blots/container": ms,
  "blots/cursor": wr,
  "blots/embed": Yd,
  "blots/inline": In,
  "blots/scroll": BO,
  "blots/text": kr,
  "modules/clipboard": dD,
  "modules/history": xD,
  "modules/keyboard": oc,
  "modules/uploader": Uv,
  "modules/input": TD,
  "modules/uiNode": DD
});
class LD extends Or {
  add(e, n) {
    let r = 0;
    if (n === "+1" || n === "-1") {
      const i = this.value(e) || 0;
      r = n === "+1" ? i + 1 : i - 1;
    } else typeof n == "number" && (r = n);
    return r === 0 ? (this.remove(e), !0) : super.add(e, r.toString());
  }
  canAdd(e, n) {
    return super.canAdd(e, n) || super.canAdd(e, parseInt(n, 10));
  }
  value(e) {
    return parseInt(super.value(e), 10) || void 0;
  }
}
const ND = new LD("indent", "ql-indent", {
  scope: Se.BLOCK,
  // @ts-expect-error
  whitelist: [1, 2, 3, 4, 5, 6, 7, 8]
});
class PD extends gn {
  static blotName = "blockquote";
  static tagName = "blockquote";
}
let RD = class extends gn {
  static blotName = "header";
  static tagName = ["H1", "H2", "H3", "H4", "H5", "H6"];
  static formats(e) {
    return this.tagName.indexOf(e.tagName) + 1;
  }
};
class ul extends ms {
}
ul.blotName = "list-container";
ul.tagName = "OL";
class dl extends gn {
  static create(e) {
    const n = super.create();
    return n.setAttribute("data-list", e), n;
  }
  static formats(e) {
    return e.getAttribute("data-list") || void 0;
  }
  static register() {
    Q.register(ul);
  }
  constructor(e, n) {
    super(e, n);
    const r = n.ownerDocument.createElement("span"), i = (s) => {
      if (!e.isEnabled()) return;
      const o = this.statics.formats(n, e);
      o === "checked" ? (this.format("list", "unchecked"), s.preventDefault()) : o === "unchecked" && (this.format("list", "checked"), s.preventDefault());
    };
    r.addEventListener("mousedown", i), r.addEventListener("touchstart", i), this.attachUI(r);
  }
  format(e, n) {
    e === this.statics.blotName && n ? this.domNode.setAttribute("data-list", n) : super.format(e, n);
  }
}
dl.blotName = "list";
dl.tagName = "LI";
ul.allowedChildren = [dl];
dl.requiredContainer = ul;
class sh extends In {
  static blotName = "bold";
  static tagName = ["STRONG", "B"];
  static create() {
    return super.create();
  }
  static formats() {
    return !0;
  }
  optimize(e) {
    super.optimize(e), this.domNode.tagName !== this.statics.tagName[0] && this.replaceWith(this.statics.blotName);
  }
}
class MD extends sh {
  static blotName = "italic";
  static tagName = ["EM", "I"];
}
class Aa extends In {
  static blotName = "link";
  static tagName = "A";
  static SANITIZED_URL = "about:blank";
  static PROTOCOL_WHITELIST = ["http", "https", "mailto", "tel", "sms"];
  static create(e) {
    const n = super.create(e);
    return n.setAttribute("href", this.sanitize(e)), n.setAttribute("rel", "noopener noreferrer"), n.setAttribute("target", "_blank"), n;
  }
  static formats(e) {
    return e.getAttribute("href");
  }
  static sanitize(e) {
    return jv(e, this.PROTOCOL_WHITELIST) ? e : this.SANITIZED_URL;
  }
  format(e, n) {
    e !== this.statics.blotName || !n ? super.format(e, n) : this.domNode.setAttribute("href", this.constructor.sanitize(n));
  }
}
function jv(t, e) {
  const n = document.createElement("a");
  n.href = t;
  const r = n.href.slice(0, n.href.indexOf(":"));
  return e.indexOf(r) > -1;
}
class qD extends In {
  static blotName = "script";
  static tagName = ["SUB", "SUP"];
  static create(e) {
    return e === "super" ? document.createElement("sup") : e === "sub" ? document.createElement("sub") : super.create(e);
  }
  static formats(e) {
    if (e.tagName === "SUB") return "sub";
    if (e.tagName === "SUP") return "super";
  }
}
class BD extends sh {
  static blotName = "strike";
  static tagName = ["S", "STRIKE"];
}
class UD extends In {
  static blotName = "underline";
  static tagName = "U";
}
class jD extends Yd {
  static blotName = "formula";
  static className = "ql-formula";
  static tagName = "SPAN";
  static create(e) {
    if (window.katex == null)
      throw new Error("Formula module requires KaTeX.");
    const n = super.create(e);
    return typeof e == "string" && (window.katex.render(e, n, {
      throwOnError: !1,
      errorColor: "#f00"
    }), n.setAttribute("data-value", e)), n;
  }
  static value(e) {
    return e.getAttribute("data-value");
  }
  html() {
    const {
      formula: e
    } = this.value();
    return `<span>${e}</span>`;
  }
}
const fg = ["alt", "height", "width"];
let GD = class extends tr {
  static blotName = "image";
  static tagName = "IMG";
  static create(e) {
    const n = super.create(e);
    return typeof e == "string" && n.setAttribute("src", this.sanitize(e)), n;
  }
  static formats(e) {
    return fg.reduce((n, r) => (e.hasAttribute(r) && (n[r] = e.getAttribute(r)), n), {});
  }
  static match(e) {
    return /\.(jpe?g|gif|png)$/.test(e) || /^data:image\/.+;base64/.test(e);
  }
  static sanitize(e) {
    return jv(e, ["http", "https", "data"]) ? e : "//:0";
  }
  static value(e) {
    return e.getAttribute("src");
  }
  format(e, n) {
    fg.indexOf(e) > -1 ? n ? this.domNode.setAttribute(e, n) : this.domNode.removeAttribute(e) : super.format(e, n);
  }
};
const gg = ["height", "width"];
class FD extends gr {
  static blotName = "video";
  static className = "ql-video";
  static tagName = "IFRAME";
  static create(e) {
    const n = super.create(e);
    return n.setAttribute("frameborder", "0"), n.setAttribute("allowfullscreen", "true"), n.setAttribute("src", this.sanitize(e)), n;
  }
  static formats(e) {
    return gg.reduce((n, r) => (e.hasAttribute(r) && (n[r] = e.getAttribute(r)), n), {});
  }
  static sanitize(e) {
    return Aa.sanitize(e);
  }
  static value(e) {
    return e.getAttribute("src");
  }
  format(e, n) {
    gg.indexOf(e) > -1 ? n ? this.domNode.setAttribute(e, n) : this.domNode.removeAttribute(e) : super.format(e, n);
  }
  html() {
    const {
      video: e
    } = this.value();
    return `<a href="${e}">${e}</a>`;
  }
}
const _o = new Or("code-token", "hljs", {
  scope: Se.INLINE
});
class pi extends In {
  static formats(e, n) {
    for (; e != null && e !== n.domNode; ) {
      if (e.classList && e.classList.contains(Dn.className))
        return super.formats(e, n);
      e = e.parentNode;
    }
  }
  constructor(e, n, r) {
    super(e, n, r), _o.add(this.domNode, r);
  }
  format(e, n) {
    e !== pi.blotName ? super.format(e, n) : n ? _o.add(this.domNode, n) : (_o.remove(this.domNode), this.domNode.classList.remove(this.statics.className));
  }
  optimize() {
    super.optimize(...arguments), _o.value(this.domNode) || this.unwrap();
  }
}
pi.blotName = "code-token";
pi.className = "ql-token";
class dr extends Dn {
  static create(e) {
    const n = super.create(e);
    return typeof e == "string" && n.setAttribute("data-language", e), n;
  }
  static formats(e) {
    return e.getAttribute("data-language") || "plain";
  }
  static register() {
  }
  // Syntax module will register
  format(e, n) {
    e === this.statics.blotName && n ? this.domNode.setAttribute("data-language", n) : super.format(e, n);
  }
  replaceWith(e, n) {
    return this.formatAt(0, this.length(), pi.blotName, !1), super.replaceWith(e, n);
  }
}
class Eo extends vs {
  attach() {
    super.attach(), this.forceNext = !1, this.scroll.emitMount(this);
  }
  format(e, n) {
    e === dr.blotName && (this.forceNext = !0, this.children.forEach((r) => {
      r.format(e, n);
    }));
  }
  formatAt(e, n, r, i) {
    r === dr.blotName && (this.forceNext = !0), super.formatAt(e, n, r, i);
  }
  highlight(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !1;
    if (this.children.head == null) return;
    const i = `${Array.from(this.domNode.childNodes).filter((o) => o !== this.uiNode).map((o) => o.textContent).join(`
`)}
`, s = dr.formats(this.children.head.domNode);
    if (n || this.forceNext || this.cachedText !== i) {
      if (i.trim().length > 0 || this.cachedText == null) {
        const o = this.children.reduce((a, c) => a.concat($v(c, !1)), new _e()), l = e(i, s);
        o.diff(l).reduce((a, c) => {
          let {
            retain: u,
            attributes: d
          } = c;
          return u ? (d && Object.keys(d).forEach((f) => {
            [dr.blotName, pi.blotName].includes(f) && this.formatAt(a, u, f, d[f]);
          }), a + u) : a;
        }, 0);
      }
      this.cachedText = i, this.forceNext = !1;
    }
  }
  html(e, n) {
    const [r] = this.children.find(e);
    return `<pre data-language="${r ? dr.formats(r.domNode) : "plain"}">
${sc(this.code(e, n))}
</pre>`;
  }
  optimize(e) {
    if (super.optimize(e), this.parent != null && this.children.head != null && this.uiNode != null) {
      const n = dr.formats(this.children.head.domNode);
      n !== this.uiNode.value && (this.uiNode.value = n);
    }
  }
}
Eo.allowedChildren = [dr];
dr.requiredContainer = Eo;
dr.allowedChildren = [pi, wr, kr, Dr];
const VD = (t, e, n) => {
  if (typeof t.versionString == "string") {
    const r = t.versionString.split(".")[0];
    if (parseInt(r, 10) >= 11)
      return t.highlight(n, {
        language: e
      }).value;
  }
  return t.highlight(e, n).value;
};
class Gv extends Kr {
  static register() {
    Q.register(pi, !0), Q.register(dr, !0), Q.register(Eo, !0);
  }
  constructor(e, n) {
    if (super(e, n), this.options.hljs == null)
      throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");
    this.languages = this.options.languages.reduce((r, i) => {
      let {
        key: s
      } = i;
      return r[s] = !0, r;
    }, {}), this.highlightBlot = this.highlightBlot.bind(this), this.initListener(), this.initTimer();
  }
  initListener() {
    this.quill.on(Q.events.SCROLL_BLOT_MOUNT, (e) => {
      if (!(e instanceof Eo)) return;
      const n = this.quill.root.ownerDocument.createElement("select");
      this.options.languages.forEach((r) => {
        let {
          key: i,
          label: s
        } = r;
        const o = n.ownerDocument.createElement("option");
        o.textContent = s, o.setAttribute("value", i), n.appendChild(o);
      }), n.addEventListener("change", () => {
        e.format(dr.blotName, n.value), this.quill.root.focus(), this.highlight(e, !0);
      }), e.uiNode == null && (e.attachUI(n), e.children.head && (n.value = dr.formats(e.children.head.domNode)));
    });
  }
  initTimer() {
    let e = null;
    this.quill.on(Q.events.SCROLL_OPTIMIZE, () => {
      e && clearTimeout(e), e = setTimeout(() => {
        this.highlight(), e = null;
      }, this.options.interval);
    });
  }
  highlight() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : null, n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !1;
    if (this.quill.selection.composing) return;
    this.quill.update(Q.sources.USER);
    const r = this.quill.getSelection();
    (e == null ? this.quill.scroll.descendants(Eo) : [e]).forEach((s) => {
      s.highlight(this.highlightBlot, n);
    }), this.quill.update(Q.sources.SILENT), r != null && this.quill.setSelection(r, Q.sources.SILENT);
  }
  highlightBlot(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : "plain";
    if (n = this.languages[n] ? n : "plain", n === "plain")
      return sc(e).split(`
`).reduce((i, s, o) => (o !== 0 && i.insert(`
`, {
        [Dn.blotName]: n
      }), i.insert(s)), new _e());
    const r = this.quill.root.ownerDocument.createElement("div");
    return r.classList.add(Dn.className), r.innerHTML = VD(this.options.hljs, n, e), ih(this.quill.scroll, r, [(i, s) => {
      const o = _o.value(i);
      return o ? s.compose(new _e().retain(s.length(), {
        [pi.blotName]: o
      })) : s;
    }], [(i, s) => i.data.split(`
`).reduce((o, l, a) => (a !== 0 && o.insert(`
`, {
      [Dn.blotName]: n
    }), o.insert(l)), s)], /* @__PURE__ */ new WeakMap());
  }
}
Gv.DEFAULTS = {
  hljs: window.hljs,
  interval: 1e3,
  languages: [{
    key: "plain",
    label: "Plain"
  }, {
    key: "bash",
    label: "Bash"
  }, {
    key: "cpp",
    label: "C++"
  }, {
    key: "cs",
    label: "C#"
  }, {
    key: "css",
    label: "CSS"
  }, {
    key: "diff",
    label: "Diff"
  }, {
    key: "xml",
    label: "HTML/XML"
  }, {
    key: "java",
    label: "Java"
  }, {
    key: "javascript",
    label: "JavaScript"
  }, {
    key: "markdown",
    label: "Markdown"
  }, {
    key: "php",
    label: "PHP"
  }, {
    key: "python",
    label: "Python"
  }, {
    key: "ruby",
    label: "Ruby"
  }, {
    key: "sql",
    label: "SQL"
  }]
};
class Sr extends gn {
  static blotName = "table";
  static tagName = "TD";
  static create(e) {
    const n = super.create();
    return e ? n.setAttribute("data-row", e) : n.setAttribute("data-row", oh()), n;
  }
  static formats(e) {
    if (e.hasAttribute("data-row"))
      return e.getAttribute("data-row");
  }
  cellOffset() {
    return this.parent ? this.parent.children.indexOf(this) : -1;
  }
  format(e, n) {
    e === Sr.blotName && n ? this.domNode.setAttribute("data-row", n) : super.format(e, n);
  }
  row() {
    return this.parent;
  }
  rowOffset() {
    return this.row() ? this.row().rowOffset() : -1;
  }
  table() {
    return this.row() && this.row().table();
  }
}
class cs extends ms {
  static blotName = "table-row";
  static tagName = "TR";
  checkMerge() {
    if (super.checkMerge() && this.next.children.head != null) {
      const e = this.children.head.formats(), n = this.children.tail.formats(), r = this.next.children.head.formats(), i = this.next.children.tail.formats();
      return e.table === n.table && e.table === r.table && e.table === i.table;
    }
    return !1;
  }
  optimize(e) {
    super.optimize(e), this.children.forEach((n) => {
      if (n.next == null) return;
      const r = n.formats(), i = n.next.formats();
      if (r.table !== i.table) {
        const s = this.splitAfter(n);
        s && s.optimize(), this.prev && this.prev.optimize();
      }
    });
  }
  rowOffset() {
    return this.parent ? this.parent.children.indexOf(this) : -1;
  }
  table() {
    return this.parent && this.parent.parent;
  }
}
class Mi extends ms {
  static blotName = "table-body";
  static tagName = "TBODY";
}
class ka extends ms {
  static blotName = "table-container";
  static tagName = "TABLE";
  balanceCells() {
    const e = this.descendants(cs), n = e.reduce((r, i) => Math.max(i.children.length, r), 0);
    e.forEach((r) => {
      new Array(n - r.children.length).fill(0).forEach(() => {
        let i;
        r.children.head != null && (i = Sr.formats(r.children.head.domNode));
        const s = this.scroll.create(Sr.blotName, i);
        r.appendChild(s), s.optimize();
      });
    });
  }
  cells(e) {
    return this.rows().map((n) => n.children.at(e));
  }
  deleteColumn(e) {
    const [n] = this.descendant(Mi);
    n == null || n.children.head == null || n.children.forEach((r) => {
      const i = r.children.at(e);
      i?.remove();
    });
  }
  insertColumn(e) {
    const [n] = this.descendant(Mi);
    n == null || n.children.head == null || n.children.forEach((r) => {
      const i = r.children.at(e), s = Sr.formats(r.children.head.domNode), o = this.scroll.create(Sr.blotName, s);
      r.insertBefore(o, i);
    });
  }
  insertRow(e) {
    const [n] = this.descendant(Mi);
    if (n == null || n.children.head == null) return;
    const r = oh(), i = this.scroll.create(cs.blotName);
    n.children.head.children.forEach(() => {
      const o = this.scroll.create(Sr.blotName, r);
      i.appendChild(o);
    });
    const s = n.children.at(e);
    n.insertBefore(i, s);
  }
  rows() {
    const e = this.children.head;
    return e == null ? [] : e.children.map((n) => n);
  }
}
ka.allowedChildren = [Mi];
Mi.requiredContainer = ka;
Mi.allowedChildren = [cs];
cs.requiredContainer = Mi;
cs.allowedChildren = [Sr];
Sr.requiredContainer = cs;
function oh() {
  return `row-${Math.random().toString(36).slice(2, 6)}`;
}
class HD extends Kr {
  static register() {
    Q.register(Sr), Q.register(cs), Q.register(Mi), Q.register(ka);
  }
  constructor() {
    super(...arguments), this.listenBalanceCells();
  }
  balanceTables() {
    this.quill.scroll.descendants(ka).forEach((e) => {
      e.balanceCells();
    });
  }
  deleteColumn() {
    const [e, , n] = this.getTable();
    n != null && (e.deleteColumn(n.cellOffset()), this.quill.update(Q.sources.USER));
  }
  deleteRow() {
    const [, e] = this.getTable();
    e != null && (e.remove(), this.quill.update(Q.sources.USER));
  }
  deleteTable() {
    const [e] = this.getTable();
    if (e == null) return;
    const n = e.offset();
    e.remove(), this.quill.update(Q.sources.USER), this.quill.setSelection(n, Q.sources.SILENT);
  }
  getTable() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : this.quill.getSelection();
    if (e == null) return [null, null, null, -1];
    const [n, r] = this.quill.getLine(e.index);
    if (n == null || n.statics.blotName !== Sr.blotName)
      return [null, null, null, -1];
    const i = n.parent;
    return [i.parent.parent, i, n, r];
  }
  insertColumn(e) {
    const n = this.quill.getSelection();
    if (!n) return;
    const [r, i, s] = this.getTable(n);
    if (s == null) return;
    const o = s.cellOffset();
    r.insertColumn(o + e), this.quill.update(Q.sources.USER);
    let l = i.rowOffset();
    e === 0 && (l += 1), this.quill.setSelection(n.index + l, n.length, Q.sources.SILENT);
  }
  insertColumnLeft() {
    this.insertColumn(0);
  }
  insertColumnRight() {
    this.insertColumn(1);
  }
  insertRow(e) {
    const n = this.quill.getSelection();
    if (!n) return;
    const [r, i, s] = this.getTable(n);
    if (s == null) return;
    const o = i.rowOffset();
    r.insertRow(o + e), this.quill.update(Q.sources.USER), e > 0 ? this.quill.setSelection(n, Q.sources.SILENT) : this.quill.setSelection(n.index + i.children.length, n.length, Q.sources.SILENT);
  }
  insertRowAbove() {
    this.insertRow(0);
  }
  insertRowBelow() {
    this.insertRow(1);
  }
  insertTable(e, n) {
    const r = this.quill.getSelection();
    if (r == null) return;
    const i = new Array(e).fill(0).reduce((s) => {
      const o = new Array(n).fill(`
`).join("");
      return s.insert(o, {
        table: oh()
      });
    }, new _e().retain(r.index));
    this.quill.updateContents(i, Q.sources.USER), this.quill.setSelection(r.index, Q.sources.SILENT), this.balanceTables();
  }
  listenBalanceCells() {
    this.quill.on(Q.events.SCROLL_OPTIMIZE, (e) => {
      e.some((n) => ["TD", "TR", "TBODY", "TABLE"].includes(n.target.tagName) ? (this.quill.once(Q.events.TEXT_CHANGE, (r, i, s) => {
        s === Q.sources.USER && this.balanceTables();
      }), !0) : !1);
    });
  }
}
const pg = bi("quill:toolbar");
class lh extends Kr {
  constructor(e, n) {
    if (super(e, n), Array.isArray(this.options.container)) {
      const r = document.createElement("div");
      r.setAttribute("role", "toolbar"), zD(r, this.options.container), e.container?.parentNode?.insertBefore(r, e.container), this.container = r;
    } else typeof this.options.container == "string" ? this.container = document.querySelector(this.options.container) : this.container = this.options.container;
    if (!(this.container instanceof HTMLElement)) {
      pg.error("Container required for toolbar", this.options);
      return;
    }
    this.container.classList.add("ql-toolbar"), this.controls = [], this.handlers = {}, this.options.handlers && Object.keys(this.options.handlers).forEach((r) => {
      const i = this.options.handlers?.[r];
      i && this.addHandler(r, i);
    }), Array.from(this.container.querySelectorAll("button, select")).forEach((r) => {
      this.attach(r);
    }), this.quill.on(Q.events.EDITOR_CHANGE, () => {
      const [r] = this.quill.selection.getRange();
      this.update(r);
    });
  }
  addHandler(e, n) {
    this.handlers[e] = n;
  }
  attach(e) {
    let n = Array.from(e.classList).find((i) => i.indexOf("ql-") === 0);
    if (!n) return;
    if (n = n.slice(3), e.tagName === "BUTTON" && e.setAttribute("type", "button"), this.handlers[n] == null && this.quill.scroll.query(n) == null) {
      pg.warn("ignoring attaching to nonexistent format", n, e);
      return;
    }
    const r = e.tagName === "SELECT" ? "change" : "click";
    e.addEventListener(r, (i) => {
      let s;
      if (e.tagName === "SELECT") {
        if (e.selectedIndex < 0) return;
        const l = e.options[e.selectedIndex];
        l.hasAttribute("selected") ? s = !1 : s = l.value || !1;
      } else
        e.classList.contains("ql-active") ? s = !1 : s = e.value || !e.hasAttribute("value"), i.preventDefault();
      this.quill.focus();
      const [o] = this.quill.selection.getRange();
      if (this.handlers[n] != null)
        this.handlers[n].call(this, s);
      else if (
        // @ts-expect-error
        this.quill.scroll.query(n).prototype instanceof tr
      ) {
        if (s = prompt(`Enter ${n}`), !s) return;
        this.quill.updateContents(new _e().retain(o.index).delete(o.length).insert({
          [n]: s
        }), Q.sources.USER);
      } else
        this.quill.format(n, s, Q.sources.USER);
      this.update(o);
    }), this.controls.push([n, e]);
  }
  update(e) {
    const n = e == null ? {} : this.quill.getFormat(e);
    this.controls.forEach((r) => {
      const [i, s] = r;
      if (s.tagName === "SELECT") {
        let o = null;
        if (e == null)
          o = null;
        else if (n[i] == null)
          o = s.querySelector("option[selected]");
        else if (!Array.isArray(n[i])) {
          let l = n[i];
          typeof l == "string" && (l = l.replace(/"/g, '\\"')), o = s.querySelector(`option[value="${l}"]`);
        }
        o == null ? (s.value = "", s.selectedIndex = -1) : o.selected = !0;
      } else if (e == null)
        s.classList.remove("ql-active"), s.setAttribute("aria-pressed", "false");
      else if (s.hasAttribute("value")) {
        const o = n[i], l = o === s.getAttribute("value") || o != null && o.toString() === s.getAttribute("value") || o == null && !s.getAttribute("value");
        s.classList.toggle("ql-active", l), s.setAttribute("aria-pressed", l.toString());
      } else {
        const o = n[i] != null;
        s.classList.toggle("ql-active", o), s.setAttribute("aria-pressed", o.toString());
      }
    });
  }
}
lh.DEFAULTS = {};
function mg(t, e, n) {
  const r = document.createElement("button");
  r.setAttribute("type", "button"), r.classList.add(`ql-${e}`), r.setAttribute("aria-pressed", "false"), n != null ? (r.value = n, r.setAttribute("aria-label", `${e}: ${n}`)) : r.setAttribute("aria-label", e), t.appendChild(r);
}
function zD(t, e) {
  Array.isArray(e[0]) || (e = [e]), e.forEach((n) => {
    const r = document.createElement("span");
    r.classList.add("ql-formats"), n.forEach((i) => {
      if (typeof i == "string")
        mg(r, i);
      else {
        const s = Object.keys(i)[0], o = i[s];
        Array.isArray(o) ? WD(r, s, o) : mg(r, s, o);
      }
    }), t.appendChild(r);
  });
}
function WD(t, e, n) {
  const r = document.createElement("select");
  r.classList.add(`ql-${e}`), n.forEach((i) => {
    const s = document.createElement("option");
    i !== !1 ? s.setAttribute("value", String(i)) : s.setAttribute("selected", "selected"), r.appendChild(s);
  }), t.appendChild(r);
}
lh.DEFAULTS = {
  container: null,
  handlers: {
    clean() {
      const t = this.quill.getSelection();
      if (t != null)
        if (t.length === 0) {
          const e = this.quill.getFormat();
          Object.keys(e).forEach((n) => {
            this.quill.scroll.query(n, Se.INLINE) != null && this.quill.format(n, !1, Q.sources.USER);
          });
        } else
          this.quill.removeFormat(t.index, t.length, Q.sources.USER);
    },
    direction(t) {
      const {
        align: e
      } = this.quill.getFormat();
      t === "rtl" && e == null ? this.quill.format("align", "right", Q.sources.USER) : !t && e === "right" && this.quill.format("align", !1, Q.sources.USER), this.quill.format("direction", t, Q.sources.USER);
    },
    indent(t) {
      const e = this.quill.getSelection(), n = this.quill.getFormat(e), r = parseInt(n.indent || 0, 10);
      if (t === "+1" || t === "-1") {
        let i = t === "+1" ? 1 : -1;
        n.direction === "rtl" && (i *= -1), this.quill.format("indent", r + i, Q.sources.USER);
      }
    },
    link(t) {
      t === !0 && (t = prompt("Enter link URL:")), this.quill.format("link", t, Q.sources.USER);
    },
    list(t) {
      const e = this.quill.getSelection(), n = this.quill.getFormat(e);
      t === "check" ? n.list === "checked" || n.list === "unchecked" ? this.quill.format("list", !1, Q.sources.USER) : this.quill.format("list", "unchecked", Q.sources.USER) : this.quill.format("list", t, Q.sources.USER);
    }
  }
};
const JD = '<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>', QD = '<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>', KD = '<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>', YD = '<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>', XD = '<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>', ZD = '<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>', eL = '<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>', tL = '<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>', vg = '<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>', nL = '<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>', rL = '<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>', iL = '<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>', sL = '<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>', oL = '<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>', lL = '<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>', aL = '<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>', cL = '<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>', uL = '<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>', dL = '<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>', hL = '<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>', fL = '<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>', gL = '<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>', pL = '<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>', mL = '<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>', vL = '<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>', yL = '<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>', bL = '<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>', wL = '<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>', _L = '<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>', SL = '<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>', xL = '<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>', CL = '<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>', $L = '<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>', Jo = {
  align: {
    "": JD,
    center: QD,
    right: KD,
    justify: YD
  },
  background: XD,
  blockquote: ZD,
  bold: eL,
  clean: tL,
  code: vg,
  "code-block": vg,
  color: nL,
  direction: {
    "": rL,
    rtl: iL
  },
  formula: sL,
  header: {
    1: oL,
    2: lL,
    3: aL,
    4: cL,
    5: uL,
    6: dL
  },
  italic: hL,
  image: fL,
  indent: {
    "+1": gL,
    "-1": pL
  },
  link: mL,
  list: {
    bullet: vL,
    check: yL,
    ordered: bL
  },
  script: {
    sub: wL,
    super: _L
  },
  strike: SL,
  table: xL,
  underline: CL,
  video: $L
}, EL = '<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';
let yg = 0;
function bg(t, e) {
  t.setAttribute(e, `${t.getAttribute(e) !== "true"}`);
}
class lc {
  constructor(e) {
    this.select = e, this.container = document.createElement("span"), this.buildPicker(), this.select.style.display = "none", this.select.parentNode.insertBefore(this.container, this.select), this.label.addEventListener("mousedown", () => {
      this.togglePicker();
    }), this.label.addEventListener("keydown", (n) => {
      switch (n.key) {
        case "Enter":
          this.togglePicker();
          break;
        case "Escape":
          this.escape(), n.preventDefault();
          break;
      }
    }), this.select.addEventListener("change", this.update.bind(this));
  }
  togglePicker() {
    this.container.classList.toggle("ql-expanded"), bg(this.label, "aria-expanded"), bg(this.options, "aria-hidden");
  }
  buildItem(e) {
    const n = document.createElement("span");
    n.tabIndex = "0", n.setAttribute("role", "button"), n.classList.add("ql-picker-item");
    const r = e.getAttribute("value");
    return r && n.setAttribute("data-value", r), e.textContent && n.setAttribute("data-label", e.textContent), n.addEventListener("click", () => {
      this.selectItem(n, !0);
    }), n.addEventListener("keydown", (i) => {
      switch (i.key) {
        case "Enter":
          this.selectItem(n, !0), i.preventDefault();
          break;
        case "Escape":
          this.escape(), i.preventDefault();
          break;
      }
    }), n;
  }
  buildLabel() {
    const e = document.createElement("span");
    return e.classList.add("ql-picker-label"), e.innerHTML = EL, e.tabIndex = "0", e.setAttribute("role", "button"), e.setAttribute("aria-expanded", "false"), this.container.appendChild(e), e;
  }
  buildOptions() {
    const e = document.createElement("span");
    e.classList.add("ql-picker-options"), e.setAttribute("aria-hidden", "true"), e.tabIndex = "-1", e.id = `ql-picker-options-${yg}`, yg += 1, this.label.setAttribute("aria-controls", e.id), this.options = e, Array.from(this.select.options).forEach((n) => {
      const r = this.buildItem(n);
      e.appendChild(r), n.selected === !0 && this.selectItem(r);
    }), this.container.appendChild(e);
  }
  buildPicker() {
    Array.from(this.select.attributes).forEach((e) => {
      this.container.setAttribute(e.name, e.value);
    }), this.container.classList.add("ql-picker"), this.label = this.buildLabel(), this.buildOptions();
  }
  escape() {
    this.close(), setTimeout(() => this.label.focus(), 1);
  }
  close() {
    this.container.classList.remove("ql-expanded"), this.label.setAttribute("aria-expanded", "false"), this.options.setAttribute("aria-hidden", "true");
  }
  selectItem(e) {
    let n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : !1;
    const r = this.container.querySelector(".ql-selected");
    e !== r && (r?.classList.remove("ql-selected"), e != null && (e.classList.add("ql-selected"), this.select.selectedIndex = Array.from(e.parentNode.children).indexOf(e), e.hasAttribute("data-value") ? this.label.setAttribute("data-value", e.getAttribute("data-value")) : this.label.removeAttribute("data-value"), e.hasAttribute("data-label") ? this.label.setAttribute("data-label", e.getAttribute("data-label")) : this.label.removeAttribute("data-label"), n && (this.select.dispatchEvent(new Event("change")), this.close())));
  }
  update() {
    let e;
    if (this.select.selectedIndex > -1) {
      const r = (
        // @ts-expect-error Fix me later
        this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex]
      );
      e = this.select.options[this.select.selectedIndex], this.selectItem(r);
    } else
      this.selectItem(null);
    const n = e != null && e !== this.select.querySelector("option[selected]");
    this.label.classList.toggle("ql-active", n);
  }
}
class Fv extends lc {
  constructor(e, n) {
    super(e), this.label.innerHTML = n, this.container.classList.add("ql-color-picker"), Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0, 7).forEach((r) => {
      r.classList.add("ql-primary");
    });
  }
  buildItem(e) {
    const n = super.buildItem(e);
    return n.style.backgroundColor = e.getAttribute("value") || "", n;
  }
  selectItem(e, n) {
    super.selectItem(e, n);
    const r = this.label.querySelector(".ql-color-label"), i = e && e.getAttribute("data-value") || "";
    r && (r.tagName === "line" ? r.style.stroke = i : r.style.fill = i);
  }
}
class Vv extends lc {
  constructor(e, n) {
    super(e), this.container.classList.add("ql-icon-picker"), Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach((r) => {
      r.innerHTML = n[r.getAttribute("data-value") || ""];
    }), this.defaultItem = this.container.querySelector(".ql-selected"), this.selectItem(this.defaultItem);
  }
  selectItem(e, n) {
    super.selectItem(e, n);
    const r = e || this.defaultItem;
    if (r != null) {
      if (this.label.innerHTML === r.innerHTML) return;
      this.label.innerHTML = r.innerHTML;
    }
  }
}
const TL = (t) => {
  const {
    overflowY: e
  } = getComputedStyle(t, null);
  return e !== "visible" && e !== "clip";
};
class Hv {
  constructor(e, n) {
    this.quill = e, this.boundsContainer = n || document.body, this.root = e.addContainer("ql-tooltip"), this.root.innerHTML = this.constructor.TEMPLATE, TL(this.quill.root) && this.quill.root.addEventListener("scroll", () => {
      this.root.style.marginTop = `${-1 * this.quill.root.scrollTop}px`;
    }), this.hide();
  }
  hide() {
    this.root.classList.add("ql-hidden");
  }
  position(e) {
    const n = e.left + e.width / 2 - this.root.offsetWidth / 2, r = e.bottom + this.quill.root.scrollTop;
    this.root.style.left = `${n}px`, this.root.style.top = `${r}px`, this.root.classList.remove("ql-flip");
    const i = this.boundsContainer.getBoundingClientRect(), s = this.root.getBoundingClientRect();
    let o = 0;
    if (s.right > i.right && (o = i.right - s.right, this.root.style.left = `${n + o}px`), s.left < i.left && (o = i.left - s.left, this.root.style.left = `${n + o}px`), s.bottom > i.bottom) {
      const l = s.bottom - s.top, a = e.bottom - e.top + l;
      this.root.style.top = `${r - a}px`, this.root.classList.add("ql-flip");
    }
    return o;
  }
  show() {
    this.root.classList.remove("ql-editing"), this.root.classList.remove("ql-hidden");
  }
}
const AL = [!1, "center", "right", "justify"], kL = ["#000000", "#e60000", "#ff9900", "#ffff00", "#008a00", "#0066cc", "#9933ff", "#ffffff", "#facccc", "#ffebcc", "#ffffcc", "#cce8cc", "#cce0f5", "#ebd6ff", "#bbbbbb", "#f06666", "#ffc266", "#ffff66", "#66b966", "#66a3e0", "#c285ff", "#888888", "#a10000", "#b26b00", "#b2b200", "#006100", "#0047b2", "#6b24b2", "#444444", "#5c0000", "#663d00", "#666600", "#003700", "#002966", "#3d1466"], IL = [!1, "serif", "monospace"], OL = ["1", "2", "3", !1], DL = ["small", !1, "large", "huge"];
class hl extends co {
  constructor(e, n) {
    super(e, n);
    const r = (i) => {
      if (!document.body.contains(e.root)) {
        document.body.removeEventListener("click", r);
        return;
      }
      this.tooltip != null && // @ts-expect-error
      !this.tooltip.root.contains(i.target) && // @ts-expect-error
      document.activeElement !== this.tooltip.textbox && !this.quill.hasFocus() && this.tooltip.hide(), this.pickers != null && this.pickers.forEach((s) => {
        s.container.contains(i.target) || s.close();
      });
    };
    e.emitter.listenDOM("click", document.body, r);
  }
  addModule(e) {
    const n = super.addModule(e);
    return e === "toolbar" && this.extendToolbar(n), n;
  }
  buildButtons(e, n) {
    Array.from(e).forEach((r) => {
      (r.getAttribute("class") || "").split(/\s+/).forEach((s) => {
        if (s.startsWith("ql-") && (s = s.slice(3), n[s] != null))
          if (s === "direction")
            r.innerHTML = n[s][""] + n[s].rtl;
          else if (typeof n[s] == "string")
            r.innerHTML = n[s];
          else {
            const o = r.value || "";
            o != null && n[s][o] && (r.innerHTML = n[s][o]);
          }
      });
    });
  }
  buildPickers(e, n) {
    this.pickers = Array.from(e).map((i) => {
      if (i.classList.contains("ql-align") && (i.querySelector("option") == null && vo(i, AL), typeof n.align == "object"))
        return new Vv(i, n.align);
      if (i.classList.contains("ql-background") || i.classList.contains("ql-color")) {
        const s = i.classList.contains("ql-background") ? "background" : "color";
        return i.querySelector("option") == null && vo(i, kL, s === "background" ? "#ffffff" : "#000000"), new Fv(i, n[s]);
      }
      return i.querySelector("option") == null && (i.classList.contains("ql-font") ? vo(i, IL) : i.classList.contains("ql-header") ? vo(i, OL) : i.classList.contains("ql-size") && vo(i, DL)), new lc(i);
    });
    const r = () => {
      this.pickers.forEach((i) => {
        i.update();
      });
    };
    this.quill.on(we.events.EDITOR_CHANGE, r);
  }
}
hl.DEFAULTS = Ri({}, co.DEFAULTS, {
  modules: {
    toolbar: {
      handlers: {
        formula() {
          this.quill.theme.tooltip.edit("formula");
        },
        image() {
          let t = this.container.querySelector("input.ql-image[type=file]");
          t == null && (t = document.createElement("input"), t.setAttribute("type", "file"), t.setAttribute("accept", this.quill.uploader.options.mimetypes.join(", ")), t.classList.add("ql-image"), t.addEventListener("change", () => {
            const e = this.quill.getSelection(!0);
            this.quill.uploader.upload(e, t.files), t.value = "";
          }), this.container.appendChild(t)), t.click();
        },
        video() {
          this.quill.theme.tooltip.edit("video");
        }
      }
    }
  }
});
class zv extends Hv {
  constructor(e, n) {
    super(e, n), this.textbox = this.root.querySelector('input[type="text"]'), this.listen();
  }
  listen() {
    this.textbox.addEventListener("keydown", (e) => {
      e.key === "Enter" ? (this.save(), e.preventDefault()) : e.key === "Escape" && (this.cancel(), e.preventDefault());
    });
  }
  cancel() {
    this.hide(), this.restoreFocus();
  }
  edit() {
    let e = arguments.length > 0 && arguments[0] !== void 0 ? arguments[0] : "link", n = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : null;
    if (this.root.classList.remove("ql-hidden"), this.root.classList.add("ql-editing"), this.textbox == null) return;
    n != null ? this.textbox.value = n : e !== this.root.getAttribute("data-mode") && (this.textbox.value = "");
    const r = this.quill.getBounds(this.quill.selection.savedRange);
    r != null && this.position(r), this.textbox.select(), this.textbox.setAttribute("placeholder", this.textbox.getAttribute(`data-${e}`) || ""), this.root.setAttribute("data-mode", e);
  }
  restoreFocus() {
    this.quill.focus({
      preventScroll: !0
    });
  }
  save() {
    let {
      value: e
    } = this.textbox;
    switch (this.root.getAttribute("data-mode")) {
      case "link": {
        const {
          scrollTop: n
        } = this.quill.root;
        this.linkRange ? (this.quill.formatText(this.linkRange, "link", e, we.sources.USER), delete this.linkRange) : (this.restoreFocus(), this.quill.format("link", e, we.sources.USER)), this.quill.root.scrollTop = n;
        break;
      }
      case "video":
        e = LL(e);
      case "formula": {
        if (!e) break;
        const n = this.quill.getSelection(!0);
        if (n != null) {
          const r = n.index + n.length;
          this.quill.insertEmbed(
            r,
            // @ts-expect-error Fix me later
            this.root.getAttribute("data-mode"),
            e,
            we.sources.USER
          ), this.root.getAttribute("data-mode") === "formula" && this.quill.insertText(r + 1, " ", we.sources.USER), this.quill.setSelection(r + 2, we.sources.USER);
        }
        break;
      }
    }
    this.textbox.value = "", this.hide();
  }
}
function LL(t) {
  let e = t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/) || t.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);
  return e ? `${e[1] || "https"}://www.youtube.com/embed/${e[2]}?showinfo=0` : (e = t.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/)) ? `${e[1] || "https"}://player.vimeo.com/video/${e[2]}/` : t;
}
function vo(t, e) {
  let n = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : !1;
  e.forEach((r) => {
    const i = document.createElement("option");
    r === n ? i.setAttribute("selected", "selected") : i.setAttribute("value", String(r)), t.appendChild(i);
  });
}
const NL = [["bold", "italic", "link"], [{
  header: 1
}, {
  header: 2
}, "blockquote"]];
class PL extends zv {
  static TEMPLATE = ['<span class="ql-tooltip-arrow"></span>', '<div class="ql-tooltip-editor">', '<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">', '<a class="ql-close"></a>', "</div>"].join("");
  constructor(e, n) {
    super(e, n), this.quill.on(we.events.EDITOR_CHANGE, (r, i, s, o) => {
      if (r === we.events.SELECTION_CHANGE)
        if (i != null && i.length > 0 && o === we.sources.USER) {
          this.show(), this.root.style.left = "0px", this.root.style.width = "", this.root.style.width = `${this.root.offsetWidth}px`;
          const l = this.quill.getLines(i.index, i.length);
          if (l.length === 1) {
            const a = this.quill.getBounds(i);
            a != null && this.position(a);
          } else {
            const a = l[l.length - 1], c = this.quill.getIndex(a), u = Math.min(a.length() - 1, i.index + i.length - c), d = this.quill.getBounds(new as(c, u));
            d != null && this.position(d);
          }
        } else document.activeElement !== this.textbox && this.quill.hasFocus() && this.hide();
    });
  }
  listen() {
    super.listen(), this.root.querySelector(".ql-close").addEventListener("click", () => {
      this.root.classList.remove("ql-editing");
    }), this.quill.on(we.events.SCROLL_OPTIMIZE, () => {
      setTimeout(() => {
        if (this.root.classList.contains("ql-hidden")) return;
        const e = this.quill.getSelection();
        if (e != null) {
          const n = this.quill.getBounds(e);
          n != null && this.position(n);
        }
      }, 1);
    });
  }
  cancel() {
    this.show();
  }
  position(e) {
    const n = super.position(e), r = this.root.querySelector(".ql-tooltip-arrow");
    return r.style.marginLeft = "", n !== 0 && (r.style.marginLeft = `${-1 * n - r.offsetWidth / 2}px`), n;
  }
}
class Wv extends hl {
  constructor(e, n) {
    n.modules.toolbar != null && n.modules.toolbar.container == null && (n.modules.toolbar.container = NL), super(e, n), this.quill.container.classList.add("ql-bubble");
  }
  extendToolbar(e) {
    this.tooltip = new PL(this.quill, this.options.bounds), e.container != null && (this.tooltip.root.appendChild(e.container), this.buildButtons(e.container.querySelectorAll("button"), Jo), this.buildPickers(e.container.querySelectorAll("select"), Jo));
  }
}
Wv.DEFAULTS = Ri({}, hl.DEFAULTS, {
  modules: {
    toolbar: {
      handlers: {
        link(t) {
          t ? this.quill.theme.tooltip.edit() : this.quill.format("link", !1, Q.sources.USER);
        }
      }
    }
  }
});
const RL = [[{
  header: ["1", "2", "3", !1]
}], ["bold", "italic", "underline", "link"], [{
  list: "ordered"
}, {
  list: "bullet"
}], ["clean"]];
class ML extends zv {
  static TEMPLATE = ['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>', '<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">', '<a class="ql-action"></a>', '<a class="ql-remove"></a>'].join("");
  preview = this.root.querySelector("a.ql-preview");
  listen() {
    super.listen(), this.root.querySelector("a.ql-action").addEventListener("click", (e) => {
      this.root.classList.contains("ql-editing") ? this.save() : this.edit("link", this.preview.textContent), e.preventDefault();
    }), this.root.querySelector("a.ql-remove").addEventListener("click", (e) => {
      if (this.linkRange != null) {
        const n = this.linkRange;
        this.restoreFocus(), this.quill.formatText(n, "link", !1, we.sources.USER), delete this.linkRange;
      }
      e.preventDefault(), this.hide();
    }), this.quill.on(we.events.SELECTION_CHANGE, (e, n, r) => {
      if (e != null) {
        if (e.length === 0 && r === we.sources.USER) {
          const [i, s] = this.quill.scroll.descendant(Aa, e.index);
          if (i != null) {
            this.linkRange = new as(e.index - s, i.length());
            const o = Aa.formats(i.domNode);
            this.preview.textContent = o, this.preview.setAttribute("href", o), this.show();
            const l = this.quill.getBounds(this.linkRange);
            l != null && this.position(l);
            return;
          }
        } else
          delete this.linkRange;
        this.hide();
      }
    });
  }
  show() {
    super.show(), this.root.removeAttribute("data-mode");
  }
}
class Jv extends hl {
  constructor(e, n) {
    n.modules.toolbar != null && n.modules.toolbar.container == null && (n.modules.toolbar.container = RL), super(e, n), this.quill.container.classList.add("ql-snow");
  }
  extendToolbar(e) {
    e.container != null && (e.container.classList.add("ql-snow"), this.buildButtons(e.container.querySelectorAll("button"), Jo), this.buildPickers(e.container.querySelectorAll("select"), Jo), this.tooltip = new ML(this.quill, this.options.bounds), e.container.querySelector(".ql-link") && this.quill.keyboard.addBinding({
      key: "k",
      shortKey: !0
    }, (n, r) => {
      e.handlers.link.call(e, !r.format.link);
    }));
  }
}
Jv.DEFAULTS = Ri({}, hl.DEFAULTS, {
  modules: {
    toolbar: {
      handlers: {
        link(t) {
          if (t) {
            const e = this.quill.getSelection();
            if (e == null || e.length === 0) return;
            let n = this.quill.getText(e);
            /^\S+@\S+\.\S+$/.test(n) && n.indexOf("mailto:") !== 0 && (n = `mailto:${n}`);
            const {
              tooltip: r
            } = this.quill.theme;
            r.edit("link", n);
          } else
            this.quill.format("link", !1, Q.sources.USER);
        }
      }
    }
  }
});
Q.register({
  "attributors/attribute/direction": Ov,
  "attributors/class/align": Av,
  "attributors/class/background": GO,
  "attributors/class/color": jO,
  "attributors/class/direction": Dv,
  "attributors/class/font": Pv,
  "attributors/class/size": Mv,
  "attributors/style/align": kv,
  "attributors/style/background": eh,
  "attributors/style/color": Zd,
  "attributors/style/direction": Lv,
  "attributors/style/font": Rv,
  "attributors/style/size": qv
}, !0);
Q.register({
  "formats/align": Av,
  "formats/direction": Dv,
  "formats/indent": ND,
  "formats/background": eh,
  "formats/color": Zd,
  "formats/font": Pv,
  "formats/size": Mv,
  "formats/blockquote": PD,
  "formats/code-block": Dn,
  "formats/header": RD,
  "formats/list": dl,
  "formats/bold": sh,
  "formats/code": th,
  "formats/italic": MD,
  "formats/link": Aa,
  "formats/script": qD,
  "formats/strike": BD,
  "formats/underline": UD,
  "formats/formula": jD,
  "formats/image": GD,
  "formats/video": FD,
  "modules/syntax": Gv,
  "modules/table": HD,
  "modules/toolbar": lh,
  "themes/bubble": Wv,
  "themes/snow": Jv,
  "ui/icons": Jo,
  "ui/picker": lc,
  "ui/icon-picker": Vv,
  "ui/color-picker": Fv,
  "ui/tooltip": Hv
}, !0);
let Gc = null;
class qL {
  collaborators;
  setCollaborators;
  activeCollaborators;
  onPropertySaved;
  onValueSet;
  isRichText = !1;
  isFocused;
  setIsFocused;
  isSaving;
  setIsSaving;
  isFullscreen;
  setIsFullscreen;
  value;
  setValue;
  srcName;
  identity;
  readonly;
  key;
  container;
  setContainer;
  session = null;
  constructor(e, n, r, i, s, o) {
    [this.container, this.setContainer] = I(null), [this.collaborators, this.setCollaborators] = I([]), [this.isFocused, this.setIsFocused] = I(!1), [this.isFullscreen, this.setIsFullscreen] = I(!1), [this.value, this.setValue] = I(""), [this.isSaving, this.setIsSaving] = I(!1), this.srcName = e, this.identity = n, this.readonly = r, this.onPropertySaved = o, this.onValueSet = s, this.activeCollaborators = P(() => this.collaborators().filter((l) => l.active && l.online && l.id !== this.session?.provider?.awareness.clientID)), this.key = P(() => `${this.srcName()}:${this.identity()}`), this.isRichText = i, Z(Tr(() => [this.srcName(), this.identity(), this.container()], () => {
      this.container() && (this.session && (this.session.destroy(), this.session = null), !(!this.srcName() || !this.identity()) && (this.session = new BL({
        srcName: this.srcName(),
        identity: this.identity(),
        readonly: this.readonly(),
        richtext: this.isRichText,
        onAutosave: (l) => {
          this.setValue(l), this.save();
        },
        onFocusChange: (l) => this.setIsFocused(l),
        onValueSet: (l, a) => {
          this.setValue(l), this.onValueSet?.(l, a);
        },
        onPropertySaved: (l) => this.onPropertySaved?.(l),
        onPresenceChange: (l) => {
          this.setCollaborators(l);
        }
      }), this.session.bootstrap(this.container())));
    }));
  }
  async save() {
    this.setIsSaving(!0);
    try {
      const e = new Promise((r) => setTimeout(r, 1e3)), n = Oi.SaveValue(this.srcName(), this.identity(), this.value(), this.session?.snapshot ?? "");
      await Promise.all([n, e]);
    } catch (e) {
      console.error("Error saving value", e);
    }
    this.setIsSaving(!1);
  }
}
class BL {
  id;
  srcName;
  identity;
  key;
  ydoc;
  provider;
  editor;
  binding;
  onValueSet;
  onPropertySaved;
  onFocusChange;
  onAutosave;
  onPresenceChange;
  richtext = !1;
  readonly = !1;
  focused = !1;
  cloudSyncTimer = void 0;
  heartbeatTimer = void 0;
  constructor(e) {
    this.id = Math.floor(Math.random() * 1e6), this.srcName = e.srcName, this.identity = e.identity, this.key = `${this.srcName}:${this.identity}`, this.onValueSet = e.onValueSet, this.onFocusChange = e.onFocusChange, this.onPropertySaved = e.onPropertySaved, this.onAutosave = e.onAutosave, this.onPresenceChange = e.onPresenceChange, this.richtext = e.richtext || !1, this.readonly = e.readonly || !1;
  }
  get snapshot() {
    if (!this.ydoc) return null;
    const e = pu(this.ydoc);
    return btoa(String.fromCharCode(...e));
  }
  async bootstrap(e) {
    const n = await Oi.GetCurrentValue(this.srcName, this.identity) || "", r = new ns();
    r.getText("quill").insert(0, n);
    const s = pu(r), o = btoa(String.fromCharCode(...s)), l = await Oi.Bootstrap({
      key: this.key,
      snapshotBase64: o,
      value: n
    });
    await Oi.JoinCollaboration(this.key, Date.now()), this.ydoc = new ns(), l?.snapshotBase64 && $d(this.ydoc, Uint8Array.from(atob(l.snapshotBase64), (a) => a.charCodeAt(0))), this.editor = this.initQuill(e), this.provider = new $E(this.key, this.ydoc, {
      id: this.id
    }), this.binding = new fE(this.ydoc.getText("quill"), this.editor, this.provider.awareness), this.getCursorInfo().then((a) => this.provider?.updatePresence(a)), this.provider.awareness.on("change", () => {
      const a = this.provider?.awareness.getStates();
      if (!a) return;
      const c = [...a.entries()].map(([u, d]) => this.buildCollaborator(u, d));
      this.onPresenceChange?.(c);
    }), this.heartbeatTimer = window.setInterval(() => {
      UL(this.key);
    }, 1e4);
  }
  initQuill(e) {
    const n = document.createElement("div");
    e.replaceChildren(n), this.cloudSyncTimer && (clearTimeout(this.cloudSyncTimer), this.cloudSyncTimer = void 0);
    const r = this.buildQuillOptions(), i = new Q(n, r);
    return i.on("text-change", (s, o, l) => {
      const a = this.richtext ? i.getSemanticHTML() : i.getText() ?? "", c = a.endsWith(`
`) ? a.slice(0, -1) : a;
      this.onValueSet?.(c, l === "user" ? "user" : "collaborator"), l === "user" && (this.cloudSyncTimer && clearTimeout(this.cloudSyncTimer), this.cloudSyncTimer = window.setTimeout(() => {
        this.focused && this.onAutosave?.(c);
      }, 2e3));
    }), i.on("selection-change", (s, o, l) => {
      this.readonly || (this.focused = !!s, this.onFocusChange?.(this.focused));
    }), i;
  }
  buildQuillOptions() {
    const e = {
      modules: {
        cursors: !0,
        toolbar: !1,
        history: {
          userOnly: !0
        }
      },
      formats: [],
      theme: "snow"
    };
    return this.richtext && (e.modules.toolbar = [[{
      header: [1, 2, !1]
    }], ["bold", "italic", "underline"], ["image", "code-block"]], e.formats = ["bold", "italic", "underline", "header", "image", "code-block"]), e;
  }
  async getCursorInfo() {
    return Gc || (Gc = await Oi.GetCursorInfo()), Gc;
  }
  buildCollaborator(e, n) {
    const r = !!n?.user, i = n?.user?.name ?? "Unknown", s = n?.user?.color ?? "#000000", o = i.split(" ").map((a) => a[0]).join("").toUpperCase(), l = !!n?.cursor;
    return {
      id: e,
      name: i,
      color: s,
      initials: o,
      online: r,
      active: l
    };
  }
  async destroy() {
    this.provider?.destroy(), this.ydoc?.destroy(), this.binding?.destroy(), this.provider = void 0, this.ydoc = void 0, this.binding = void 0, this.editor = void 0, this.cloudSyncTimer && (clearTimeout(this.cloudSyncTimer), this.cloudSyncTimer = void 0), this.heartbeatTimer && (clearInterval(this.heartbeatTimer), this.heartbeatTimer = void 0);
    try {
      await Oi.LeaveCollaboration(this.key, Date.now());
    } catch (e) {
      console.error("Error leaving collaboration", e);
    }
  }
}
const zl = /* @__PURE__ */ new Set();
function UL(t) {
  zl.add(t);
}
setInterval(() => {
  try {
    if (zl.size === 0) return;
    const t = Array.from(zl);
    zl.clear(), Oi.Heartbeat(t);
  } catch (t) {
    console.error("Error sending heartbeat", t);
  }
}, 1e4);
var Qv = { exports: {} };
/*! For license information please see quill-cursors.js.LICENSE.txt */
(function(t, e) {
  (function(n, r) {
    t.exports = r();
  })(self, () => (() => {
    var n = { 582: (o, l, a) => {
      a.d(l, { Z: () => g });
      var c = a(81), u = a.n(c), d = a(645), f = a.n(d)()(u());
      f.push([o.id, ".ql-container{position:relative;overflow:hidden}@media(pointer: coarse){.ql-cursor-caret-container{z-index:-1}}.ql-cursor.hidden{display:none}.ql-cursor .ql-cursor-caret-container,.ql-cursor .ql-cursor-flag{position:absolute}.ql-cursor .ql-cursor-flag{z-index:1;transform:translate3d(-1px, -100%, 0);opacity:0;visibility:hidden;color:#fff;padding-bottom:2px;border-radius:0 3px 3px 0}.ql-cursor .ql-cursor-flag.flag-flipped{border-radius:3px 0 0 3px;transform:translate3d(calc(-100% + 1px ), -100%, 0)}@media screen{.ql-cursor .ql-cursor-flag{transition:opacity 0ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 0ms,visibility 0ms cubic-bezier(0.25, 0.46, 0.45, 0.94) 0ms}}.ql-cursor .ql-cursor-flag .ql-cursor-name{margin-left:5px;margin-right:5px;display:inline-block;margin-top:-2px;white-space:nowrap}.ql-cursor .ql-cursor-flag.no-delay[style]{transition-delay:unset !important}.ql-cursor .ql-cursor-caret-container{cursor:text;margin-left:-9px;padding:0 9px}.ql-cursor .ql-cursor-caret-container.hover+.ql-cursor-flag{opacity:1;visibility:visible;transition:none}.ql-cursor .ql-cursor-caret-container.no-pointer{pointer-events:none}.ql-cursor .ql-cursor-caret-container .ql-cursor-caret{position:absolute;top:0;bottom:0;width:2px;margin-left:-1px;background-color:attr(data-color)}.ql-cursor .ql-cursor-selection-block{position:absolute;pointer-events:none}", ""]);
      const g = f;
    }, 645: (o) => {
      o.exports = function(l) {
        var a = [];
        return a.toString = function() {
          return this.map(function(c) {
            var u = "", d = c[5] !== void 0;
            return c[4] && (u += "@supports (".concat(c[4], ") {")), c[2] && (u += "@media ".concat(c[2], " {")), d && (u += "@layer".concat(c[5].length > 0 ? " ".concat(c[5]) : "", " {")), u += l(c), d && (u += "}"), c[2] && (u += "}"), c[4] && (u += "}"), u;
          }).join("");
        }, a.i = function(c, u, d, f, g) {
          typeof c == "string" && (c = [[null, c, void 0]]);
          var p = {};
          if (d) for (var S = 0; S < this.length; S++) {
            var _ = this[S][0];
            _ != null && (p[_] = !0);
          }
          for (var m = 0; m < c.length; m++) {
            var y = [].concat(c[m]);
            d && p[y[0]] || (g !== void 0 && (y[5] === void 0 || (y[1] = "@layer".concat(y[5].length > 0 ? " ".concat(y[5]) : "", " {").concat(y[1], "}")), y[5] = g), u && (y[2] && (y[1] = "@media ".concat(y[2], " {").concat(y[1], "}")), y[2] = u), f && (y[4] ? (y[1] = "@supports (".concat(y[4], ") {").concat(y[1], "}"), y[4] = f) : y[4] = "".concat(f)), a.push(y));
          }
        }, a;
      };
    }, 81: (o) => {
      o.exports = function(l) {
        return l[1];
      };
    }, 529: (o) => {
      var l = -1;
      function a(v, x, C, E) {
        if (v === x) return v ? [[0, v]] : [];
        if (C != null) {
          var k = function(ie, X, V) {
            var U = typeof V == "number" ? { index: V, length: 0 } : V.oldRange, W = typeof V == "number" ? null : V.newRange, ce = ie.length, ue = X.length;
            if (U.length === 0 && (W === null || W.length === 0)) {
              var xe = U.index, H = ie.slice(0, xe), ee = ie.slice(xe), se = W ? W.index : null, K = xe + ue - ce;
              if ((se === null || se === K) && !(K < 0 || K > ue)) {
                var re = X.slice(0, K);
                if ((be = X.slice(K)) === ee) {
                  var J = Math.min(xe, K);
                  if ((oe = H.slice(0, J)) === (Ae = re.slice(0, J))) return m(oe, H.slice(J), re.slice(J), ee);
                }
              }
              if (se === null || se === xe) {
                var he = xe, be = (re = X.slice(0, he), X.slice(he));
                if (re === H) {
                  var me = Math.min(ce - he, ue - he);
                  if ((Qe = ee.slice(ee.length - me)) === (Ye = be.slice(be.length - me))) return m(H, ee.slice(0, ee.length - me), be.slice(0, be.length - me), Qe);
                }
              }
            }
            if (U.length > 0 && W && W.length === 0) {
              var oe = ie.slice(0, U.index), Qe = ie.slice(U.index + U.length);
              if (!(ue < (J = oe.length) + (me = Qe.length))) {
                var Ae = X.slice(0, J), Ye = X.slice(ue - me);
                if (oe === Ae && Qe === Ye) return m(oe, ie.slice(J, ce - me), X.slice(J, ue - me), Qe);
              }
            }
            return null;
          }(v, x, C);
          if (k) return k;
        }
        var L = u(v, x), M = v.substring(0, L);
        L = d(v = v.substring(L), x = x.substring(L));
        var G = v.substring(v.length - L), Y = function(ie, X) {
          var V;
          if (!ie) return [[1, X]];
          if (!X) return [[l, ie]];
          var U = ie.length > X.length ? ie : X, W = ie.length > X.length ? X : ie, ce = U.indexOf(W);
          if (ce !== -1) return V = [[1, U.substring(0, ce)], [0, W], [1, U.substring(ce + W.length)]], ie.length > X.length && (V[0][0] = V[2][0] = l), V;
          if (W.length === 1) return [[l, ie], [1, X]];
          var ue = function(he, be) {
            var me = he.length > be.length ? he : be, oe = he.length > be.length ? be : he;
            if (me.length < 4 || 2 * oe.length < me.length) return null;
            function Qe(ht, it, ot) {
              for (var wt, pt, lt, Ge, yt = ht.substring(ot, ot + Math.floor(ht.length / 4)), at = -1, te = ""; (at = it.indexOf(yt, at + 1)) !== -1; ) {
                var pe = u(ht.substring(ot), it.substring(at)), tt = d(ht.substring(0, ot), it.substring(0, at));
                te.length < tt + pe && (te = it.substring(at - tt, at) + it.substring(at, at + pe), wt = ht.substring(0, ot - tt), pt = ht.substring(ot + pe), lt = it.substring(0, at - tt), Ge = it.substring(at + pe));
              }
              return 2 * te.length >= ht.length ? [wt, pt, lt, Ge, te] : null;
            }
            var Ae, Ye, De, Oe, nt, We = Qe(me, oe, Math.ceil(me.length / 4)), gt = Qe(me, oe, Math.ceil(me.length / 2));
            return We || gt ? (Ae = gt ? We && We[4].length > gt[4].length ? We : gt : We, he.length > be.length ? (Ye = Ae[0], De = Ae[1], Oe = Ae[2], nt = Ae[3]) : (Oe = Ae[0], nt = Ae[1], Ye = Ae[2], De = Ae[3]), [Ye, De, Oe, nt, Ae[4]]) : null;
          }(ie, X);
          if (ue) {
            var xe = ue[0], H = ue[1], ee = ue[2], se = ue[3], K = ue[4], re = a(xe, ee), J = a(H, se);
            return re.concat([[0, K]], J);
          }
          return function(he, be) {
            for (var me = he.length, oe = be.length, Qe = Math.ceil((me + oe) / 2), Ae = Qe, Ye = 2 * Qe, De = new Array(Ye), Oe = new Array(Ye), nt = 0; nt < Ye; nt++) De[nt] = -1, Oe[nt] = -1;
            De[Ae + 1] = 0, Oe[Ae + 1] = 0;
            for (var We = me - oe, gt = We % 2 != 0, ht = 0, it = 0, ot = 0, wt = 0, pt = 0; pt < Qe; pt++) {
              for (var lt = -pt + ht; lt <= pt - it; lt += 2) {
                for (var Ge = Ae + lt, yt = (Be = lt === -pt || lt !== pt && De[Ge - 1] < De[Ge + 1] ? De[Ge + 1] : De[Ge - 1] + 1) - lt; Be < me && yt < oe && he.charAt(Be) === be.charAt(yt); ) Be++, yt++;
                if (De[Ge] = Be, Be > me) it += 2;
                else if (yt > oe) ht += 2;
                else if (gt && (pe = Ae + We - lt) >= 0 && pe < Ye && Oe[pe] !== -1 && Be >= (te = me - Oe[pe])) return c(he, be, Be, yt);
              }
              for (var at = -pt + ot; at <= pt - wt; at += 2) {
                for (var te, pe = Ae + at, tt = (te = at === -pt || at !== pt && Oe[pe - 1] < Oe[pe + 1] ? Oe[pe + 1] : Oe[pe - 1] + 1) - at; te < me && tt < oe && he.charAt(me - te - 1) === be.charAt(oe - tt - 1); ) te++, tt++;
                if (Oe[pe] = te, te > me) wt += 2;
                else if (tt > oe) ot += 2;
                else if (!gt) {
                  var Be;
                  if ((Ge = Ae + We - at) >= 0 && Ge < Ye && De[Ge] !== -1 && (yt = Ae + (Be = De[Ge]) - Ge, Be >= (te = me - te)))
                    return c(he, be, Be, yt);
                }
              }
            }
            return [[l, he], [1, be]];
          }(ie, X);
        }(v = v.substring(0, v.length - L), x = x.substring(0, x.length - L));
        return M && Y.unshift([0, M]), G && Y.push([0, G]), f(Y, E), Y;
      }
      function c(v, x, C, E) {
        var k = v.substring(0, C), L = x.substring(0, E), M = v.substring(C), G = x.substring(E), Y = a(k, L), ie = a(M, G);
        return Y.concat(ie);
      }
      function u(v, x) {
        if (!v || !x || v.charAt(0) !== x.charAt(0)) return 0;
        for (var C = 0, E = Math.min(v.length, x.length), k = E, L = 0; C < k; ) v.substring(L, k) == x.substring(L, k) ? L = C = k : E = k, k = Math.floor((E - C) / 2 + C);
        return g(v.charCodeAt(k - 1)) && k--, k;
      }
      function d(v, x) {
        if (!v || !x || v.slice(-1) !== x.slice(-1)) return 0;
        for (var C = 0, E = Math.min(v.length, x.length), k = E, L = 0; C < k; ) v.substring(v.length - k, v.length - L) == x.substring(x.length - k, x.length - L) ? L = C = k : E = k, k = Math.floor((E - C) / 2 + C);
        return p(v.charCodeAt(v.length - k)) && k--, k;
      }
      function f(v, x) {
        v.push([0, ""]);
        for (var C, E = 0, k = 0, L = 0, M = "", G = ""; E < v.length; ) if (E < v.length - 1 && !v[E][1]) v.splice(E, 1);
        else switch (v[E][0]) {
          case 1:
            L++, G += v[E][1], E++;
            break;
          case l:
            k++, M += v[E][1], E++;
            break;
          case 0:
            var Y = E - L - k - 1;
            if (x) {
              if (Y >= 0 && _(v[Y][1])) {
                var ie = v[Y][1].slice(-1);
                if (v[Y][1] = v[Y][1].slice(0, -1), M = ie + M, G = ie + G, !v[Y][1]) {
                  v.splice(Y, 1), E--;
                  var X = Y - 1;
                  v[X] && v[X][0] === 1 && (L++, G = v[X][1] + G, X--), v[X] && v[X][0] === l && (k++, M = v[X][1] + M, X--), Y = X;
                }
              }
              S(v[E][1]) && (ie = v[E][1].charAt(0), v[E][1] = v[E][1].slice(1), M += ie, G += ie);
            }
            if (E < v.length - 1 && !v[E][1]) {
              v.splice(E, 1);
              break;
            }
            if (M.length > 0 || G.length > 0) {
              M.length > 0 && G.length > 0 && ((C = u(G, M)) !== 0 && (Y >= 0 ? v[Y][1] += G.substring(0, C) : (v.splice(0, 0, [0, G.substring(0, C)]), E++), G = G.substring(C), M = M.substring(C)), (C = d(G, M)) !== 0 && (v[E][1] = G.substring(G.length - C) + v[E][1], G = G.substring(0, G.length - C), M = M.substring(0, M.length - C)));
              var V = L + k;
              M.length === 0 && G.length === 0 ? (v.splice(E - V, V), E -= V) : M.length === 0 ? (v.splice(E - V, V, [1, G]), E = E - V + 1) : G.length === 0 ? (v.splice(E - V, V, [l, M]), E = E - V + 1) : (v.splice(E - V, V, [l, M], [1, G]), E = E - V + 2);
            }
            E !== 0 && v[E - 1][0] === 0 ? (v[E - 1][1] += v[E][1], v.splice(E, 1)) : E++, L = 0, k = 0, M = "", G = "";
        }
        v[v.length - 1][1] === "" && v.pop();
        var U = !1;
        for (E = 1; E < v.length - 1; ) v[E - 1][0] === 0 && v[E + 1][0] === 0 && (v[E][1].substring(v[E][1].length - v[E - 1][1].length) === v[E - 1][1] ? (v[E][1] = v[E - 1][1] + v[E][1].substring(0, v[E][1].length - v[E - 1][1].length), v[E + 1][1] = v[E - 1][1] + v[E + 1][1], v.splice(E - 1, 1), U = !0) : v[E][1].substring(0, v[E + 1][1].length) == v[E + 1][1] && (v[E - 1][1] += v[E + 1][1], v[E][1] = v[E][1].substring(v[E + 1][1].length) + v[E + 1][1], v.splice(E + 1, 1), U = !0)), E++;
        U && f(v, x);
      }
      function g(v) {
        return v >= 55296 && v <= 56319;
      }
      function p(v) {
        return v >= 56320 && v <= 57343;
      }
      function S(v) {
        return p(v.charCodeAt(0));
      }
      function _(v) {
        return g(v.charCodeAt(v.length - 1));
      }
      function m(v, x, C, E) {
        return _(v) || S(E) ? null : function(k) {
          for (var L = [], M = 0; M < k.length; M++) k[M][1].length > 0 && L.push(k[M]);
          return L;
        }([[0, v], [l, x], [1, C], [0, E]]);
      }
      function y(v, x, C) {
        return a(v, x, C, !0);
      }
      y.INSERT = 1, y.DELETE = l, y.EQUAL = 0, o.exports = y;
    }, 465: (o, l, a) => {
      o = a.nmd(o);
      var c = "__lodash_hash_undefined__", u = 9007199254740991, d = "[object Arguments]", f = "[object Boolean]", g = "[object Date]", p = "[object Function]", S = "[object GeneratorFunction]", _ = "[object Map]", m = "[object Number]", y = "[object Object]", v = "[object Promise]", x = "[object RegExp]", C = "[object Set]", E = "[object String]", k = "[object Symbol]", L = "[object WeakMap]", M = "[object ArrayBuffer]", G = "[object DataView]", Y = "[object Float32Array]", ie = "[object Float64Array]", X = "[object Int8Array]", V = "[object Int16Array]", U = "[object Int32Array]", W = "[object Uint8Array]", ce = "[object Uint8ClampedArray]", ue = "[object Uint16Array]", xe = "[object Uint32Array]", H = /\w*$/, ee = /^\[object .+?Constructor\]$/, se = /^(?:0|[1-9]\d*)$/, K = {};
      K[d] = K["[object Array]"] = K[M] = K[G] = K[f] = K[g] = K[Y] = K[ie] = K[X] = K[V] = K[U] = K[_] = K[m] = K[y] = K[x] = K[C] = K[E] = K[k] = K[W] = K[ce] = K[ue] = K[xe] = !0, K["[object Error]"] = K[p] = K[L] = !1;
      var re = typeof a.g == "object" && a.g && a.g.Object === Object && a.g, J = typeof self == "object" && self && self.Object === Object && self, he = re || J || Function("return this")(), be = l && !l.nodeType && l, me = be && o && !o.nodeType && o, oe = me && me.exports === be;
      function Qe(N, F) {
        return N.set(F[0], F[1]), N;
      }
      function Ae(N, F) {
        return N.add(F), N;
      }
      function Ye(N, F, ae, ge) {
        var ke = -1, Ze = N ? N.length : 0;
        for (ge; ++ke < Ze; ) ae = F(ae, N[ke], ke, N);
        return ae;
      }
      function De(N) {
        var F = !1;
        if (N != null && typeof N.toString != "function") try {
          F = !!(N + "");
        } catch {
        }
        return F;
      }
      function Oe(N) {
        var F = -1, ae = Array(N.size);
        return N.forEach(function(ge, ke) {
          ae[++F] = [ke, ge];
        }), ae;
      }
      function nt(N, F) {
        return function(ae) {
          return N(F(ae));
        };
      }
      function We(N) {
        var F = -1, ae = Array(N.size);
        return N.forEach(function(ge) {
          ae[++F] = ge;
        }), ae;
      }
      var gt, ht = Array.prototype, it = Function.prototype, ot = Object.prototype, wt = he["__core-js_shared__"], pt = (gt = /[^.]+$/.exec(wt && wt.keys && wt.keys.IE_PROTO || "")) ? "Symbol(src)_1." + gt : "", lt = it.toString, Ge = ot.hasOwnProperty, yt = ot.toString, at = RegExp("^" + lt.call(Ge).replace(/[\\^$.*+?()[\]{}|]/g, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"), te = oe ? he.Buffer : void 0, pe = he.Symbol, tt = he.Uint8Array, Be = nt(Object.getPrototypeOf, Object), It = Object.create, nn = ot.propertyIsEnumerable, Lr = ht.splice, Ln = Object.getOwnPropertySymbols, Nr = te ? te.isBuffer : void 0, wi = nt(Object.keys, Object), nr = Pn(he, "DataView"), pn = Pn(he, "Map"), Ft = Pn(he, "Promise"), rn = Pn(he, "Set"), Vt = Pn(he, "WeakMap"), Lt = Pn(Object, "create"), rr = Rn(nr), sn = Rn(pn), ir = Rn(Ft), Fn = Rn(rn), Pr = Rn(Vt), Nn = pe ? pe.prototype : void 0, Rr = Nn ? Nn.valueOf : void 0;
      function Pt(N) {
        var F = -1, ae = N ? N.length : 0;
        for (this.clear(); ++F < ae; ) {
          var ge = N[F];
          this.set(ge[0], ge[1]);
        }
      }
      function on(N) {
        var F = -1, ae = N ? N.length : 0;
        for (this.clear(); ++F < ae; ) {
          var ge = N[F];
          this.set(ge[0], ge[1]);
        }
      }
      function cn(N) {
        var F = -1, ae = N ? N.length : 0;
        for (this.clear(); ++F < ae; ) {
          var ge = N[F];
          this.set(ge[0], ge[1]);
        }
      }
      function sr(N) {
        this.__data__ = new on(N);
      }
      function mn(N, F, ae) {
        var ge = N[F];
        Ge.call(N, F) && xi(ge, ae) && (ae !== void 0 || F in N) || (N[F] = ae);
      }
      function or(N, F) {
        for (var ae = N.length; ae--; ) if (xi(N[ae][0], F)) return ae;
        return -1;
      }
      function mt(N, F, ae, ge, ke, Ze, St) {
        var Fe;
        if (ge && (Fe = Ze ? ge(N, ke, Ze, St) : ge(N)), Fe !== void 0) return Fe;
        if (!Ke(N)) return N;
        var At = q(N);
        if (At) {
          if (Fe = function(Ce) {
            var et = Ce.length, Ct = Ce.constructor(et);
            return et && typeof Ce[0] == "string" && Ge.call(Ce, "index") && (Ct.index = Ce.index, Ct.input = Ce.input), Ct;
          }(N), !F) return function(Ce, et) {
            var Ct = -1, Ue = Ce.length;
            for (et || (et = Array(Ue)); ++Ct < Ue; ) et[Ct] = Ce[Ct];
            return et;
          }(N, Fe);
        } else {
          var xt = _t(N), Mn = xt == p || xt == S;
          if (le(N)) return function(Ce, et) {
            if (et) return Ce.slice();
            var Ct = new Ce.constructor(Ce.length);
            return Ce.copy(Ct), Ct;
          }(N, F);
          if (xt == y || xt == d || Mn && !Ze) {
            if (De(N)) return Ze ? N : {};
            if (Fe = function(Ce) {
              return typeof Ce.constructor != "function" || lr(Ce) ? {} : Ke(et = Be(Ce)) ? It(et) : {};
              var et;
            }(Mn ? {} : N), !F) return function(Ce, et) {
              return _i(Ce, Yr(Ce), et);
            }(N, function(Ce, et) {
              return Ce && _i(et, Re(et), Ce);
            }(Fe, N));
          } else {
            if (!K[xt]) return Ze ? N : {};
            Fe = function(Ce, et, Ct, Ue) {
              var Je, $n = Ce.constructor;
              switch (et) {
                case M:
                  return Mr(Ce);
                case f:
                case g:
                  return new $n(+Ce);
                case G:
                  return function(He, Ot) {
                    var $t = Ot ? Mr(He.buffer) : He.buffer;
                    return new He.constructor($t, He.byteOffset, He.byteLength);
                  }(Ce, Ue);
                case Y:
                case ie:
                case X:
                case V:
                case U:
                case W:
                case ce:
                case ue:
                case xe:
                  return function(He, Ot) {
                    var $t = Ot ? Mr(He.buffer) : He.buffer;
                    return new He.constructor($t, He.byteOffset, He.length);
                  }(Ce, Ue);
                case _:
                  return function(He, Ot, $t) {
                    return Ye(Ot ? $t(Oe(He), !0) : Oe(He), Qe, new He.constructor());
                  }(Ce, Ue, Ct);
                case m:
                case E:
                  return new $n(Ce);
                case x:
                  return function(He) {
                    var Ot = new He.constructor(He.source, H.exec(He));
                    return Ot.lastIndex = He.lastIndex, Ot;
                  }(Ce);
                case C:
                  return function(He, Ot, $t) {
                    return Ye(Ot ? $t(We(He), !0) : We(He), Ae, new He.constructor());
                  }(Ce, Ue, Ct);
                case k:
                  return Je = Ce, Rr ? Object(Rr.call(Je)) : {};
              }
            }(N, xt, mt, F);
          }
        }
        St || (St = new sr());
        var vn = St.get(N);
        if (vn) return vn;
        if (St.set(N, Fe), !At) var qn = ae ? function(Ce) {
          return function(et, Ct, Ue) {
            var Je = Ct(et);
            return q(et) ? Je : function($n, He) {
              for (var Ot = -1, $t = He.length, En = $n.length; ++Ot < $t; ) $n[En + Ot] = He[Ot];
              return $n;
            }(Je, Ue(et));
          }(Ce, Re, Yr);
        }(N) : Re(N);
        return function(Ce, et) {
          for (var Ct = -1, Ue = Ce ? Ce.length : 0; ++Ct < Ue && et(Ce[Ct], Ct) !== !1; ) ;
        }(qn || N, function(Ce, et) {
          qn && (Ce = N[et = Ce]), mn(Fe, et, mt(Ce, F, ae, ge, et, N, St));
        }), Fe;
      }
      function Mr(N) {
        var F = new N.constructor(N.byteLength);
        return new tt(F).set(new tt(N)), F;
      }
      function _i(N, F, ae, ge) {
        ae || (ae = {});
        for (var ke = -1, Ze = F.length; ++ke < Ze; ) {
          var St = F[ke], Fe = void 0;
          mn(ae, St, Fe === void 0 ? N[St] : Fe);
        }
        return ae;
      }
      function Vn(N, F) {
        var ae, ge, ke = N.__data__;
        return ((ge = typeof (ae = F)) == "string" || ge == "number" || ge == "symbol" || ge == "boolean" ? ae !== "__proto__" : ae === null) ? ke[typeof F == "string" ? "string" : "hash"] : ke.map;
      }
      function Pn(N, F) {
        var ae = function(ge, ke) {
          return ge?.[ke];
        }(N, F);
        return function(ge) {
          return !(!Ke(ge) || (ke = ge, pt && pt in ke)) && (ve(ge) || De(ge) ? at : ee).test(Rn(ge));
          var ke;
        }(ae) ? ae : void 0;
      }
      Pt.prototype.clear = function() {
        this.__data__ = Lt ? Lt(null) : {};
      }, Pt.prototype.delete = function(N) {
        return this.has(N) && delete this.__data__[N];
      }, Pt.prototype.get = function(N) {
        var F = this.__data__;
        if (Lt) {
          var ae = F[N];
          return ae === c ? void 0 : ae;
        }
        return Ge.call(F, N) ? F[N] : void 0;
      }, Pt.prototype.has = function(N) {
        var F = this.__data__;
        return Lt ? F[N] !== void 0 : Ge.call(F, N);
      }, Pt.prototype.set = function(N, F) {
        return this.__data__[N] = Lt && F === void 0 ? c : F, this;
      }, on.prototype.clear = function() {
        this.__data__ = [];
      }, on.prototype.delete = function(N) {
        var F = this.__data__, ae = or(F, N);
        return !(ae < 0 || (ae == F.length - 1 ? F.pop() : Lr.call(F, ae, 1), 0));
      }, on.prototype.get = function(N) {
        var F = this.__data__, ae = or(F, N);
        return ae < 0 ? void 0 : F[ae][1];
      }, on.prototype.has = function(N) {
        return or(this.__data__, N) > -1;
      }, on.prototype.set = function(N, F) {
        var ae = this.__data__, ge = or(ae, N);
        return ge < 0 ? ae.push([N, F]) : ae[ge][1] = F, this;
      }, cn.prototype.clear = function() {
        this.__data__ = { hash: new Pt(), map: new (pn || on)(), string: new Pt() };
      }, cn.prototype.delete = function(N) {
        return Vn(this, N).delete(N);
      }, cn.prototype.get = function(N) {
        return Vn(this, N).get(N);
      }, cn.prototype.has = function(N) {
        return Vn(this, N).has(N);
      }, cn.prototype.set = function(N, F) {
        return Vn(this, N).set(N, F), this;
      }, sr.prototype.clear = function() {
        this.__data__ = new on();
      }, sr.prototype.delete = function(N) {
        return this.__data__.delete(N);
      }, sr.prototype.get = function(N) {
        return this.__data__.get(N);
      }, sr.prototype.has = function(N) {
        return this.__data__.has(N);
      }, sr.prototype.set = function(N, F) {
        var ae = this.__data__;
        if (ae instanceof on) {
          var ge = ae.__data__;
          if (!pn || ge.length < 199) return ge.push([N, F]), this;
          ae = this.__data__ = new cn(ge);
        }
        return ae.set(N, F), this;
      };
      var Yr = Ln ? nt(Ln, Object) : function() {
        return [];
      }, _t = function(N) {
        return yt.call(N);
      };
      function Si(N, F) {
        return !!(F = F ?? u) && (typeof N == "number" || se.test(N)) && N > -1 && N % 1 == 0 && N < F;
      }
      function lr(N) {
        var F = N && N.constructor;
        return N === (typeof F == "function" && F.prototype || ot);
      }
      function Rn(N) {
        if (N != null) {
          try {
            return lt.call(N);
          } catch {
          }
          try {
            return N + "";
          } catch {
          }
        }
        return "";
      }
      function xi(N, F) {
        return N === F || N != N && F != F;
      }
      (nr && _t(new nr(new ArrayBuffer(1))) != G || pn && _t(new pn()) != _ || Ft && _t(Ft.resolve()) != v || rn && _t(new rn()) != C || Vt && _t(new Vt()) != L) && (_t = function(N) {
        var F = yt.call(N), ae = F == y ? N.constructor : void 0, ge = ae ? Rn(ae) : void 0;
        if (ge) switch (ge) {
          case rr:
            return G;
          case sn:
            return _;
          case ir:
            return v;
          case Fn:
            return C;
          case Pr:
            return L;
        }
        return F;
      });
      var q = Array.isArray;
      function j(N) {
        return N != null && function(F) {
          return typeof F == "number" && F > -1 && F % 1 == 0 && F <= u;
        }(N.length) && !ve(N);
      }
      var le = Nr || function() {
        return !1;
      };
      function ve(N) {
        var F = Ke(N) ? yt.call(N) : "";
        return F == p || F == S;
      }
      function Ke(N) {
        var F = typeof N;
        return !!N && (F == "object" || F == "function");
      }
      function Re(N) {
        return j(N) ? function(F, ae) {
          var ge = q(F) || function(Fe) {
            return function(At) {
              return /* @__PURE__ */ function(xt) {
                return !!xt && typeof xt == "object";
              }(At) && j(At);
            }(Fe) && Ge.call(Fe, "callee") && (!nn.call(Fe, "callee") || yt.call(Fe) == d);
          }(F) ? function(Fe, At) {
            for (var xt = -1, Mn = Array(Fe); ++xt < Fe; ) Mn[xt] = At(xt);
            return Mn;
          }(F.length, String) : [], ke = ge.length, Ze = !!ke;
          for (var St in F) !Ge.call(F, St) || Ze && (St == "length" || Si(St, ke)) || ge.push(St);
          return ge;
        }(N) : function(F) {
          if (!lr(F)) return wi(F);
          var ae = [];
          for (var ge in Object(F)) Ge.call(F, ge) && ge != "constructor" && ae.push(ge);
          return ae;
        }(N);
      }
      o.exports = function(N) {
        return mt(N, !0, !0);
      };
    }, 307: (o, l, a) => {
      o = a.nmd(o);
      var c = "__lodash_hash_undefined__", u = 9007199254740991, d = "[object Arguments]", f = "[object Array]", g = "[object Boolean]", p = "[object Date]", S = "[object Error]", _ = "[object Function]", m = "[object Map]", y = "[object Number]", v = "[object Object]", x = "[object Promise]", C = "[object RegExp]", E = "[object Set]", k = "[object String]", L = "[object WeakMap]", M = "[object ArrayBuffer]", G = "[object DataView]", Y = /^\[object .+?Constructor\]$/, ie = /^(?:0|[1-9]\d*)$/, X = {};
      X["[object Float32Array]"] = X["[object Float64Array]"] = X["[object Int8Array]"] = X["[object Int16Array]"] = X["[object Int32Array]"] = X["[object Uint8Array]"] = X["[object Uint8ClampedArray]"] = X["[object Uint16Array]"] = X["[object Uint32Array]"] = !0, X[d] = X[f] = X[M] = X[g] = X[G] = X[p] = X[S] = X[_] = X[m] = X[y] = X[v] = X[C] = X[E] = X[k] = X[L] = !1;
      var V = typeof a.g == "object" && a.g && a.g.Object === Object && a.g, U = typeof self == "object" && self && self.Object === Object && self, W = V || U || Function("return this")(), ce = l && !l.nodeType && l, ue = ce && o && !o.nodeType && o, xe = ue && ue.exports === ce, H = xe && V.process, ee = function() {
        try {
          return H && H.binding && H.binding("util");
        } catch {
        }
      }(), se = ee && ee.isTypedArray;
      function K(q, j) {
        for (var le = -1, ve = q == null ? 0 : q.length; ++le < ve; ) if (j(q[le], le, q)) return !0;
        return !1;
      }
      function re(q) {
        var j = -1, le = Array(q.size);
        return q.forEach(function(ve, Ke) {
          le[++j] = [Ke, ve];
        }), le;
      }
      function J(q) {
        var j = -1, le = Array(q.size);
        return q.forEach(function(ve) {
          le[++j] = ve;
        }), le;
      }
      var he, be, me, oe = Array.prototype, Qe = Function.prototype, Ae = Object.prototype, Ye = W["__core-js_shared__"], De = Qe.toString, Oe = Ae.hasOwnProperty, nt = (he = /[^.]+$/.exec(Ye && Ye.keys && Ye.keys.IE_PROTO || "")) ? "Symbol(src)_1." + he : "", We = Ae.toString, gt = RegExp("^" + De.call(Oe).replace(/[\\^$.*+?()[\]{}|]/g, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"), ht = xe ? W.Buffer : void 0, it = W.Symbol, ot = W.Uint8Array, wt = Ae.propertyIsEnumerable, pt = oe.splice, lt = it ? it.toStringTag : void 0, Ge = Object.getOwnPropertySymbols, yt = ht ? ht.isBuffer : void 0, at = (be = Object.keys, me = Object, function(q) {
        return be(me(q));
      }), te = cn(W, "DataView"), pe = cn(W, "Map"), tt = cn(W, "Promise"), Be = cn(W, "Set"), It = cn(W, "WeakMap"), nn = cn(Object, "create"), Lr = mt(te), Ln = mt(pe), Nr = mt(tt), wi = mt(Be), nr = mt(It), pn = it ? it.prototype : void 0, Ft = pn ? pn.valueOf : void 0;
      function rn(q) {
        var j = -1, le = q == null ? 0 : q.length;
        for (this.clear(); ++j < le; ) {
          var ve = q[j];
          this.set(ve[0], ve[1]);
        }
      }
      function Vt(q) {
        var j = -1, le = q == null ? 0 : q.length;
        for (this.clear(); ++j < le; ) {
          var ve = q[j];
          this.set(ve[0], ve[1]);
        }
      }
      function Lt(q) {
        var j = -1, le = q == null ? 0 : q.length;
        for (this.clear(); ++j < le; ) {
          var ve = q[j];
          this.set(ve[0], ve[1]);
        }
      }
      function rr(q) {
        var j = -1, le = q == null ? 0 : q.length;
        for (this.__data__ = new Lt(); ++j < le; ) this.add(q[j]);
      }
      function sn(q) {
        var j = this.__data__ = new Vt(q);
        this.size = j.size;
      }
      function ir(q, j) {
        for (var le = q.length; le--; ) if (Mr(q[le][0], j)) return le;
        return -1;
      }
      function Fn(q) {
        return q == null ? q === void 0 ? "[object Undefined]" : "[object Null]" : lt && lt in Object(q) ? function(j) {
          var le = Oe.call(j, lt), ve = j[lt];
          try {
            j[lt] = void 0;
            var Ke = !0;
          } catch {
          }
          var Re = We.call(j);
          return Ke && (le ? j[lt] = ve : delete j[lt]), Re;
        }(q) : function(j) {
          return We.call(j);
        }(q);
      }
      function Pr(q) {
        return lr(q) && Fn(q) == d;
      }
      function Nn(q, j, le, ve, Ke) {
        return q === j || (q == null || j == null || !lr(q) && !lr(j) ? q != q && j != j : function(Re, N, F, ae, ge, ke) {
          var Ze = Vn(Re), St = Vn(N), Fe = Ze ? f : mn(Re), At = St ? f : mn(N), xt = (Fe = Fe == d ? v : Fe) == v, Mn = (At = At == d ? v : At) == v, vn = Fe == At;
          if (vn && Pn(Re)) {
            if (!Pn(N)) return !1;
            Ze = !0, xt = !1;
          }
          if (vn && !xt) return ke || (ke = new sn()), Ze || Rn(Re) ? Rr(Re, N, F, ae, ge, ke) : function(Ue, Je, $n, He, Ot, $t, En) {
            switch ($n) {
              case G:
                if (Ue.byteLength != Je.byteLength || Ue.byteOffset != Je.byteOffset) return !1;
                Ue = Ue.buffer, Je = Je.buffer;
              case M:
                return !(Ue.byteLength != Je.byteLength || !$t(new ot(Ue), new ot(Je)));
              case g:
              case p:
              case y:
                return Mr(+Ue, +Je);
              case S:
                return Ue.name == Je.name && Ue.message == Je.message;
              case C:
              case k:
                return Ue == Je + "";
              case m:
                var yn = re;
              case E:
                var un = 1 & He;
                if (yn || (yn = J), Ue.size != Je.size && !un) return !1;
                var dn = En.get(Ue);
                if (dn) return dn == Je;
                He |= 2, En.set(Ue, Je);
                var Ht = Rr(yn(Ue), yn(Je), He, Ot, $t, En);
                return En.delete(Ue), Ht;
              case "[object Symbol]":
                if (Ft) return Ft.call(Ue) == Ft.call(Je);
            }
            return !1;
          }(Re, N, Fe, F, ae, ge, ke);
          if (!(1 & F)) {
            var qn = xt && Oe.call(Re, "__wrapped__"), Ce = Mn && Oe.call(N, "__wrapped__");
            if (qn || Ce) {
              var et = qn ? Re.value() : Re, Ct = Ce ? N.value() : N;
              return ke || (ke = new sn()), ge(et, Ct, F, ae, ke);
            }
          }
          return !!vn && (ke || (ke = new sn()), function(Ue, Je, $n, He, Ot, $t) {
            var En = 1 & $n, yn = Pt(Ue), un = yn.length;
            if (un != Pt(Je).length && !En) return !1;
            for (var dn = un; dn--; ) {
              var Ht = yn[dn];
              if (!(En ? Ht in Je : Oe.call(Je, Ht))) return !1;
            }
            var bs = $t.get(Ue);
            if (bs && $t.get(Je)) return bs == Je;
            var Tn = !0;
            $t.set(Ue, Je), $t.set(Je, Ue);
            for (var Hi = En; ++dn < un; ) {
              var Ci = Ue[Ht = yn[dn]], $i = Je[Ht];
              if (He) var ws = En ? He($i, Ci, Ht, Je, Ue, $t) : He(Ci, $i, Ht, Ue, Je, $t);
              if (!(ws === void 0 ? Ci === $i || Ot(Ci, $i, $n, He, $t) : ws)) {
                Tn = !1;
                break;
              }
              Hi || (Hi = Ht == "constructor");
            }
            if (Tn && !Hi) {
              var Xr = Ue.constructor, Rt = Je.constructor;
              Xr == Rt || !("constructor" in Ue) || !("constructor" in Je) || typeof Xr == "function" && Xr instanceof Xr && typeof Rt == "function" && Rt instanceof Rt || (Tn = !1);
            }
            return $t.delete(Ue), $t.delete(Je), Tn;
          }(Re, N, F, ae, ge, ke));
        }(q, j, le, ve, Nn, Ke));
      }
      function Rr(q, j, le, ve, Ke, Re) {
        var N = 1 & le, F = q.length, ae = j.length;
        if (F != ae && !(N && ae > F)) return !1;
        var ge = Re.get(q);
        if (ge && Re.get(j)) return ge == j;
        var ke = -1, Ze = !0, St = 2 & le ? new rr() : void 0;
        for (Re.set(q, j), Re.set(j, q); ++ke < F; ) {
          var Fe = q[ke], At = j[ke];
          if (ve) var xt = N ? ve(At, Fe, ke, j, q, Re) : ve(Fe, At, ke, q, j, Re);
          if (xt !== void 0) {
            if (xt) continue;
            Ze = !1;
            break;
          }
          if (St) {
            if (!K(j, function(Mn, vn) {
              if (qn = vn, !St.has(qn) && (Fe === Mn || Ke(Fe, Mn, le, ve, Re))) return St.push(vn);
              var qn;
            })) {
              Ze = !1;
              break;
            }
          } else if (Fe !== At && !Ke(Fe, At, le, ve, Re)) {
            Ze = !1;
            break;
          }
        }
        return Re.delete(q), Re.delete(j), Ze;
      }
      function Pt(q) {
        return function(j, le, ve) {
          var Ke = le(j);
          return Vn(j) ? Ke : function(Re, N) {
            for (var F = -1, ae = N.length, ge = Re.length; ++F < ae; ) Re[ge + F] = N[F];
            return Re;
          }(Ke, ve(j));
        }(q, xi, sr);
      }
      function on(q, j) {
        var le, ve, Ke = q.__data__;
        return ((ve = typeof (le = j)) == "string" || ve == "number" || ve == "symbol" || ve == "boolean" ? le !== "__proto__" : le === null) ? Ke[typeof j == "string" ? "string" : "hash"] : Ke.map;
      }
      function cn(q, j) {
        var le = function(ve, Ke) {
          return ve?.[Ke];
        }(q, j);
        return function(ve) {
          return !(!Si(ve) || function(Ke) {
            return !!nt && nt in Ke;
          }(ve)) && (Yr(ve) ? gt : Y).test(mt(ve));
        }(le) ? le : void 0;
      }
      rn.prototype.clear = function() {
        this.__data__ = nn ? nn(null) : {}, this.size = 0;
      }, rn.prototype.delete = function(q) {
        var j = this.has(q) && delete this.__data__[q];
        return this.size -= j ? 1 : 0, j;
      }, rn.prototype.get = function(q) {
        var j = this.__data__;
        if (nn) {
          var le = j[q];
          return le === c ? void 0 : le;
        }
        return Oe.call(j, q) ? j[q] : void 0;
      }, rn.prototype.has = function(q) {
        var j = this.__data__;
        return nn ? j[q] !== void 0 : Oe.call(j, q);
      }, rn.prototype.set = function(q, j) {
        var le = this.__data__;
        return this.size += this.has(q) ? 0 : 1, le[q] = nn && j === void 0 ? c : j, this;
      }, Vt.prototype.clear = function() {
        this.__data__ = [], this.size = 0;
      }, Vt.prototype.delete = function(q) {
        var j = this.__data__, le = ir(j, q);
        return !(le < 0 || (le == j.length - 1 ? j.pop() : pt.call(j, le, 1), --this.size, 0));
      }, Vt.prototype.get = function(q) {
        var j = this.__data__, le = ir(j, q);
        return le < 0 ? void 0 : j[le][1];
      }, Vt.prototype.has = function(q) {
        return ir(this.__data__, q) > -1;
      }, Vt.prototype.set = function(q, j) {
        var le = this.__data__, ve = ir(le, q);
        return ve < 0 ? (++this.size, le.push([q, j])) : le[ve][1] = j, this;
      }, Lt.prototype.clear = function() {
        this.size = 0, this.__data__ = { hash: new rn(), map: new (pe || Vt)(), string: new rn() };
      }, Lt.prototype.delete = function(q) {
        var j = on(this, q).delete(q);
        return this.size -= j ? 1 : 0, j;
      }, Lt.prototype.get = function(q) {
        return on(this, q).get(q);
      }, Lt.prototype.has = function(q) {
        return on(this, q).has(q);
      }, Lt.prototype.set = function(q, j) {
        var le = on(this, q), ve = le.size;
        return le.set(q, j), this.size += le.size == ve ? 0 : 1, this;
      }, rr.prototype.add = rr.prototype.push = function(q) {
        return this.__data__.set(q, c), this;
      }, rr.prototype.has = function(q) {
        return this.__data__.has(q);
      }, sn.prototype.clear = function() {
        this.__data__ = new Vt(), this.size = 0;
      }, sn.prototype.delete = function(q) {
        var j = this.__data__, le = j.delete(q);
        return this.size = j.size, le;
      }, sn.prototype.get = function(q) {
        return this.__data__.get(q);
      }, sn.prototype.has = function(q) {
        return this.__data__.has(q);
      }, sn.prototype.set = function(q, j) {
        var le = this.__data__;
        if (le instanceof Vt) {
          var ve = le.__data__;
          if (!pe || ve.length < 199) return ve.push([q, j]), this.size = ++le.size, this;
          le = this.__data__ = new Lt(ve);
        }
        return le.set(q, j), this.size = le.size, this;
      };
      var sr = Ge ? function(q) {
        return q == null ? [] : (q = Object(q), function(j, le) {
          for (var ve = -1, Ke = j == null ? 0 : j.length, Re = 0, N = []; ++ve < Ke; ) {
            var F = j[ve];
            ae = F, wt.call(q, ae) && (N[Re++] = F);
          }
          var ae;
          return N;
        }(Ge(q)));
      } : function() {
        return [];
      }, mn = Fn;
      function or(q, j) {
        return !!(j = j ?? u) && (typeof q == "number" || ie.test(q)) && q > -1 && q % 1 == 0 && q < j;
      }
      function mt(q) {
        if (q != null) {
          try {
            return De.call(q);
          } catch {
          }
          try {
            return q + "";
          } catch {
          }
        }
        return "";
      }
      function Mr(q, j) {
        return q === j || q != q && j != j;
      }
      (te && mn(new te(new ArrayBuffer(1))) != G || pe && mn(new pe()) != m || tt && mn(tt.resolve()) != x || Be && mn(new Be()) != E || It && mn(new It()) != L) && (mn = function(q) {
        var j = Fn(q), le = j == v ? q.constructor : void 0, ve = le ? mt(le) : "";
        if (ve) switch (ve) {
          case Lr:
            return G;
          case Ln:
            return m;
          case Nr:
            return x;
          case wi:
            return E;
          case nr:
            return L;
        }
        return j;
      });
      var _i = Pr(/* @__PURE__ */ function() {
        return arguments;
      }()) ? Pr : function(q) {
        return lr(q) && Oe.call(q, "callee") && !wt.call(q, "callee");
      }, Vn = Array.isArray, Pn = yt || function() {
        return !1;
      };
      function Yr(q) {
        if (!Si(q)) return !1;
        var j = Fn(q);
        return j == _ || j == "[object GeneratorFunction]" || j == "[object AsyncFunction]" || j == "[object Proxy]";
      }
      function _t(q) {
        return typeof q == "number" && q > -1 && q % 1 == 0 && q <= u;
      }
      function Si(q) {
        var j = typeof q;
        return q != null && (j == "object" || j == "function");
      }
      function lr(q) {
        return q != null && typeof q == "object";
      }
      var Rn = se ? /* @__PURE__ */ function(q) {
        return function(j) {
          return q(j);
        };
      }(se) : function(q) {
        return lr(q) && _t(q.length) && !!X[Fn(q)];
      };
      function xi(q) {
        return (j = q) != null && _t(j.length) && !Yr(j) ? function(le, ve) {
          var Ke = Vn(le), Re = !Ke && _i(le), N = !Ke && !Re && Pn(le), F = !Ke && !Re && !N && Rn(le), ae = Ke || Re || N || F, ge = ae ? function(St, Fe) {
            for (var At = -1, xt = Array(St); ++At < St; ) xt[At] = Fe(At);
            return xt;
          }(le.length, String) : [], ke = ge.length;
          for (var Ze in le) !Oe.call(le, Ze) || ae && (Ze == "length" || N && (Ze == "offset" || Ze == "parent") || F && (Ze == "buffer" || Ze == "byteLength" || Ze == "byteOffset") || or(Ze, ke)) || ge.push(Ze);
          return ge;
        }(q) : function(le) {
          if (Ke = (ve = le) && ve.constructor, ve !== (typeof Ke == "function" && Ke.prototype || Ae)) return at(le);
          var ve, Ke, Re = [];
          for (var N in Object(le)) Oe.call(le, N) && N != "constructor" && Re.push(N);
          return Re;
        }(q);
        var j;
      }
      o.exports = function(q, j) {
        return Nn(q, j);
      };
    }, 210: function(o, l, a) {
      var c = this && this.__importDefault || function(g) {
        return g && g.__esModule ? g : { default: g };
      };
      Object.defineProperty(l, "__esModule", { value: !0 });
      var u, d = c(a(465)), f = c(a(307));
      (function(g) {
        g.compose = function(p, S, _) {
          p === void 0 && (p = {}), S === void 0 && (S = {}), typeof p != "object" && (p = {}), typeof S != "object" && (S = {});
          var m = d.default(S);
          for (var y in _ || (m = Object.keys(m).reduce(function(v, x) {
            return m[x] != null && (v[x] = m[x]), v;
          }, {})), p) p[y] !== void 0 && S[y] === void 0 && (m[y] = p[y]);
          return Object.keys(m).length > 0 ? m : void 0;
        }, g.diff = function(p, S) {
          p === void 0 && (p = {}), S === void 0 && (S = {}), typeof p != "object" && (p = {}), typeof S != "object" && (S = {});
          var _ = Object.keys(p).concat(Object.keys(S)).reduce(function(m, y) {
            return f.default(p[y], S[y]) || (m[y] = S[y] === void 0 ? null : S[y]), m;
          }, {});
          return Object.keys(_).length > 0 ? _ : void 0;
        }, g.invert = function(p, S) {
          p === void 0 && (p = {}), S === void 0 && (S = {}), p = p || {};
          var _ = Object.keys(S).reduce(function(m, y) {
            return S[y] !== p[y] && p[y] !== void 0 && (m[y] = S[y]), m;
          }, {});
          return Object.keys(p).reduce(function(m, y) {
            return p[y] !== S[y] && S[y] === void 0 && (m[y] = null), m;
          }, _);
        }, g.transform = function(p, S, _) {
          if (_ === void 0 && (_ = !1), typeof p != "object") return S;
          if (typeof S == "object") {
            if (!_) return S;
            var m = Object.keys(S).reduce(function(y, v) {
              return p[v] === void 0 && (y[v] = S[v]), y;
            }, {});
            return Object.keys(m).length > 0 ? m : void 0;
          }
        };
      })(u || (u = {})), l.default = u;
    }, 895: function(o, l, a) {
      var c = this && this.__importDefault || function(m) {
        return m && m.__esModule ? m : { default: m };
      }, u = c(a(529)), d = c(a(465)), f = c(a(307)), g = c(a(210)), p = c(a(430)), S = "\0", _ = function() {
        function m(y) {
          Array.isArray(y) ? this.ops = y : y != null && Array.isArray(y.ops) ? this.ops = y.ops : this.ops = [];
        }
        return m.prototype.insert = function(y, v) {
          var x = {};
          return typeof y == "string" && y.length === 0 ? this : (x.insert = y, v != null && typeof v == "object" && Object.keys(v).length > 0 && (x.attributes = v), this.push(x));
        }, m.prototype.delete = function(y) {
          return y <= 0 ? this : this.push({ delete: y });
        }, m.prototype.retain = function(y, v) {
          if (y <= 0) return this;
          var x = { retain: y };
          return v != null && typeof v == "object" && Object.keys(v).length > 0 && (x.attributes = v), this.push(x);
        }, m.prototype.push = function(y) {
          var v = this.ops.length, x = this.ops[v - 1];
          if (y = d.default(y), typeof x == "object") {
            if (typeof y.delete == "number" && typeof x.delete == "number") return this.ops[v - 1] = { delete: x.delete + y.delete }, this;
            if (typeof x.delete == "number" && y.insert != null && (v -= 1, typeof (x = this.ops[v - 1]) != "object")) return this.ops.unshift(y), this;
            if (f.default(y.attributes, x.attributes)) {
              if (typeof y.insert == "string" && typeof x.insert == "string") return this.ops[v - 1] = { insert: x.insert + y.insert }, typeof y.attributes == "object" && (this.ops[v - 1].attributes = y.attributes), this;
              if (typeof y.retain == "number" && typeof x.retain == "number") return this.ops[v - 1] = { retain: x.retain + y.retain }, typeof y.attributes == "object" && (this.ops[v - 1].attributes = y.attributes), this;
            }
          }
          return v === this.ops.length ? this.ops.push(y) : this.ops.splice(v, 0, y), this;
        }, m.prototype.chop = function() {
          var y = this.ops[this.ops.length - 1];
          return y && y.retain && !y.attributes && this.ops.pop(), this;
        }, m.prototype.filter = function(y) {
          return this.ops.filter(y);
        }, m.prototype.forEach = function(y) {
          this.ops.forEach(y);
        }, m.prototype.map = function(y) {
          return this.ops.map(y);
        }, m.prototype.partition = function(y) {
          var v = [], x = [];
          return this.forEach(function(C) {
            (y(C) ? v : x).push(C);
          }), [v, x];
        }, m.prototype.reduce = function(y, v) {
          return this.ops.reduce(y, v);
        }, m.prototype.changeLength = function() {
          return this.reduce(function(y, v) {
            return v.insert ? y + p.default.length(v) : v.delete ? y - v.delete : y;
          }, 0);
        }, m.prototype.length = function() {
          return this.reduce(function(y, v) {
            return y + p.default.length(v);
          }, 0);
        }, m.prototype.slice = function(y, v) {
          y === void 0 && (y = 0), v === void 0 && (v = 1 / 0);
          for (var x = [], C = p.default.iterator(this.ops), E = 0; E < v && C.hasNext(); ) {
            var k = void 0;
            E < y ? k = C.next(y - E) : (k = C.next(v - E), x.push(k)), E += p.default.length(k);
          }
          return new m(x);
        }, m.prototype.compose = function(y) {
          var v = p.default.iterator(this.ops), x = p.default.iterator(y.ops), C = [], E = x.peek();
          if (E != null && typeof E.retain == "number" && E.attributes == null) {
            for (var k = E.retain; v.peekType() === "insert" && v.peekLength() <= k; ) k -= v.peekLength(), C.push(v.next());
            E.retain - k > 0 && x.next(E.retain - k);
          }
          for (var L = new m(C); v.hasNext() || x.hasNext(); ) if (x.peekType() === "insert") L.push(x.next());
          else if (v.peekType() === "delete") L.push(v.next());
          else {
            var M = Math.min(v.peekLength(), x.peekLength()), G = v.next(M), Y = x.next(M);
            if (typeof Y.retain == "number") {
              var ie = {};
              typeof G.retain == "number" ? ie.retain = M : ie.insert = G.insert;
              var X = g.default.compose(G.attributes, Y.attributes, typeof G.retain == "number");
              if (X && (ie.attributes = X), L.push(ie), !x.hasNext() && f.default(L.ops[L.ops.length - 1], ie)) {
                var V = new m(v.rest());
                return L.concat(V).chop();
              }
            } else typeof Y.delete == "number" && typeof G.retain == "number" && L.push(Y);
          }
          return L.chop();
        }, m.prototype.concat = function(y) {
          var v = new m(this.ops.slice());
          return y.ops.length > 0 && (v.push(y.ops[0]), v.ops = v.ops.concat(y.ops.slice(1))), v;
        }, m.prototype.diff = function(y, v) {
          if (this.ops === y.ops) return new m();
          var x = [this, y].map(function(M) {
            return M.map(function(G) {
              if (G.insert != null) return typeof G.insert == "string" ? G.insert : S;
              throw new Error("diff() called " + (M === y ? "on" : "with") + " non-document");
            }).join("");
          }), C = new m(), E = u.default(x[0], x[1], v), k = p.default.iterator(this.ops), L = p.default.iterator(y.ops);
          return E.forEach(function(M) {
            for (var G = M[1].length; G > 0; ) {
              var Y = 0;
              switch (M[0]) {
                case u.default.INSERT:
                  Y = Math.min(L.peekLength(), G), C.push(L.next(Y));
                  break;
                case u.default.DELETE:
                  Y = Math.min(G, k.peekLength()), k.next(Y), C.delete(Y);
                  break;
                case u.default.EQUAL:
                  Y = Math.min(k.peekLength(), L.peekLength(), G);
                  var ie = k.next(Y), X = L.next(Y);
                  f.default(ie.insert, X.insert) ? C.retain(Y, g.default.diff(ie.attributes, X.attributes)) : C.push(X).delete(Y);
              }
              G -= Y;
            }
          }), C.chop();
        }, m.prototype.eachLine = function(y, v) {
          v === void 0 && (v = `
`);
          for (var x = p.default.iterator(this.ops), C = new m(), E = 0; x.hasNext(); ) {
            if (x.peekType() !== "insert") return;
            var k = x.peek(), L = p.default.length(k) - x.peekLength(), M = typeof k.insert == "string" ? k.insert.indexOf(v, L) - L : -1;
            if (M < 0) C.push(x.next());
            else if (M > 0) C.push(x.next(M));
            else {
              if (y(C, x.next(1).attributes || {}, E) === !1) return;
              E += 1, C = new m();
            }
          }
          C.length() > 0 && y(C, {}, E);
        }, m.prototype.invert = function(y) {
          var v = new m();
          return this.reduce(function(x, C) {
            if (C.insert) v.delete(p.default.length(C));
            else {
              if (C.retain && C.attributes == null) return v.retain(C.retain), x + C.retain;
              if (C.delete || C.retain && C.attributes) {
                var E = C.delete || C.retain;
                return y.slice(x, x + E).forEach(function(k) {
                  C.delete ? v.push(k) : C.retain && C.attributes && v.retain(p.default.length(k), g.default.invert(C.attributes, k.attributes));
                }), x + E;
              }
            }
            return x;
          }, 0), v.chop();
        }, m.prototype.transform = function(y, v) {
          if (v === void 0 && (v = !1), v = !!v, typeof y == "number") return this.transformPosition(y, v);
          for (var x = y, C = p.default.iterator(this.ops), E = p.default.iterator(x.ops), k = new m(); C.hasNext() || E.hasNext(); ) if (C.peekType() !== "insert" || !v && E.peekType() === "insert") if (E.peekType() === "insert") k.push(E.next());
          else {
            var L = Math.min(C.peekLength(), E.peekLength()), M = C.next(L), G = E.next(L);
            if (M.delete) continue;
            G.delete ? k.push(G) : k.retain(L, g.default.transform(M.attributes, G.attributes, v));
          }
          else k.retain(p.default.length(C.next()));
          return k.chop();
        }, m.prototype.transformPosition = function(y, v) {
          v === void 0 && (v = !1), v = !!v;
          for (var x = p.default.iterator(this.ops), C = 0; x.hasNext() && C <= y; ) {
            var E = x.peekLength(), k = x.peekType();
            x.next(), k !== "delete" ? (k === "insert" && (C < y || !v) && (y += E), C += E) : y -= Math.min(E, y - C);
          }
          return y;
        }, m.Op = p.default, m.AttributeMap = g.default, m;
      }();
      o.exports = _;
    }, 977: function(o, l, a) {
      var c = this && this.__importDefault || function(f) {
        return f && f.__esModule ? f : { default: f };
      };
      Object.defineProperty(l, "__esModule", { value: !0 });
      var u = c(a(430)), d = function() {
        function f(g) {
          this.ops = g, this.index = 0, this.offset = 0;
        }
        return f.prototype.hasNext = function() {
          return this.peekLength() < 1 / 0;
        }, f.prototype.next = function(g) {
          g || (g = 1 / 0);
          var p = this.ops[this.index];
          if (p) {
            var S = this.offset, _ = u.default.length(p);
            if (g >= _ - S ? (g = _ - S, this.index += 1, this.offset = 0) : this.offset += g, typeof p.delete == "number") return { delete: g };
            var m = {};
            return p.attributes && (m.attributes = p.attributes), typeof p.retain == "number" ? m.retain = g : typeof p.insert == "string" ? m.insert = p.insert.substr(S, g) : m.insert = p.insert, m;
          }
          return { retain: 1 / 0 };
        }, f.prototype.peek = function() {
          return this.ops[this.index];
        }, f.prototype.peekLength = function() {
          return this.ops[this.index] ? u.default.length(this.ops[this.index]) - this.offset : 1 / 0;
        }, f.prototype.peekType = function() {
          return this.ops[this.index] ? typeof this.ops[this.index].delete == "number" ? "delete" : typeof this.ops[this.index].retain == "number" ? "retain" : "insert" : "retain";
        }, f.prototype.rest = function() {
          if (this.hasNext()) {
            if (this.offset === 0) return this.ops.slice(this.index);
            var g = this.offset, p = this.index, S = this.next(), _ = this.ops.slice(this.index);
            return this.offset = g, this.index = p, [S].concat(_);
          }
          return [];
        }, f;
      }();
      l.default = d;
    }, 430: function(o, l, a) {
      var c = this && this.__importDefault || function(f) {
        return f && f.__esModule ? f : { default: f };
      };
      Object.defineProperty(l, "__esModule", { value: !0 });
      var u, d = c(a(977));
      (function(f) {
        f.iterator = function(g) {
          return new d.default(g);
        }, f.length = function(g) {
          return typeof g.delete == "number" ? g.delete : typeof g.retain == "number" ? g.retain : typeof g.insert == "string" ? g.insert.length : 1;
        };
      })(u || (u = {})), l.default = u;
    }, 165: function(o, l, a) {
      var c, u;
      (u = typeof (c = function() {
        var d, f = {};
        function g(_, m, y) {
          var v = _.getClientRects();
          if (v.length === 2) {
            var x = _.getBoundingClientRect();
            return v[m][y] < x[y];
          }
          return !1;
        }
        function p(_) {
          if (!_ || screen.deviceXDPI === screen.logicalXDPI) return _;
          if ("length" in _) return Array.prototype.map.call(_, p);
          var m = screen.deviceXDPI / screen.logicalXDPI;
          return { top: _.top / m, bottom: _.bottom / m, left: _.left / m, right: _.right / m, width: _.width / m, height: _.height / m };
        }
        function S(_, m) {
          var y, v = 0, x = 1024;
          if (x >= m.length) return Array.prototype.push.apply(_, m);
          for (; v < m.length; ) y = Array.prototype.push.apply(_, Array.prototype.slice.call(m, v, v + x)), v += x;
          return y;
        }
        return f.isBroken = function() {
          if (d === void 0) {
            var _ = document.createElement("p"), m = document.createElement("span"), y = document.createTextNode("aa"), v = document.createTextNode("aa"), x = document.createElement("img");
            x.setAttribute("src", "data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=");
            var C = document.createRange();
            if (d = {}, _.appendChild(y), _.appendChild(m), m.appendChild(x), m.appendChild(v), document.body.appendChild(_), C.setStart(y, 1), C.setEnd(m, 0), d.getClientRects = d.getBoundingClientRect = C.getClientRects().length > 1, d.getClientRects || (C.setEnd(v, 1), d.getClientRects = d.getBoundingClientRect = C.getClientRects().length === 2), !d.getBoundingClientRect) {
              C.setEnd(C.startContainer, C.startOffset);
              var E = C.getBoundingClientRect();
              d.getBoundingClientRect = E.top === 0 && E.left === 0;
            }
            if (document.body.removeChild(_), !d.getBoundingClientRect) {
              var k = document.createElement("p");
              k.style.width = "0px", k.style.fontSize = "20px", k.style.whiteSpace = "normal", k.style.wordBreak = "normal";
              var L = document.createTextNode("m mm");
              k.appendChild(L), document.body.appendChild(k), C.setStart(L, 1), C.setEnd(L, 2), g(C, 1, "left") ? d.getBoundingClientRect = !0 : (C.setStart(L, 1), C.setEnd(L, 3), g(C, 0, "top") && (d.getBoundingClientRect = !0)), document.body.removeChild(k);
            }
            var M = window.ActiveXObject && new Function("/*@cc_on return @_jscript_version; @*/")();
            d.ieZoom = !!M && M <= 10;
          }
          return d;
        }, f.getClientRects = function(_) {
          var m = this.isBroken();
          if (m.ieZoom) return p(_.getClientRects());
          if (!m.getClientRects) return _.getClientRects();
          var y = [], v = [], x = _.endContainer, C = _.endOffset, E = document.createRange();
          function k(L) {
            for (var M = 0; L = L.previousSibling; ) M++;
            return M;
          }
          for (; x !== _.commonAncestorContainer; ) E.setStart(x, 0), E.setEnd(x, C), S(v, E.getClientRects()), C = k(x), x = x.parentNode;
          return (E = _.cloneRange()).setEnd(x, C), S(y, E.getClientRects()), S(y, v), y;
        }, f.getBoundingClientRect = function(_) {
          var m = this.getClientRects(_);
          if (m.length === 0) return null;
          var y, v = _.getBoundingClientRect(), x = this.isBroken();
          if (x.ieZoom) return p(v);
          if (!x.getBoundingClientRect) return v;
          if (v.width === 0 && v.height === 0) return m[0];
          for (var C = 0, E = m.length; C < E; C++) {
            var k = m[C];
            y ? (y.left = Math.min(y.left, k.left), y.top = Math.min(y.top, k.top), y.right = Math.max(y.right, k.right), y.bottom = Math.max(y.bottom, k.bottom)) : y = { left: k.left, top: k.top, right: k.right, bottom: k.bottom };
          }
          return y && (y.width = y.right - y.left, y.height = y.bottom - y.top), y;
        }, f;
      }) == "function" ? c.call(l, a, l, o) : c) === void 0 || (o.exports = u);
    }, 33: (o, l, a) => {
      a.r(l), a.d(l, { default: () => X });
      var c = function() {
        if (typeof Map < "u") return Map;
        function V(U, W) {
          var ce = -1;
          return U.some(function(ue, xe) {
            return ue[0] === W && (ce = xe, !0);
          }), ce;
        }
        return function() {
          function U() {
            this.__entries__ = [];
          }
          return Object.defineProperty(U.prototype, "size", { get: function() {
            return this.__entries__.length;
          }, enumerable: !0, configurable: !0 }), U.prototype.get = function(W) {
            var ce = V(this.__entries__, W), ue = this.__entries__[ce];
            return ue && ue[1];
          }, U.prototype.set = function(W, ce) {
            var ue = V(this.__entries__, W);
            ~ue ? this.__entries__[ue][1] = ce : this.__entries__.push([W, ce]);
          }, U.prototype.delete = function(W) {
            var ce = this.__entries__, ue = V(ce, W);
            ~ue && ce.splice(ue, 1);
          }, U.prototype.has = function(W) {
            return !!~V(this.__entries__, W);
          }, U.prototype.clear = function() {
            this.__entries__.splice(0);
          }, U.prototype.forEach = function(W, ce) {
            ce === void 0 && (ce = null);
            for (var ue = 0, xe = this.__entries__; ue < xe.length; ue++) {
              var H = xe[ue];
              W.call(ce, H[1], H[0]);
            }
          }, U;
        }();
      }(), u = typeof window < "u" && typeof document < "u" && window.document === document, d = a.g !== void 0 && a.g.Math === Math ? a.g : typeof self < "u" && self.Math === Math ? self : typeof window < "u" && window.Math === Math ? window : Function("return this")(), f = typeof requestAnimationFrame == "function" ? requestAnimationFrame.bind(d) : function(V) {
        return setTimeout(function() {
          return V(Date.now());
        }, 1e3 / 60);
      }, g = ["top", "right", "bottom", "left", "width", "height", "size", "weight"], p = typeof MutationObserver < "u", S = function() {
        function V() {
          this.connected_ = !1, this.mutationEventsAdded_ = !1, this.mutationsObserver_ = null, this.observers_ = [], this.onTransitionEnd_ = this.onTransitionEnd_.bind(this), this.refresh = /* @__PURE__ */ function(U, W) {
            var ce = !1, ue = !1, xe = 0;
            function H() {
              ce && (ce = !1, U()), ue && se();
            }
            function ee() {
              f(H);
            }
            function se() {
              var K = Date.now();
              if (ce) {
                if (K - xe < 2) return;
                ue = !0;
              } else ce = !0, ue = !1, setTimeout(ee, 20);
              xe = K;
            }
            return se;
          }(this.refresh.bind(this));
        }
        return V.prototype.addObserver = function(U) {
          ~this.observers_.indexOf(U) || this.observers_.push(U), this.connected_ || this.connect_();
        }, V.prototype.removeObserver = function(U) {
          var W = this.observers_, ce = W.indexOf(U);
          ~ce && W.splice(ce, 1), !W.length && this.connected_ && this.disconnect_();
        }, V.prototype.refresh = function() {
          this.updateObservers_() && this.refresh();
        }, V.prototype.updateObservers_ = function() {
          var U = this.observers_.filter(function(W) {
            return W.gatherActive(), W.hasActive();
          });
          return U.forEach(function(W) {
            return W.broadcastActive();
          }), U.length > 0;
        }, V.prototype.connect_ = function() {
          u && !this.connected_ && (document.addEventListener("transitionend", this.onTransitionEnd_), window.addEventListener("resize", this.refresh), p ? (this.mutationsObserver_ = new MutationObserver(this.refresh), this.mutationsObserver_.observe(document, { attributes: !0, childList: !0, characterData: !0, subtree: !0 })) : (document.addEventListener("DOMSubtreeModified", this.refresh), this.mutationEventsAdded_ = !0), this.connected_ = !0);
        }, V.prototype.disconnect_ = function() {
          u && this.connected_ && (document.removeEventListener("transitionend", this.onTransitionEnd_), window.removeEventListener("resize", this.refresh), this.mutationsObserver_ && this.mutationsObserver_.disconnect(), this.mutationEventsAdded_ && document.removeEventListener("DOMSubtreeModified", this.refresh), this.mutationsObserver_ = null, this.mutationEventsAdded_ = !1, this.connected_ = !1);
        }, V.prototype.onTransitionEnd_ = function(U) {
          var W = U.propertyName, ce = W === void 0 ? "" : W;
          g.some(function(ue) {
            return !!~ce.indexOf(ue);
          }) && this.refresh();
        }, V.getInstance = function() {
          return this.instance_ || (this.instance_ = new V()), this.instance_;
        }, V.instance_ = null, V;
      }(), _ = function(V, U) {
        for (var W = 0, ce = Object.keys(U); W < ce.length; W++) {
          var ue = ce[W];
          Object.defineProperty(V, ue, { value: U[ue], enumerable: !1, writable: !1, configurable: !0 });
        }
        return V;
      }, m = function(V) {
        return V && V.ownerDocument && V.ownerDocument.defaultView || d;
      }, y = k(0, 0, 0, 0);
      function v(V) {
        return parseFloat(V) || 0;
      }
      function x(V) {
        for (var U = [], W = 1; W < arguments.length; W++) U[W - 1] = arguments[W];
        return U.reduce(function(ce, ue) {
          return ce + v(V["border-" + ue + "-width"]);
        }, 0);
      }
      var C = typeof SVGGraphicsElement < "u" ? function(V) {
        return V instanceof m(V).SVGGraphicsElement;
      } : function(V) {
        return V instanceof m(V).SVGElement && typeof V.getBBox == "function";
      };
      function E(V) {
        return u ? C(V) ? function(U) {
          var W = U.getBBox();
          return k(0, 0, W.width, W.height);
        }(V) : function(U) {
          var W = U.clientWidth, ce = U.clientHeight;
          if (!W && !ce) return y;
          var ue = m(U).getComputedStyle(U), xe = function(he) {
            for (var be = {}, me = 0, oe = ["top", "right", "bottom", "left"]; me < oe.length; me++) {
              var Qe = oe[me], Ae = he["padding-" + Qe];
              be[Qe] = v(Ae);
            }
            return be;
          }(ue), H = xe.left + xe.right, ee = xe.top + xe.bottom, se = v(ue.width), K = v(ue.height);
          if (ue.boxSizing === "border-box" && (Math.round(se + H) !== W && (se -= x(ue, "left", "right") + H), Math.round(K + ee) !== ce && (K -= x(ue, "top", "bottom") + ee)), !function(he) {
            return he === m(he).document.documentElement;
          }(U)) {
            var re = Math.round(se + H) - W, J = Math.round(K + ee) - ce;
            Math.abs(re) !== 1 && (se -= re), Math.abs(J) !== 1 && (K -= J);
          }
          return k(xe.left, xe.top, se, K);
        }(V) : y;
      }
      function k(V, U, W, ce) {
        return { x: V, y: U, width: W, height: ce };
      }
      var L = function() {
        function V(U) {
          this.broadcastWidth = 0, this.broadcastHeight = 0, this.contentRect_ = k(0, 0, 0, 0), this.target = U;
        }
        return V.prototype.isActive = function() {
          var U = E(this.target);
          return this.contentRect_ = U, U.width !== this.broadcastWidth || U.height !== this.broadcastHeight;
        }, V.prototype.broadcastRect = function() {
          var U = this.contentRect_;
          return this.broadcastWidth = U.width, this.broadcastHeight = U.height, U;
        }, V;
      }(), M = function(V, U) {
        var W, ce, ue, xe, H, ee, se, K = (ce = (W = U).x, ue = W.y, xe = W.width, H = W.height, ee = typeof DOMRectReadOnly < "u" ? DOMRectReadOnly : Object, se = Object.create(ee.prototype), _(se, { x: ce, y: ue, width: xe, height: H, top: ue, right: ce + xe, bottom: H + ue, left: ce }), se);
        _(this, { target: V, contentRect: K });
      }, G = function() {
        function V(U, W, ce) {
          if (this.activeObservations_ = [], this.observations_ = new c(), typeof U != "function") throw new TypeError("The callback provided as parameter 1 is not a function.");
          this.callback_ = U, this.controller_ = W, this.callbackCtx_ = ce;
        }
        return V.prototype.observe = function(U) {
          if (!arguments.length) throw new TypeError("1 argument required, but only 0 present.");
          if (typeof Element < "u" && Element instanceof Object) {
            if (!(U instanceof m(U).Element)) throw new TypeError('parameter 1 is not of type "Element".');
            var W = this.observations_;
            W.has(U) || (W.set(U, new L(U)), this.controller_.addObserver(this), this.controller_.refresh());
          }
        }, V.prototype.unobserve = function(U) {
          if (!arguments.length) throw new TypeError("1 argument required, but only 0 present.");
          if (typeof Element < "u" && Element instanceof Object) {
            if (!(U instanceof m(U).Element)) throw new TypeError('parameter 1 is not of type "Element".');
            var W = this.observations_;
            W.has(U) && (W.delete(U), W.size || this.controller_.removeObserver(this));
          }
        }, V.prototype.disconnect = function() {
          this.clearActive(), this.observations_.clear(), this.controller_.removeObserver(this);
        }, V.prototype.gatherActive = function() {
          var U = this;
          this.clearActive(), this.observations_.forEach(function(W) {
            W.isActive() && U.activeObservations_.push(W);
          });
        }, V.prototype.broadcastActive = function() {
          if (this.hasActive()) {
            var U = this.callbackCtx_, W = this.activeObservations_.map(function(ce) {
              return new M(ce.target, ce.broadcastRect());
            });
            this.callback_.call(U, W, U), this.clearActive();
          }
        }, V.prototype.clearActive = function() {
          this.activeObservations_.splice(0);
        }, V.prototype.hasActive = function() {
          return this.activeObservations_.length > 0;
        }, V;
      }(), Y = typeof WeakMap < "u" ? /* @__PURE__ */ new WeakMap() : new c(), ie = function V(U) {
        if (!(this instanceof V)) throw new TypeError("Cannot call a class as a function.");
        if (!arguments.length) throw new TypeError("1 argument required, but only 0 present.");
        var W = S.getInstance(), ce = new G(U, W, this);
        Y.set(this, ce);
      };
      ["observe", "unobserve", "disconnect"].forEach(function(V) {
        ie.prototype[V] = function() {
          var U;
          return (U = Y.get(this))[V].apply(U, arguments);
        };
      });
      const X = d.ResizeObserver !== void 0 ? d.ResizeObserver : ie;
    }, 413: (o, l, a) => {
      a.r(l), a.d(l, { default: () => k });
      var c = a(379), u = a.n(c), d = a(795), f = a.n(d), g = a(569), p = a.n(g), S = a(565), _ = a.n(S), m = a(216), y = a.n(m), v = a(589), x = a.n(v), C = a(582), E = {};
      E.styleTagTransform = x(), E.setAttributes = _(), E.insert = p().bind(null, "head"), E.domAPI = f(), E.insertStyleElement = y(), u()(C.Z, E);
      const k = C.Z && C.Z.locals ? C.Z.locals : void 0;
    }, 379: (o) => {
      var l = [];
      function a(d) {
        for (var f = -1, g = 0; g < l.length; g++) if (l[g].identifier === d) {
          f = g;
          break;
        }
        return f;
      }
      function c(d, f) {
        for (var g = {}, p = [], S = 0; S < d.length; S++) {
          var _ = d[S], m = f.base ? _[0] + f.base : _[0], y = g[m] || 0, v = "".concat(m, " ").concat(y);
          g[m] = y + 1;
          var x = a(v), C = { css: _[1], media: _[2], sourceMap: _[3], supports: _[4], layer: _[5] };
          if (x !== -1) l[x].references++, l[x].updater(C);
          else {
            var E = u(C, f);
            f.byIndex = S, l.splice(S, 0, { identifier: v, updater: E, references: 1 });
          }
          p.push(v);
        }
        return p;
      }
      function u(d, f) {
        var g = f.domAPI(f);
        return g.update(d), function(p) {
          if (p) {
            if (p.css === d.css && p.media === d.media && p.sourceMap === d.sourceMap && p.supports === d.supports && p.layer === d.layer) return;
            g.update(d = p);
          } else g.remove();
        };
      }
      o.exports = function(d, f) {
        var g = c(d = d || [], f = f || {});
        return function(p) {
          p = p || [];
          for (var S = 0; S < g.length; S++) {
            var _ = a(g[S]);
            l[_].references--;
          }
          for (var m = c(p, f), y = 0; y < g.length; y++) {
            var v = a(g[y]);
            l[v].references === 0 && (l[v].updater(), l.splice(v, 1));
          }
          g = m;
        };
      };
    }, 569: (o) => {
      var l = {};
      o.exports = function(a, c) {
        var u = function(d) {
          if (l[d] === void 0) {
            var f = document.querySelector(d);
            if (window.HTMLIFrameElement && f instanceof window.HTMLIFrameElement) try {
              f = f.contentDocument.head;
            } catch {
              f = null;
            }
            l[d] = f;
          }
          return l[d];
        }(a);
        if (!u) throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");
        u.appendChild(c);
      };
    }, 216: (o) => {
      o.exports = function(l) {
        var a = document.createElement("style");
        return l.setAttributes(a, l.attributes), l.insert(a, l.options), a;
      };
    }, 565: (o, l, a) => {
      o.exports = function(c) {
        var u = a.nc;
        u && c.setAttribute("nonce", u);
      };
    }, 795: (o) => {
      o.exports = function(l) {
        var a = l.insertStyleElement(l);
        return { update: function(c) {
          (function(u, d, f) {
            var g = "";
            f.supports && (g += "@supports (".concat(f.supports, ") {")), f.media && (g += "@media ".concat(f.media, " {"));
            var p = f.layer !== void 0;
            p && (g += "@layer".concat(f.layer.length > 0 ? " ".concat(f.layer) : "", " {")), g += f.css, p && (g += "}"), f.media && (g += "}"), f.supports && (g += "}");
            var S = f.sourceMap;
            S && typeof btoa < "u" && (g += `
/*# sourceMappingURL=data:application/json;base64,`.concat(btoa(unescape(encodeURIComponent(JSON.stringify(S)))), " */")), d.styleTagTransform(g, u, d.options);
          })(a, l, c);
        }, remove: function() {
          (function(c) {
            if (c.parentNode === null) return !1;
            c.parentNode.removeChild(c);
          })(a);
        } };
      };
    }, 589: (o) => {
      o.exports = function(l, a) {
        if (a.styleSheet) a.styleSheet.cssText = l;
        else {
          for (; a.firstChild; ) a.removeChild(a.firstChild);
          a.appendChild(document.createTextNode(l));
        }
      };
    }, 607: function(o, l, a) {
      var c = this && this.__importDefault || function(f) {
        return f && f.__esModule ? f : { default: f };
      };
      Object.defineProperty(l, "__esModule", { value: !0 }), l.Cursor = l.default = void 0;
      var u = c(a(678));
      l.default = u.default;
      var d = c(a(353));
      l.Cursor = d.default, a(413);
    }, 353: (o, l) => {
      Object.defineProperty(l, "__esModule", { value: !0 });
      var a = function() {
        function c(u, d, f) {
          this.id = u, this.name = d, this.color = f, this.toggleNearCursor = this.toggleNearCursor.bind(this), this._toggleOpenedCursor = this._toggleOpenedCursor.bind(this), this._setHoverState = this._setHoverState.bind(this);
        }
        return c.prototype.build = function(u) {
          var d = document.createElement(c.CONTAINER_ELEMENT_TAG);
          d.classList.add(c.CURSOR_CLASS), d.id = "ql-cursor-".concat(this.id), d.innerHTML = u.template;
          var f = d.getElementsByClassName(c.SELECTION_CLASS)[0], g = d.getElementsByClassName(c.CARET_CONTAINER_CLASS)[0], p = g.getElementsByClassName(c.CARET_CLASS)[0], S = d.getElementsByClassName(c.FLAG_CLASS)[0];
          return S.style.backgroundColor = this.color, p.style.backgroundColor = this.color, d.getElementsByClassName(c.NAME_CLASS)[0].textContent = this.name, this._hideDelay = "".concat(u.hideDelayMs, "ms"), this._hideSpeedMs = u.hideSpeedMs, this._positionFlag = u.positionFlag, S.style.transitionDelay = this._hideDelay, S.style.transitionDuration = "".concat(this._hideSpeedMs, "ms"), this._el = d, this._selectionEl = f, this._caretEl = g, this._flagEl = S, g.addEventListener("mouseover", this._setHoverState, { passive: !0 }), this._el;
        }, c.prototype.show = function() {
          this._el.classList.remove(c.HIDDEN_CLASS);
        }, c.prototype.hide = function() {
          this._el.classList.add(c.HIDDEN_CLASS);
        }, c.prototype.remove = function() {
          this._el.parentNode.removeChild(this._el);
        }, c.prototype.toggleNearCursor = function(u, d) {
          var f = this._getCoordinates(), g = f.left, p = f.right, S = f.top, _ = f.bottom, m = u >= g && u <= p && d >= S && d <= _;
          return this._caretEl.classList.toggle(c.CONTAINER_HOVER_CLASS, m), m;
        }, c.prototype.toggleFlag = function(u) {
          var d = this;
          this._caretEl.classList.toggle(c.CONTAINER_HOVER_CLASS, u) || (this._flagEl.classList.add(c.NO_DELAY_CLASS), setTimeout(function() {
            return d._flagEl.classList.remove(c.NO_DELAY_CLASS);
          }, this._hideSpeedMs));
        }, c.prototype.updateCaret = function(u, d) {
          this._caretEl.style.top = "".concat(u.top, "px"), this._caretEl.style.left = "".concat(u.left, "px"), this._caretEl.style.height = "".concat(u.height, "px"), this._positionFlag ? this._positionFlag(this._flagEl, u, d) : this._updateCaretFlag(u, d);
        }, c.prototype.updateSelection = function(u, d) {
          var f = this;
          this._clearSelection(), u = u || [], u = Array.from(u), u = this._sanitize(u), (u = this._sortByDomPosition(u)).forEach(function(g) {
            return f._addSelection(g, d);
          });
        }, c.prototype._setHoverState = function() {
          document.addEventListener("mousemove", this._toggleOpenedCursor, { passive: !0 });
        }, c.prototype._toggleOpenedCursor = function(u) {
          var d = this.toggleNearCursor(u.clientX, u.clientY);
          this._caretEl.classList.toggle(c.CONTAINER_NO_POINTER_CLASS, d), d || document.removeEventListener("mousemove", this._toggleOpenedCursor);
        }, c.prototype._getCoordinates = function() {
          return this._caretEl.getBoundingClientRect();
        }, c.prototype._updateCaretFlag = function(u, d) {
          this._flagEl.style.width = "";
          var f = this._flagEl.getBoundingClientRect();
          this._flagEl.classList.remove(c.FLAG_FLIPPED_CLASS), u.left > d.width - f.width && this._flagEl.classList.add(c.FLAG_FLIPPED_CLASS), this._flagEl.style.left = "".concat(u.left, "px"), this._flagEl.style.top = "".concat(u.top, "px"), this._flagEl.style.width = "".concat(Math.ceil(f.width), "px");
        }, c.prototype._clearSelection = function() {
          this._selectionEl.innerHTML = "";
        }, c.prototype._addSelection = function(u, d) {
          var f = this._selectionBlock(u, d);
          this._selectionEl.appendChild(f);
        }, c.prototype._selectionBlock = function(u, d) {
          var f = document.createElement(c.SELECTION_ELEMENT_TAG);
          return f.classList.add(c.SELECTION_BLOCK_CLASS), f.style.top = "".concat(u.top - d.top, "px"), f.style.left = "".concat(u.left - d.left, "px"), f.style.width = "".concat(u.width, "px"), f.style.height = "".concat(u.height, "px"), f.style.backgroundColor = this.color, f.style.opacity = "0.3", f;
        }, c.prototype._sortByDomPosition = function(u) {
          return u.sort(function(d, f) {
            return d.top === f.top ? d.left - f.left : d.top - f.top;
          });
        }, c.prototype._sanitize = function(u) {
          var d = this, f = /* @__PURE__ */ new Set();
          return u.filter(function(g) {
            if (!g.width || !g.height) return !1;
            var p = d._serialize(g);
            return !f.has(p) && (f.add(p), !0);
          });
        }, c.prototype._serialize = function(u) {
          return ["top:".concat(u.top), "right:".concat(u.right), "bottom:".concat(u.bottom), "left:".concat(u.left)].join(";");
        }, c.CONTAINER_ELEMENT_TAG = "SPAN", c.SELECTION_ELEMENT_TAG = "SPAN", c.CURSOR_CLASS = "ql-cursor", c.SELECTION_CLASS = "ql-cursor-selections", c.SELECTION_BLOCK_CLASS = "ql-cursor-selection-block", c.CARET_CLASS = "ql-cursor-caret", c.CARET_CONTAINER_CLASS = "ql-cursor-caret-container", c.CONTAINER_HOVER_CLASS = "hover", c.CONTAINER_NO_POINTER_CLASS = "no-pointer", c.FLAG_CLASS = "ql-cursor-flag", c.FLAG_FLIPPED_CLASS = "flag-flipped", c.NAME_CLASS = "ql-cursor-name", c.HIDDEN_CLASS = "hidden", c.NO_DELAY_CLASS = "no-delay", c;
      }();
      l.default = a;
    }, 678: function(o, l, a) {
      var c = this && this.__createBinding || (Object.create ? function(v, x, C, E) {
        E === void 0 && (E = C);
        var k = Object.getOwnPropertyDescriptor(x, C);
        k && !("get" in k ? !x.__esModule : k.writable || k.configurable) || (k = { enumerable: !0, get: function() {
          return x[C];
        } }), Object.defineProperty(v, E, k);
      } : function(v, x, C, E) {
        E === void 0 && (E = C), v[E] = x[C];
      }), u = this && this.__setModuleDefault || (Object.create ? function(v, x) {
        Object.defineProperty(v, "default", { enumerable: !0, value: x });
      } : function(v, x) {
        v.default = x;
      }), d = this && this.__importStar || function(v) {
        if (v && v.__esModule) return v;
        var x = {};
        if (v != null) for (var C in v) C !== "default" && Object.prototype.hasOwnProperty.call(v, C) && c(x, v, C);
        return u(x, v), x;
      }, f = this && this.__importDefault || function(v) {
        return v && v.__esModule ? v : { default: v };
      };
      Object.defineProperty(l, "__esModule", { value: !0 });
      var g = f(a(353)), p = d(a(165)), S = f(a(338)), _ = f(a(33)), m = a(895), y = function() {
        function v(x, C) {
          C === void 0 && (C = {}), this._cursors = {}, this._isObserving = !1, this._handleCursorTouch = this._handleCursorTouch.bind(this), this.quill = x, this.options = this._setDefaults(C), this._container = this.quill.addContainer(this.options.containerClass), this._boundsContainer = this.options.boundsContainer || this.quill.container, this._currentSelection = this.quill.getSelection(), this._registerSelectionChangeListeners(), this._registerTextChangeListener(), this._registerDomListeners();
        }
        return v.prototype.createCursor = function(x, C, E) {
          var k = this._cursors[x];
          if (!k) {
            k = new g.default(x, C, E), this._cursors[x] = k;
            var L = k.build(this.options);
            this._container.appendChild(L);
          }
          return k;
        }, v.prototype.moveCursor = function(x, C) {
          var E = this._cursors[x];
          E && (E.range = C, this._updateCursor(E));
        }, v.prototype.removeCursor = function(x) {
          var C = this._cursors[x];
          C && (C.remove(), delete this._cursors[x]);
        }, v.prototype.update = function() {
          var x = this;
          this.cursors().forEach(function(C) {
            return x._updateCursor(C);
          });
        }, v.prototype.clearCursors = function() {
          var x = this;
          this.cursors().forEach(function(C) {
            return x.removeCursor(C.id);
          });
        }, v.prototype.toggleFlag = function(x, C) {
          var E = this._cursors[x];
          E && E.toggleFlag(C);
        }, v.prototype.cursors = function() {
          var x = this;
          return Object.keys(this._cursors).map(function(C) {
            return x._cursors[C];
          });
        }, v.prototype._registerSelectionChangeListeners = function() {
          var x = this;
          this.quill.on(this.quill.constructor.events.SELECTION_CHANGE, function(C) {
            x._currentSelection = C;
          });
        }, v.prototype._registerTextChangeListener = function() {
          var x = this;
          this.quill.on(this.quill.constructor.events.TEXT_CHANGE, function(C) {
            return x._handleTextChange(C);
          });
        }, v.prototype._registerDomListeners = function() {
          var x = this, C = this.quill.container.getElementsByClassName("ql-editor")[0];
          C.addEventListener("scroll", function() {
            return x.update();
          }, { passive: !0 }), C.addEventListener("touchstart", this._handleCursorTouch, { passive: !0 });
        }, v.prototype._handleCursorTouch = function(x) {
          var C = this;
          this.cursors().forEach(function(E) {
            E.toggleNearCursor(x.pageX, x.pageY), setTimeout(function() {
              return E.toggleFlag(!1);
            }, C.options.hideDelayMs);
          });
        }, v.prototype._registerResizeObserver = function() {
          var x = this;
          if (!this._isObserving) {
            var C = this.quill.container.getElementsByClassName("ql-editor")[0], E = new _.default(function(k) {
              if (!k[0].target.isConnected) return E.disconnect(), void (x._isObserving = !1);
              x.update();
            });
            E.observe(C), this._isObserving = !0;
          }
        }, v.prototype._updateCursor = function(x) {
          if (this._registerResizeObserver(), !x.range) return x.hide();
          var C = this._indexWithinQuillBounds(x.range.index), E = this._indexWithinQuillBounds(x.range.index + x.range.length), k = this.quill.getLeaf(C), L = this.quill.getLeaf(E);
          if (!this._leafIsValid(k) || !this._leafIsValid(L)) return x.hide();
          x.show();
          var M = this._boundsContainer.getBoundingClientRect(), G = this.quill.getBounds(E);
          x.updateCaret(G, M);
          var Y = this._lineRanges(x, k, L).reduce(function(ie, X) {
            return ie.concat(Array.from(p.getClientRects(X)));
          }, []);
          x.updateSelection(Y, M);
        }, v.prototype._indexWithinQuillBounds = function(x) {
          var C = this.quill.getLength(), E = C ? C - 1 : 0;
          return x = Math.max(x, 0), Math.min(x, E);
        }, v.prototype._leafIsValid = function(x) {
          return x && x[0] && x[0].domNode && x[1] >= 0;
        }, v.prototype._handleTextChange = function(x) {
          var C = this;
          window.setTimeout(function() {
            C.options.transformOnTextChange && C._transformCursors(x), C.options.selectionChangeSource && (C._emitSelection(), C.update());
          });
        }, v.prototype._emitSelection = function() {
          this.quill.emitter.emit(this.quill.constructor.events.SELECTION_CHANGE, this.quill.getSelection(), this._currentSelection, this.options.selectionChangeSource);
        }, v.prototype._setDefaults = function(x) {
          return (x = Object.assign({}, x)).template || (x.template = v.DEFAULTS.template), x.containerClass || (x.containerClass = v.DEFAULTS.containerClass), x.selectionChangeSource !== null && (x.selectionChangeSource || (x.selectionChangeSource = v.DEFAULTS.selectionChangeSource)), x.hideDelayMs = Number.isInteger(x.hideDelayMs) ? x.hideDelayMs : v.DEFAULTS.hideDelayMs, x.hideSpeedMs = Number.isInteger(x.hideSpeedMs) ? x.hideSpeedMs : v.DEFAULTS.hideSpeedMs, x.transformOnTextChange = !!x.transformOnTextChange, x;
        }, v.prototype._lineRanges = function(x, C, E) {
          var k = this.quill.getLines(x.range);
          return k.reduce(function(L, M, G) {
            if (!M.children) {
              var Y = document.createRange();
              return Y.selectNode(M.domNode), L.concat(Y);
            }
            var ie = G === 0 ? C : M.path(0).pop(), X = ie[0], V = ie[1], U = G === k.length - 1 ? E : M.path(M.length() - 1).pop(), W = U[0], ce = U[1], ue = document.createRange();
            return X.domNode.nodeType === Node.TEXT_NODE ? ue.setStart(X.domNode, V) : ue.setStartBefore(X.domNode), W.domNode.nodeType === Node.TEXT_NODE ? ue.setEnd(W.domNode, ce) : ue.setEndAfter(W.domNode), L.concat(ue);
          }, []);
        }, v.prototype._transformCursors = function(x) {
          var C = this;
          x = new m(x), this.cursors().filter(function(E) {
            return E.range;
          }).forEach(function(E) {
            E.range.index = x.transformPosition(E.range.index), C._updateCursor(E);
          });
        }, v.DEFAULTS = { template: S.default, containerClass: "ql-cursors", selectionChangeSource: "api", hideDelayMs: 3e3, hideSpeedMs: 400 }, v;
      }();
      l.default = y;
    }, 338: function(o, l, a) {
      var c = this && this.__importDefault || function(f) {
        return f && f.__esModule ? f : { default: f };
      };
      Object.defineProperty(l, "__esModule", { value: !0 });
      var u = c(a(353)), d = `
  <span class="`.concat(u.default.SELECTION_CLASS, `"></span>
  <span class="`).concat(u.default.CARET_CONTAINER_CLASS, `">
    <span class="`).concat(u.default.CARET_CLASS, `"></span>
  </span>
  <div class="`).concat(u.default.FLAG_CLASS, `">
    <small class="`).concat(u.default.NAME_CLASS, `"></small>
  </div>
`);
      l.default = d;
    } }, r = {};
    function i(o) {
      var l = r[o];
      if (l !== void 0) return l.exports;
      var a = r[o] = { id: o, loaded: !1, exports: {} };
      return n[o].call(a.exports, a, a.exports, i), a.loaded = !0, a.exports;
    }
    i.n = (o) => {
      var l = o && o.__esModule ? () => o.default : () => o;
      return i.d(l, { a: l }), l;
    }, i.d = (o, l) => {
      for (var a in l) i.o(l, a) && !i.o(o, a) && Object.defineProperty(o, a, { enumerable: !0, get: l[a] });
    }, i.g = function() {
      if (typeof globalThis == "object") return globalThis;
      try {
        return this || new Function("return this")();
      } catch {
        if (typeof window == "object") return window;
      }
    }(), i.o = (o, l) => Object.prototype.hasOwnProperty.call(o, l), i.r = (o) => {
      typeof Symbol < "u" && Symbol.toStringTag && Object.defineProperty(o, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(o, "__esModule", { value: !0 });
    }, i.nmd = (o) => (o.paths = [], o.children || (o.children = []), o), i.nc = void 0;
    var s = i(607);
    return s.default;
  })());
})(Qv);
var jL = Qv.exports;
const GL = /* @__PURE__ */ zd(jL), FL = "_editor_lkywv_43", VL = "_overlay_lkywv_91", HL = "_toolbar_lkywv_127", zL = "_label_lkywv_251", jr = {
  "st-collaborative-edit": "_st-collaborative-edit_lkywv_1",
  editor: FL,
  overlay: VL,
  toolbar: HL,
  "toolbar-collaborators": "_toolbar-collaborators_lkywv_183",
  "toolbar-actions": "_toolbar-actions_lkywv_203",
  "toolbar-status": "_toolbar-status_lkywv_221",
  label: zL,
  "non-focused-toolbar": "_non-focused-toolbar_lkywv_273"
};
var Wl = /* @__PURE__ */ T("<div>"), WL = /* @__PURE__ */ T('<span style=color:green;><i class="fas fa-rotate fa-spin"></i>Saving...'), JL = /* @__PURE__ */ T('<i class="fas fa-cloud-arrow-up">'), QL = /* @__PURE__ */ T("<div><div><img src=Images/ST/CollaborativeEdit.svg width=20 height=20></div><div><div class=template></div></div><div></div><div>"), KL = /* @__PURE__ */ T('<div style=color:green;flex-grow:1;display:flex;align-items:center;justify-content:end;gap:4px;><i class="fas fa-rotate fa-spin"></i>Saving...'), YL = /* @__PURE__ */ T("<div><div>");
Q.register("modules/cursors", GL);
const Kv = bt(), XL = () => Ir(Kv);
let ZL = class {
  insertTemplate;
};
class eN {
  srcName = "";
  identity = "";
  originalValue = "";
  richText = !1;
  placeholder = "";
  rows = "";
  cols = "";
  label = "";
  readonly = !1;
  onValueSet = () => {
  };
  onPropertySaved = () => {
  };
  events = new ZL();
}
function Bu(t) {
  const e = P(() => t.srcName), n = P(() => t.identity), r = P(() => t.readonly ?? !1), i = new qL(e, n, r, t.richText ?? !1, t.onValueSet, t.onPropertySaved);
  return t.events && (t.events.insertTemplate = (s) => {
    i.session?.editor?.insertText(i.session?.editor.getSelection()?.index ?? 0, s, "user");
  }), h(Kv.Provider, {
    value: i,
    get children() {
      return h(tN, t);
    }
  });
}
function tN(t) {
  const e = XL(), [n, r] = I(t.cols ? parseInt(t.cols) : 0), [i, s] = I(t.rows ? parseInt(t.rows) : 0), o = P(() => `${n()}ch`), l = P(() => `calc(${i()}lh)`), a = () => {
    e.session?.destroy();
  };
  jt(() => {
    window.addEventListener("beforeunload", a);
  }), Gn(() => {
    window.removeEventListener("beforeunload", a), a();
  }), Z(() => {
    e.session?.editor?.enable(!t.readonly), t.readonly && e.session?.destroy();
  });
  const c = (f) => {
    e.setContainer(f);
  }, u = P(() => e.isFocused() || e.isFullscreen());
  let d;
  return Z((f) => (f && !e.isFocused() && e.save(), e.isFocused())), (() => {
    var f = Wl(), g = d;
    return typeof g == "function" ? Le(g, f) : d = f, w(f, h(id, {
      get mount() {
        return e.isFullscreen() ? document.body : d;
      },
      get children() {
        var p = YL(), S = p.firstChild;
        return w(p, h(B, {
          get when() {
            return u();
          },
          get children() {
            return [(() => {
              var _ = Wl();
              return R(() => D(_, jr.overlay)), _;
            })(), (() => {
              var _ = QL(), m = _.firstChild;
              m.firstChild;
              var y = m.nextSibling, v = y.firstChild, x = y.nextSibling, C = x.nextSibling;
              return w(m, () => t.label, null), w(y, h(ne, {
                style: "font-size: 0.7em;",
                icon: "fas fa-file",
                onClick: (E) => {
                  window.ST.Actions.EditText && window.ST.Actions.EditText.ShowTemplates && window.ST.Actions.EditText.ShowTemplates.call(E.currentTarget);
                }
              }), v), w(y, h(B, {
                get when() {
                  return !e.isFullscreen();
                },
                get children() {
                  return h(Zn, {
                    get children() {
                      return [h(ne, {
                        style: "font-size: 0.7em;",
                        icon: "fas fa-chevron-down",
                        onClick: () => s(Math.max(5, i() - 5))
                      }), h(ne, {
                        style: "font-size: 0.7em;",
                        icon: "fas fa-chevron-up",
                        onClick: () => s(i() + 5)
                      })];
                    }
                  });
                }
              }), v), w(y, h(ne, {
                style: "font-size: 0.7em;",
                icon: "fas fa-arrows-alt",
                onClick: () => e.setIsFullscreen(!e.isFullscreen())
              }), v), w(x, h(B, {
                get when() {
                  return e.isSaving();
                },
                get children() {
                  return WL();
                }
              }), null), w(x, h(B, {
                get when() {
                  return !e.isSaving();
                },
                get children() {
                  return [JL(), "Up To Date"];
                }
              }), null), w(C, h(de, {
                get each() {
                  return e.activeCollaborators();
                },
                children: (E) => h(wg, {
                  collaborator: E
                })
              })), R((E) => {
                var k = jr.toolbar, L = jr.label, M = jr["toolbar-actions"], G = jr["toolbar-status"], Y = jr["toolbar-collaborators"];
                return k !== E.e && D(_, E.e = k), L !== E.t && D(m, E.t = L), M !== E.a && D(y, E.a = M), G !== E.o && D(x, E.o = G), Y !== E.i && D(C, E.i = Y), E;
              }, {
                e: void 0,
                t: void 0,
                a: void 0,
                o: void 0,
                i: void 0
              }), _;
            })()];
          }
        }), S), w(p, h(B, {
          get when() {
            return !u();
          },
          get children() {
            var _ = Wl();
            return w(_, h(B, {
              get when() {
                return e.isSaving();
              },
              get children() {
                var m = KL();
                return R(() => D(m, jr["toolbar-status"])), m;
              }
            }), null), w(_, h(de, {
              get each() {
                return e.activeCollaborators();
              },
              children: (m) => h(wg, {
                collaborator: m
              })
            }), null), R(() => D(_, jr["non-focused-toolbar"])), _;
          }
        }), S), Le(c, S), R((_) => {
          var m = jr["st-collaborative-edit"], y = e.isFullscreen() ? {} : {
            width: o(),
            height: l()
          }, v = e.readonly(), x = e.isFocused(), C = e.isFullscreen(), E = !!t.richText, k = jr.editor;
          return m !== _.e && D(p, _.e = m), _.t = Yn(p, y, _.t), v !== _.a && ye(p, "data-readonly", _.a = v), x !== _.o && ye(p, "data-focused", _.o = x), C !== _.i && ye(p, "data-fullscreen", _.i = C), E !== _.n && ye(p, "data-richtext", _.n = E), k !== _.s && D(S, _.s = k), _;
        }, {
          e: void 0,
          t: void 0,
          a: void 0,
          o: void 0,
          i: void 0,
          n: void 0,
          s: void 0
        }), p;
      }
    })), f;
  })();
}
Bu.defaultProps = new eN();
const wg = (t) => {
  const [e, n, r] = t.collaborator.color.slice(1).match(/.{1,2}/g) ?? ["00", "00", "00"], i = Fc(parseInt(e, 16)), s = Fc(parseInt(n, 16)), o = Fc(parseInt(r, 16)), l = 0.2126 * i + 0.7152 * s + 0.0722 * o, a = (l + 0.05) / 0.05, c = 1.05 / (l + 0.05), u = a > c ? "#000000" : "#FFFFFF";
  return (() => {
    var d = Wl();
    return Le(tooltip, d, () => t.collaborator.name), u != null ? d.style.setProperty("color", u) : d.style.removeProperty("color"), d.style.setProperty("border-radius", "50%"), d.style.setProperty("width", "28px"), d.style.setProperty("height", "28px"), d.style.setProperty("display", "flex"), d.style.setProperty("align-items", "center"), d.style.setProperty("justify-content", "center"), w(d, () => t.collaborator.initials), R((f) => (f = t.collaborator.color) != null ? d.style.setProperty("background-color", f) : d.style.removeProperty("background-color")), d;
  })();
}, Fc = (t) => (t = t / 255, t <= 0.03928 ? t / 12.92 : ((t + 0.055) / 1.055) ** 2.4);
class nN {
  dirty;
  value;
  setValue;
  oldValue;
  setOldValue;
  type;
  constructor(e, n, r = "string") {
    [this.value, this.setValue] = e, [this.oldValue, this.setOldValue] = n, this.type = r, this.dirty = P(() => !this.isEqual(this.value(), this.oldValue()));
  }
  undo() {
    this.setValue(() => this.oldValue());
  }
  isEqual(e, n) {
    switch (this.type) {
      case "string":
        return e === n;
      case "date":
        return Nl(e) && Nl(n) ? e.getDate() === n.getDate() && e.getMonth() === n.getMonth() && e.getFullYear() === n.getFullYear() : e?.toString() === n?.toString();
      case "time":
        return Nl(e) && Nl(n) ? e.getHours() === n.getHours() && e.getMinutes() === n.getMinutes() : e?.toString() === n?.toString();
    }
  }
}
const Nl = (t) => t instanceof Date || t?.constructor === Date, _g = {
  "st-view-control": "_st-view-control_1frdu_1",
  "actions-container": "_actions-container_1frdu_25"
};
var rN = /* @__PURE__ */ T("<label>"), iN = /* @__PURE__ */ T("<div><div>");
const Yv = bt(), sN = () => Ir(Yv);
class oN {
  value;
  oldValue;
  label;
  type;
  srcObject;
  srcElement;
  affectsStatus;
}
function Ia(t) {
  const e = t.oldValue ?? I(t.value[0]()), n = new nN(t.value, e, t.type);
  return h(Yv.Provider, {
    value: n,
    get children() {
      return h(lN, t);
    }
  });
}
function lN(t) {
  const e = sN();
  return jt(async () => {
  }), (() => {
    var n = iN(), r = n.firstChild;
    return w(r, h(B, {
      get when() {
        return P(() => !!t.affectsStatus)() && e.dirty();
      },
      get children() {
        return h(ne, {
          style: "font-size: 0.8em; padding: 4px;",
          icon: "fa fa-arrow-rotate-left",
          type: "warning",
          onClick: () => e.undo()
        });
      }
    })), w(n, h(B, {
      get when() {
        return t.label;
      },
      get children() {
        var i = rN();
        return w(i, () => t.label), i;
      }
    }), null), w(n, () => t.children, null), R((i) => {
      var s = `${_g["st-view-control"]} flexbox`, o = _g["actions-container"];
      return s !== i.e && D(n, i.e = s), o !== i.t && D(r, i.t = o), i;
    }, {
      e: void 0,
      t: void 0
    }), n;
  })();
}
Ia.defaultProps = new oN();
class aN {
  componentName = "";
  viewId = "";
  identity = "";
  srcObject = "";
  srcElement = "";
  affectsStatus = "";
  primaryObjectGU = "";
  value = "";
  events = {
    onValueSet: (e) => {
    },
    refresh: () => {
    },
    setValue: (e) => {
    },
    setOldValue: (e) => {
    },
    setProps: (e) => {
    }
  };
}
function Uu(t) {
  const [e, n] = I(void 0), [r, i] = I(void 0), [s, o] = I({}), l = P(() => t.affectsStatus === "true");
  jt(() => {
    Z((g) => {
      g !== e() && t.events?.onValueSet && t.events?.onValueSet(e());
    }, e());
  });
  const {
    component: a,
    defaultProps: c
  } = window.solidComponents[t.componentName];
  t.events && (t.events.setValue = n, t.events.setProps = o, t.events.setOldValue = i);
  const u = P(() => ({
    ...c,
    ...s() ?? {}
  })), d = new Op();
  d.events = t.events ?? {};
  function f() {
    return Z(() => d.setViewId(t.viewId ?? "")), Z(() => d.setIdentity(t.identity ?? "")), Z(() => d.setPrimaryObjectGU(t.primaryObjectGU ?? "")), h(Ia, {
      value: [e, n],
      oldValue: [r, i],
      get srcElement() {
        return t.srcElement;
      },
      get srcObject() {
        return t.srcObject;
      },
      get affectsStatus() {
        return l();
      },
      get children() {
        return h(a, Xt({
          get srcElement() {
            return t.srcElement;
          },
          get srcObject() {
            return t.srcObject;
          }
        }, u, {
          get value() {
            return e();
          },
          setValue: n
        }));
      }
    });
  }
  return h(ja.Provider, {
    value: d,
    get children() {
      return h(Ty.Provider, {
        value: new Ay(),
        get children() {
          return h(f, {});
        }
      });
    }
  });
}
Uu.defaultProps = new aN();
var cN = /* @__PURE__ */ T('<div style="padding:10px 15px;max-width:320px;text-align:center">'), uN = /* @__PURE__ */ T('<div class="flexbox horizontal middle padded"><div class=auto></div><div></div><div></div><div class=auto>');
function Xv(t, e) {
  return new Promise((n, r) => {
    const i = document.createElement("div");
    document.body.appendChild(i);
    let s = () => {
    };
    s = Kg(() => h(Oa, {
      onClose: () => {
        s(), i.remove();
      },
      onYes: n,
      onNo: r,
      title: t,
      prompt: e
    }), i);
  });
}
class dN {
  onClose;
  onYes = () => {
  };
  onNo = () => {
  };
  title = "";
  prompt = "";
}
function Oa(t) {
  const [e, n] = I(!0);
  return Z(() => {
    e() || t.onClose?.call(t);
  }), h(Gt, {
    get title() {
      return t.title;
    },
    show: [e, n],
    get children() {
      return [(() => {
        var r = cN();
        return w(r, () => t.prompt), r;
      })(), (() => {
        var r = uN(), i = r.firstChild, s = i.nextSibling, o = s.nextSibling;
        return w(s, h(ne, {
          focused: !0,
          type: "success",
          icon: "fa fa-check",
          onClick: () => {
            n(!1), t.onYes();
          },
          children: "Yes"
        })), w(o, h(ne, {
          type: "default",
          icon: "fa fa-times",
          onClick: () => {
            n(!1), t.onNo();
          },
          children: "No"
        })), r;
      })()];
    }
  });
}
Oa.defaultProps = new dN();
class hN {
  constructor() {
  }
}
const An = {
  "st-support-assist": "_st-support-assist_1fs5j_1",
  "chat-result-container": "_chat-result-container_1fs5j_39",
  "chat-result-layout": "_chat-result-layout_1fs5j_55",
  "response-container": "_response-container_1fs5j_83",
  "response-left-col": "_response-left-col_1fs5j_97",
  "response-avatar": "_response-avatar_1fs5j_111",
  "reference-toggle": "_reference-toggle_1fs5j_131",
  "response-card": "_response-card_1fs5j_141",
  "fade-in": "_fade-in_1fs5j_1",
  "response-reference": "_response-reference_1fs5j_181",
  "response-reference-content": "_response-reference-content_1fs5j_197",
  "response-card-actions": "_response-card-actions_1fs5j_213",
  "reference-title": "_reference-title_1fs5j_227"
}, fN = {
  "st-textarea": "_st-textarea_d9i5e_1"
};
var gN = /* @__PURE__ */ T("<label><span></span><textarea>");
class pN {
  label;
  value;
  placeholder;
  selected = !1;
  focused = !1;
  required = !1;
}
function Qo(t) {
  const [e, n] = Wr(t, ["label", "value", "placeholder", "selected", "focused", "required", "class"]), [r, i] = t.value ?? I("");
  return (() => {
    var s = gN(), o = s.firstChild, l = o.nextSibling;
    return w(o, () => t.label), l.$$input = (a) => i(a.target.value), io(l, Xt({
      get placeholder() {
        return t.placeholder;
      },
      get class() {
        return fN["st-textarea"] + ` ${t.class ?? ""}`;
      },
      get value() {
        return r();
      }
    }, n), !1, !1), R(() => o.hidden = !t.label), s;
  })();
}
Qo.defaultProps = new pN();
Xe(["input"]);
const mN = {
  "st-image": "_st-image_1g61r_1"
};
var vN = /* @__PURE__ */ T("<img>");
class yN {
  alt;
}
function Ko(t) {
  const [e, n] = Wr(t, ["src", "class", "children"]), r = P(() => ed(t.src));
  return (() => {
    var i = vN();
    return io(i, Xt({
      get class() {
        return `${mN["st-image"]} ${e.class ?? ""}`;
      },
      get src() {
        return r();
      }
    }, n), !1, !1), i;
  })();
}
Ko.defaultProps = new yN();
var bN = /* @__PURE__ */ T('<div><div class="flexbox horizontal middle"><i class="fa fa-brain-circuit"style=padding-right:8px;font-size:32px;></i>Enter search criteria to identify documentation, ETNs and source resolved tickets to research</div><div style=display:flex;gap:1em;width:fit-content;align-self:start;></div><div style="width:100%;border-bottom:1px solid var(--st-panel-border);"></div><div>'), wN = /* @__PURE__ */ T('<div class="flexbox vertical middle">'), _N = /* @__PURE__ */ T("<i>"), SN = /* @__PURE__ */ T("<div>"), xN = /* @__PURE__ */ T("<div><div><div style=min-height:350px;><div><div></div></div><div></div></div></div><div style=max-height:100%;overflow-y:auto;>"), CN = /* @__PURE__ */ T("<span style=white-space:pre-wrap;>"), $N = /* @__PURE__ */ T("<div><div></div><div>"), EN = /* @__PURE__ */ T('<i class="fa fa-file-pdf"style=padding:8px;font-size:32px;>'), TN = /* @__PURE__ */ T('<i class="fa fa-file"style=padding:8px;font-size:32px;>'), AN = /* @__PURE__ */ T("<div><h3></h3><span>");
const Zv = bt(), B5 = () => Ir(Zv);
class kN {
  excludeSensitiveData;
}
function Da(t) {
  const e = new hN();
  return h(Zv.Provider, {
    value: e,
    get children() {
      return h(IN, t);
    }
  });
}
function IN(t) {
  const [e, n] = I(""), [r, i] = I(), [s, o] = I(!1), l = async () => {
    if (!s()) {
      o(!0);
      try {
        const u = await rd.Prompt(e(), t.excludeSensitiveData ?? !1);
        i(u);
      } catch {
      } finally {
        o(!1);
      }
    }
  }, a = () => {
    n(""), i(void 0);
  }, c = (u) => {
    u.key === "Enter" && !u.shiftKey && (l(), u.preventDefault(), u.stopPropagation());
  };
  return (() => {
    var u = bN(), d = u.firstChild, f = d.nextSibling, g = f.nextSibling, p = g.nextSibling;
    return d.style.setProperty("color", "var(--st-hint-fg, var(--st-color-dim-fg))"), w(u, h(Qo, {
      get disabled() {
        return s();
      },
      value: [e, n],
      label: "",
      rows: 7,
      onKeyDown: c
    }), f), w(f, h(ne, {
      icon: "fa fa-brain-circuit",
      get enabled() {
        return e().length > 0;
      },
      type: "primary",
      onClick: l,
      get loading() {
        return s();
      },
      children: "Submit"
    }), null), w(f, h(ne, {
      icon: "fa fa-rotate-left",
      get enabled() {
        return P(() => e().length > 0)() && !s();
      },
      type: "warning",
      onClick: a,
      children: "Clear All"
    }), null), w(p, h(DN, {
      get response() {
        return r();
      },
      get loading() {
        return s();
      }
    })), R((S) => {
      var _ = An["st-support-assist"], m = An["chat-result-container"];
      return _ !== S.e && D(u, S.e = _), m !== S.t && D(p, S.t = m), S;
    }, {
      e: void 0,
      t: void 0
    }), u;
  })();
}
function ON() {
  return (() => {
    var t = wN();
    return w(t, h(Zi, {
      processing: !0,
      size: "350px"
    })), t;
  })();
}
function DN(t) {
  const e = P(() => {
    let u = 0;
    return t.response?.citations?.map((d) => d.references?.map(() => u++) ?? []) ?? [];
  }), [n, r] = I(!0), [i, s] = I(!1), [o, l] = I(void 0);
  Z(() => {
    t.response, l(void 0);
  });
  const a = async (u) => {
    if (!i())
      try {
        await rd.SetUserRating(t.response.aiLogGU, u), l(u);
      } catch (d) {
        console.error(d);
      } finally {
        s(!1);
      }
  }, c = (u, d) => {
    document.querySelector(`[data-ref-idx="${e()[u][d] + 1}"]`)?.scrollIntoView({
      behavior: "smooth"
    });
  };
  return h(B, {
    get when() {
      return t.loading || t.response;
    },
    get children() {
      var u = xN(), d = u.firstChild, f = d.firstChild, g = f.firstChild, p = g.firstChild, S = g.nextSibling, _ = d.nextSibling;
      return w(p, h(Ko, {
        get classList() {
          return {
            "fa fa-spin": t.loading
          };
        },
        alt: "Synergy Logo",
        src: "Images/ST/synergy_logo_hires.png",
        width: "28px",
        height: "28px"
      })), w(g, h(B, {
        get when() {
          return !t.loading && t.response?.citations?.length;
        },
        get children() {
          var m = _N();
          return m.$$click = () => r(!n()), R((y) => {
            var v = An["reference-toggle"], x = {
              "fa fa-eye": !n(),
              "fa fa-eye-slash": n()
            };
            return v !== y.e && D(m, y.e = v), y.t = ro(m, x, y.t), y;
          }, {
            e: void 0,
            t: void 0
          }), m;
        }
      }), null), w(S, h(B, {
        get when() {
          return !t.loading;
        },
        get fallback() {
          return h(ON, {});
        },
        get children() {
          return h(Zt, {
            get children() {
              return h(Pe, {
                get when() {
                  return t.response.citations?.length > 0;
                },
                get children() {
                  return h(de, {
                    get each() {
                      return t.response.citations;
                    },
                    children: (m, y) => [(() => {
                      var v = CN();
                      return w(v, () => m.text), v;
                    })(), h(de, {
                      get each() {
                        return m.references;
                      },
                      children: (v, x) => h(Ve, {
                        get children() {
                          return [h(Ve.Trigger, {
                            action: "hover",
                            as: "span",
                            get class() {
                              return An["response-reference"];
                            },
                            onClick: (C) => (c(y(), x()), !0),
                            get children() {
                              return ["[", P(() => e()[y()][x()] + 1), "]"];
                            }
                          }), h(Ve.Content, {
                            get class() {
                              return An["response-reference-content"];
                            },
                            as: "div",
                            get children() {
                              return h(Sg, {
                                reference: v
                              });
                            }
                          })];
                        }
                      })
                    })]
                  });
                }
              });
            }
          });
        }
      })), w(d, h(B, {
        get when() {
          return !t.loading;
        },
        get children() {
          var m = SN();
          return w(m, h(ne, {
            icon: "fa fa-thumbs-down",
            get type() {
              return o() === !1 ? "danger" : "default";
            },
            onClick: () => a(!1),
            get loading() {
              return i();
            }
          }), null), w(m, h(ne, {
            icon: "fa fa-thumbs-up",
            get type() {
              return o() === !0 ? "success" : "default";
            },
            onClick: () => a(!0),
            get loading() {
              return i();
            }
          }), null), R(() => D(m, An["response-card-actions"])), m;
        }
      }), null), w(_, h(B, {
        get when() {
          return P(() => !t.loading)() && n();
        },
        get children() {
          return h(de, {
            get each() {
              return t.response?.citations;
            },
            children: (m, y) => h(de, {
              get each() {
                return m.references;
              },
              children: (v, x) => (() => {
                var C = $N(), E = C.firstChild, k = E.nextSibling;
                return w(E, () => "[" + (e()[y()][x()] + 1) + "]"), w(k, h(Sg, {
                  reference: v
                })), R((L) => {
                  var M = An["response-container"], G = An["response-reference"], Y = e()[y()][x()] + 1, ie = An["response-card"];
                  return M !== L.e && D(C, L.e = M), G !== L.t && D(E, L.t = G), Y !== L.a && ye(E, "data-ref-idx", L.a = Y), ie !== L.o && D(k, L.o = ie), L;
                }, {
                  e: void 0,
                  t: void 0,
                  a: void 0,
                  o: void 0
                }), C;
              })()
            })
          });
        }
      })), R((m) => {
        var y = An["chat-result-layout"], v = An["response-container"], x = An["response-left-col"], C = An["response-avatar"], E = An["response-card"];
        return y !== m.e && D(u, m.e = y), v !== m.t && D(f, m.t = v), x !== m.a && D(g, m.a = x), C !== m.o && D(p, m.o = C), E !== m.i && D(S, m.i = E), m;
      }, {
        e: void 0,
        t: void 0,
        a: void 0,
        o: void 0,
        i: void 0
      }), u;
    }
  });
}
function Sg(t) {
  const e = P(() => t.reference.title?.startsWith("Ticket: ") ? h(Ko, {
    alt: "Tickets Icon",
    src: "Images/ST_VIEW/TICKETS.svg",
    style: "padding: 8px; height: 46px;"
  }) : t.reference.title?.endsWith("pdf") ? EN() : TN()), n = async () => {
    if (t.reference.ticketGU)
      IS("C30E8A12-CAFD-4A7B-8302-B9F3C54B355C", void 0, t.reference.ticketGU);
    else if (t.reference.uri) {
      const r = await rd.GetPresignedUrl(t.reference.uri);
      r && window.open(r, "_blank");
    }
  };
  return (() => {
    var r = AN(), i = r.firstChild, s = i.nextSibling;
    return i.$$click = n, w(i, e, null), w(i, () => t.reference.title, null), s.style.setProperty("white-space", "pre-wrap"), w(s, () => t.reference.text), R(() => D(i, `${An["reference-title"]} flexbox horizontal middle`)), r;
  })();
}
Da.defaultProps = new kN();
Xe(["click"]);
class LN {
}
function ju(t) {
  return h(Da, {
    excludeSensitiveData: !0
  });
}
ju.defaultProps = new LN();
const yo = {
  "st-date-picker": "_st-date-picker_1iq6a_1",
  "picker-panel": "_picker-panel_1iq6a_13",
  "picker-calendar": "_picker-calendar_1iq6a_33",
  "picker-days": "_picker-days_1iq6a_49",
  "picker-day": "_picker-day_1iq6a_49"
};
var Vc = /* @__PURE__ */ T("<div>"), NN = /* @__PURE__ */ T('<i class="fa fa-chevron-left">'), PN = /* @__PURE__ */ T('<i class="fa fa-chevron-right">'), RN = /* @__PURE__ */ T("<div><div>");
class MN {
  value;
}
function Yo(t) {
  let e;
  const [n, r] = I(!1), [i, s] = t.value ?? I(void 0), o = P(() => i()?.getDate()), l = P(() => i()?.getMonth()), a = P(() => i()?.getFullYear()), [c, u] = I(""), [d, f] = I((/* @__PURE__ */ new Date()).getMonth()), [g, p] = I((/* @__PURE__ */ new Date()).getFullYear());
  Z(Tr(() => [i()], () => {
    const C = BN(i());
    c() !== C && u(C), f(i()?.getMonth() ?? (/* @__PURE__ */ new Date()).getMonth()), p(i()?.getFullYear() ?? (/* @__PURE__ */ new Date()).getFullYear());
  })), Z(() => {
    n() && setTimeout(() => e.focus(), 5);
  });
  const S = Ie(() => g().toString(), (C) => p(parseInt(C))), _ = Ie(() => d().toString(), (C) => f(parseInt(C))), m = P(() => {
    const C = [], k = new Date(g(), d(), 1).getDay(), L = new Date(g(), d(), 1 - k);
    for (let M = 0; M < 42; M++) {
      const G = new Date(L.getFullYear(), L.getMonth(), L.getDate() + M);
      C.push(G);
    }
    return C;
  }), y = (C) => {
    const E = new Date(g(), d() + C);
    p(E.getFullYear()), f(E.getMonth());
  }, v = (C) => {
    s(C);
  }, x = () => {
    const C = qN(c());
    C ? s(C) : c() && e.focus();
  };
  return (() => {
    var C = Vc();
    return w(C, h(Ve, {
      open: [n, r],
      get children() {
        return [h(Ve.Trigger, {
          get children() {
            return h(dt, {
              ref(E) {
                var k = e;
                typeof k == "function" ? k(E) : e = E;
              },
              value: [c, u],
              icon: "fa fa-calendar-days",
              onFocusOut: () => x()
            });
          }
        }), h(Ve.Content, {
          get children() {
            return [(() => {
              var E = Vc();
              return w(E, h(Ee, {
                value: _,
                get children() {
                  return h(de, {
                    get each() {
                      return Array.from({
                        length: 12
                      }, (k, L) => L);
                    },
                    children: (k) => h(Ee.Option, {
                      get value() {
                        return k.toString();
                      },
                      get children() {
                        return fe.monthIndexName(k);
                      }
                    })
                  });
                }
              }), null), w(E, h(Ee, {
                value: S,
                get displayValue() {
                  return g();
                },
                get children() {
                  return h(de, {
                    get each() {
                      return [...Array(79).keys()].map((k) => k + 1975);
                    },
                    children: (k) => h(Ee.Option, {
                      get value() {
                        return k.toString();
                      },
                      children: k
                    })
                  });
                }
              }), null), R(() => D(E, yo["picker-panel"])), E;
            })(), (() => {
              var E = RN(), k = E.firstChild;
              return w(E, h(ne, {
                onClick: () => y(-1),
                get children() {
                  return NN();
                }
              }), k), w(k, h(de, {
                get each() {
                  return m();
                },
                children: (L) => (() => {
                  var M = Vc();
                  return M.$$click = () => v(L), w(M, () => L.getDate()), R((G) => {
                    var Y = yo["picker-day"], ie = L.getMonth() != d(), X = o() == L.getDate() && l() == L.getMonth() && a() == L.getFullYear();
                    return Y !== G.e && D(M, G.e = Y), ie !== G.t && ye(M, "data-disabled", G.t = ie), X !== G.a && ye(M, "data-selected", G.a = X), G;
                  }, {
                    e: void 0,
                    t: void 0,
                    a: void 0
                  }), M;
                })()
              })), w(E, h(ne, {
                onClick: () => y(1),
                get children() {
                  return PN();
                }
              }), null), R((L) => {
                var M = yo["picker-calendar"], G = yo["picker-days"];
                return M !== L.e && D(E, L.e = M), G !== L.t && D(k, L.t = G), L;
              }, {
                e: void 0,
                t: void 0
              }), E;
            })()];
          }
        })];
      }
    })), R(() => D(C, yo["st-date-picker"])), C;
  })();
}
Yo.defaultProps = new MN();
const qN = (t) => {
  if (t.toLowerCase() === "t") return /* @__PURE__ */ new Date();
  const e = t.split("/");
  if (e.length != 3) return;
  const n = parseInt(e[0]) - 1, r = parseInt(e[1]), i = parseInt(e[2]);
  if (!(isNaN(r) || isNaN(n) || isNaN(i)))
    return new Date(i, n, r);
}, BN = (t) => t ? `${(t.getMonth() + 1).toString().padStart(2, "0")}/${t.getDate().toString().padStart(2, "0")}/${t.getFullYear()}` : "";
Xe(["click"]);
const UN = "_dorito_pai64_1", jN = {
  dorito: UN
};
var GN = /* @__PURE__ */ T("<span>");
class FN {
  tooltip = "";
  type = "info";
}
function li(t) {
  const e = P(() => {
    switch (t.type) {
      case "danger":
        return "upper-right";
      case "warning":
        return "lower-right";
      case "info":
        return "upper-left";
      default:
        return "upper-left";
    }
  });
  let n;
  return jt(() => {
    const r = n.parentElement;
    r && window.getComputedStyle(r).position === "static" && (r.style.position = "relative");
  }), (() => {
    var r = GN();
    Le(tooltip, r, () => t.tooltip);
    var i = n;
    return typeof i == "function" ? Le(i, r) : n = r, R((s) => {
      var o = jN.dorito, l = e(), a = t.type;
      return o !== s.e && D(r, s.e = o), l !== s.t && ye(r, "data-position", s.t = l), a !== s.a && ye(r, "data-type", s.a = a), s;
    }, {
      e: void 0,
      t: void 0,
      a: void 0
    }), r;
  })();
}
li.defaultProps = new FN();
class ey extends By {
  instanceId = Cr();
  isHighlighted;
  setIsHighlighted;
  constructor() {
    super(), [this.isHighlighted, this.setIsHighlighted] = I(!1);
  }
}
class ty {
  onRowClicked;
  onDeleteSearchCriteria;
  onOpenFindResults;
  onIsPinned;
  onReturnToSearch;
}
class VN {
  searchCriteria;
  setSearchCriteria;
  selectedRows;
  setSelectedRows;
  viewState;
  setViewState;
  events = new ty();
  constructor() {
    [this.searchCriteria, this.setSearchCriteria] = I(new zN()), [this.selectedRows, this.setSelectedRows] = I([]), [this.viewState, this.setViewState] = I(new DS());
  }
}
const ah = bt();
function HN() {
  return Nt(ah);
}
function ac() {
  return Ir(ah);
}
class zN {
  controls = {};
  grids = {};
}
const WN = "_skeleton_ccwsb_1", JN = {
  skeleton: WN
};
var QN = /* @__PURE__ */ T("<h2>"), KN = /* @__PURE__ */ T('<div style="text-align:right;padding:5px 10px">Total Rows: <strong></strong> (<!>ms)'), YN = /* @__PURE__ */ T('<div class="st-grid flexbox vertical"><div class="st-grid-container auto"><div class=virtual-content></div><div style=position:sticky;top:0;max-height:12px;padding-right:10px><table style=width:100%><thead></thead><tbody>'), XN = /* @__PURE__ */ T("<th>Line"), xg = /* @__PURE__ */ T("<tr>"), ZN = /* @__PURE__ */ T("<th scope=col>"), e2 = /* @__PURE__ */ T("<th>"), t2 = /* @__PURE__ */ T("<td class=empty-cell>"), n2 = /* @__PURE__ */ T("<td>"), r2 = /* @__PURE__ */ T("<input type=checkbox>"), i2 = /* @__PURE__ */ T("<select><option>"), s2 = /* @__PURE__ */ T("<span>"), o2 = /* @__PURE__ */ T("<div>"), l2 = /* @__PURE__ */ T("<div>Loading...");
const a2 = window.ST || {};
class c2 {
  definition;
  data;
  headerRows;
  constructor(e) {
    this.data = I(), this.definition = I(e), this.headerRows = P(() => {
      const n = this.definition[0]();
      return n?.columns.reduce((r, i) => {
        let s = o(i, 0);
        r[s].push(i);
        function o(l, a) {
          return r[a] || r.push([]), l.supertitles.forEach((c) => {
            const u = n.supertitles[c], d = r[a];
            d[d.length - 1] !== u && d.push(u), u.colSpan++, a++, r[a] || r.push([]);
          }), a;
        }
        return r;
      }, []) || [];
    });
  }
}
const Gu = bt({});
class ny {
  viewId = "";
  gridId = "";
  groupGu = void 0;
  events = new ty();
  selectedRows = I([]);
  ctx;
}
const Hc = {
  ...new ey(),
  identity: "EMPTY_ROW",
  values: {}
};
function La(t) {
  const e = t.ctx ?? new c2(), n = ac(), [r, i] = e.definition;
  let s;
  return Z(() => {
    const {
      viewId: o,
      gridId: l
    } = t, a = n.viewState();
    o && l && a.serverState?.PrimaryObjectGU && (clearTimeout(s), s = setTimeout(() => {
      Jg.GetGridDefinition(o, l, a).then(i);
    }, 100));
  }), h(Gu.Provider, {
    value: e,
    get children() {
      return h(B, {
        get when() {
          return r();
        },
        get fallback() {
          return h(g2, {});
        },
        get children() {
          return u2(t);
        }
      });
    }
  });
}
La.defaultProps = new ny();
function u2(t) {
  const e = ac(), n = Nt(Gu), {
    viewId: r,
    gridId: i,
    groupGu: s
  } = t, [o, l] = n.data, [a, c] = I(0), [u, d] = I(), [f, g] = I(24), [p, S] = I(20), [_, m] = I(!1), [y, v] = t.selectedRows;
  let x, C, E;
  const k = (H) => {
    S(Math.floor((x.clientHeight - E.clientHeight) / f()));
  };
  {
    let H;
    jt(() => {
      let ee = 0;
      H = setInterval(() => {
        x && ee != x.clientHeight && (ee == x.clientHeight, k());
      }, 200);
    }), Gn(() => {
      clearInterval(H);
    });
  }
  Z(() => {
    f(), x && k();
  }), Z(() => {
    if (a() > 0 && C) {
      const ee = Math.floor(Math.max(C.clientWidth, parseInt(C.style.minWidth)));
      C.style.minWidth = `${ee}px`;
    }
  }), Z(() => {
    const H = u()?.filter((ee) => ee.isHighlighted()).map((ee) => ee.identity || "");
    v(H || []);
  });
  let L = !1;
  Z(() => {
    const H = y(), ee = u() || [];
    if (!L) {
      L = !0;
      for (const se of ee)
        se.identity && H.includes(se.identity) ? se.setIsHighlighted(!0) : se.setIsHighlighted(!1);
      L = !1;
    }
  }), Z(() => {
    e.searchCriteria(), C && (C.style.minWidth = "");
  });
  function M() {
    jt(() => {
      window.addEventListener("resize", k), k();
    }), Gn(() => {
      window.removeEventListener("resize", k);
    });
    const [H, ee] = n.definition, se = P(() => (o()?.totalRows || 0) * f());
    return (() => {
      var K = YN(), re = K.firstChild, J = re.firstChild, he = J.nextSibling, be = he.firstChild, me = be.firstChild, oe = me.nextSibling;
      w(K, h(B, {
        get when() {
          return H()?.title;
        },
        get children() {
          var De = QN();
          return w(De, () => H().title), De;
        }
      }), re), w(K, h(B, {
        get when() {
          return !!o();
        },
        get children() {
          var De = KN(), Oe = De.firstChild, nt = Oe.nextSibling, We = nt.nextSibling, gt = We.nextSibling;
          return gt.nextSibling, w(nt, () => o().totalRows.toLocaleString()), w(De, () => o().duration, gt), De;
        }
      }), re), re.addEventListener("scroll", ie);
      var Qe = x;
      typeof Qe == "function" ? Le(Qe, re) : x = re;
      var Ae = C;
      typeof Ae == "function" ? Le(Ae, he) : C = he;
      var Ye = E;
      return typeof Ye == "function" ? Le(Ye, me) : E = me, w(me, h(de, {
        get each() {
          return n.headerRows();
        },
        children: (De, Oe) => (() => {
          var nt = xg();
          return w(nt, h(B, {
            get when() {
              return P(() => !!H().showLineSelector)() && Oe() === 0;
            },
            get children() {
              var We = XN();
              return R(() => ye(We, "rowspan", n.headerRows().length)), We;
            }
          }), null), w(nt, h(de, {
            each: De,
            children: (We, gt) => (() => {
              var ht = ZN();
              return w(ht, () => We.label), R((it) => {
                var ot = We?.rowSpan || 1, wt = We?.colSpan || 1;
                return ot !== it.e && ye(ht, "rowspan", it.e = ot), wt !== it.t && ye(ht, "colspan", it.t = wt), it;
              }, {
                e: void 0,
                t: void 0
              }), ht;
            })()
          }), null), nt;
        })()
      })), w(oe, h(de, {
        get each() {
          return u();
        },
        children: (De, Oe) => G(De, Oe())
      })), R((De) => (De = se() + "px") != null ? J.style.setProperty("height", De) : J.style.removeProperty("height")), K;
    })();
  }
  function G(H, ee) {
    const se = Nt(Gu), [K, re] = se.definition;
    function J(be) {
      window.requestAnimationFrame(() => {
        g(Math.max(f(), be.clientHeight));
      });
    }
    const he = new h2();
    return he.shape = 0, (() => {
      var be = xg();
      Ao(be, "click", X.bind(H), !0);
      var me = J;
      return typeof me == "function" ? Le(me, be) : J = be, w(be, h(B, {
        get when() {
          return K().showLineSelector;
        },
        get children() {
          var oe = e2();
          return w(oe, () => a() + ee + 1), oe;
        }
      }), null), w(be, h(B, {
        when: H === Hc,
        get children() {
          return h(de, {
            get each() {
              return Array(K().columns.length);
            },
            children: (oe, Qe) => (() => {
              var Ae = t2();
              return w(Ae, h(f2, he)), Ae;
            })()
          });
        }
      }), null), w(be, h(B, {
        when: H !== Hc,
        get children() {
          return h(de, {
            get each() {
              return H.values;
            },
            children: (oe, Qe) => (() => {
              var Ae = n2();
              return w(Ae, () => d2(K().columns[Qe()], oe)), Ae;
            })()
          });
        }
      }), null), R(() => be.classList.toggle("selected", !!H.isHighlighted())), be;
    })();
  }
  let Y = 0;
  function ie(H) {
    const ee = o()?.totalRows || 0, se = Math.ceil(this.scrollTop / (this.scrollHeight - E.clientHeight - 20) * ee);
    this.clientWidth > Y && (Y = this.clientWidth, this.style.minWidth = `${this.clientWidth}px`), c(Math.max(0, Math.min(se, ee - 20)));
  }
  function X(H) {
    const ee = this.isHighlighted();
    for (var se of xe)
      se?.setIsHighlighted(!1);
    this.setIsHighlighted(!ee), t.events.onRowClicked?.call(this, this, H);
  }
  let V, U = 0, W, ce = 0;
  function ue(H, ee = !1) {
    clearTimeout(W), !(H < 0 || !ee && H === o()?.startRow) && (U = H, W = setTimeout(async () => {
      if (V && await V, U !== H) return;
      V = Jg.LoadData(r, i, s || "", H, e.viewState());
      const se = await V;
      se ? (ce = 0, l(se)) : ce++ < 5 && ue(H), a2.DEBUGGING_COMPONENT && console.log(se);
    }, 150));
  }
  let xe = [];
  return Z(() => {
    const H = o(), ee = a();
    _();
    const se = Math.min(H?.totalRows || 0, p());
    if (H?.rows) {
      let K = H.startRow;
      H.rows.forEach((he) => {
        xe[K++] = {
          ...new ey(),
          ...he
        };
      });
      const re = [], J = [];
      for (let he = 0; he < se; he++) {
        const be = he + ee, me = xe[be];
        if (be >= H.totalRows) break;
        me ? re.push(me) : (J.push(be), re.push(Hc));
      }
      J.length && ue(J[0]), d(re);
    } else
      ue(0);
  }), Z(() => {
    e.viewState(), xe = [], c(0), ue(0, !0);
  }), h(M, {});
}
function d2(t, e) {
  switch (t?.controlType) {
    case "REV_CHECK_BOX":
      return (() => {
        var n = r2();
        return n.checked = e === "Y", R(() => ye(n, "aria-label", t.label)), n;
      })();
    case "REV_DROP_DOWN":
      return (() => {
        var n = i2(), r = n.firstChild;
        return w(r, e), n;
      })();
    default:
      return (() => {
        var n = s2();
        return w(n, e), n;
      })();
  }
}
class h2 {
  shape = 0;
  width = "100%";
  height = "1em";
}
function f2(t) {
  return (() => {
    var e = o2();
    return R((n) => {
      var r = JN.skeleton, i = t.width, s = t.height, o = t.height;
      return r !== n.e && D(e, n.e = r), i !== n.t && ((n.t = i) != null ? e.style.setProperty("width", i) : e.style.removeProperty("width")), s !== n.a && ((n.a = s) != null ? e.style.setProperty("height", s) : e.style.removeProperty("height")), o !== n.o && ((n.o = o) != null ? e.style.setProperty("line-height", o) : e.style.removeProperty("line-height")), n;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0
    }), e;
  })();
}
function g2() {
  return l2();
}
Xe(["click"]);
const p2 = "_title_yagke_7", zc = {
  "search-item-value": "_search-item-value_yagke_1",
  title: p2
};
var m2 = /* @__PURE__ */ T("<span>"), v2 = /* @__PURE__ */ T('<div class="flexbox vertical padded"style=min-width:180px><h2>New Filter</h2><div></div><div>'), y2 = /* @__PURE__ */ T('<div class=search-criteria><h3 class="flexbox horizontal middle"><span></span><span class=auto>Search Criteria</span><span></span></h3><div>'), b2 = /* @__PURE__ */ T('<i class="fas fa-caret-right">'), w2 = /* @__PURE__ */ T('<i class="fas fa-caret-down">'), _2 = /* @__PURE__ */ T('<div class="flexbox horizontal"style=margin:2px;padding:3px;background-color:var(--st-color-search-item-bg)><div class=auto><span style=color:#888></span>:<em><span></span></em></div><div class=item-tools>'), S2 = /* @__PURE__ */ T('<div class="flexbox vertical"style=margin:2px;padding:3px;background-color:var(--st-color-search-item-bg)><span style=color:#888>'), x2 = /* @__PURE__ */ T('<div class="flexbox horizontal"style=margin-left:50px><div class=auto><span style=color:#888></span>:<em><span></span></em></div><div class=item-tools>');
function C2(t) {
  const e = ac(), [n, r] = t.searchCriteria, [i, s] = I(!0);
  function o(_) {
    const m = [];
    if (_)
      for (const [y, v] of Object.entries(_))
        v.isData || m.push({
          srcName: y,
          ...v
        });
    return m;
  }
  const l = P(() => {
    const _ = n();
    return Object.entries(_.grids || {}).map(([m, y]) => ({
      guid: m,
      ...y
    }));
  }), a = (_) => {
    const m = {
      ...n()
    };
    delete m.controls[_.srcName], r(m), t.onDeleteSearchCriteria && t.onDeleteSearchCriteria(_.srcName);
  }, c = (_, m) => {
    const y = {
      ...n()
    };
    delete y.grids[_.guid].columns[m.srcName], Object.keys(y.grids[_.guid].columns).length === 0 && delete y.grids[_.guid], r(y), t.onDeleteSearchCriteria && t.onDeleteSearchCriteria(m.srcName);
  }, u = (_) => {
    const m = _.desc || _.value, y = m ? m.split(",") : [];
    return _.condition?.values && y.push.apply(y, _.condition.values), y.join(", ");
  }, [d, f] = I(""), [g, p] = I(!1);
  async function S() {
    window.ST.SendServerEvent(null, "Rev_Create_Filter", {
      "@FILTER_NAME": d(),
      "@ACTIVATE": "Y",
      VIEW_STATE: JSON.stringify(e.viewState())
    }), p(!1), f("");
  }
  return h(B, {
    get when() {
      return Object.keys(n() || {}).length > 0;
    },
    get children() {
      var _ = y2(), m = _.firstChild, y = m.firstChild, v = y.nextSibling, x = v.nextSibling, C = m.nextSibling;
      return m.$$click = () => s(!i()), w(y, (() => {
        var E = P(() => !!i());
        return () => E() ? b2() : w2();
      })()), x.$$click = (E) => {
        E.stopPropagation();
      }, w(x, h(Ve, {
        placement: "bottom-end",
        open: [g, p],
        get children() {
          return [h(Ve.Trigger, {
            get children() {
              var E = m2();
              return Le(tooltip, E, () => "Create Filter"), w(E, h(vr, {
                src: "far fa-filter",
                "aria-label": "Create Filter"
              })), E;
            }
          }), h(Ve.Content, {
            get children() {
              var E = v2(), k = E.firstChild, L = k.nextSibling, M = L.nextSibling;
              return w(L, h(dt, {
                focused: !0,
                defaultInput: S,
                value: [d, f],
                placeholder: "Filter Name"
              })), w(M, h(ne, {
                type: "primary",
                onClick: S,
                children: "Create"
              })), R(() => D(k, zc.title)), E;
            }
          })];
        }
      })), w(C, h(de, {
        get each() {
          return o(n().controls);
        },
        children: (E) => (() => {
          var k = _2(), L = k.firstChild, M = L.firstChild, G = M.nextSibling, Y = G.nextSibling, ie = Y.firstChild, X = L.nextSibling;
          return w(M, () => E.label), w(ie, () => u(E)), w(X, h(Dt, {
            icon: "fas fa-times",
            label: "Remove",
            onClick: () => a(E)
          })), R(() => D(Y, zc["search-item-value"])), k;
        })()
      }), null), w(C, h(de, {
        get each() {
          return l();
        },
        children: (E) => (() => {
          var k = S2(), L = k.firstChild;
          return w(L, () => E.label), w(k, h(de, {
            get each() {
              return o(E.columns);
            },
            children: (M) => (() => {
              var G = x2(), Y = G.firstChild, ie = Y.firstChild, X = ie.nextSibling, V = X.nextSibling, U = V.firstChild, W = Y.nextSibling;
              return w(ie, () => M.label), w(U, () => u(M)), w(W, h(Dt, {
                icon: "fas fa-times",
                label: "Remove",
                onClick: () => c(E, M)
              })), R(() => D(V, zc["search-item-value"])), G;
            })()
          }), null), k;
        })()
      }), null), R(() => _.classList.toggle("collapsed", !!i())), _;
    }
  });
}
Xe(["click"]);
var $2 = /* @__PURE__ */ T('<div class="hidden debug auto"style="flex:1 1 auto;background-color:lemonchiffon">&nbsp;'), E2 = /* @__PURE__ */ T('<div id=SearchResults class="st-find-result-panel flexbox horizontal auto"><div class="flexbox vertical panel auto"style="border:1px solid var(--st-panel-border)"><h2 class="flexbox horizontal middle"><span class=auto>Search Results</span></h2></div><div class="nav-bar flexbox vertical"><div role=button style=min-height:80px;cursor:pointer><span class="fas fa-magnifying-glass"role=presentation aria-label="Toggle Search Panel"></span></div><div class=auto>');
class T2 extends ky {
  primaryObjectGU = "";
  visible = !0;
  pinned = !1;
}
const Cg = window.ST || {}, $g = "967DB868-B68A-477D-87B8-313E598846FA", A2 = "FIND_RESULTS";
function Fu(t) {
  const e = HN() ?? new VN();
  return t.iface && (t.iface.context = e), h(ah.Provider, {
    value: e,
    get children() {
      return h(k2, t);
    }
  });
}
function k2(t) {
  const e = ac(), [n, r] = I(t.visible ?? !0);
  Z(() => r(t.visible ?? !0));
  const [i, s] = I(t.pinned ?? !1);
  Z(() => s(t.pinned ?? !1));
  const [o, l] = I(!t.pinned);
  Z(() => l(!t.pinned));
  const a = new ny();
  a.viewId = $g, a.gridId = A2, a.events = e.events, a.selectedRows = [e.selectedRows, e.setSelectedRows], Z(() => {
    e.setViewState({
      ...js(e.viewState),
      viewGU: $g,
      serverState: {
        PrimaryObjectGU: t.primaryObjectGU
      }
    });
  });
  let c;
  function u() {
    clearTimeout(c), i() || l(!0);
  }
  function d() {
    clearTimeout(c), c = setTimeout(() => {
      l(!1);
    }, 250);
  }
  function f() {
    s(!i()), e.events?.onIsPinned && e.events.onIsPinned(i());
  }
  Cg.DEBUGGING_COMPONENT && setTimeout(function() {
    r(!0), e.events.onRowClicked = function(y) {
      console.log(this);
    }, e.events.onDeleteSearchCriteria = function(y) {
      console.log("deleting");
    };
  }, 500);
  async function g() {
    const y = await Uy.GetFindResults(e.viewState().viewGU || "", e.viewState().tabGU || "", e.viewState());
    e.events.onOpenFindResults ? e.events.onOpenFindResults(y) : console.log(y);
  }
  let p = !1;
  Z(function() {
    const y = i();
    n() && !y && !p && (p = !0, l(!0), r(!1), requestAnimationFrame(() => {
      r(!0), p = !1;
    }));
  }), Z(() => {
    const y = e.searchCriteria(), v = js(e.viewState);
    if (v.dataElements = x(y?.controls), v.gridElements = [], y?.grids)
      for (const [C, E] of Object.entries(y.grids)) {
        const k = {
          guid: C,
          dataElements: x(E.columns)
        };
        v.gridElements.push(k);
      }
    e.setViewState({
      ...v
    });
    function x(C) {
      const E = [];
      if (C)
        for (const [k, L] of Object.entries(C)) {
          const M = {
            srcName: k,
            ...L
          };
          M.fkSource && (M.value = "*"), E.push(M);
        }
      return E;
    }
  });
  function S() {
    e.events.onReturnToSearch && e.events.onReturnToSearch(e.searchCriteria());
  }
  const _ = P(() => {
    const y = o(), {
      viewId: v,
      gridId: x
    } = a;
    return e.viewState(), !!(!y && v && x);
  }), m = P(() => {
    const y = e.searchCriteria() || {};
    return Object.keys(y.controls || {}).length > 0 || Object.keys(y.grids || {}).length > 0;
  });
  return h(B, {
    get when() {
      return n();
    },
    get children() {
      return [h(B, {
        get when() {
          return Cg.DEBUGGING_COMPONENT;
        },
        get children() {
          return $2();
        }
      }), (() => {
        var y = E2(), v = y.firstChild, x = v.firstChild;
        x.firstChild;
        var C = v.nextSibling, E = C.firstChild;
        return y.addEventListener("mouseleave", u), w(x, h(B, {
          get when() {
            return m();
          },
          get children() {
            return h(Dt, {
              icon: "fa-solid fa-arrow-right-to-arc spin-180",
              label: "Return To Search",
              onClick: S
            });
          }
        }), null), w(x, h(Dt, {
          icon: "fa-solid fa-up-right-from-square",
          label: "Open Find Results",
          onClick: () => g()
        }), null), w(x, h(B, {
          get when() {
            return i();
          },
          get children() {
            return h(Dt, {
              icon: "fa-solid fa-thumbtack",
              label: "Unpin",
              onClick: f
            });
          }
        }), null), w(x, h(B, {
          get when() {
            return !i();
          },
          get children() {
            return h(Dt, {
              icon: "fa-thin fa-thumbtack",
              label: "Pin",
              onClick: f
            });
          }
        }), null), w(v, h(B, {
          get when() {
            return m();
          },
          get children() {
            return h(C2, {
              get searchCriteria() {
                return [e.searchCriteria, e.setSearchCriteria];
              },
              get onDeleteSearchCriteria() {
                return e.events.onDeleteSearchCriteria;
              }
            });
          }
        }), null), w(v, h(B, {
          get when() {
            return _();
          },
          get children() {
            return h(La, a);
          }
        }), null), E.$$click = () => s(!i()), E.addEventListener("mouseenter", d), R(() => y.classList.toggle("collapsed", !!(!i() && o()))), y;
      })()];
    }
  });
}
Fu.defaultProps = new T2();
Xe(["click"]);
var I2 = /* @__PURE__ */ T("<dialog style=min-width:600px><h3>Tone:</h3><h3>Attitude:</h3><h3>Verbosity:");
function O2(t) {
  const e = J2();
  e.myWritingStyle();
  const n = I("0"), r = I("0"), i = I("0"), s = Object.entries(ai).filter((u) => Number(u[1]) >= 0), [o, l] = t.show;
  let a;
  return jt(() => {
    requestAnimationFrame(() => {
      Z(() => {
        o() ? a.showModal() : a.close();
      });
    });
  }), Z(() => {
    const u = e.myWritingStyle();
    n[1](u.tone.toString()), r[1](u.attitude.toString()), i[1](u.verbosity.toString());
  }), (() => {
    var u = I2(), d = u.firstChild, f = d.nextSibling, g = f.nextSibling;
    Le(draggable, u, () => {
    }), u.$$click = c;
    var p = a;
    return typeof p == "function" ? Le(p, u) : a = u, w(u, h(qi, {
      type: "info",
      children: "Define Your Writing Style"
    }), d), w(u, h(rt, {
      name: "tone",
      value: n,
      get children() {
        return [h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Casual.svg",
          label: "Casual",
          value: "0"
        }), h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Technical.svg",
          label: "Technical",
          value: "1"
        }), h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Formal.svg",
          label: "Formal",
          value: "2"
        })];
      }
    }), f), w(u, h(rt, {
      name: "attitude",
      value: r,
      get children() {
        return [h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Neutral.svg",
          label: "Neutral",
          value: "0"
        }), h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Empathetic.svg",
          label: "Empathetic",
          value: "1"
        }), h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Enthusiastic.svg",
          label: "Enthusiastic",
          value: "2"
        }), h(rt.Option, {
          icon: "Images/ST_VIEW/WritingStyle/Persuasive.svg",
          label: "Persuasive",
          value: "3"
        })];
      }
    }), g), w(u, h(rt, {
      name: "verbosity",
      value: i,
      get children() {
        return h(de, {
          each: s,
          children: (S) => h(rt.Option, {
            get icon() {
              return `Images/ST_VIEW/WritingStyle/${S[0]}.svg`;
            },
            get label() {
              return S[0];
            },
            get value() {
              return S[1].toString();
            }
          })
        });
      }
    }), null), u;
  })();
  function c(u) {
    const d = this.getBoundingClientRect(), f = d.top <= u.clientY && u.clientY <= d.top + d.height && d.left <= u.clientX && u.clientX <= d.left + d.width;
    u.target === this && !f && (e.setMyWritingStyle({
      writingStyleGU: e.myWritingStyle().writingStyleGU,
      tone: Yl[Yl[+n[0]()]],
      attitude: Xl[Xl[+r[0]()]],
      verbosity: ai[ai[+i[0]()]]
    }), l(!1));
  }
}
Xe(["click"]);
const [D2, Eg] = I();
let Tg = !1;
class ry {
  constructor() {
    Tg || (Tg = !0, Zl.GetWritingStyles().then((e) => {
      Eg(e);
    }).catch(console.error));
  }
  get styles() {
    return D2() || [];
  }
  myWritingStyle() {
    return this.styles[0] || new Wg();
  }
  getWritingStyle(e) {
    return this.styles.find((n) => n.writingStyleGU === e) || this.myWritingStyle();
  }
  setMyWritingStyle(e) {
    Zl.SaveWritingStyle(e);
    const [n, ...r] = this.styles;
    Eg([e, ...r]);
  }
}
const L2 = "_loading_1pb2i_55", N2 = "_pulse_1pb2i_1", P2 = "_heading_1pb2i_101", R2 = {
  "text-preview": "_text-preview_1pb2i_19",
  "text-loading-icon": "_text-loading-icon_1pb2i_45",
  loading: L2,
  pulse: N2,
  heading: P2,
  "st-memo-gen": "_st-memo-gen_1pb2i_125",
  "use-container": "_use-container_1pb2i_133"
};
var M2 = /* @__PURE__ */ T('<div class="auto flexbox vertical st-generated-text-preview"><div class="flexbox horizontal middle"style="margin:0 10px"><div class=label></div></div><div class="auto flexbox vertical text-preview"><div class="auto flexbox vertical"style=align-items:left;overflow:auto><div class=ai-loader></div></div></div><div class="flexbox horizontal middle"style="margin:0 10px;position:absolute;top:100%;left:0;right:0;"><div class=auto></div><div style=z-index:1></div><div class=auto>'), q2 = /* @__PURE__ */ T('<div class="flexbox horizontal padded">');
const [U5, B2] = I("");
document.addEventListener("selectionchange", (t) => {
  let e = document.getSelection()?.toString();
  B2(e || "");
});
class U2 {
  text = "";
  selected;
  setSelected;
  constructor(e) {
    this.text = e, [this.selected, this.setSelected] = I(!1);
  }
}
function j2(t) {
  const e = P(() => t.generatedText || []), n = P(() => t.loading), [r, i] = I(!0), [s, o] = I(!1), [l, a] = I(0), [c, u] = I(1);
  let d = !1;
  return Z(() => {
    const f = !!e() && e().length > 0;
    (async () => d || (d = !0, f ? (c() && (u(0), await Ls(1e3), i(!1)), o(!0), await Ls(1e3), a(1)) : (l() && (a(0), o(!1)), i(!0), await Ls(100), u(1)), d = !1))();
  }), (() => {
    var f = M2(), g = f.firstChild, p = g.firstChild, S = g.nextSibling, _ = S.firstChild, m = _.firstChild, y = S.nextSibling, v = y.firstChild, x = v.nextSibling;
    return w(p, () => t.label), w(m, h(Zi, {
      get processing() {
        return n();
      },
      size: "300px"
    })), w(_, h(B, {
      get when() {
        return s();
      },
      get children() {
        return h(de, {
          get each() {
            return t.generatedItems;
          },
          children: (C) => h(G2, {
            generatedItem: C
          })
        });
      }
    }), null), w(x, h(ne, {
      type: "success",
      get enabled() {
        return !!e();
      },
      get onClick() {
        return t.onReplace;
      },
      children: "Add"
    })), R((C) => {
      var E = !!n(), k = r() ? "" : "none", L = c();
      return E !== C.e && S.classList.toggle("loading", C.e = E), k !== C.t && ((C.t = k) != null ? m.style.setProperty("display", k) : m.style.removeProperty("display")), L !== C.a && ((C.a = L) != null ? m.style.setProperty("opacity", L) : m.style.removeProperty("opacity")), C;
    }, {
      e: void 0,
      t: void 0,
      a: void 0
    }), f;
  })();
}
function G2(t) {
  return (() => {
    var e = q2();
    return w(e, h(ut, {
      label: "",
      get value() {
        return [t.generatedItem.selected, t.generatedItem.setSelected];
      }
    }), null), w(e, () => t.generatedItem.text, null), e;
  })();
}
var F2 = /* @__PURE__ */ T('<div class="flexbox horizontal middle"><span class=auto style="margin:0 5px">'), V2 = /* @__PURE__ */ T('<div class="flexbox vertical middle"><div style=max-width:600px;width:100%>'), H2 = /* @__PURE__ */ T('<div class="auto flexbox horizontal">'), z2 = /* @__PURE__ */ T('<i class="fas fa-pen-nib">'), W2 = /* @__PURE__ */ T('<div class="flexbox horizontal middle padded"><div></div><div class=auto></div><div>');
const iy = bt(new ry());
function J2() {
  return Nt(iy);
}
const Q2 = window.ST || {};
class K2 {
  onOpen;
  onClose;
  onReplace;
}
class Vu {
  code = "";
  desc = "";
  generatedText = I([]);
  generatedItems = I([]);
  loading = I(!1);
}
class Y2 {
  srcName = "";
  identity = "";
  boid = "";
  lookupItems = [new Vu()];
  onSelected;
  events = new K2();
}
function Hu(t) {
  const [e, n] = I(!!Q2.DEBUGGING_COMPONENT), [r, i] = I(t.lookupItems), s = new ry(), o = I(!1), l = I(s.myWritingStyle().writingStyleGU), [a, c] = I(""), u = P(() => t.identity), d = P(() => t.srcName), f = P(() => t.boid), [g, p] = I(s.myWritingStyle().verbosity);
  return Z(() => {
    const m = e();
    m && t.events.onOpen ? t.events.onOpen() : !m && t.events.onClose && t.events.onClose(), c("");
    for (const y of r())
      m || y.generatedText[1]([]);
  }), Z(() => {
    const m = s.myWritingStyle();
    m && requestAnimationFrame(() => {
      m.verbosity !== g() && p(m.verbosity);
    });
  }), Z(() => {
    const m = g();
    requestAnimationFrame(() => {
      const y = s.myWritingStyle();
      y.verbosity !== m && (y.verbosity = m, s.setMyWritingStyle(y));
    });
  }), Z(() => {
    const m = t.boid;
    m && Zl.GetMemoLookupItems(m).then((y) => {
      const v = y.map((x) => {
        const C = new Vu();
        return C.code = x.code || "", C.desc = x.desc || "", C;
      }) || [];
      if (v.length === 0) {
        const x = new Vu();
        v.push(x);
      }
      i(v);
    });
  }), h(iy.Provider, {
    value: s,
    get children() {
      return [h(Dt, {
        icon: "fas fa-brain-circuit s-link",
        label: "Generate Rows",
        onClick: () => n(!0)
      }), h(Gt, {
        get class() {
          return `${R2["st-grid-gen"]} st-grid-gen`;
        },
        show: [e, n],
        get children() {
          return [h(qi, {
            type: "info",
            children: "What would you like to say?"
          }), (() => {
            var m = F2(), y = m.firstChild;
            return w(y, h(dt, {
              value: [a, c],
              onEnterKey: _
            })), w(m, h(ne, {
              type: "primary",
              onClick: _,
              children: "Compose"
            }), null), m;
          })(), (() => {
            var m = V2(), y = m.firstChild;
            return w(y, h(zs, {
              type: ai,
              value: [g, p],
              label: "Verbosity"
            })), m;
          })(), (() => {
            var m = H2();
            return w(m, h(de, {
              get each() {
                return r();
              },
              children: (y) => h(j2, {
                get label() {
                  return y.desc;
                },
                onReplace: () => S(y.generatedItems[0]()),
                get loading() {
                  return y.loading[0]();
                },
                get generatedText() {
                  return y.generatedText[0]();
                },
                get generatedItems() {
                  return y.generatedItems[0]();
                }
              })
            })), m;
          })(), (() => {
            var m = W2(), y = m.firstChild, v = y.nextSibling, x = v.nextSibling;
            return w(y, h(ne, {
              onClick: () => o[1](!0),
              tooltip: "Configure My Writing Style",
              get children() {
                return z2();
              }
            })), w(x, h(ne, {
              onClick: () => n(!1),
              children: "Close"
            })), m;
          })(), h(O2, {
            show: o
          })];
        }
      })];
    }
  });
  function S(m) {
    if (t.events.onReplace) {
      var y = [];
      for (var v of m)
        v.selected() && y.push(v.text);
      t.events.onReplace(y);
    }
    for (const x of r())
      x.generatedText[1]([]);
    n(!1);
  }
  async function _() {
    const m = s.getWritingStyle(l[0]());
    for (const y of r())
      y.loading[1](!0), y.generatedText[1]([]), y.generatedItems[1]([]), Zl.Generate(a(), u(), d(), f(), y.code, m).then((v) => new Promise((x) => setTimeout(() => x(v), 1e3))).then((v) => {
        y.generatedText[1](v.text);
        for (var x of v.text)
          y.generatedItems[1]((C) => [...C, new U2(x)]);
        y.loading[1](!1);
      }).catch((v) => {
        Qt.notify("error", v), y.loading[1](!1);
      });
  }
}
Hu.defaultProps = new Y2();
const Wc = {
  "st-group-box": "_st-group-box_14to2_1",
  "st-group-box-label": "_st-group-box-label_14to2_35",
  "st-group-box-content": "_st-group-box-content_14to2_55"
};
var X2 = /* @__PURE__ */ T("<div><div><span class=fa style=margin-right:0.5rem;></span></div><div>");
class Z2 {
  label;
  class;
}
function Qi(t) {
  const [e, n] = Wr(t, ["label", "class"]), [r, i] = I(!0);
  return (() => {
    var s = X2(), o = s.firstChild, l = o.firstChild, a = o.nextSibling;
    return o.$$click = () => i(!r()), w(o, () => t.label, null), w(a, () => t.children), R((c) => {
      var u = Wc["st-group-box"], d = r(), f = Wc["st-group-box-label"], g = !r(), p = !!r(), S = `${Wc["st-group-box-content"]} ${e.class ?? ""}`;
      return u !== c.e && D(s, c.e = u), d !== c.t && ye(s, "data-open", c.t = d), f !== c.a && D(o, c.a = f), g !== c.o && l.classList.toggle("fa-chevron-right", c.o = g), p !== c.i && l.classList.toggle("fa-chevron-down", c.i = p), S !== c.n && D(a, c.n = S), c;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0,
      n: void 0
    }), s;
  })();
}
Qi.defaultProps = new Z2();
Xe(["click"]);
class eP {
  constructor() {
  }
}
const Pl = {};
async function sy(t) {
  return new Promise(async (e, n) => {
    t ? window !== bh() ? e(await bh().ST.LoadIACData(t)) : (Pl[t] || (Pl[t] = await jy.LoadIntegratedActions(t)), Pl[t] && e(Pl[t])) : n();
  });
}
window.ST.LoadIACData = sy;
const tP = {
  "st-iac-menu": "_st-iac-menu_1i2j5_1"
};
var nP = /* @__PURE__ */ T("<div>");
window.ST.LoadIACData = sy;
const oy = bt(), j5 = () => Ir(oy);
class rP {
}
function zu(t) {
  const e = new eP();
  return h(oy.Provider, {
    value: e,
    get children() {
      return h(iP, t);
    }
  });
}
function iP(t) {
  return (() => {
    var e = nP();
    return w(e, () => t.children), R(() => D(e, tP["st-iac-menu"])), e;
  })();
}
zu.defaultProps = new rP();
const sP = "_icon_5lgbh_3", oP = "_badge_5lgbh_39", lP = "_error_5lgbh_73", aP = "_success_5lgbh_85", cP = "_info_5lgbh_97", Jt = {
  icon: sP,
  "gear-1": "_gear-1_5lgbh_19",
  "gear-2": "_gear-2_5lgbh_27",
  badge: oP,
  error: lP,
  success: aP,
  info: cP,
  "status-panel": "_status-panel_5lgbh_109",
  "status-panel-actions": "_status-panel-actions_5lgbh_125",
  "info-row": "_info-row_5lgbh_137",
  "info-row-title": "_info-row-title_5lgbh_157",
  "info-icon": "_info-icon_5lgbh_179",
  "info-top-row": "_info-top-row_5lgbh_199",
  "submit-dt": "_submit-dt_5lgbh_239",
  "job-id": "_job-id_5lgbh_249",
  "job-note": "_job-note_5lgbh_259",
  "job-description": "_job-description_5lgbh_269",
  "info-bottom-row": "_info-bottom-row_5lgbh_279",
  "info-actions": "_info-actions_5lgbh_293",
  "status-icon": "_status-icon_5lgbh_313",
  "status-icon-loading-badge": "_status-icon-loading-badge_5lgbh_321",
  "detail-container": "_detail-container_5lgbh_349",
  "detail-panel": "_detail-panel_5lgbh_357",
  "detail-panel-title": "_detail-panel-title_5lgbh_371",
  "detail-panel-content": "_detail-panel-content_5lgbh_381"
};
class uP {
  activeJobs;
  completedJobs;
  errorJobs;
  iconBadgeCount;
  iconBadgeColor;
  isProcessing;
  showBadge;
  jobs;
  setJobs;
  historicalJobs;
  setHistoricalJobs;
  loadingHistoricalJobs;
  setLoadingHistoricalJobs;
  singularJobs;
  recurringJobs;
  canAccessUserViewer;
  setCanAccessUserViewer;
  canAccessAdminViewer;
  setCanAccessAdminViewer;
  selectedJobIds;
  setSelectedJobIds;
  retrievedActionsJobIds;
  setRetrievedActionsJobIds;
  timeToWait = 1e3;
  refreshTimeout;
  historyExhausted = !1;
  constructor() {
    [this.jobs, this.setJobs] = I([]), [this.historicalJobs, this.setHistoricalJobs] = I([]), [this.loadingHistoricalJobs, this.setLoadingHistoricalJobs] = I(!1), [this.retrievedActionsJobIds, this.setRetrievedActionsJobIds] = I([]), this.activeJobs = P(() => this.jobs().filter((e) => this.isActive(e))), this.completedJobs = P(() => this.jobs().filter((e) => e.state === cr.Complete)), this.errorJobs = P(() => this.jobs().filter((e) => e.state === cr.Error)), this.recurringJobs = P(() => this.jobs().filter((e) => e.recurring === !0)), this.iconBadgeCount = P(() => this.errorJobs().length > 0 ? this.errorJobs().length : this.activeJobs().length > 0 ? this.activeJobs().length : this.completedJobs().length > 0 ? this.completedJobs().length : 0), this.showBadge = P(() => this.iconBadgeCount() > 0), this.iconBadgeColor = P(() => this.errorJobs().length > 0 ? "error" : this.activeJobs().length > 0 ? "success" : this.completedJobs().length > 0 ? "info" : ""), this.isProcessing = P(() => this.activeJobs().length > 0), this.singularJobs = P(() => this.jobs().filter((e) => e.recurring === !1)), [this.canAccessUserViewer, this.setCanAccessUserViewer] = I(!1), [this.canAccessAdminViewer, this.setCanAccessAdminViewer] = I(!1), [this.selectedJobIds, this.setSelectedJobIds] = I([]), Z(() => {
      const e = this.recurringJobs().map((n) => n.processQueueGU);
      this.setSelectedJobIds((n) => n.filter((r) => e.includes(r)));
    });
  }
  toggleSelectedJob(e, n) {
    const r = this.selectedJobIds();
    console.log("toggling", e.processQueueGU, n), n ? this.setSelectedJobIds([...r, e.processQueueGU]) : this.setSelectedJobIds(r.filter((i) => i !== e.processQueueGU));
  }
  async abort(e) {
    try {
      this.moveToHistorical(e), await _l.AbortJobs([e.processQueueGU]);
    } catch (n) {
      console.error(n);
    } finally {
      this.refreshStatusList();
    }
  }
  moveToHistorical(e) {
    this.historicalJobs().some((n) => n.processQueueGU === e.processQueueGU) || (this.setJobs(this.jobs().filter((n) => n.processQueueGU !== e.processQueueGU)), this.setHistoricalJobs([e, ...this.historicalJobs()]));
  }
  async dismiss(e) {
    this.moveToHistorical(e), window.ST.SendServerEvent(null, "JobQueue_Remove_Job", {
      "@FOCUS_KEY": window.ST.RevFocusKey,
      "@JOB_GUID": e.processQueueGU
    }).then(() => {
      this.refreshStatusList(), this.refreshHistoricalJobs();
    });
  }
  async dismissAll() {
    const e = this.completedJobs().map((n) => n.processQueueGU);
    try {
      window.ST.SendServerEvent(null, "JobQueue_Dismiss_All", {
        "@FOCUS_KEY": window.ST.RevFocusKey,
        "@JOB_GUID": e.join(",")
      }), this.setJobs((n) => n.filter((r) => r.state !== cr.Complete)), this.setHistoricalJobs([...this.historicalJobs(), ...this.completedJobs()]), this.refreshStatusList();
    } catch {
      Qt.notify("error", "An error occurred while dismissing all jobs");
    }
  }
  isActive(e) {
    switch (e.state) {
      case cr.InProgress:
        return !0;
      case cr.Hold:
      case cr.Waiting:
        return e.recurring || !e.submitDT ? !1 : new Date(e.submitDT).getTime() < Date.now();
      default:
        return !1;
    }
  }
  async refreshStatusList() {
    this.refreshTimeout && clearTimeout(this.refreshTimeout);
    const e = await _l.GetStatusList(!0);
    this.setCanAccessUserViewer(e.userViewerAccess), this.setCanAccessAdminViewer(e.adminViewerAccess);
    const n = this.jobs(), r = n.filter((a) => !e.jobs.some((c) => c.processQueueGU === a.processQueueGU));
    r.length > 0 && this.refreshHistoricalJobs();
    const i = e.jobs.map((a) => {
      const c = n.find((u) => u.processQueueGU === a.processQueueGU);
      return c ? { ...c, ...a } : a;
    });
    let s = r.length > 0;
    for (const a of i) {
      const c = n.find((u) => u.processQueueGU === a.processQueueGU);
      if (!c) {
        s = !0;
        break;
      }
      if (c.state !== a.state) {
        s = !0;
        break;
      }
      if (c.userJobStatus !== a.userJobStatus) {
        s = !0;
        break;
      }
    }
    s ? this.timeToWait = this.activeJobs().length > 0 ? 2e3 : 4e3 : this.timeToWait = Math.min(this.timeToWait * 2, 32e3), this.setJobs(i.toSorted((a, c) => new Date(c.submitDT).getTime() - new Date(a.submitDT).getTime()));
    const l = this.completedJobs().filter((a) => !this.retrievedActionsJobIds().includes(a.processQueueGU));
    for (const a of l)
      this.checkForActionsLegacy(a.processQueueGU);
    this.refreshTimeout = window.setTimeout(() => this.refreshStatusList(), this.timeToWait);
  }
  async refreshHistoricalJobs() {
    this.setLoadingHistoricalJobs(!0);
    try {
      const e = "", n = this.historicalJobs()[0]?.completionDT ?? "", r = await _l.GetHistoricalJobs(e, n);
      this.setHistoricalJobs(r);
    } catch (e) {
      console.error(e);
    }
    this.setLoadingHistoricalJobs(!1);
  }
  async loadMoreJobs() {
    if (!this.historyExhausted) {
      this.setLoadingHistoricalJobs(!0);
      try {
        const e = this.historicalJobs().at(-1)?.completionDT ?? "", r = await _l.GetHistoricalJobs(e, "");
        r.length === 0 && (this.historyExhausted = !0), this.setHistoricalJobs([...this.historicalJobs(), ...r]);
      } catch (e) {
        console.error(e);
      }
      this.setLoadingHistoricalJobs(!1);
    }
  }
  async checkForActionsLegacy(e) {
    if (this.setRetrievedActionsJobIds([...this.retrievedActionsJobIds(), e]), window.ST && window.ST.SendServerEvent) {
      const n = {
        "@FOCUS_KEY": window.ST.RevFocusKey,
        "@GUID": e
      };
      window.ST.SendServerEvent(null, "JobQueue_Get_Status", n, null);
    }
  }
  dispose() {
    this.refreshTimeout && window.clearTimeout(this.refreshTimeout);
  }
}
const dP = new uP(), cc = () => dP;
var hP = /* @__PURE__ */ T("<div style=font-style:italic;text-overflow:ellipsis;overflow-x:hidden;>"), fP = /* @__PURE__ */ T('<i class="fa fa-gear"style=font-size:11px;>'), gP = /* @__PURE__ */ T("<div><div><img></div><div><div></div><div style=font-weight:bold;text-overflow:ellipsis;overflow-x:hidden;></div><div style=font-weight:bold;></div></div><div></div><div>");
const Jc = (t) => {
  const e = cc(), n = P(() => t.historical ? !0 : t.job.state === cr.Complete || t.job.state === cr.Error), r = Ie(() => e.selectedJobIds().includes(t.job.processQueueGU), (i) => {
    e.toggleSelectedJob(t.job, i);
  });
  return (() => {
    var i = gP(), s = i.firstChild, o = s.firstChild, l = s.nextSibling, a = l.firstChild, c = a.nextSibling, u = c.nextSibling, d = l.nextSibling, f = d.nextSibling;
    return w(s, h(B, {
      get when() {
        return t.job.recurring;
      },
      get children() {
        return h(ut, {
          label: "",
          value: r
        });
      }
    }), o), w(a, () => t.job.submitDT), Le(tooltip, c, () => t.job.jobID), w(c, () => t.job.jobID), w(l, h(B, {
      get when() {
        return t.job.note;
      },
      get children() {
        var g = hP();
        return Le(tooltip, g, () => ({
          tooltip: t.job.note ?? "",
          placement: "bottom"
        })), w(g, () => t.job.note), R(() => D(g, Jt["job-note"])), g;
      }
    }), u), Le(tooltip, u, () => t.job.description), w(u, () => t.job.description), w(d, () => t.job.userJobStatus), w(f, h(Zn, {
      get children() {
        return [h(B, {
          get when() {
            return !t.job.recurring;
          },
          get children() {
            return [h(ne, {
              type: "success",
              onClick: () => {
                AP(t.job);
              },
              children: "View"
            }), h(B, {
              get when() {
                return !n();
              },
              get children() {
                return h(ne, {
                  type: "danger",
                  onClick: () => {
                    e.abort(t.job);
                  },
                  icon: "fa fa-xmark",
                  children: "Abort"
                });
              }
            }), h(B, {
              get when() {
                return n() && !t.historical;
              },
              get children() {
                return h(ne, {
                  type: "danger",
                  onClick: () => {
                    e.dismiss(t.job);
                  },
                  icon: "fa fa-xmark",
                  children: "Dismiss"
                });
              }
            })];
          }
        }), h(B, {
          get when() {
            return n() || t.job.recurring;
          },
          get children() {
            return h(ne, {
              get enabled() {
                return !!t.job.reportGU;
              },
              onClick: () => {
                kP(t.job);
              },
              "aria-label": "Configure",
              get children() {
                return fP();
              }
            });
          }
        })];
      }
    })), R((g) => {
      var p = Jt["info-row"], S = Jt["info-icon"], _ = ed(t.job.statusIcon), m = Jt["info-top-row"], y = Jt["submit-dt"], v = Jt["job-id"], x = Jt["job-description"], C = Jt["info-bottom-row"], E = Jt["info-actions"];
      return p !== g.e && D(i, g.e = p), S !== g.t && D(s, g.t = S), _ !== g.a && ye(o, "src", g.a = _), m !== g.o && D(l, g.o = m), y !== g.i && D(a, g.i = y), v !== g.n && D(c, g.n = v), x !== g.s && D(u, g.s = x), C !== g.h && D(d, g.h = C), E !== g.r && D(f, g.r = E), g;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0,
      n: void 0,
      s: void 0,
      h: void 0,
      r: void 0
    }), i;
  })();
};
var pP = /* @__PURE__ */ T('<div class="flexbox middle"style=padding:8px;font-style:italic;>No Active Jobs'), Ag = /* @__PURE__ */ T("<div style=max-height:300px;overflow-y:auto;>"), mP = /* @__PURE__ */ T('<div class="flexbox middle"style=padding:8px;font-style:italic;>No Historical Jobs'), vP = /* @__PURE__ */ T('<div class="flexbox middle"style=padding:8px;font-style:italic;>Loading...'), yP = /* @__PURE__ */ T('<div class="flexbox middle"style=padding:8px;font-style:italic;>No Recurring Jobs'), bP = /* @__PURE__ */ T('<div style=max-height:300px;overflow-y:auto;><div class="flexbox horizontal middle">'), wP = /* @__PURE__ */ T("<div><div>"), _P = /* @__PURE__ */ T("<span>Current Jobs (<!>)"), SP = /* @__PURE__ */ T("<span>Recent"), xP = /* @__PURE__ */ T("<span>Recurring Jobs (<!>)");
function CP() {
  const t = cc(), e = () => {
    Uh("VIEW", "211CE8CC-8B52-42E4-9C4A-014824D814E1", !0);
  }, n = () => {
    Uh("VIEW", "82ACAB90-ABA7-48D0-96B5-6522F5AE07DF", !0);
  }, r = (s) => {
    const o = s.target;
    o.scrollHeight - o.clientHeight - o.scrollTop < 10 && !t.loadingHistoricalJobs() && t.loadMoreJobs();
  };
  I(!1);
  const i = () => {
    const s = t.selectedJobIds().join(",");
    lu("ED8F3484-B4BC-4F30-B861-60A6D3210A05", s, {
      mode: "ADD"
    });
  };
  return (() => {
    var s = wP(), o = s.firstChild;
    return w(s, h(xr, {
      multiple: !0,
      get children() {
        return [h(xr.Item, {
          get title() {
            return [(() => {
              var l = _P(), a = l.firstChild, c = a.nextSibling;
              return c.nextSibling, w(l, () => t.singularJobs().length, c), R(() => D(l, Jt["info-row-title"])), l;
            })(), h(B, {
              get when() {
                return t.completedJobs().length > 1;
              },
              get children() {
                return h(ne, {
                  icon: "fa fa-xmark",
                  style: {
                    position: "absolute",
                    right: "16px",
                    "font-size": "12px"
                  },
                  type: "warning",
                  onClick: () => t.dismissAll(),
                  children: "Dismiss All"
                });
              }
            })];
          },
          open: !0,
          get children() {
            var l = Ag();
            return w(l, h(B, {
              get when() {
                return t.singularJobs().length === 0;
              },
              get children() {
                return pP();
              }
            }), null), w(l, h(gc, {
              get each() {
                return t.singularJobs();
              },
              children: (a) => h(Jc, {
                get job() {
                  return a();
                }
              })
            }), null), l;
          }
        }), h(xr.Item, {
          get title() {
            return (() => {
              var l = SP();
              return R(() => D(l, Jt["info-row-title"])), l;
            })();
          },
          get children() {
            var l = Ag();
            return l.addEventListener("scroll", r), w(l, h(B, {
              get when() {
                return P(() => !t.loadingHistoricalJobs())() && t.historicalJobs().length === 0;
              },
              get children() {
                return mP();
              }
            }), null), w(l, h(gc, {
              get each() {
                return t.historicalJobs();
              },
              children: (a) => h(Jc, {
                get job() {
                  return a();
                },
                historical: !0
              })
            }), null), w(l, h(B, {
              get when() {
                return t.loadingHistoricalJobs();
              },
              get children() {
                return vP();
              }
            }), null), l;
          }
        }), h(xr.Item, {
          get title() {
            return (() => {
              var l = xP(), a = l.firstChild, c = a.nextSibling;
              return c.nextSibling, w(l, () => t.recurringJobs().length, c), R(() => D(l, Jt["info-row-title"])), l;
            })();
          },
          get children() {
            var l = bP(), a = l.firstChild;
            return w(l, h(B, {
              get when() {
                return t.recurringJobs().length === 0;
              },
              get children() {
                return yP();
              }
            }), a), a.style.setProperty("justify-content", "center"), a.style.setProperty("padding", "4px"), w(a, h(ne, {
              get enabled() {
                return t.selectedJobIds().length > 0;
              },
              onClick: i,
              children: "Reschedule"
            })), w(l, h(gc, {
              get each() {
                return t.recurringJobs();
              },
              children: (c) => h(Jc, {
                get job() {
                  return c();
                }
              })
            }), null), l;
          }
        })];
      }
    }), o), w(o, h(B, {
      get when() {
        return t.canAccessUserViewer();
      },
      get children() {
        return h(ne, {
          onClick: e,
          children: "JobQueue Viewer"
        });
      }
    }), null), w(o, h(B, {
      get when() {
        return t.canAccessAdminViewer();
      },
      get children() {
        return h(ne, {
          onClick: n,
          children: "JobQueue Admin"
        });
      }
    }), null), R((l) => {
      var a = Jt["status-panel"], c = Jt["status-panel-actions"];
      return a !== l.e && D(s, l.e = a), c !== l.t && D(o, l.t = c), l;
    }, {
      e: void 0,
      t: void 0
    }), s;
  })();
}
var kg = /* @__PURE__ */ T("<i>"), $P = /* @__PURE__ */ T("<div>");
class EP {
}
function Wu() {
  const t = cc();
  return t.refreshStatusList(), t.refreshHistoricalJobs(), h(Ve, {
    get children() {
      return [h(Ve.Trigger, {
        get class() {
          return Jt.icon;
        },
        action: "hover",
        "aria-label": "Job Queue",
        get children() {
          return [(() => {
            var e = kg();
            return R((n) => {
              var r = `fa fa-gear ${Jt["gear-1"]}`, i = !!t.isProcessing();
              return r !== n.e && D(e, n.e = r), i !== n.t && e.classList.toggle("fa-spin", n.t = i), n;
            }, {
              e: void 0,
              t: void 0
            }), e;
          })(), (() => {
            var e = kg();
            return R((n) => {
              var r = `fa fa-gear reverse ${Jt["gear-2"]}`, i = !!t.isProcessing();
              return r !== n.e && D(e, n.e = r), i !== n.t && e.classList.toggle("fa-spin", n.t = i), n;
            }, {
              e: void 0,
              t: void 0
            }), e;
          })(), h(B, {
            get when() {
              return t.showBadge();
            },
            get children() {
              var e = $P();
              return w(e, () => t.iconBadgeCount()), R(() => D(e, `${Jt.badge} ${t.iconBadgeColor() ? Jt[t.iconBadgeColor()] : ""}`)), e;
            }
          })];
        }
      }), h(Ve.Content, {
        as: CP
      })];
    }
  });
}
Wu.defaultProps = new EP();
var TP = /* @__PURE__ */ ((t) => (t.Controller = "C", t.Dependent = "D", t.Maintenance = "M", t))(TP || {});
const Ig = "603E6071-9313-4552-828A-885490F40BCB", AP = (t) => {
  switch (t.state) {
    case cr.Hold:
    case cr.Waiting:
    case cr.InProgress:
      t.category === "C" ? lu(Ig, t.processQueueGU) : IP(t);
      break;
    case cr.CtlInProgress:
      lu(Ig, t.processQueueGU);
      break;
    default:
      OP(t);
      break;
  }
  try {
    const e = cc();
    e.moveToHistorical(t), e.refreshStatusList();
  } catch (e) {
    console.error(e);
  }
}, kP = (t) => {
  if (t.reportGU) {
    if (window.ST?.OpenWindow) {
      window.ST.OpenWindow({
        REV_RENDER: {
          "@FOCUS_KEY": t.focusKey,
          VIEW: {
            "@GUID": t.reportGU,
            "@RENDER_VIEW": "YES",
            "@MODE": "NORMAL",
            "@TYPE": "REPORT",
            "@SHOW_SUBTITLE": "Y",
            "@MODAL": "YES",
            REV_DATA_ROOT: {
              "@ACTION": "CURRENT",
              "@PRIMARY_OBJECT": "",
              CLIENT_STATE: {
                CLIENT_ACTION: {
                  "@TYPE": "SAVE_PARENT_COMMAND",
                  "@BUTTON_ID": "LAUNCH_RI",
                  "@ELEMENT_ID": "REV_BUTTON",
                  "@IN_GRID": "Y"
                }
              },
              REV_DATA_REQUEST: {
                REV_VIEW: {
                  "@GUID": t.reportGU
                }
              }
            }
          },
          SERVER_STATE: {
            D: {
              "@K": "__REPORT_PROCCESS_QUEUE_GU__",
              "@V": t.processQueueGU || ""
            }
          }
        }
      });
      return;
    }
    alert("Launch RI not implemented");
  }
}, IP = (t) => {
  window.ST.JobQueue.ShowJobDetails(t.processQueueGU);
}, OP = (t) => {
  if (window.ST?.JobQueue?.ViewResults) {
    DP(t);
    return;
  }
  alert("View results not implemented");
}, DP = (t) => {
  if (t.type == "D" || t.type == "ACT") {
    window.ST.JobQueue.GetDocValResults(t.processQueueGU);
    return;
  }
  var e = {
    "@FOCUS_KEY": window.ST.RevFocusKey,
    "@GUID": t.processQueueGU,
    "@MARK_READ": "Y"
  };
  if (t.multiResultFile)
    window.ST.SendServerEvent(null, "JobQueue_Get_MultiResults", e).done(function(i) {
      var s = $(i && i.documentElement).find("JOB_QUEUE_MULTIRESULTS")[0];
      window.ST.JobQueue.ShowMultiResultDialog(s);
    });
  else {
    var n = t.resultType, r = [ar.HTML, ar.PDF, ar.Txt, ar.RTF, ar.TIFF, ar.Excel, ar.ExcelXLSX, ar.XML, ar.CSV, ar.Fixed, ar.WordDOCX, ar.ZIP];
    (t.primaryResultFile || r.includes(n) || t.type === "C") && window.ST.SendServerEvent(null, "JobQueue_Get_Results", {
      "@FOCUS_KEY": window.ST.RevFocusKey,
      "@JOB_GUID": t.processQueueGU,
      "@FILE_GUID": t.primaryResultFile
    });
  }
}, LP = "_popup_gon4c_37", Og = {
  "st-menu-label": "_st-menu-label_gon4c_1",
  "st-menu": "_st-menu_gon4c_1",
  popup: LP
};
var NP = /* @__PURE__ */ T("<span style=margin-right:5px>"), PP = /* @__PURE__ */ T('<i class="fas fa-caret-down">'), RP = /* @__PURE__ */ T("<ul>"), MP = /* @__PURE__ */ T("<li><span>");
class qP {
  children;
  label;
}
function Na(t) {
  const e = us(() => t.children);
  return h(Ve, {
    get children() {
      return [h(Ve.Trigger, {
        get class() {
          return Og["st-menu-label"];
        },
        role: "button",
        get children() {
          return [(() => {
            var n = NP();
            return w(n, () => t.label), n;
          })(), PP()];
        }
      }), h(Ve.Content, {
        get children() {
          var n = RP();
          return w(n, e), R(() => D(n, Og["st-menu"])), n;
        }
      })];
    }
  });
}
Na.defaultProps = new qP();
class G5 {
  children;
  label;
  value;
}
Na.Item = (t) => {
  const e = us(() => t.children), n = t.value || t.label;
  return (() => {
    var r = MP(), i = r.firstChild;
    return ye(r, "data-value", n), w(i, () => t.label), w(r, e, null), r;
  })();
};
class BP {
  loadingPreview;
  setLoadingPreview;
  prompt;
  setPrompt;
  preview;
  setPreview;
  history;
  setHistory;
  selectedHistoryId;
  setSelectedHistoryId;
  constructor(e) {
    [this.preview, this.setPreview] = er(e ?? new ea()), [this.prompt, this.setPrompt] = I(""), [this.loadingPreview, this.setLoadingPreview] = I(!1), [this.history, this.setHistory] = I([]), [this.selectedHistoryId, this.setSelectedHistoryId] = I("");
  }
  reset() {
    this.setPreview(new ea()), this.setPrompt(""), this.setHistory([]);
  }
  async submitPrompt() {
    this.setLoadingPreview(!0);
    try {
      const e = await To.Prompt(this.prompt(), this.preview.stQueryString ?? ""), n = {
        id: Cr(),
        prompt: this.prompt(),
        preview: e
      };
      this.setHistory([...this.history(), n]), this.selectHistoryItem(n), this.setPrompt("");
    } catch (e) {
      console.error(e), Qt.notify("error", "Error submitting prompt");
    } finally {
      this.setLoadingPreview(!1);
    }
  }
  selectHistoryItem(e) {
    this.setSelectedHistoryId(e.id), this.setPreview(e.preview), this.setPrompt(e.prompt);
  }
  async setUserRating(e, n) {
    if (e.preview.aiLogGU)
      try {
        await To.SetUserRating(e.preview.aiLogGU, n);
        const r = this.history().map((i) => ({
          ...i,
          isHelpful: i.id === e.id ? n : i.isHelpful
        }));
        this.setHistory(r);
      } catch (r) {
        console.error(r), Qt.notify("error", "Error submitting rating");
      }
  }
  removeProperty(e, n) {
    this.setPreview(ia((r) => {
      const i = (s) => {
        s.BOID === e.BOID ? s.properties = s.properties.filter((o) => o.ID !== n.ID) : s.childBOs.forEach((o) => i(o));
      };
      i(r.primaryBO);
    }));
  }
  removeBO(e) {
    this.setPreview(ia((n) => {
      const r = (i) => {
        if (i.childBOs.some((s) => s.ID === e.ID))
          i.childBOs = i.childBOs.filter((s) => s.ID !== e.ID);
        else
          for (const s of i.childBOs)
            r(s);
      };
      r(n.primaryBO);
    }));
  }
}
const Wt = {
  "st-query-assist": "_st-query-assist_g4iiw_1",
  "chat-panel": "_chat-panel_g4iiw_25",
  "preview-panel": "_preview-panel_g4iiw_47",
  "query-preview": "_query-preview_g4iiw_61",
  "bo-node": "_bo-node_g4iiw_69",
  "bo-node-name": "_bo-node-name_g4iiw_91",
  "bo-node-container": "_bo-node-container_g4iiw_99",
  "bo-node-properties": "_bo-node-properties_g4iiw_109",
  "property-node": "_property-node_g4iiw_117",
  "property-node-name": "_property-node-name_g4iiw_139",
  "remove-button": "_remove-button_g4iiw_147",
  "history-panel": "_history-panel_g4iiw_177",
  "history-entry": "_history-entry_g4iiw_189",
  "history-entry-actions": "_history-entry-actions_g4iiw_231",
  "rating-button": "_rating-button_g4iiw_245",
  "query-string-container": "_query-string-container_g4iiw_275"
};
var Dg = /* @__PURE__ */ T('<div><span></span><i class="fa fa-copy"style=cursor:pointer;>'), UP = /* @__PURE__ */ T('<div><div><div style="display:grid;grid-template-columns:1fr auto;"><div style=margin-left:0.5em;></div></div><div></div></div><div></div><div>'), jP = /* @__PURE__ */ T('<div><i class="fa fa-history"></i><span></span><div><button><i class="fa fa-thumbs-down"></i></button><button><i class="fa fa-thumbs-up">'), GP = /* @__PURE__ */ T("<div style=width:100%;height:100%;display:flex;align-items:center;justify-content:center;>"), FP = /* @__PURE__ */ T('<button><i class="fa fa-trash">'), VP = /* @__PURE__ */ T("<div><div><div></div></div><div>"), HP = /* @__PURE__ */ T('<div><div></div><button><i class="fa fa-trash">'), zP = /* @__PURE__ */ T("<div style=display:grid;gap:1em;>");
const ly = bt(), ch = () => Ir(ly);
class WP {
  preview;
}
function Pa(t) {
  const [e, n] = t.preview ?? I(new ea()), r = new BP(e());
  return Z(() => {
    console.log("yo"), n(r.preview);
  }), h(ly.Provider, {
    value: r,
    get children() {
      return h(JP, t);
    }
  });
}
function JP(t) {
  const e = ch(), n = (i) => {
    i.key === "Enter" && e.submitPrompt();
  }, r = () => {
    navigator.clipboard.writeText(e.preview.stQueryString ?? ""), Qt.notify("success", "Query string copied to clipboard");
  };
  return Z(() => {
    const i = JSON.stringify(e.preview);
    To.GetQueryString(e.preview).then((s) => {
      JSON.stringify(e.preview) === i && e.setPreview((o) => ({
        ...o,
        stQueryString: s
      }));
    });
  }), (() => {
    var i = UP(), s = i.firstChild, o = s.firstChild, l = o.firstChild, a = o.nextSibling, c = s.nextSibling, u = c.nextSibling;
    return w(s, h(Qo, {
      rows: 8,
      get value() {
        return [e.prompt, e.setPrompt];
      },
      label: "",
      onKeyDown: n
    }), o), w(o, h(ne, {
      onClick: () => e.submitPrompt(),
      icon: "fa fa-brain",
      get loading() {
        return e.loadingPreview();
      },
      get enabled() {
        return !!e.prompt();
      },
      children: "Submit"
    }), l), w(l, h(ne, {
      get enabled() {
        return !!e.preview?.stQueryString;
      },
      type: "warning",
      onClick: () => e.reset(),
      icon: "fa fa-undo",
      children: "Reset"
    })), w(a, h(de, {
      get each() {
        return e.history().toReversed();
      },
      children: (d) => (() => {
        var f = jP(), g = f.firstChild, p = g.nextSibling, S = p.nextSibling, _ = S.firstChild, m = _.nextSibling;
        return f.$$click = () => e.selectHistoryItem(d), Le(tooltip, p, () => d.prompt), w(p, () => d.prompt), _.$$click = () => e.setUserRating(d, !1), m.$$click = () => e.setUserRating(d, !0), R((y) => {
          var v = Wt["history-entry"], x = e.selectedHistoryId() === d.id, C = Wt["history-entry-actions"], E = Wt["rating-button"], k = d.isHelpful === !1, L = Wt["rating-button"], M = d.isHelpful === !0;
          return v !== y.e && D(f, y.e = v), x !== y.t && ye(f, "data-selected", y.t = x), C !== y.a && D(S, y.a = C), E !== y.o && D(_, y.o = E), k !== y.i && ye(_, "data-selected", y.i = k), L !== y.n && D(m, y.n = L), M !== y.s && ye(m, "data-selected", y.s = M), y;
        }, {
          e: void 0,
          t: void 0,
          a: void 0,
          o: void 0,
          i: void 0,
          n: void 0,
          s: void 0
        }), f;
      })()
    })), w(c, h(B, {
      get when() {
        return !e.loadingPreview();
      },
      get fallback() {
        return h(ay, {});
      },
      get children() {
        return h(B, {
          get when() {
            return e.preview?.primaryBO?.ID;
          },
          get children() {
            return h(cy, {
              get bo() {
                return e.preview.primaryBO;
              }
            });
          }
        });
      }
    })), w(u, h(xr, {
      get children() {
        return [h(xr.Item, {
          title: "Full Query String",
          titlePlacement: "left",
          get disabled() {
            return !e.preview.stQueryString;
          },
          get children() {
            var d = Dg(), f = d.firstChild, g = f.nextSibling;
            return w(f, () => e.preview.stQueryString), g.$$click = r, R(() => D(d, Wt["query-string-container"])), d;
          }
        }), h(B, {
          get when() {
            return e.preview.rawResponse;
          },
          get children() {
            return h(xr.Item, {
              title: "Raw LLM Output",
              titlePlacement: "left",
              get children() {
                var d = Dg(), f = d.firstChild, g = f.nextSibling;
                return w(f, () => e.preview.rawResponse), g.$$click = r, R(() => D(d, Wt["query-string-container"])), d;
              }
            });
          }
        })];
      }
    })), R((d) => {
      var f = Wt["st-query-assist"], g = Wt["chat-panel"], p = Wt["history-panel"], S = Wt["preview-panel"], _ = Wt["query-preview"];
      return f !== d.e && D(i, d.e = f), g !== d.t && D(s, d.t = g), p !== d.a && D(a, d.a = p), S !== d.o && D(c, d.o = S), _ !== d.i && D(u, d.i = _), d;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0
    }), i;
  })();
}
Pa.defaultProps = new WP();
function ay() {
  return (() => {
    var t = GP();
    return w(t, h(Zi, {
      processing: !0,
      size: "350px"
    })), t;
  })();
}
function cy(t) {
  const e = ch(), n = () => {
    e.removeBO(t.bo);
  };
  return (() => {
    var r = VP(), i = r.firstChild, s = i.firstChild, o = i.nextSibling;
    return w(s, () => t.bo.name), w(i, h(B, {
      get when() {
        return t.bo.BOID !== e.preview.primaryBO.BOID;
      },
      get children() {
        var l = FP();
        return l.$$click = n, R(() => D(l, Wt["remove-button"])), l;
      }
    }), null), w(o, h(de, {
      get each() {
        return t.bo.properties;
      },
      children: (l) => h(QP, {
        get bo() {
          return t.bo;
        },
        property: l
      })
    })), w(r, h(de, {
      get each() {
        return t.bo.childBOs;
      },
      children: (l) => h(cy, {
        bo: l
      })
    }), null), R((l) => {
      var a = Wt["bo-node-container"], c = Wt["bo-node"], u = Wt["bo-node-name"], d = Wt["bo-node-properties"];
      return a !== l.e && D(r, l.e = a), c !== l.t && D(i, l.t = c), u !== l.a && D(s, l.a = u), d !== l.o && D(o, l.o = d), l;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0
    }), r;
  })();
}
function QP(t) {
  const e = ch(), n = async () => {
    e.removeProperty(t.bo, t.property);
  };
  return (() => {
    var r = HP(), i = r.firstChild, s = i.nextSibling;
    return w(i, () => t.property.srcElement), s.$$click = n, R((o) => {
      var l = Wt["property-node"], a = Wt["property-node-name"], c = Wt["remove-button"];
      return l !== o.e && D(r, o.e = l), a !== o.t && D(i, o.t = a), c !== o.a && D(s, o.a = c), o;
    }, {
      e: void 0,
      t: void 0,
      a: void 0
    }), r;
  })();
}
const F5 = async (t) => ip((e, n) => {
  const [r, i] = I(new ea()), [s, o] = I(!1), [l, a] = I(!0), c = async () => {
    o(!0);
    try {
      const u = r(), d = await To.GetQueryString(u);
      e(d);
    } catch (u) {
      console.error(u), Qt.notify("error", "An unexpected error ocurred while generating the query string");
    } finally {
      o(!1);
    }
  };
  return jt(async () => {
    try {
      if (t) {
        const u = await To.LoadFromQueryXML(t);
        i(u);
      }
    } catch (u) {
      console.error(u), Qt.notify("error", "An unexpected error ocurred while loading the query");
    } finally {
      a(!1);
    }
  }), h(B, {
    get when() {
      return !l();
    },
    get fallback() {
      return h(ay, {});
    },
    get children() {
      var u = zP();
      return w(u, h(Pa, {
        preview: [r, i]
      }), null), w(u, h(ne, {
        type: "primary",
        onClick: c,
        get loading() {
          return s();
        },
        get enabled() {
          return !!r();
        },
        children: "Use This Query"
      }), null), u;
    }
  });
}, {
  title: "Query Assist"
});
Xe(["click"]);
class KP {
  constructor() {
  }
}
const YP = "_field_1azbg_17", uy = {
  "st-recur-pattern": "_st-recur-pattern_1azbg_1",
  field: YP
}, XP = "_picker_go8q2_13", ZP = "_clock_go8q2_33", eR = "_hand_go8q2_89", Ii = {
  "st-time-picker": "_st-time-picker_go8q2_1",
  picker: XP,
  clock: ZP,
  hand: eR,
  "clock-hour": "_clock-hour_go8q2_113",
  "clock-minute": "_clock-minute_go8q2_123",
  "clock-hour-marker": "_clock-hour-marker_go8q2_135"
};
var Lg = /* @__PURE__ */ T("<div>"), tR = /* @__PURE__ */ T("<div><div></div><div>"), nR = /* @__PURE__ */ T("<span>");
class rR {
  value;
}
const Ju = (t) => {
  const e = t.indexOf(":"), n = 0, r = e + 1, i = t.indexOf("AM"), s = t.indexOf("PM"), o = i !== -1 ? i : s;
  if (e === -1 || o === -1) return {
    valid: !1,
    hour: {},
    minute: {},
    amPm: {}
  };
  const l = t.slice(n, e).trim(), a = t.slice(r, o).trim(), c = t.slice(o, o + 2).trim();
  return {
    valid: !0,
    hour: {
      value: l,
      start: n,
      end: n + l.length
    },
    minute: {
      value: a,
      start: r,
      end: r + a.length
    },
    amPm: {
      value: c,
      start: o,
      end: o + c.length
    }
  };
}, iR = (t) => {
  if (!t) return;
  const {
    valid: e,
    hour: n,
    minute: r,
    amPm: i
  } = Ju(t);
  if (!e) return;
  const s = parseInt(n.value), o = parseInt(r.value);
  if (isNaN(s) || isNaN(o)) return;
  const l = new Date(1900, 0, 1, 0, 0, 0, 0);
  return i.value === "AM" ? l.setHours(s % 12) : l.setHours(s % 12 + 12), l.setMinutes(o), l;
};
function Ra(t) {
  let e;
  const [n, r] = t.value ?? I(), [i, s] = I(!1), [o, l] = I(""), [a, c] = I(), [u, d] = I(), [f, g] = I(""), [p, S] = Ie(() => a()?.toString() ?? "", (x) => {
    if (x === void 0) return;
    const C = parseInt(x);
    isNaN(C) || (C < 1 ? c(12) : C > 12 ? c(1) : c(C));
  }), [_, m] = Ie(() => u()?.toString().padStart(2, "0") ?? "", (x) => {
    if (x === void 0) return;
    const C = parseInt(x);
    isNaN(C) || (C < 0 ? d(59) : C > 59 ? d(0) : d(C));
  });
  Z(Tr(() => [n()], ([x]) => {
    const C = n();
    if (!C) return;
    const E = C.getHours() < 12 ? "AM" : "PM", k = C.getHours() % 12 || 12, L = C.getMinutes();
    Hg(() => {
      g(E), c(k), d(L), l(`${k}:${L.toString().padStart(2, "0")} ${E}`);
    });
  })), Z(Tr(() => [a(), u(), f()], () => {
    const x = a(), C = u(), E = f();
    if (x === void 0 || C === void 0 || E === "") return;
    const k = new Date(1900, 0, 1, 0, 0, 0, 0);
    E === "AM" ? k.setHours(x % 12) : k.setHours(x % 12 + 12), k.setMinutes(C), k.toISOString() !== n()?.toISOString() && r(k);
  })), Z(() => {
    i() && !n() && r(/* @__PURE__ */ new Date());
  });
  const y = () => {
    const x = iR(o());
    x && r(x);
  }, v = (x) => {
    const C = e.value, {
      valid: E,
      hour: k,
      minute: L,
      amPm: M
    } = Ju(C), G = e.selectionStart, Y = (X, V) => X >= V.start && X <= V.end, ie = (X) => {
      const V = e.value, U = Ju(V);
      if (!U.valid) return;
      const W = U[X];
      setTimeout(() => e.setSelectionRange(W.start, W.end), 0);
    };
    if (E && G !== null)
      switch (x.key) {
        case "ArrowUp":
        case "ArrowDown":
          {
            x.preventDefault();
            const X = x.key === "ArrowUp" ? 1 : -1;
            if (Y(G, k))
              c((a() ?? 0) + X), ie("hour");
            else if (Y(G, L)) {
              const V = (u() ?? 0) + X;
              V < 0 ? d(59) : V > 59 ? d(0) : d(V), ie("minute");
            } else if (Y(G, M)) {
              const V = ["AM", "PM"], W = (V.findIndex((ce) => ce === f()) + X + V.length) % V.length;
              g(V[W]), ie("amPm");
            }
          }
          break;
        case "Tab":
          {
            const X = x.shiftKey ? -1 : 1, V = [k, L, M], W = V.findIndex((ce) => Y(G, ce)) + X;
            W >= 0 && W < V.length && (x.preventDefault(), e.setSelectionRange(V[W].start, V[W].end));
          }
          break;
      }
  };
  return (() => {
    var x = Lg();
    return w(x, h(Ve, {
      open: [i, s],
      get children() {
        return [h(Ve.Trigger, {
          get children() {
            return h(dt, {
              ref(C) {
                var E = e;
                typeof E == "function" ? E(C) : e = C;
              },
              value: [o, l],
              icon: "fa fa-clock",
              onFocusOut: y,
              onKeyDown: v
            });
          }
        }), h(Ve.Content, {
          get class() {
            return Ii.picker;
          },
          get children() {
            return [h(dt, {
              value: [p, S],
              type: "number"
            }), h(dt, {
              value: [_, m],
              type: "number"
            }), h(Ee, {
              value: [f, g],
              get children() {
                return [h(Ee.Option, {
                  value: "AM",
                  children: "AM"
                }), h(Ee.Option, {
                  value: "PM",
                  children: "PM"
                })];
              }
            }), (() => {
              var C = Lg();
              return C.style.setProperty("grid-column", "1 / 4"), w(C, h(sR, {
                hour: [a, c],
                minute: [u, d]
              })), C;
            })()];
          }
        })];
      }
    })), R(() => D(x, Ii["st-time-picker"])), x;
  })();
}
function sR(t) {
  let e;
  const [n, r] = t.hour, [i, s] = t.minute, [o, l] = I(-90);
  Z(Tr(() => [n()], ([x], C) => {
    if (x === void 0) return;
    if (C === void 0 || C[0] === void 0) {
      l(x * 30 - 90);
      return;
    }
    const E = o(), k = E % 360;
    let M = x * 30 - 90 - k;
    M > 180 ? M -= 360 : M < -180 && (M += 360), l(E + M);
  }));
  const [a, c] = I(-90);
  Z(Tr(() => [i()], ([x], C) => {
    if (x === void 0) return;
    if (C === void 0 || C[0] === void 0) {
      c(x * 6 - 90);
      return;
    }
    const E = a(), k = E % 360;
    let M = x * 6 - 90 - k;
    M > 180 ? M -= 360 : M < -180 && (M += 360), c(E + M);
  }));
  const [u, d] = I(!1), [f, g] = I(!1), p = (x) => {
    x.preventDefault(), d(!0);
  }, S = () => d(!1), _ = (x) => {
    if (!u()) return;
    const C = e.getBoundingClientRect(), E = x.clientX - C.left - C.width / 2, k = x.clientY - C.top - C.height / 2, L = Math.atan2(k, E) * 180 / Math.PI + 90;
    let M = Math.round(L / 6) % 60;
    M < 0 && (M += 60), M = Math.abs(M), s(M);
  }, m = (x) => {
    x.preventDefault(), g(!0);
  }, y = () => g(!1), v = (x) => {
    if (!f()) return;
    const C = e.getBoundingClientRect(), E = x.clientX - C.left - C.width / 2, k = x.clientY - C.top - C.height / 2, L = Math.atan2(k, E) * 180 / Math.PI + 90;
    let M = Math.round(L / 30) % 12;
    M < 0 && (M += 12), M = Math.abs(M), r(M || 12);
  };
  return Z(() => {
    u() ? (document.addEventListener("mousemove", _), document.addEventListener("mouseup", S)) : (document.removeEventListener("mousemove", _), document.removeEventListener("mouseup", S)), f() ? (document.addEventListener("mousemove", v), document.addEventListener("mouseup", y)) : (document.removeEventListener("mousemove", v), document.removeEventListener("mouseup", y));
  }), (() => {
    var x = tR(), C = x.firstChild, E = C.nextSibling, k = e;
    return typeof k == "function" ? Le(k, x) : e = x, C.$$mousedown = m, E.$$mousedown = p, w(x, h(de, {
      get each() {
        return [...Array(12).keys()];
      },
      children: (L) => (() => {
        var M = nR();
        return w(M, L + 1), R((G) => {
          var Y = Ii["clock-hour-marker"], ie = `--angle: ${L * 30 - 60}deg;`;
          return Y !== G.e && D(M, G.e = Y), G.t = Yn(M, ie, G.t), G;
        }, {
          e: void 0,
          t: void 0
        }), M;
      })()
    }), null), R((L) => {
      var M = Ii.clock, G = `${Ii["clock-hour"]} ${Ii.hand}`, Y = `${o()}deg`, ie = `${Ii["clock-minute"]} ${Ii.hand}`, X = `${a()}deg`;
      return M !== L.e && D(x, L.e = M), G !== L.t && D(C, L.t = G), Y !== L.a && ((L.a = Y) != null ? C.style.setProperty("rotate", Y) : C.style.removeProperty("rotate")), ie !== L.o && D(E, L.o = ie), X !== L.i && ((L.i = X) != null ? E.style.setProperty("rotate", X) : E.style.removeProperty("rotate")), L;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0
    }), x;
  })();
}
Ra.defaultProps = new rR();
Xe(["mousedown"]);
var oR = /* @__PURE__ */ T('<div class="flexbox horizontal spaced">'), lR = /* @__PURE__ */ T("<div>This report print immediately and then per schedule."), aR = /* @__PURE__ */ T('<div class="flexbox horizontal middle spaced"style=align-self:start;white-space:nowrap;>Every&nbsp;<!>&nbsp;Week(s) on:'), cR = /* @__PURE__ */ T('<div class=spaced style="display:grid;grid-template-columns:1fr 1fr;grid-template-rows:repeat(5, 1fr);grid-auto-flow:column;">'), uR = /* @__PURE__ */ T('<div class="flexbox horizontal middle spaced"style=white-space:nowrap;>Day<!>of the month'), dR = /* @__PURE__ */ T('<div class="flexbox horizontal middle spaced"style=white-space:nowrap;>The<!>of the month'), hR = /* @__PURE__ */ T('<div class=spaced style="display:grid;grid-template-columns:1fr 1fr;grid-template-rows:repeat(6, 1fr);grid-auto-flow:column;">'), fR = /* @__PURE__ */ T("<div>"), gR = /* @__PURE__ */ T("<div><label>");
const dy = bt(), V5 = () => Ir(dy);
class pR {
  value;
  setValue;
}
function Qu(t) {
  const e = new KP();
  return h(dy.Provider, {
    value: e,
    get children() {
      return h(SR, t);
    }
  });
}
const Ng = "0", mR = "1", vR = "2", yR = "3", bR = [{
  order: 1,
  code: "0",
  description: "Once"
}, {
  order: 2,
  code: "1",
  description: "Daily"
}, {
  order: 3,
  code: "2",
  description: "Weekly"
}, {
  order: 4,
  code: "3",
  description: "Monthly"
}], wR = [{
  order: 1,
  code: "1",
  description: "First"
}, {
  order: 2,
  code: "2",
  description: "Second"
}, {
  order: 3,
  code: "3",
  description: "Third"
}, {
  order: 4,
  code: "4",
  description: "Fourth"
}, {
  order: 5,
  code: "5",
  description: "Last"
}], _R = [{
  order: 1,
  code: "0",
  description: "Sunday"
}, {
  order: 2,
  code: "1",
  description: "Monday"
}, {
  order: 3,
  code: "2",
  description: "Tuesday"
}, {
  order: 4,
  code: "3",
  description: "Wednesday"
}, {
  order: 5,
  code: "4",
  description: "Thursday"
}, {
  order: 6,
  code: "5",
  description: "Friday"
}, {
  order: 7,
  code: "6",
  description: "Saturday"
}];
function SR(t) {
  const [e, n] = er(t.value ? JSON.parse(t.value) : new Gy());
  Z(() => {
    if (t.value) {
      const te = JSON.parse(t.value);
      n(te);
    }
  });
  const [r, i] = Ie(() => e.type.toString(), (te) => n("type", parseInt(te))), [s, o] = Ie(() => fe.fromJson(e.startTime), (te) => n("startTime", fe.toJson(te))), [l, a] = Ie(() => fe.fromJson(e.startDate), (te) => n("startDate", fe.toJson(te))), [c, u] = Ie(() => fe.fromJson(e.stopDate), (te) => n("stopDate", fe.toJson(te))), [d, f] = Ie(() => e.onlyScheduleForValidDays, (te) => n("onlyScheduleForValidDays", te)), [g, p] = Ie(() => e.dayCount.toString(), (te) => n("dayCount", parseInt(te))), [S, _] = Ie(() => e.weekCount.toString(), (te) => n("weekCount", parseInt(te))), [m, y] = Ie(() => e.monday, (te) => n("monday", te)), [v, x] = Ie(() => e.tuesday, (te) => n("tuesday", te)), [C, E] = Ie(() => e.wednesday, (te) => n("wednesday", te)), [k, L] = Ie(() => e.thursday, (te) => n("thursday", te)), [M, G] = Ie(() => e.friday, (te) => n("friday", te)), [Y, ie] = Ie(() => e.saturday, (te) => n("saturday", te)), [X, V] = Ie(() => e.sunday, (te) => n("sunday", te)), [U, W] = Ie(() => e.january, (te) => n("january", te)), [ce, ue] = Ie(() => e.february, (te) => n("february", te)), [xe, H] = Ie(() => e.march, (te) => n("march", te)), [ee, se] = Ie(() => e.april, (te) => n("april", te)), [K, re] = Ie(() => e.may, (te) => n("may", te)), [J, he] = Ie(() => e.june, (te) => n("june", te)), [be, me] = Ie(() => e.july, (te) => n("july", te)), [oe, Qe] = Ie(() => e.august, (te) => n("august", te)), [Ae, Ye] = Ie(() => e.september, (te) => n("september", te)), [De, Oe] = Ie(() => e.october, (te) => n("october", te)), [nt, We] = Ie(() => e.november, (te) => n("november", te)), [gt, ht] = Ie(() => e.december, (te) => n("december", te)), [it, ot] = Ie(() => e.monthType.toString(), (te) => n("monthType", parseInt(te))), [wt, pt] = Ie(() => e.monthDayType.toString(), (te) => n("monthDayType", parseInt(te))), [lt, Ge] = Ie(() => e.monthDayofWeek.toString(), (te) => n("monthDayofWeek", parseInt(te))), [yt, at] = Ie(() => (e.monthDayofMonth || 1).toString(), (te) => n("monthDayofMonth", parseInt(te)));
  return I(""), Z(Tr(() => [JSON.stringify(e)], () => {
    t.setValue?.(JSON.stringify(e));
  })), (() => {
    var te = fR();
    return w(te, h(Qi, {
      label: "Schedule Job",
      get children() {
        return [(() => {
          var pe = oR();
          return w(pe, h(Rl, {
            label: "Schedule Task",
            get children() {
              return h(Ee, {
                value: [r, i],
                get children() {
                  return h(de, {
                    each: bR,
                    children: (tt) => h(Ee.Item, {
                      get value() {
                        return tt.code;
                      },
                      get children() {
                        return tt.description;
                      }
                    })
                  });
                }
              });
            }
          }), null), w(pe, h(B, {
            get when() {
              return r() !== Ng;
            },
            get children() {
              return [h(Rl, {
                label: "Start Time",
                get children() {
                  return h(Ra, {
                    value: [s, o]
                  });
                }
              }), h(Rl, {
                label: "Start Date",
                get children() {
                  return h(Yo, {
                    value: [l, a]
                  });
                }
              }), h(Rl, {
                label: "Stop Date",
                get children() {
                  return h(Yo, {
                    value: [c, u]
                  });
                }
              }), h(ut, {
                label: "Only Schedule for Valid School Days",
                value: [d, f]
              })];
            }
          }), null), pe;
        })(), lR()];
      }
    }), null), w(te, h(Zt, {
      get children() {
        return [h(Pe, {
          get when() {
            return r() === Ng;
          },
          get children() {
            return [];
          }
        }), h(Pe, {
          get when() {
            return r() === mR;
          },
          get children() {
            return h(Qi, {
              label: "Schedule Daily",
              class: "flexbox horizontal middle spaced",
              get children() {
                return ["EveryÂ ", h(dt, {
                  type: "number",
                  value: [g, p]
                }), "Â Day(s)"];
              }
            });
          }
        }), h(Pe, {
          get when() {
            return r() === vR;
          },
          get children() {
            return h(Qi, {
              label: "Schedule Weekly",
              class: "flexbox horizontal middle spaced",
              get children() {
                return [(() => {
                  var pe = aR(), tt = pe.firstChild, Be = tt.nextSibling;
                  return Be.nextSibling, w(pe, h(dt, {
                    type: "number",
                    value: [S, _]
                  }), Be), pe;
                })(), (() => {
                  var pe = cR();
                  return w(pe, h(ut, {
                    label: "Monday",
                    value: [m, y]
                  }), null), w(pe, h(ut, {
                    label: "Tuesday",
                    value: [v, x]
                  }), null), w(pe, h(ut, {
                    label: "Wednesday",
                    value: [C, E]
                  }), null), w(pe, h(ut, {
                    label: "Thursday",
                    value: [k, L]
                  }), null), w(pe, h(ut, {
                    label: "Friday",
                    value: [M, G]
                  }), null), w(pe, h(ut, {
                    label: "Saturday",
                    value: [Y, ie]
                  }), null), w(pe, h(ut, {
                    label: "Sunday",
                    value: [X, V]
                  }), null), pe;
                })()];
              }
            });
          }
        }), h(Pe, {
          get when() {
            return r() === yR;
          },
          get children() {
            return h(Qi, {
              label: "Schedule Task Monthly",
              class: "flexbox horizontal spaced",
              get children() {
                return [h(rt, {
                  value: [it, ot],
                  vertical: !0,
                  get children() {
                    return [h(rt.Option, {
                      value: "0",
                      get children() {
                        var pe = uR(), tt = pe.firstChild, Be = tt.nextSibling;
                        return Be.nextSibling, w(pe, h(Ee, {
                          value: [yt, at],
                          get children() {
                            return h(de, {
                              get each() {
                                return Array.from({
                                  length: 31
                                }, (It, nn) => nn + 1);
                              },
                              children: (It) => h(Ee.Item, {
                                get value() {
                                  return It.toString();
                                },
                                get children() {
                                  return It.toString();
                                }
                              })
                            });
                          }
                        }), Be), pe;
                      }
                    }), h(rt.Option, {
                      value: "1",
                      get children() {
                        var pe = dR(), tt = pe.firstChild, Be = tt.nextSibling;
                        return Be.nextSibling, w(pe, h(Ee, {
                          value: [wt, pt],
                          get children() {
                            return h(de, {
                              each: wR,
                              children: (It) => h(Ee.Item, {
                                get value() {
                                  return It.code;
                                },
                                get children() {
                                  return It.description;
                                }
                              })
                            });
                          }
                        }), Be), w(pe, h(Ee, {
                          value: [lt, Ge],
                          get children() {
                            return h(de, {
                              each: _R,
                              children: (It) => h(Ee.Item, {
                                get value() {
                                  return It.code;
                                },
                                get children() {
                                  return It.description;
                                }
                              })
                            });
                          }
                        }), Be), pe;
                      }
                    })];
                  }
                }), (() => {
                  var pe = hR();
                  return w(pe, h(ut, {
                    label: "January",
                    value: [U, W]
                  }), null), w(pe, h(ut, {
                    label: "February",
                    value: [ce, ue]
                  }), null), w(pe, h(ut, {
                    label: "March",
                    value: [xe, H]
                  }), null), w(pe, h(ut, {
                    label: "April",
                    value: [ee, se]
                  }), null), w(pe, h(ut, {
                    label: "May",
                    value: [K, re]
                  }), null), w(pe, h(ut, {
                    label: "June",
                    value: [J, he]
                  }), null), w(pe, h(ut, {
                    label: "July",
                    value: [be, me]
                  }), null), w(pe, h(ut, {
                    label: "August",
                    value: [oe, Qe]
                  }), null), w(pe, h(ut, {
                    label: "September",
                    value: [Ae, Ye]
                  }), null), w(pe, h(ut, {
                    label: "October",
                    value: [De, Oe]
                  }), null), w(pe, h(ut, {
                    label: "November",
                    value: [nt, We]
                  }), null), w(pe, h(ut, {
                    label: "December",
                    value: [gt, ht]
                  }), null), pe;
                })()];
              }
            });
          }
        })];
      }
    }), null), R(() => D(te, uy["st-recur-pattern"])), te;
  })();
}
function Rl(t) {
  return (() => {
    var e = gR(), n = e.firstChild;
    return w(n, () => t.label), w(e, () => t.children, null), R(() => D(e, uy.field)), e;
  })();
}
Qu.defaultProps = new pR();
const {
  truncateTime: H5,
  startOfWeek: xR,
  startOfMonth: CR,
  endOfMonth: $R,
  addDays: Pg,
  addYears: ER,
  monthName: z5
} = fe, zn = 50, Wn = 50, Rg = [new Hn(0, zn, Wn), new Hn(64, zn, Wn), new Hn(32, zn, Wn), new Hn(96, zn, Wn), new Hn(160, zn, Wn), new Hn(128, zn, Wn), new Hn(224, zn, Wn), new Hn(192, zn, Wn), new Hn(288, zn, Wn), new Hn(256, zn, Wn), new Hn(352, zn, Wn), new Hn(320, zn, Wn)];
class hy {
  onDateChanged;
  onUpdate;
  afterAddClicked;
  refresh;
}
class TR {
  calendar;
  baseCalendar;
  setBaseCalendar;
  adjCalendar;
  setAdjCalendar;
  legends;
  setLegends;
  enabledLegendItems;
  setEnabledLegendItems;
  appointments = I([]);
  displayMode;
  setDisplayMode;
  day;
  setDay;
  hoveredDay;
  setHoveredDay;
  isEnabled = I(!0);
  minCellHeight = I("");
  colorIndices = /* @__PURE__ */ new Map();
  colorIndex = 0;
  afterAddClicked;
  events;
  constructor(e, n) {
    this.events = e ?? new hy(), this.afterAddClicked = n ?? !1, [this.displayMode, this.setDisplayMode] = I("Week"), [this.baseCalendar, this.setBaseCalendar] = I([]), [this.adjCalendar, this.setAdjCalendar] = I([]), [this.legends, this.setLegends] = I([]), [this.enabledLegendItems, this.setEnabledLegendItems] = I({}), [this.day, this.setDay] = I(fe.today()), [this.hoveredDay, this.setHoveredDay] = I(), this.calendar = P(() => this.baseCalendar().concat(this.adjCalendar()));
  }
  getColor(e) {
    return new Hn(e, zn, Wn);
  }
  nextColor(e = void 0) {
    return e ? (this.colorIndices.has(e) || this.colorIndices.set(e, this.nextColor()), this.colorIndices.get(e)) : Rg[this.colorIndex++ % Rg.length];
  }
  getAppointments(e) {
    const n = fe.truncateTime(e).getTime();
    return this.appointments[0]().filter((r) => n >= fe.truncateTime(r.start).getTime() && n < fe.addDays(fe.truncateTime(r.end), 1).getTime());
  }
  firstDate() {
    let e;
    const n = this.calendar();
    for (const r of n) {
      const i = fe.truncateTime(fe.dateFromString(r.startDate || ""));
      r.status !== pc.Inactive && (!e || i.getTime() < e.getTime()) && (e = i);
    }
    return e;
  }
  lastDate() {
    let e;
    const n = this.calendar();
    for (const r of n) {
      const i = fe.truncateTime(fe.dateFromString(r.endDate || r.startDate || ""));
      r.status !== pc.Inactive && (!e || i.getTime() > e.getTime()) && (e = i);
    }
    return e;
  }
  years() {
    const e = [];
    let n = this.firstDate() ?? fe.today(), r = this.lastDate() ?? n;
    for (; n <= r; )
      e.push(n.getFullYear()), n = ER(n, 1);
    return e;
  }
  months() {
    const e = [];
    let n = fe.startOfMonth(this.firstDate() ?? fe.today()), r = fe.endOfMonth(this.lastDate() ?? n);
    for (; n <= r; )
      e.push(n), n = fe.addMonths(n, 1);
    return e;
  }
  weeksFor(e) {
    const n = [];
    let r = xR(CR(e));
    for (; r <= $R(e); )
      n.push(Pg(r, e.getDay())), r = Pg(r, 7);
    return n;
  }
  weeks() {
    return this.weeksFor(this.day());
  }
  monthEnabled(e) {
    let n = fe.truncateTime(fe.startOfMonth(e));
    const r = fe.truncateTime(fe.endOfMonth(e));
    for (; n.getTime() < r.getTime(); ) {
      if (this.dayEnabled(n))
        return !0;
      n = fe.addDays(n, 1);
    }
    return !1;
  }
  dayEnabled(e) {
    let n = !1;
    for (const r of this.calendar())
      e.getTime() >= fe.truncateTime(fe.dateFromString(r.startDate || "")).getTime() && e.getTime() <= fe.truncateTime(fe.dateFromString(r.endDate || r.startDate || "")).getTime() && (r.status === pc.Active ? n = !0 : n = !1);
    return this.isEnabled[0]() && n;
  }
  categoryInfo(e) {
    for (const n of this.legends())
      for (const r of n.items)
        if (r.key === e)
          return r;
  }
  addClicked(e) {
    this.setDay(e), this.events.afterAddClicked && this.events.afterAddClicked(e);
  }
  showDetails(e) {
    window.ST?.OpenViewInDialog && e.viewID && window.ST.OpenViewInDialog(e.viewID, e.ID, {
      REV_RENDER: {
        PASS_THROUGH: {
          ID: e.ID,
          Title: e.title,
          SubTitle: e.subTitle,
          ViewID: e.viewID,
          Category: e.category,
          ColorIndex: e.colorIndex,
          Start: e.start,
          End: e.end
        }
      }
    }, null, {
      fullscreen: !0
    });
  }
}
const AR = "_schedule_1liu9_1", kR = "_navigation_1liu9_67", IR = "_appointments_1liu9_77", OR = "_calendar_1liu9_77", DR = "_cell_1liu9_111", LR = "_appointment_1liu9_77", NR = "_gutter_1liu9_243", PR = "_title_1liu9_293", RR = "_subtitle_1liu9_311", MR = "_icon_1liu9_331", qR = "_heading_1liu9_399", BR = "_day_1liu9_429", UR = "_disabled_1liu9_445", jR = "_hovered_1liu9_535", GR = "_legend_1liu9_617", FR = "_month_1liu9_65", VR = "_active_1liu9_737", qe = {
  schedule: AR,
  "main-heading": "_main-heading_1liu9_49",
  "month-title": "_month-title_1liu9_65",
  navigation: kR,
  appointments: IR,
  calendar: OR,
  "mini-calendar": "_mini-calendar_1liu9_77",
  cell: DR,
  "week-day-container": "_week-day-container_1liu9_119",
  "week-day": "_week-day_1liu9_119",
  "selected-days": "_selected-days_1liu9_153",
  appointment: LR,
  gutter: NR,
  "appt-popover": "_appt-popover_1liu9_271",
  title: PR,
  subtitle: RR,
  icon: MR,
  heading: qR,
  day: BR,
  disabled: UR,
  "other-month": "_other-month_1liu9_459",
  "mini-calendar-container": "_mini-calendar-container_1liu9_491",
  hovered: jR,
  "non-empty": "_non-empty_1liu9_545",
  "mini-calendar-nav": "_mini-calendar-nav_1liu9_575",
  "icon-container": "_icon-container_1liu9_595",
  legend: GR,
  "legend-checkbox": "_legend-checkbox_1liu9_691",
  "month-grid": "_month-grid_1liu9_701",
  month: FR,
  active: VR,
  "btn-add": "_btn-add_1liu9_785"
};
var HR = /* @__PURE__ */ T("<div>"), zR = /* @__PURE__ */ T('<div class="flexbox vertical"><div class="flexbox horizontal middle"style=margin-auto></div><div>');
const {
  addDays: WR,
  addMonths: JR,
  startOfMonth: QR,
  monthName: KR,
  truncateTime: W5
} = fe;
class YR {
  selYear;
  setSelYear;
  selMonth;
  setSelMonth;
  constructor() {
    [this.selYear, this.setSelYear] = I(0), [this.selMonth, this.setSelMonth] = I(0);
  }
}
const fy = bt();
function XR() {
  return Ir(fy);
}
function uh() {
  const t = Ut(), e = new YR();
  return h(fy.Provider, {
    value: e,
    get children() {
      return h(Ve, {
        get children() {
          return [h(Ve.Trigger, {
            as: "span",
            class: "auto",
            style: "text-align: center; cursor: pointer",
            get children() {
              return KR(t.day());
            }
          }), h(Ve.Content, {
            get children() {
              return h(uh.Months, {});
            }
          })];
        }
      });
    }
  });
}
uh.Months = function() {
  const t = Ut(), e = XR(), n = Xo(), r = P(() => Array.from({
    length: 12
  }, (a, c) => c)), [i, s] = Ie(() => e.selYear().toString(), (a) => e.setSelYear(parseInt(a)));
  function o(a) {
    const c = e.selYear() + a, u = t.firstDate() ?? fe.today(), d = t.lastDate() ?? u;
    c >= u.getFullYear() && c <= d.getFullYear() && e.setSelYear(c);
  }
  function l(a) {
    const c = P(() => new Date(e.selYear(), a.month)), u = P(() => t.monthEnabled(c())), d = P(() => {
      let g = QR(c());
      const p = JR(g, 1);
      for (; g.getTime() < p.getTime(); )
        if (g = WR(g, 1), t.getAppointments(g).length > 0)
          return !0;
      return !1;
    });
    function f() {
      u() && (n.setIsOpen(!1), t.setDay(new Date(e.selYear(), a.month)));
    }
    return (() => {
      var g = HR();
      return g.$$click = f, w(g, () => fe.shortMonthName(c())), R((p) => {
        var S = qe.month, _ = {
          [qe.disabled]: !u(),
          [qe.active]: e.selMonth() == a.month,
          [qe["non-empty"]]: d()
        };
        return S !== p.e && D(g, p.e = S), p.t = ro(g, _, p.t), p;
      }, {
        e: void 0,
        t: void 0
      }), g;
    })();
  }
  return Z(() => {
    const a = t.day();
    n.isOpen() && (e.setSelYear(a.getFullYear()), e.setSelMonth(a.getMonth()));
  }), (() => {
    var a = zR(), c = a.firstChild, u = c.nextSibling;
    return w(c, h(Dt, {
      icon: "fa fa-chevron-left",
      label: "Previous Year",
      onClick: () => o(-1)
    }), null), w(c, h(Ee, {
      value: [i, s],
      get children() {
        return [h(Ee.Trigger, {
          as: "span",
          class: "auto",
          style: "text-align: center",
          get children() {
            return e.selYear();
          }
        }), h(de, {
          get each() {
            return t.years();
          },
          children: (d) => h(Ee.Item, {
            value: d,
            children: d
          })
        })];
      }
    }), null), w(c, h(Dt, {
      icon: "fa fa-chevron-right",
      label: "Next Year",
      onClick: () => o(1)
    }), null), w(u, h(de, {
      get each() {
        return r();
      },
      children: (d) => h(l, {
        month: d
      })
    })), R(() => D(u, qe["month-grid"])), a;
  })();
};
Xe(["click"]);
var dh = /* @__PURE__ */ T("<div>"), ZR = /* @__PURE__ */ T("<div tabindex=0><div style=align-content:center>");
const {
  startOfWeek: Qc,
  addDays: Ml,
  addMonths: Mg,
  startOfMonth: Ma,
  endOfMonth: eM,
  endOfWeek: tM,
  truncateTime: qg
} = fe;
function nM() {
  const t = Ut();
  return (() => {
    var e = dh();
    return w(e, h(Dt, {
      icon: "fa fa-chevron-left",
      label: "Previous Month",
      onClick: () => t.setDay(Mg(t.day(), -1))
    }), null), w(e, h(uh, {}), null), w(e, h(Dt, {
      icon: "fa fa-chevron-right",
      label: "Next Month",
      onClick: () => t.setDay(Mg(t.day(), 1))
    }), null), R(() => D(e, `${qe["mini-calendar-nav"]} flexbox horizontal middle`)), e;
  })();
}
function rM() {
  const t = Ut();
  return (() => {
    var e = dh();
    return w(e, h(de, {
      get each() {
        return t.weeks();
      },
      children: (n) => h(sM, {
        date: n
      })
    }), null), w(e, h(iM, {}), null), R(() => D(e, qe["mini-calendar"])), e;
  })();
}
function iM() {
  const e = Ut(), [n, r] = I(30), [i, s] = I(20);
  function o(u) {
    const d = new ResizeObserver((f) => {
      requestAnimationFrame(() => {
        if (u.parentElement) {
          const g = e.day(), p = Qc(Ma(g)), _ = (tM(eM(g)).getTime() - p.getTime()) / 864e5, m = Math.max(5, Math.ceil(_ / 7)), y = u.parentElement.getBoundingClientRect();
          s(Math.ceil(y.width / 7) - 1), r(Math.ceil(y.height / m) - 1);
        }
      });
    });
    requestAnimationFrame(() => {
      u.parentElement && d.observe(u.parentElement);
    });
  }
  const l = P(() => {
    const u = e.day(), d = Qc(u), f = Ma(u), g = (d.getTime() - f.getTime()) / 7;
    return Math.ceil(g / 864e5) * n() + 4;
  }), a = P(() => {
    const u = e.day(), d = Qc(u);
    let f = 0;
    switch (e.displayMode()) {
      case "Day":
        f = u.getTime() - d.getTime();
        break;
      case "WorkWeek":
        f = 864e5;
        break;
    }
    return f / 864e5 * i() + 2;
  }), c = P(() => {
    switch (e.displayMode()) {
      case "Day":
        return i();
      case "Week":
        return i() * 7 - 4;
      case "WorkWeek":
        return i() * 5 - 4;
    }
  });
  return h(B, {
    get when() {
      return e.displayMode() !== "Month";
    },
    get children() {
      var u = dh(), d = o;
      return typeof d == "function" ? Le(d, u) : o = u, R((f) => {
        var g = qe["selected-days"], p = `${l()}px`, S = `${a()}px`, _ = `${c()}px`, m = `${n() - 8}px`;
        return g !== f.e && D(u, f.e = g), p !== f.t && ((f.t = p) != null ? u.style.setProperty("top", p) : u.style.removeProperty("top")), S !== f.a && ((f.a = S) != null ? u.style.setProperty("left", S) : u.style.removeProperty("left")), _ !== f.o && ((f.o = _) != null ? u.style.setProperty("width", _) : u.style.removeProperty("width")), m !== f.i && ((f.i = m) != null ? u.style.setProperty("height", m) : u.style.removeProperty("height")), f;
      }, {
        e: void 0,
        t: void 0,
        a: void 0,
        o: void 0,
        i: void 0
      }), u;
    }
  });
}
function sM(t) {
  const e = P(() => {
    const n = fe.startOfWeek(t.date);
    return [0, 1, 2, 3, 4, 5, 6].map((r) => fe.addDays(n, r));
  });
  return h(de, {
    get each() {
      return e();
    },
    children: (n) => h(oM, {
      date: n
    })
  });
}
function oM(t) {
  const e = Ut(), n = P(() => e.getAppointments(t.date).length > 0), r = P(() => {
    const o = Ma(e.day()), l = Ma(t.date);
    return o.getFullYear() === l.getFullYear() && o.getMonth() === l.getMonth();
  }), i = P(() => qg(t.date).getTime() === qg(/* @__PURE__ */ new Date()).getTime());
  function s(o) {
    function l(a) {
      e.dayEnabled(a) && e.setHoveredDay(a), o.preventDefault();
    }
    switch (o.key) {
      case " ":
      case "Enter":
        e.setDay(t.date), o.preventDefault();
        break;
      case "ArrowUp":
        return l(Ml(t.date, -7));
      case "ArrowDown":
        return l(Ml(t.date, 7));
      case "ArrowLeft":
        return l(Ml(t.date, -1));
      case "ArrowRight":
        return l(Ml(t.date, 1));
    }
  }
  return (() => {
    var o = ZR(), l = o.firstChild;
    return o.$$keydown = s, o.$$click = () => e.setDay(t.date), w(o, h(B, {
      get when() {
        return i();
      },
      get children() {
        return h(li, {
          type: "info",
          tooltip: "Today"
        });
      }
    }), l), w(l, () => t.date.getDate()), R((a) => {
      var c = `flexbox vertical middle ${qe.day}`, u = {
        [qe["non-empty"]]: n(),
        [qe["other-month"]]: !r(),
        [qe.disabled]: !e.dayEnabled(t.date),
        [qe.hovered]: e.hoveredDay() === t.date
      };
      return c !== a.e && D(o, a.e = c), a.t = ro(o, u, a.t), a;
    }, {
      e: void 0,
      t: void 0
    }), o;
  })();
}
Xe(["click", "keydown"]);
var gy = /* @__PURE__ */ T("<span>"), py = /* @__PURE__ */ T("<span style=text-align:right>"), lM = /* @__PURE__ */ T("<span><span></span><p>"), aM = /* @__PURE__ */ T("<div role=button>"), cM = /* @__PURE__ */ T('<div class="flexbox horizontal"><span role=presentation></span><span class="flexbox vertical auto"><span></span><span style=text-align:right>'), my = /* @__PURE__ */ T("<span role=presentation>"), uM = /* @__PURE__ */ T('<div class="flexbox horizontal middle"><span>'), dM = /* @__PURE__ */ T('<div class="flexbox horizontal"><span><span>&nbsp;</span></span><div class="flexbox vertical auto"style=padding:5px;white-space:initial><span></span><span>'), hM = /* @__PURE__ */ T("<div tabindex=0><div role=presentation><span>");
const {
  truncateTime: ui
} = fe, hh = 24 * 60 * 60 * 1e3;
function Kc(t) {
  const e = Ut();
  fe.getDate(t.start), t.date.getDate();
  const n = e.categoryInfo(t.category), r = P(() => fe.toLocaleTimeString(t.start, "en-US", {
    hour: "numeric",
    minute: "2-digit",
    hour12: !0
  })), s = Math.min(7 - t.date.getDay(), Math.max(1, (ui(t.end).getTime() - ui(t.start).getTime()) / hh)) > 1 || fe.getTime(t.start) === ui(t.start).getTime();
  t.colorIndex < 0 ? e.nextColor(n?.key ?? t.category ?? t.id) : e.getColor(t.colorIndex);
  const o = P(() => {
    const c = e.enabledLegendItems()[t.category || t.id];
    return c === void 0 ? !0 : c;
  });
  let l;
  function a() {
    window.ST?.OpenViewInDialog && t.viewID && window.ST.OpenViewInDialog(t.viewID, t.id, {
      REV_RENDER: {
        PASS_THROUGH: {
          ID: t.id,
          Title: t.title?.replaceAll("<", "&lt;").replaceAll(">", "&gt;"),
          SubTitle: t.subTitle,
          ViewID: t.viewID,
          Category: t.category,
          ColorIndex: t.colorIndex,
          Start: t.start,
          End: t.end
        }
      }
    }, l, {
      fullscreen: !0
    });
  }
  return h(B, {
    get when() {
      return o();
    },
    get children() {
      var c = aM();
      return c.$$click = a, w(c, h(Zt, {
        get children() {
          return [h(Pe, {
            get when() {
              return !t.description;
            },
            get children() {
              return h(Bg, t);
            }
          }), h(Pe, {
            get when() {
              return !!t.description;
            },
            get children() {
              return h($r, {
                placement: "bottom",
                get children() {
                  return [h($r.Trigger, {
                    get children() {
                      return h(Bg, t);
                    }
                  }), h($r.Content, {
                    get children() {
                      var u = lM(), d = u.firstChild, f = d.nextSibling;
                      return w(d, () => t.title), w(u, h(B, {
                        get when() {
                          return t.subTitle;
                        },
                        get children() {
                          var g = gy();
                          return w(g, () => t.subTitle), R(() => D(g, qe.subtitle)), g;
                        }
                      }), f), w(u, h(B, {
                        when: !s,
                        get children() {
                          var g = py();
                          return w(g, r), g;
                        }
                      }), null), R((g) => {
                        var p = `${qe["appt-popover"]} flexbox vertical auto`, S = qe.title, _ = t.description;
                        return p !== g.e && D(u, g.e = p), S !== g.t && D(d, g.t = S), _ !== g.a && (f.innerHTML = g.a = _), g;
                      }, {
                        e: void 0,
                        t: void 0,
                        a: void 0
                      }), u;
                    }
                  })];
                }
              });
            }
          })];
        }
      })), R(() => D(c, qe.appointment)), c;
    }
  });
}
function Bg(t) {
  const e = Ut();
  fe.getDate(t.start), t.date.getDate();
  const n = e.categoryInfo(t.category), r = P(() => fe.toLocaleTimeString(t.start, "en-US", {
    hour: "numeric",
    minute: "2-digit",
    hour12: !0
  })), s = Math.min(7 - t.date.getDay(), Math.max(1, (ui(t.end).getTime() - ui(t.start).getTime()) / hh)) > 1 || fe.getTime(t.start) === ui(t.start).getTime(), o = t.colorIndex < 0 ? e.nextColor(n?.key ?? t.category ?? t.id) : e.getColor(t.colorIndex);
  return h(Zt, {
    get children() {
      return [h(Pe, {
        when: s === !1,
        get children() {
          var l = cM(), a = l.firstChild, c = a.nextSibling, u = c.firstChild, d = u.nextSibling;
          return a.style.setProperty("border-radius", "4px"), a.style.setProperty("margin-right", "5px"), w(a, h(vr, {
            size: 16,
            get src() {
              return n?.iconPath ?? t.iconPath ?? "";
            }
          })), w(u, () => t.title), w(c, h(B, {
            get when() {
              return t.subTitle;
            },
            get children() {
              var f = gy();
              return w(f, () => t.subTitle), R(() => D(f, qe.subtitle)), f;
            }
          }), d), w(d, r), R((f) => {
            var g = `flexbox vertical middle ${qe.icon}`, p = o.toString(), S = o.gsComplement().toString(), _ = qe.title;
            return g !== f.e && D(a, f.e = g), p !== f.t && ((f.t = p) != null ? a.style.setProperty("background-color", p) : a.style.removeProperty("background-color")), S !== f.a && ((f.a = S) != null ? a.style.setProperty("color", S) : a.style.removeProperty("color")), _ !== f.o && D(u, f.o = _), f;
          }, {
            e: void 0,
            t: void 0,
            a: void 0,
            o: void 0
          }), l;
        }
      }), h(Pe, {
        when: s === !0,
        get children() {
          var l = uM(), a = l.firstChild;
          return l.style.setProperty("border-radius", "4px"), w(l, h(B, {
            get when() {
              return n?.iconPath ?? t.iconPath;
            },
            get children() {
              var c = my();
              return w(c, h(vr, {
                size: 16,
                get src() {
                  return n?.iconPath ?? t.iconPath ?? "";
                }
              })), R(() => D(c, `${qe.icon} flexbox vertical middle`)), c;
            }
          }), a), w(a, () => t.title), R((c) => {
            var u = o.toString(), d = o.gsComplement().toString(), f = `${qe.title} auto`;
            return u !== c.e && ((c.e = u) != null ? l.style.setProperty("background-color", u) : l.style.removeProperty("background-color")), d !== c.t && ((c.t = d) != null ? l.style.setProperty("color", d) : l.style.removeProperty("color")), f !== c.a && D(a, c.a = f), c;
          }, {
            e: void 0,
            t: void 0,
            a: void 0
          }), l;
        }
      })];
    }
  });
}
function vy(t) {
  const e = Ut();
  fe.getDate(t.start), t.calDate.getDate();
  const n = e.categoryInfo(t.category), r = t.colorIndex < 0 ? e.nextColor(n?.key ?? t.category ?? t.ID) : e.getColor(t.colorIndex), s = Math.min(7 - t.calDate.getDay(), Math.max(1, (ui(t.end).getTime() - ui(t.start).getTime()) / hh)) > 1 || fe.getTime(t.start) === ui(t.start).getTime(), o = P(() => fe.toLocaleTimeString(t.start, "en-US", {
    hour: "numeric",
    minute: "2-digit",
    hour12: !0
  })), l = P(() => !!(t.subTitle || t.description));
  return (() => {
    var a = hM(), c = a.firstChild, u = c.firstChild;
    return a.$$click = () => e.showDetails(t), a.style.setProperty("overflow", "hidden"), a.style.setProperty("position", "relative"), w(c, h(B, {
      get when() {
        return n?.iconPath ?? t.iconPath;
      },
      get children() {
        var d = my();
        return w(d, h(vr, {
          size: 16,
          get src() {
            return n?.iconPath ?? t.iconPath ?? "";
          }
        })), R(() => D(d, `${qe.icon} flexbox vertical middle`)), d;
      }
    }), u), w(u, () => t.title), w(a, h(B, {
      get when() {
        return l();
      },
      get children() {
        var d = dM(), f = d.firstChild, g = f.firstChild, p = f.nextSibling, S = p.firstChild, _ = S.nextSibling;
        return w(S, () => t.subTitle), w(p, h(B, {
          when: !s,
          get children() {
            var m = py();
            return w(m, o), m;
          }
        }), null), R((m) => {
          var y = qe.gutter, v = r.toString(), x = r.gsComplement().toString(), C = qe.subtitle, E = qe.description, k = t.description;
          return y !== m.e && D(f, m.e = y), v !== m.t && ((m.t = v) != null ? g.style.setProperty("background-color", v) : g.style.removeProperty("background-color")), x !== m.a && ((m.a = x) != null ? g.style.setProperty("color", x) : g.style.removeProperty("color")), C !== m.o && D(S, m.o = C), E !== m.i && D(_, m.i = E), k !== m.n && (_.innerHTML = m.n = k), m;
        }, {
          e: void 0,
          t: void 0,
          a: void 0,
          o: void 0,
          i: void 0,
          n: void 0
        }), d;
      }
    }), null), R((d) => {
      var f = qe.appointment, g = `flexbox horizontal middle ${qe.title}`, p = r.toString(), S = r.gsComplement().toString(), _ = `${qe.title} auto`;
      return f !== d.e && D(a, d.e = f), g !== d.t && D(c, d.t = g), p !== d.a && ((d.a = p) != null ? c.style.setProperty("background-color", p) : c.style.removeProperty("background-color")), S !== d.o && ((d.o = S) != null ? c.style.setProperty("color", S) : c.style.removeProperty("color")), _ !== d.i && D(u, d.i = _), d;
    }, {
      e: void 0,
      t: void 0,
      a: void 0,
      o: void 0,
      i: void 0
    }), a;
  })();
}
Xe(["click"]);
var fM = /* @__PURE__ */ T("<div>&#8226;"), gM = /* @__PURE__ */ T('<div class="flexbox vertical middle"style=font-size:24px><div class=auto></div><div></div><div class=auto>'), So = /* @__PURE__ */ T("<div>"), pM = /* @__PURE__ */ T("<div>&nbsp;"), mM = /* @__PURE__ */ T("<div><div>"), vM = /* @__PURE__ */ T('<div class="flexbox vertical">');
function Yc(t) {
  const e = Ut();
  return h(Zt, {
    get children() {
      return [h(Pe, {
        get when() {
          return e.displayMode() === "Month";
        },
        get children() {
          return h(yM, t);
        }
      }), h(Pe, {
        get when() {
          return e.displayMode() === "Week" || e.displayMode() === "WorkWeek";
        },
        get children() {
          return h(bM, t);
        }
      }), h(Pe, {
        get when() {
          return e.displayMode() === "Day";
        },
        get children() {
          return h(wM, t);
        }
      })];
    }
  });
}
function yM(t) {
  const e = Ut(), n = 150, [r, i] = I(!0), [s, o] = I("large"), l = P(() => fe.truncateTime(t.date).getTime() === fe.today().getTime()), a = P(() => {
    const S = e.day();
    return t.date.getTime() === fe.startOfMonth(S).getTime() || t.date.getMonth() !== S.getMonth() && t.date.getTime() === fe.startOfWeek(S).getTime() || t.date.getMonth() !== S.getMonth() && t.date.getDate() === 1;
  }), c = P(() => {
    switch (s()) {
      case "small":
        return "bullet";
      case "medium":
        return "icon";
      case "large":
      case "full":
      default:
        return "details";
    }
  });
  function u(S) {
    const _ = new ResizeObserver((m) => {
      i(!0);
      for (let y of m) {
        const {
          width: v,
          height: x
        } = y.contentRect, C = Math.min(1, v / n);
        switch (S.style.fontSize = `${Math.max(0.65, C)}em`, i(C > 0.65), e.displayMode()) {
          case "Day":
            o("full");
            break;
          case "Week":
            o("full");
            break;
          case "Month":
            v < 60 ? o("small") : v < 100 ? o("medium") : o("large");
            break;
        }
      }
    });
    _.observe(S), Gn(() => _.disconnect());
  }
  const d = P(() => e.dayEnabled(t.date)), f = P(() => {
    const S = [];
    d() || S.push(qe.disabled);
    const _ = fe.startOfMonth(e.day()), m = fe.endOfMonth(e.day());
    return (_.getTime() > t.date.getTime() || m.getTime() < t.date.getTime()) && S.push(qe["other-month"]), S.join(" ");
  }), g = P(() => fe.today().getTime() === fe.truncateTime(t.date).getTime() ? qe.active : ""), p = P(() => e.getAppointments(t.date));
  return (() => {
    var S = So(), _ = u;
    return typeof _ == "function" ? Le(_, S) : u = S, w(S, h(Zt, {
      get children() {
        return [h(Pe, {
          get when() {
            return s() === "small";
          },
          get children() {
            return [h(B, {
              get when() {
                return l();
              },
              get children() {
                return h(li, {
                  type: "info",
                  tooltip: "Today"
                });
              }
            }), (() => {
              var m = gM(), y = m.firstChild, v = y.nextSibling, x = v.nextSibling;
              return w(v, () => t.date.getDate()), w(m, h(Zt, {
                get fallback() {
                  return pM();
                },
                get children() {
                  return [h(Pe, {
                    get when() {
                      return p().length > 0;
                    },
                    get children() {
                      return fM();
                    }
                  }), h(Pe, {
                    get when() {
                      return e.afterAddClicked;
                    },
                    get children() {
                      return h(Ds, t);
                    }
                  })];
                }
              }), x), m;
            })()];
          }
        }), h(Pe, {
          get when() {
            return s() === "medium";
          },
          get children() {
            return [h(B, {
              get when() {
                return l();
              },
              get children() {
                return h(li, {
                  type: "info",
                  tooltip: "Today"
                });
              }
            }), h(B, {
              get when() {
                return a();
              },
              get children() {
                return [P(() => fe.shortMonthName(t.date)), "Â "];
              }
            }), P(() => t.date.getDate()), h(B, {
              get when() {
                return d();
              },
              get children() {
                var m = So();
                return m.style.setProperty("position", "relative"), m.style.setProperty("background-color", "inherit"), w(m, h(B, {
                  get when() {
                    return p().length == 0;
                  },
                  get children() {
                    return h(Ds, t);
                  }
                }), null), w(m, h(de, {
                  get each() {
                    return p();
                  },
                  children: (y) => {
                    const v = y.ID || Cr();
                    return h(Kc, Xt({
                      get date() {
                        return t.date;
                      }
                    }, y, {
                      get displayType() {
                        return c();
                      },
                      id: v,
                      get title() {
                        return y.title || "Appointment";
                      }
                    }));
                  }
                }), null), m;
              }
            })];
          }
        }), h(Pe, {
          get when() {
            return s() === "large";
          },
          get children() {
            return [h(B, {
              get when() {
                return l();
              },
              get children() {
                return h(li, {
                  type: "info",
                  tooltip: "Today"
                });
              }
            }), h(B, {
              get when() {
                return a();
              },
              get children() {
                return [P(() => fe.shortMonthName(t.date)), "Â "];
              }
            }), P(() => t.date.getDate()), h(B, {
              get when() {
                return d();
              },
              get children() {
                var m = So();
                return m.style.setProperty("position", "relative"), m.style.setProperty("background-color", "inherit"), w(m, h(B, {
                  get when() {
                    return p().length == 0;
                  },
                  get children() {
                    return h(Ds, t);
                  }
                }), null), w(m, h(de, {
                  get each() {
                    return p();
                  },
                  children: (y) => {
                    const v = y.ID || Cr();
                    return h(Kc, Xt({
                      get date() {
                        return t.date;
                      }
                    }, y, {
                      get displayType() {
                        return c();
                      },
                      id: v,
                      get title() {
                        return y.title || "Appointment";
                      }
                    }));
                  }
                }), null), m;
              }
            })];
          }
        }), h(Pe, {
          get when() {
            return s() === "full";
          },
          get children() {
            return [h(B, {
              get when() {
                return l();
              },
              get children() {
                return h(li, {
                  type: "info",
                  tooltip: "Today"
                });
              }
            }), h(B, {
              get when() {
                return a();
              },
              get children() {
                return [P(() => fe.shortMonthName(t.date)), "Â "];
              }
            }), P(() => t.date.getDate()), h(B, {
              get when() {
                return d();
              },
              get children() {
                var m = So();
                return m.style.setProperty("position", "relative"), m.style.setProperty("background-color", "inherit"), w(m, h(B, {
                  get when() {
                    return p().length == 0;
                  },
                  get children() {
                    return h(Ds, t);
                  }
                }), null), w(m, h(de, {
                  get each() {
                    return p();
                  },
                  children: (y) => {
                    const v = y.ID || Cr();
                    return h(Kc, Xt({
                      get date() {
                        return t.date;
                      }
                    }, y, {
                      get displayType() {
                        return c();
                      },
                      id: v,
                      get title() {
                        return y.title || "Appointment";
                      }
                    }));
                  }
                }), null), m;
              }
            })];
          }
        })];
      }
    })), R((m) => {
      var y = `cell ${f()} ${g()} ${qe.cell}`, v = e.minCellHeight[0](), x = (7 - t.date.getDay()).toString();
      return y !== m.e && D(S, m.e = y), v !== m.t && ((m.t = v) != null ? S.style.setProperty("min-height", v) : S.style.removeProperty("min-height")), x !== m.a && ((m.a = x) != null ? S.style.setProperty("z-index", x) : S.style.removeProperty("z-index")), m;
    }, {
      e: void 0,
      t: void 0,
      a: void 0
    }), S;
  })();
}
function bM(t) {
  const e = Ut(), n = P(() => e.getAppointments(t.date));
  return (() => {
    var r = mM(), i = r.firstChild;
    return w(i, () => t.date.getDate()), w(r, h(B, {
      get when() {
        return n().length == 0;
      },
      get children() {
        return h(Ds, t);
      }
    }), null), w(r, h(de, {
      get each() {
        return n();
      },
      children: (s) => h(vy, Xt(s, {
        get calDate() {
          return t.date;
        }
      }))
    }), null), R((s) => {
      var o = `flexbox vertical ${qe["week-day-container"]}`, l = qe["week-day"];
      return o !== s.e && D(r, s.e = o), l !== s.t && D(i, s.t = l), s;
    }, {
      e: void 0,
      t: void 0
    }), r;
  })();
}
function wM(t) {
  const e = Ut(), n = P(() => e.getAppointments(t.date)), r = P(() => fe.truncateTime(t.date).getTime() === fe.today().getTime());
  return (() => {
    var i = vM();
    return w(i, h(B, {
      get when() {
        return r();
      },
      get children() {
        return h(li, {
          type: "info",
          tooltip: "Today"
        });
      }
    }), null), w(i, h(B, {
      get when() {
        return n().length == 0;
      },
      get children() {
        return h(Ds, t);
      }
    }), null), w(i, h(de, {
      get each() {
        return n();
      },
      children: (s) => h(vy, Xt(s, {
        get calDate() {
          return t.date;
        }
      }))
    }), null), i;
  })();
}
function Ds(t) {
  const e = Ut(), n = P(() => {
    const i = fe.startOfMonth(e.day()), s = fe.endOfMonth(e.day());
    return i.getTime() > t.date.getTime() || s.getTime() < t.date.getTime();
  }), r = P(() => {
    const i = n(), s = e.dayEnabled(t.date);
    return e.afterAddClicked && !i && s;
  });
  return h(B, {
    get when() {
      return r();
    },
    get children() {
      var i = So();
      return w(i, h(ne, {
        type: "link",
        icon: "fa fa-add",
        tooltip: "Add Entry",
        onClick: () => e.addClicked(t.date)
      })), R(() => D(i, `flexbox vertical ${qe["btn-add"]}`)), i;
    }
  });
}
var _M = /* @__PURE__ */ T('<div style=min-width:95%><div class="flexbox horizontal auto">'), SM = /* @__PURE__ */ T("<div><div><span style=margin:auto>"), fh = /* @__PURE__ */ T("<div>"), xM = /* @__PURE__ */ T('<div class="flexbox vertical"><div>'), CM = /* @__PURE__ */ T("<div><h2></h2><ul>"), $M = /* @__PURE__ */ T('<li><label class="flexbox horizontal middle padded"><input type=checkbox><span></span><span class=auto>');
const J5 = window.ST, yy = bt(), Ut = () => Ir(yy);
class EM {
  displayMode = "Month";
  viewId = "";
  objectId = "";
  identity = "";
  afterAddClicked = !1;
  enabled = !1;
  events = new hy();
}
function Ku(t) {
  const e = new TR(t.events, t.afterAddClicked);
  return h(yy.Provider, {
    value: e,
    get children() {
      return h(TM, t);
    }
  });
}
function TM(t) {
  const e = TS(), n = Ut();
  Z(() => n.setDisplayMode(t.displayMode)), Z(() => {
    n.isEnabled[1](t.enabled);
  }), Z(() => {
    n.appointments[0]() && t.events?.onUpdate && requestAnimationFrame(t.events.onUpdate);
  }), Z(() => {
    const i = n.firstDate(), s = n.lastDate();
    i && n.day().getTime() < i.getTime() && n.setDay(i), s && n.day().getTime() > s.getTime() && n.setDay(s);
  }), Z(() => {
    const i = t.viewId, s = t.objectId;
    i && s && (async () => {
      const o = await xh.FetchCalendar(i, s);
      n.setLegends(o.legends), n.setBaseCalendar(o.calendar);
    })();
  }), Z(() => {
    const i = fe.toString(n.day());
    t.events?.onDateChanged && t.events?.onDateChanged(i);
  });
  const r = qa(async (i, s, o) => {
    const l = await xh.FetchAppointments(i, s, o);
    n.setAdjCalendar(l.calendar), n.appointments[1](l.appointments.map((a) => ({
      ...a
    })));
  }, 150);
  if (t.events) {
    let i = t.identity;
    t.events.refresh = () => {
      i !== t.identity ? (n.appointments[1]([]), r(t.viewId, t.objectId, t.identity), i = t.identity) : e && i != e.identity() && (n.appointments[1]([]), r(t.viewId, t.objectId, e.identity()), i = e.identity());
    };
  }
  return Z(() => {
    const i = t.viewId, s = t.objectId, o = t.identity;
    n.colorIndices.clear(), n.colorIndex = 0, o ? r(i, s, o) : n.appointments[1]([]);
  }), (() => {
    var i = _M(), s = i.firstChild;
    return w(i, h(AM, {}), s), w(s, h(kM, {}), null), w(s, h(IM, {}), null), R(() => D(i, `${qe.schedule} flexbox vertical`)), i;
  })();
}
Ku.defaultProps = new EM();
function AM() {
  const t = Ut();
  function e(r) {
    switch (t.displayMode()) {
      case "Month":
        t.setDay(fe.addMonths(t.day(), r));
        break;
      case "WorkWeek":
      case "Week":
        t.setDay(fe.addDays(t.day(), r * 7));
        break;
      case "Day":
        t.setDay(fe.addDays(t.day(), r));
        break;
    }
  }
  const n = P(() => new Intl.DateTimeFormat("en-US", {
    weekday: "long",
    year: "numeric",
    month: "long",
    day: "numeric"
  }).format(t.day()));
  return (() => {
    var r = SM(), i = r.firstChild, s = i.firstChild;
    return w(r, h(Zn, {
      get children() {
        return [h(ne, {
          type: "primary",
          onClick: () => t.setDay(fe.today()),
          children: "Today"
        }), h(ne, {
          label: "Previous",
          icon: "fa fa-chevron-left",
          onClick: () => e(-1)
        }), h(ne, {
          label: "Next",
          icon: "fa fa-chevron-right",
          onClick: () => e(1)
        })];
      }
    }), i), w(s, h(Zt, {
      get children() {
        return [h(Pe, {
          get when() {
            return t.displayMode() === "Day";
          },
          get children() {
            return n();
          }
        }), h(Pe, {
          get when() {
            return t.displayMode() !== "Day";
          },
          get children() {
            return [P(() => fe.monthName(t.day())), "Â ", P(() => t.day().getFullYear())];
          }
        })];
      }
    })), w(r, h(rt, {
      type: "button-group",
      get value() {
        return [t.displayMode, t.setDisplayMode];
      },
      get children() {
        return [h(rt.Option, {
          label: "Day",
          value: "Day"
        }), h(rt.Option, {
          label: "Work Week",
          value: "WorkWeek"
        }), h(rt.Option, {
          label: "Week",
          value: "Week"
        }), h(rt.Option, {
          label: "Month",
          value: "Month"
        })];
      }
    }), null), R((o) => {
      var l = `${qe["main-heading"]} flexbox horizontal middle`, a = `${qe["month-title"]} auto flexbox horizontal middle`;
      return l !== o.e && D(r, o.e = l), a !== o.t && D(i, o.t = a), o;
    }, {
      e: void 0,
      t: void 0
    }), r;
  })();
}
function kM() {
  const t = Ut();
  function e(r) {
    Ut();
    const i = P(() => {
      const s = fe.startOfWeek(r.date);
      return [0, 1, 2, 3, 4, 5, 6].map((o) => fe.addDays(s, o));
    });
    return h(de, {
      get each() {
        return i();
      },
      children: (s) => h(Yc, {
        date: s
      })
    });
  }
  function n(r) {
    Ut();
    const i = P(() => {
      const s = fe.startOfWeek(r.date);
      return [1, 2, 3, 4, 5].map((o) => fe.addDays(s, o));
    });
    return h(de, {
      get each() {
        return i();
      },
      children: (s) => h(Yc, {
        date: s
      })
    });
  }
  return (() => {
    var r = fh();
    return w(r, h(Zt, {
      get children() {
        return [h(Pe, {
          get when() {
            return t.displayMode() === "Month";
          },
          get children() {
            return [h(Xc, {}), h(de, {
              get each() {
                return t.weeks();
              },
              children: (i) => h(e, {
                date: i
              })
            })];
          }
        }), h(Pe, {
          get when() {
            return t.displayMode() === "Week";
          },
          get children() {
            return [h(Xc, {}), h(e, {
              get date() {
                return t.day();
              }
            })];
          }
        }), h(Pe, {
          get when() {
            return t.displayMode() === "WorkWeek";
          },
          get children() {
            return [h(Xc, {
              excludeWeekend: !0
            }), h(n, {
              get date() {
                return t.day();
              }
            })];
          }
        }), h(Pe, {
          get when() {
            return t.displayMode() === "Day";
          },
          get children() {
            return h(Yc, {
              get date() {
                return t.day();
              }
            });
          }
        })];
      }
    })), R((i) => {
      var s = `${qe.calendar} auto`, o = t.displayMode();
      return s !== i.e && D(r, i.e = s), o !== i.t && ye(r, "data-display-mode", i.t = o), i;
    }, {
      e: void 0,
      t: void 0
    }), r;
  })();
}
function Xc(t) {
  let e = fe.startOfWeek(fe.today());
  const n = t.excludeWeekend ? [1, 2, 3, 4, 5].map((l) => fe.addDays(e, l)) : [0, 1, 2, 3, 4, 5, 6].map((l) => fe.addDays(e, l)), [r, i] = I("long"), s = new ResizeObserver((l) => {
    for (let a of l) {
      const {
        width: c,
        height: u
      } = a.contentRect;
      i(c < 80 ? "short" : "long");
    }
  });
  Gn(() => s.disconnect());
  function o(l) {
    s.observe(l);
  }
  return h(de, {
    each: n,
    children: (l) => (() => {
      var a = fh(), c = o;
      return typeof c == "function" ? Le(c, a) : o = a, w(a, () => Intl.DateTimeFormat("en-US", {
        weekday: r()
      }).format(l)), R(() => D(a, qe.heading)), a;
    })()
  });
}
function IM() {
  return (() => {
    var t = xM(), e = t.firstChild;
    return w(e, h(nM, {}), null), w(e, h(rM, {}), null), w(t, h(OM, {}), null), R(() => D(e, qe["mini-calendar-container"])), t;
  })();
}
function OM() {
  const t = Ut();
  function e(r) {
    const i = t.enabledLegendItems()[r];
    return i === void 0 ? !0 : i;
  }
  function n(r) {
    const i = !e(r);
    t.setEnabledLegendItems({
      ...t.enabledLegendItems(),
      [r]: i
    });
  }
  return (() => {
    var r = fh();
    return w(r, h(de, {
      get each() {
        return t.legends();
      },
      children: (i) => (() => {
        var s = CM(), o = s.firstChild, l = o.nextSibling;
        return w(o, () => i.title), w(l, h(de, {
          get each() {
            return i.items;
          },
          children: (a) => (() => {
            var c = $M(), u = c.firstChild, d = u.firstChild, f = d.nextSibling, g = f.nextSibling;
            return d.addEventListener("change", () => n(a.key ?? "")), w(f, h(vr, {
              size: 24,
              get src() {
                return a.iconPath ?? "";
              }
            })), w(g, () => a.description), R(() => D(f, qe["legend-checkbox"])), R(() => d.checked = e(a.key ?? "")), c;
          })()
        })), R(() => D(s, qe.legend)), s;
      })()
    })), r;
  })();
}
const DM = "_tree_1iage_1", LM = "_node_1iage_9", NM = "_toggle_1iage_53", PM = "_empty_1iage_71", Jl = {
  tree: DM,
  "node-container": "_node-container_1iage_9",
  node: LM,
  toggle: NM,
  empty: PM
};
var Ug = /* @__PURE__ */ T("<span>"), RM = /* @__PURE__ */ T("<div><div role=button tabindex=0><div>");
function Q5(t) {
  Wr(t, ["class"]);
  const e = us(() => t.children), n = UM(), r = P(() => t.id ?? Cr()), i = P(() => n.expandedIds().includes(r())), s = P(() => n.selectedId() === r()), o = () => {
    n.select(r());
  }, l = () => {
    n.toggleExpanded(r());
  };
  jt(() => {
    typeof t.label == "string" ? n.setLabel(r(), t.label) : n.setLabel(r(), t.innerText?.toString() ?? t.id ?? "");
  }), Gn(() => {
    n.removeLabel(r());
  });
  const a = P(() => {
    const g = n.searchValue();
    return typeof t.label == "string" && t.label.includes(g) || t.id?.includes(g);
  }), c = P(() => !n.searchValue() || a() ? !0 : n.expandedIds().some((g) => g.startsWith(t.id ?? ""))), u = P(() => i() ? "fa-chevron-down" : "fa-chevron-right"), d = P(() => !e()), f = (g) => {
    g.key === "Enter" || g.key === " " ? d() ? o() : (o(), l()) : g.key === "ArrowRight" && !d() ? (n.select(r()), i() || n.toggleExpanded(r())) : g.key === "ArrowLeft" && !d() && (n.select(r()), i() && n.toggleExpanded(r()));
  };
  return h(B, {
    get when() {
      return c();
    },
    get children() {
      var g = RM(), p = g.firstChild, S = p.firstChild;
      return p.$$keydown = f, p.$$click = o, w(p, h(B, {
        get when() {
          return !d();
        },
        get children() {
          var _ = Ug();
          return _.$$click = l, R(() => D(_, `fa ${Jl.toggle} ${u()}`)), _;
        }
      }), S), w(p, h(B, {
        get when() {
          return t.icon;
        },
        get children() {
          var _ = Ug();
          return R(() => D(_, t.icon)), _;
        }
      }), S), w(S, () => t.label), w(g, h(B, {
        get when() {
          return i();
        },
        get children() {
          return e();
        }
      }), null), R((_) => {
        var m = Jl["node-container"], y = Jl.node, v = s(), x = a();
        return m !== _.e && D(g, _.e = m), y !== _.t && D(p, _.t = y), v !== _.a && ye(p, "data-selected", _.a = v), x !== _.o && ye(p, "data-match", _.o = x), _;
      }, {
        e: void 0,
        t: void 0,
        a: void 0,
        o: void 0
      }), g;
    }
  });
}
Xe(["click", "keydown"]);
var MM = /* @__PURE__ */ T("<div>");
class qM {
  searchValue;
  setSearchValue;
  expandedIds;
  manuallyExpandedIds;
  setManuallyExpandedIds;
  selectedId;
  setSelectedId;
  idLabelMap = {};
  setIdLabelMap;
  constructor(e) {
    [this.searchValue, this.setSearchValue] = I(""), [this.manuallyExpandedIds, this.setManuallyExpandedIds] = I([]), [this.selectedId, this.setSelectedId] = I(e ?? ""), [this.idLabelMap, this.setIdLabelMap] = er({}), this.expandedIds = P(() => {
      if (!this.searchValue())
        return this.manuallyExpandedIds();
      const n = /* @__PURE__ */ new Set();
      return Object.keys(this.idLabelMap).filter((i) => this.idLabelMap[i].includes(this.searchValue())).forEach((i) => {
        const s = i.split(".");
        s.forEach((o, l) => {
          n.add(s.slice(0, l + 1).join("."));
        }), n.add(i);
      }), [...n];
    });
  }
  toggleExpanded(e) {
    const n = this.expandedIds();
    n.includes(e) ? this.setManuallyExpandedIds(n.filter((r) => r !== e)) : this.setManuallyExpandedIds((r) => [...r, e]);
  }
  select(e) {
    this.setSelectedId(e);
  }
  setLabel(e, n) {
    this.setIdLabelMap((r) => ({
      ...r,
      [e]: n
    }));
  }
  removeLabel(e) {
    this.setIdLabelMap((n) => {
      const {
        [e]: r,
        ...i
      } = n;
      return i;
    });
  }
}
const by = bt();
class BM {
  context;
}
function Yu(t) {
  const e = t.context ?? new qM(), [n, r] = Wr(t, ["class", "context"]);
  return h(by.Provider, {
    value: e,
    get children() {
      var i = MM();
      return io(i, Xt({
        get class() {
          return `${Jl.tree} ${t.class}`;
        }
      }, r), !1, !0), w(i, h(dt, {
        placeholder: "Search",
        icon: "fa fa-search",
        get value() {
          return [e.searchValue, e.setSearchValue];
        }
      }), null), w(i, () => t.children, null), i;
    }
  });
}
Yu.defaultProps = new BM();
const UM = () => {
  const t = Nt(by);
  if (!t)
    throw new Error("TreeContext not found. Make sure the call to useTree occurs somewhere beneath an <STTree> component.");
  return t;
};
class uc {
  name = "st-view-filter";
  group;
  filter;
  constructor(e, n) {
    this.group = e, this.filter = n;
  }
  start(e) {
  }
  stop(e) {
  }
}
class to extends Qg {
  name;
  isDropTarget = I(!1);
  isDragging = I(!1);
  constructor(e) {
    super(), Object.assign(this, e), this.name = I(e.groupName || ""), td(() => {
      Z(() => this.groupName = this.name[0]());
    });
  }
}
class jM extends Fy {
  constructor(e) {
    super(), Object.assign(this, e);
  }
}
class no extends Vy {
  isDeleted = I(!1);
  isEnabled = I(!1);
  isDropTarget = I(!1);
  name$ = I("");
  constructor(e) {
    super(), Object.assign(this, e), this.name$[1](this.name || ""), this.setEnabled(this.enabled);
  }
  setEnabled(e) {
    this.isEnabled[1](e);
  }
  toggleEnabled() {
    this.isEnabled[1](!this.isEnabled[0]());
  }
  toggleDeleted() {
    this.isDeleted[1](!this.isDeleted[0]());
  }
}
class gh extends no {
  fromUser;
  constructor(e) {
    super(e), Object.assign(this, e);
  }
}
class GM {
  allFilters = [];
  allChecklists = [];
  allGroups = [];
  sharedFilters = [];
  checklistPrefs = {};
  collapsedGroups = [];
  constructor() {
    this.init();
  }
  async init() {
    const e = await Un.GetOptions();
    ln("checklistPrefs", e.checkListPreferences), ln("collapsedGroups", e.collapsedGroups), ln("allFilters", e.filters.map((n) => new no(n))), ln("sharedFilters", e.sharedFilters.map((n) => new gh(n))), ln("allChecklists", e.collections.map((n) => new jM(n))), ln("allGroups", e.groups.map((n) => new to(n)));
  }
  getGroup(e) {
    for (const n of this.allFilters)
      if (e.id && e.id === n.filterGroup.filterGroupGU || e.name[0]() === n.filterGroup.groupName)
        return n.filterGroup;
    return Object.assign(new to(new Qg()), {
      filterGroupGU: e.id,
      groupName: e.name[0]()
      //iconPath: group.iconPath
    });
  }
  isGroupExpanded(e) {
    return !this.collapsedGroups.includes(e);
  }
  toggleExpandedGroup(e) {
    const n = !this.isGroupExpanded(e), r = this.allGroups.reduce((s, o) => (s[o.filterGroupGU || ""] = !0, s), {}), i = [
      ...this.collapsedGroups.filter((s) => s !== e).filter((s) => r[s])
    ];
    n || i.push(e), ln("collapsedGroups", i), Un.UpdateCollapsedGroups(i);
  }
  updateCollectionGU(e, n) {
    ln(ia((r) => {
      const i = r.checklistPrefs;
      i[e] || (i[e] = new Hy()), i[e].userFilterCollectionGU = n;
    })), Un.UpdateCollectionGU(e, n);
  }
  async acceptSharedFilter(e, n) {
    const r = await Un.AcceptSharedFilter(e.filterGU || "", n || "");
    if (r) {
      const i = new no(r);
      return ln("sharedFilters", this.sharedFilters.filter((s) => s.filterGU !== e.filterGU)), ln("allFilters", [...this.allFilters, i]), i;
    }
  }
  removeSharedFilter(e) {
    ln("sharedFilters", this.sharedFilters.filter((n) => n.filterGU !== e.filterGU)), Un.RemoveSharedFilter(e.filterGU || "");
  }
  removeFilter(e) {
    ln("allFilters", this.allFilters.filter((n) => n.filterGU !== e.filterGU)), Un.DeleteFilter(e.filterGU || "");
  }
}
const [vt, ln] = er(new GM());
class FM {
  name = "st-view-filter";
  group;
  constructor(e) {
    this.group = e;
  }
  receiveFilter(e) {
    const n = new no(e.filter);
    n.filterGroupGU = this.group.filterGroupGU, ln("allFilters", (r) => r.filterGU === n.filterGU, n), Un.UpdateFilterGroup(n.filterGU, n.filterGroupGU);
  }
  drop(e, n) {
    n instanceof uc && (n.filter instanceof gh ? vt.acceptSharedFilter(n.filter, this.group.filterGroupGU) : this.receiveFilter(n)), this.group.isDropTarget[1](!1);
  }
  enter(e, n) {
    this.group.isDropTarget[1](!0);
  }
  leave(e, n) {
    this.group.isDropTarget[1](!1);
  }
  over(e, n) {
  }
}
class VM {
  name = "st-view-filter-group";
  group;
  constructor(e) {
    this.group = e;
  }
  receiveGroup(e, n) {
    const r = e.classList.contains("drag-hover-bottom") ? 1 : 0, i = vt.allGroups.map((l) => new to(l)).sort((l, a) => l.order - a.order), s = i.find((l) => l.filterGroupGU === this.group.filterGroupGU), o = i.find((l) => l.filterGroupGU === n.group.filterGroupGU);
    if (o) {
      i.splice(i.indexOf(o), 1), s ? i.splice(i.indexOf(s) + r, 0, o) : i.push(o);
      let l = 0;
      for (const a of i)
        a.order = l++;
      ln("allGroups", i), Un.UpdateGroupOrder(i);
    }
  }
  drop(e, n) {
    const r = e.target?.closest(".folder");
    r && (n instanceof wy && this.receiveGroup(r, n), r.classList.remove("drag-hover-top"), r.classList.remove("drag-hover-bottom")), this.group.isDropTarget[1](!1);
  }
  enter(e, n) {
    this.group.isDropTarget[1](!0);
  }
  leave(e, n) {
    this.group.isDropTarget[1](!1);
    const r = e.target?.closest(".folder");
    r && (r.classList.remove("drag-hover-top"), r.classList.remove("drag-hover-bottom"));
  }
  over(e, n) {
    const r = e.target?.closest(".folder");
    if (r) {
      const i = r.getBoundingClientRect();
      e.pageY < i.top + i.height / 2 ? (r.classList.add("drag-hover-top"), r.classList.remove("drag-hover-bottom")) : (r.classList.add("drag-hover-bottom"), r.classList.remove("drag-hover-top"));
    }
  }
}
class wy {
  name = "st-view-filter-group";
  handle;
  group;
  constructor(e) {
    this.group = e;
  }
  start(e) {
    this.group.isDragging[1](!0);
  }
  stop(e) {
    this.group.isDragging[1](!1);
  }
}
class _y {
  name = "st-view-filter";
  group;
  filter;
  constructor(e, n) {
    this.group = e, this.filter = n;
  }
  dropFilter(e, n) {
    const r = vt.allFilters.map((l) => new no(l)).sort((l, a) => l.order - a.order), i = r.find((l) => l.filterGU === this.filter.filterGU), s = r.find((l) => l.filterGU === e.filterGU);
    if (s && i) {
      const l = n ? 1 : 0;
      r.splice(r.indexOf(s), 1), r.splice(r.indexOf(i) + l, 0, s);
    }
    let o = 0;
    for (const l of r)
      l.order = o++;
    Un.UpdateFilterOrder(r), ln("allFilters", r);
  }
  async drop(e, n) {
    const r = e.target?.closest("li");
    if (r && n instanceof uc) {
      const i = r.classList.contains("drag-hover-bottom");
      if (n.filter instanceof gh) {
        const s = await vt.acceptSharedFilter(n.filter, this.group.filterGroupGU);
        s && this.dropFilter(s, i);
      } else
        this.dropFilter(n.filter, i);
    }
    this.filter.isDropTarget[1](!1);
  }
  enter(e, n) {
    this.filter.isDropTarget[1](!0);
  }
  leave(e, n) {
    this.filter.isDropTarget[1](!1);
    const r = e.target?.closest("li");
    r && (r.classList.remove("drag-hover-bottom"), r.classList.remove("drag-hover-top"));
  }
  over(e, n) {
    const r = e.target?.closest("li");
    if (r) {
      const i = r.getBoundingClientRect();
      e.pageY < i.top + i.height / 2 ? (r.classList.add("drag-hover-top"), r.classList.remove("drag-hover-bottom")) : (r.classList.add("drag-hover-bottom"), r.classList.remove("drag-hover-top"));
    }
  }
}
var HM = /* @__PURE__ */ T('<div><h4>Shared Filters</h4><ul class="filter-tabs flexbox vertical"role=tablist style=padding-left:25px;margin-bottom:15px;>'), zM = /* @__PURE__ */ T('<div class="flexbox vertical auto"><div class="flexbox horizontal auto"><div class="flexbox vertical auto"><div class="flexbox vertical auto"style=max-height:350px;overflow-y:auto;overflow-x:hidden></div></div><div class=auto>'), WM = /* @__PURE__ */ T('<ul class="filter-tabs flexbox vertical"role=tablist style=max-height:350px;overflow-y:auto;overflow-x:hidden>'), JM = /* @__PURE__ */ T('<li class="flexbox horizontal middle padded"role=tab><div class=auto></div><div class="tools flexbox horizontal middle">'), QM = /* @__PURE__ */ T('<li class="flexbox horizontal middle padded"role=tab><div class=auto> (<!>)</div><div class="tools flexbox horizontal middle">'), KM = /* @__PURE__ */ T('<span role=button aria-label="Toggle Group">'), YM = /* @__PURE__ */ T("<div class=tools>"), XM = /* @__PURE__ */ T('<div class="flexbox horizontal middle padded folder"><span class="far fa-folder"></span><h4 class=auto role=button> (<!>)'), ZM = /* @__PURE__ */ T("<div style=padding:5px;>"), e5 = /* @__PURE__ */ T("<div style=z-index:2;padding-left:20px;>");
const t5 = "ED708DB0-0944-4971-89F1-BB040A797159", ph = bt({
  primaryObjectGU: ""
});
function n5(t) {
  P(() => vt.allChecklists);
  const e = P(() => vt.sharedFilters), [n, r] = I(), [i, s] = I(), [o, l] = I();
  async function a() {
    const c = new to(await Un.CreateNewFolder());
    ln("allGroups", [c, ...vt.allGroups]), r(c);
  }
  return h(ph.Provider, {
    get value() {
      return {
        primaryObjectGU: t.primaryObjectGU
      };
    },
    get children() {
      var c = zM(), u = c.firstChild, d = u.firstChild, f = d.firstChild, g = d.nextSibling;
      return w(f, h(o5, {
        editingGroup: [n, r],
        selectedGroup: [i, s]
      })), w(d, h(ne, {
        type: "default",
        icon: "fa fa-plus",
        onClick: a,
        children: "Add Folder"
      }), null), w(g, h(B, {
        get when() {
          return e().length > 0;
        },
        get children() {
          var p = HM(), S = p.firstChild, _ = S.nextSibling;
          return w(_, h(de, {
            get each() {
              return e();
            },
            children: (m) => h(i5, {
              filter: m,
              selectedGroup: [i, s]
            })
          })), p;
        }
      }), null), w(g, h(B, {
        get when() {
          return i();
        },
        get children() {
          return h(r5, {
            get group() {
              return i();
            },
            activeFilter: [o, l],
            get setShowDialog() {
              return t.setShowDialog;
            }
          });
        }
      }), null), c;
    }
  });
}
function r5(t) {
  const e = Nt(ph), n = P(() => {
    const u = t.group.filterGroupGU;
    return vt.allFilters.filter((d) => d.primaryGU === e.primaryObjectGU).filter((d) => d.filterGroupGU === u).sort((d, f) => d.order - f.order);
  }), [r, i] = I(), [s, o] = I(), [l, a] = I(!1);
  Z(() => a(!!s())), Z(() => {
    const u = l(), d = s();
    !u && d && o(void 0);
  });
  function c(u) {
    window.ST.OpenViewInDialog && (t.setShowDialog(!1), window.ST.OpenViewInDialog(t5, u).always((d) => {
      d.closest(".modal").on("hidden.bs.modal", () => t.setShowDialog(!0));
    }));
  }
  return (() => {
    var u = WM();
    return w(u, h(de, {
      get each() {
        return n();
      },
      children: (d) => (() => {
        var f = JM(), g = f.firstChild, p = g.nextSibling;
        return Le(droppable, f, () => new _y(t.group, d)), Le(draggable, f, () => new uc(t.group, d)), w(g, h(B, {
          get when() {
            return d === r();
          },
          get children() {
            return h(dt, {
              placeholder: "Filter Name",
              get value() {
                return d.name$;
              },
              selected: !0,
              focused: !0,
              onEnterKey: () => i(void 0),
              onBlur: () => i(void 0)
            });
          }
        }), null), w(g, h(B, {
          get when() {
            return d !== r();
          },
          get children() {
            return d.name$[0]();
          }
        }), null), w(p, h(Dt, {
          label: "Edit",
          icon: "fa fa-edit",
          onClick: () => requestAnimationFrame(() => i(d))
        }), null), w(p, h(Dt, {
          label: "Share",
          icon: "fa fa-share",
          onClick: () => c(d.filterGU)
        }), null), w(p, h(Dt, {
          label: "Delete",
          icon: "fa fa-remove",
          onClick: () => {
            Xv("Delete Filter", "This operation cannot be undone. Do you want to delete this filter?").then(() => {
              vt.removeFilter(d);
            });
          }
        }), null), R(() => f.classList.toggle("drop-target", !!d.isDropTarget[0]())), f;
      })()
    })), u;
  })();
}
function i5(t) {
  const e = t.filter, n = vt.allGroups.find((r) => e.filterGroupGU === r.filterGroupGU);
  return (() => {
    var r = QM(), i = r.firstChild, s = i.firstChild, o = s.nextSibling;
    o.nextSibling;
    var l = i.nextSibling;
    return Le(droppable, r, () => new _y(n, e)), Le(draggable, r, () => new uc(n, e)), w(i, () => e.name$[0](), s), w(i, () => e.fromUser, o), w(l, h(Dt, {
      label: "Add",
      icon: "fa fa-add",
      onClick: () => vt.acceptSharedFilter(t.filter, t.selectedGroup[0]()?.filterGroupGU)
    }), null), w(l, h(Dt, {
      label: "Delete",
      icon: "fa fa-remove",
      onClick: () => vt.removeSharedFilter(t.filter)
    }), null), R(() => r.classList.toggle("drop-target", !!e.isDropTarget[0]())), r;
  })();
}
class s5 {
  editingGroup;
  selectedGroup;
}
const Sy = bt(new s5());
function o5(t) {
  const e = P(() => vt.allGroups.filter((n) => !n.parentGroupGU).sort((n, r) => n.order - r.order));
  return Z(() => {
    t.selectedGroup[0]() || t.selectedGroup[1](e()[0]);
  }), h(Sy.Provider, {
    value: t,
    get children() {
      return [h(de, {
        get each() {
          return e();
        },
        children: (n) => h(Xu, {
          group: n
        })
      }), h(Xu, {
        group: new to({
          filterGroupGU: "",
          groupName: "Other",
          order: 0
        })
      })];
    }
  });
}
function Xu(t) {
  const e = t.group, n = Nt(Sy), r = P(() => vt.allGroups.filter((d) => e.filterGroupGU && d.parentGroupGU === e.filterGroupGU).sort((d, f) => d.order - f.order)), [i, s] = n.editingGroup, [o, l] = n.selectedGroup, a = P(() => vt.isGroupExpanded(t.group?.filterGroupGU || "")), c = P(() => {
    const d = Nt(ph);
    return vt.allFilters.filter((f) => f.primaryGU === d.primaryObjectGU).filter((f) => f.filterGroupGU === t.group.filterGroupGU);
  });
  function u(d) {
    Xv("Delete Group", "This operation cannot be undone. Do you want to delete this group?").then(() => {
      Un.DeleteGroup(d.filterGroupGU);
      const f = vt.allGroups.filter((p) => p.filterGroupGU !== d.filterGroupGU).map((p) => new to(p)), g = vt.allFilters.map((p) => new no(p));
      for (const p of g)
        p.filterGroupGU === d.filterGroupGU && (p.filterGroupGU = "");
      ln("allFilters", g), ln("allGroups", f);
    });
  }
  return (() => {
    var d = e5();
    return Le(draggable, d, () => e.filterGroupGU ? new wy(e) : void 0), Le(droppable, d, () => new VM(e)), Le(droppable, d, () => new FM(e)), w(d, h(B, {
      get when() {
        return P(() => !!e.name[0]())() && i() !== e;
      },
      get children() {
        var f = XM(), g = f.firstChild, p = g.nextSibling, S = p.firstChild, _ = S.nextSibling;
        return _.nextSibling, w(f, h(B, {
          get when() {
            return r().length > 0;
          },
          get children() {
            var m = KM();
            return m.$$click = () => vt.toggleExpandedGroup(e.filterGroupGU || ""), R(() => D(m, `fa ${a() ? "fa-caret-down" : "fa-caret-right"}`)), m;
          }
        }), g), p.$$click = () => l(e), w(p, () => e.name[0](), S), w(p, () => c().length, _), w(f, h(B, {
          get when() {
            return e.filterGroupGU;
          },
          get children() {
            var m = YM();
            return w(m, h(Dt, {
              icon: "fa fa-edit s-link",
              label: "Edit",
              onClick: () => s(e)
            }), null), w(m, h(Dt, {
              icon: "fa fa-times s-link",
              label: "Delete",
              onClick: () => u(e)
            }), null), m;
          }
        }), null), R((m) => {
          var y = a(), v = e.filterGroupGU === o()?.filterGroupGU;
          return y !== m.e && ye(f, "aria-expanded", m.e = y), v !== m.t && f.classList.toggle("active", m.t = v), m;
        }, {
          e: void 0,
          t: void 0
        }), f;
      }
    }), null), w(d, h(B, {
      get when() {
        return i() === e;
      },
      get children() {
        var f = ZM();
        return w(f, h(dt, {
          get value() {
            return e.name;
          },
          selected: !0,
          focused: !0,
          onEnterKey: () => {
            Un.UpdateGroup(e), s(void 0);
          },
          onBlur: () => {
            Un.UpdateGroup(e), s(void 0);
          },
          style: "font-weight: bold;"
        })), f;
      }
    }), null), w(d, h(de, {
      get each() {
        return r();
      },
      children: (f) => h(Xu, {
        group: f
      })
    }), null), R((f) => {
      var g = !!e.isDropTarget[0](), p = !!e.isDragging[0]();
      return g !== f.e && d.classList.toggle("drop-target", f.e = g), p !== f.t && d.classList.toggle("dragging", f.t = p), f;
    }, {
      e: void 0,
      t: void 0
    }), d;
  })();
}
Xe(["click"]);
var l5 = /* @__PURE__ */ T('<span class="fa fa-check-circle filtered-check"role=presentation>'), a5 = /* @__PURE__ */ T('<div class=filter-checklists style="border-left:1px solid var(--st-color-border);white-space:nowrap"><h3>Checklist Filters</h3><div class="layout-table middle padded"style=overflow:auto><label class=layout-row><span class=layout-column><input type=radio name=filter-checklist></span><span class=layout-column>None'), c5 = /* @__PURE__ */ T('<div class="flexbox horizontal padded nowrap"><div><div class="flexbox horizontal middle"><h3 class=auto>User Filters</h3><div></div></div><div style=overflow-y:auto;overflow-x:hidden;max-height:480px>'), u5 = /* @__PURE__ */ T('<div id=REV_FILTERS class="REV_FILTERS REV_MENU">'), d5 = /* @__PURE__ */ T("<label class=layout-row><span class=layout-column><input type=radio name=filter-checklist></span><span class=layout-column>"), h5 = /* @__PURE__ */ T("<span class=st-badge>"), f5 = /* @__PURE__ */ T('<span aria-label=Collapse><i class="fa fa-caret-down"role=presentation>'), g5 = /* @__PURE__ */ T('<span aria-label=Expand><i class="fa fa-caret-right"role=presentation>'), p5 = /* @__PURE__ */ T('<div class="flexbox horizontal middle padded"role=button style=cursor:pointer><h4>'), m5 = /* @__PURE__ */ T("<ul class=filter-list>"), v5 = /* @__PURE__ */ T("<div class=filter-group>"), y5 = /* @__PURE__ */ T("<li>");
class b5 {
  openEditor;
  refresh;
  onSelectionChanged;
}
class mh {
  primaryObjectGU = "";
  events = new b5();
  showDropdown = !1;
  showFilterEditor = !1;
  getSharedFilters() {
    return vt.sharedFilters.filter((e) => e.primaryGU === this.primaryObjectGU);
  }
  getFilters() {
    return vt.allFilters.filter((e) => e.primaryGU === this.primaryObjectGU);
  }
}
const xy = bt(new mh()), w5 = () => Nt(xy);
function Zu(t) {
  const e = P(() => {
    const p = new mh();
    return p.primaryObjectGU = t.primaryObjectGU, p;
  }), n = P(() => e().getSharedFilters()), r = P(() => e().getFilters()), i = P(() => vt.allChecklists.filter((p) => p.objectID === e().primaryObjectGU)), s = P(() => vt.allGroups.map((p) => p).sort((p, S) => p.order - S.order)), [o, l] = I(t.showFilterEditor), [a, c] = I(t.showDropdown || t.showFilterEditor), u = P(() => vt.checklistPrefs[e().primaryObjectGU]?.userFilterCollectionGU ?? ""), d = P(() => {
    const p = r().filter((_) => _.isEnabled[0]()), S = !!u();
    return p.length > 0 || S;
  }), f = P(() => r().length > 0 || i().length > 0 || n().length > 0);
  Z(() => l(t.showFilterEditor)), Z(() => {
    r().filter((m) => m.isEnabled[0]()), u();
    const p = f(), S = js(a), _ = js(o);
    (S || _) && t.events.onSelectionChanged && p && requestAnimationFrame(() => {
      t.events.onSelectionChanged();
    });
  }), t.events.openEditor = () => {
    c(!0), l(!0);
  }, t.events.refresh = () => {
    vt.init();
  };
  const g = P(() => a() || o());
  return h(xy.Provider, {
    get value() {
      return e();
    },
    get children() {
      return h(B, {
        get when() {
          return f();
        },
        get children() {
          var p = u5();
          return w(p, h(Ve, {
            class: "REV_FILTERS",
            open: [g, c],
            get children() {
              return [h(Ve.Trigger, {
                as: ne,
                label: "Filters",
                icon: "fa fa-filter",
                type: "default",
                style: "padding-left: 0.5em",
                get children() {
                  return l5();
                }
              }), h(Ve.Content, {
                get children() {
                  var S = c5(), _ = S.firstChild, m = _.firstChild, y = m.firstChild, v = y.nextSibling, x = m.nextSibling;
                  return w(v, h(Dt, {
                    icon: "fa fa-edit",
                    label: "Edit Filters",
                    onClick: () => l(!0),
                    get children() {
                      return h(B, {
                        get when() {
                          return n().length > 0;
                        },
                        get children() {
                          return h(_5, {
                            get value() {
                              return n().length;
                            }
                          });
                        }
                      });
                    }
                  })), w(x, h(de, {
                    get each() {
                      return s();
                    },
                    children: (C) => h(jg, {
                      group: C
                    })
                  }), null), w(x, h(jg, {
                    group: void 0
                  }), null), w(S, h(B, {
                    get when() {
                      return i().length > 0;
                    },
                    get children() {
                      var C = a5(), E = C.firstChild, k = E.nextSibling, L = k.firstChild, M = L.firstChild, G = M.firstChild;
                      return G.$$input = () => vt.updateCollectionGU(e().primaryObjectGU, ""), w(k, h(de, {
                        get each() {
                          return i();
                        },
                        children: (Y) => (() => {
                          var ie = d5(), X = ie.firstChild, V = X.firstChild, U = X.nextSibling;
                          return V.$$input = () => vt.updateCollectionGU(Y.objectID || "", Y.collectionGU || ""), w(U, () => Y.name), R(() => ie.classList.toggle("checked", u() === Y.collectionGU)), R(() => V.value = Y.collectionGU), R(() => V.checked = u() === Y.collectionGU), ie;
                        })()
                      }), null), R(() => L.classList.toggle("checked", !u())), R(() => G.checked = !u()), C;
                    }
                  }), null), S;
                }
              })];
            }
          }), null), w(p, h(Gt, {
            class: "st-edit-filter-modal",
            show: [o, l],
            title: "Edit Filters",
            get children() {
              return h(n5, {
                get primaryObjectGU() {
                  return t.primaryObjectGU;
                },
                setShowDialog: l
              });
            }
          }), null), R(() => p.classList.toggle("filtered", !!d())), p;
        }
      });
    }
  });
}
Zu.defaultProps = new mh();
function _5(t) {
  return h(B, {
    get when() {
      return t.value;
    },
    get children() {
      var e = h5();
      return w(e, () => t.value), e;
    }
  });
}
function jg(t) {
  const e = w5(), n = P(() => e.getFilters().filter((i) => !t.group && !i.filterGroupGU || i.filterGroupGU === t.group?.filterGroupGU)), r = P(() => vt.isGroupExpanded(t.group?.filterGroupGU || ""));
  return h(B, {
    get when() {
      return n().length > 0;
    },
    get children() {
      var i = v5();
      return w(i, h(B, {
        get when() {
          return t.group;
        },
        get children() {
          var s = p5(), o = s.firstChild;
          return s.$$click = () => vt.toggleExpandedGroup(t.group.filterGroupGU || ""), w(s, h(Zt, {
            get children() {
              return [h(Pe, {
                get when() {
                  return r();
                },
                get children() {
                  return f5();
                }
              }), h(Pe, {
                get when() {
                  return !r();
                },
                get children() {
                  return g5();
                }
              })];
            }
          }), o), w(o, () => t.group.name[0]()), s;
        }
      }), null), w(i, h(B, {
        get when() {
          return !t.group || r();
        },
        get children() {
          var s = m5();
          return w(s, h(de, {
            get each() {
              return n();
            },
            children: (o) => {
              let l = !1;
              return Z(() => {
                const a = o.isEnabled[0]();
                l && Un.SetFilter(o.filterGU, a), l = !0;
              }), (() => {
                var a = y5();
                return w(a, h(ut, {
                  get label() {
                    return o.name$[0]();
                  },
                  get value() {
                    return o.isEnabled;
                  }
                })), a;
              })();
            }
          })), R(() => s.classList.toggle("root", !t.group)), s;
        }
      }), null), i;
    }
  });
}
Xe(["input", "click"]);
Te.register("extract-data-editor", "st", tu.defaultProps, tu);
Te.register("inline-edit", "st", Hs.defaultProps, Hs);
Te.register("report-browser", "st", nu.defaultProps, nu);
Te.register("sm-generator", "st", su.defaultProps, su);
Te.register("st-accordion", "st", xr.defaultProps, xr);
Te.register("st-ai-loader", "st", Zi.defaultProps, Zi);
Te.register("st-alert", "st", qi.defaultProps, qi);
Te.register("st-banner-notifications", "st", au.defaultProps, au);
Te.register("st-button", "st", ne.defaultProps, ne);
Te.register("st-button-group", "st", Zn.defaultProps, Zn);
Te.register("st-camera-input", "st", ua.defaultProps, ua);
Te.register("st-card", "st", cu.defaultProps, cu);
Te.register("st-checkbox", "st", ut.defaultProps, ut);
Te.register("st-checkbox-list", "st", sa.defaultProps, sa);
Te.register("st-collaborative-edit", "st", Bu.defaultProps, Bu);
Te.register("st-component-wrapper", "st", Uu.defaultProps, Uu);
Te.register("st-confirmation-dialog", "st", Oa.defaultProps, Oa);
Te.register("st-customer-assist", "st", ju.defaultProps, ju);
Te.register("st-data-source-editor", "st", aa.defaultProps, aa);
Te.register("st-date-picker", "st", Yo.defaultProps, Yo);
Te.register("st-dorito", "st", li.defaultProps, li);
Te.register("st-dropdown", "st", Ve.defaultProps, Ve);
Te.register("st-find-result-panel", "st", Fu.defaultProps, Fu);
Te.register("st-grid", "st", La.defaultProps, La);
Te.register("st-grid-generator-btn", "st", Hu.defaultProps, Hu);
Te.register("st-group-box", "st", Qi.defaultProps, Qi);
Te.register("st-iac-menu", "st", zu.defaultProps, zu);
Te.register("st-icon", "st", vr.defaultProps, vr);
Te.register("st-image", "st", Ko.defaultProps, Ko);
Te.register("st-input", "st", dt.defaultProps, dt);
Te.register("st-job-queue-status", "st", Wu.defaultProps, Wu);
Te.register("st-memo-generator-btn", "st", iu.defaultProps, iu);
Te.register("st-menu", "st", Na.defaultProps, Na);
Te.register("st-modal", "st", Gt.defaultProps, Gt);
Te.register("st-person-notifications", "st", ca.defaultProps, ca);
Te.register("st-popover", "st", $r.defaultProps, $r);
Te.register("st-query-assist", "st", Pa.defaultProps, Pa);
Te.register("st-query-editor", "st", la.defaultProps, la);
Te.register("st-radio-group", "st", rt.defaultProps, rt);
Te.register("st-range-slider", "st", zs.defaultProps, zs);
Te.register("st-recur-pattern", "st", Qu.defaultProps, Qu);
Te.register("st-schedule-grid", "st", Ku.defaultProps, Ku);
Te.register("st-select", "st", Ee.defaultProps, Ee);
Te.register("st-spinner", "st", da.defaultProps, da);
Te.register("st-support-assist", "st", Da.defaultProps, Da);
Te.register("st-tab", "st", Ji.defaultProps, Ji);
Te.register("st-tab-group", "st", oa.defaultProps, oa);
Te.register("st-table", "st", kn.defaultProps, kn);
Te.register("st-textarea", "st", Qo.defaultProps, Qo);
Te.register("st-time-picker", "st", Ra.defaultProps, Ra);
Te.register("st-tool-button", "st", Dt.defaultProps, Dt);
Te.register("st-tree", "st", Yu.defaultProps, Yu);
Te.register("st-view", "st", ou.defaultProps, ou);
Te.register("st-view-control", "st", Ia.defaultProps, Ia);
Te.register("st-view-filters", "st", Zu.defaultProps, Zu);
export {
  xr as Accordion,
  SS as AccordionProps,
  Zi as AiLoader,
  qi as Alert,
  au as BannerNotifications,
  ne as Button,
  Zn as ButtonGroup,
  $b as ButtonProps,
  ua as CameraInput,
  hx as CameraInputProps,
  cu as Card,
  ut as Checkbox,
  sa as CheckboxList,
  Bu as CollaborativeEdit,
  eN as CollaborativeEditProps,
  Uu as ComponentWrapper,
  Oa as ConfirmationDialog,
  dN as ConfirmationDialogProps,
  ju as CustomerAssist,
  LN as CustomerAssistProps,
  aa as DataSourceEditor,
  Yo as DatePicker,
  MN as DatePickerProps,
  li as Dorito,
  Ve as Dropdown,
  op as DropdownMenuProps,
  tu as ExtractDataEditor,
  _0 as ExtractDataEditorProps,
  Fu as FindResultPanel,
  T2 as FindResultPanelProps,
  La as Grid,
  Gu as GridContext,
  c2 as GridContextType,
  Hu as GridGeneratorBtn,
  iy as GridStoreContext,
  Qi as GroupBox,
  Z2 as GroupBoxProps,
  zu as IacMenu,
  rP as IacMenuProps,
  vr as Icon,
  Ko as Image,
  yN as ImageProps,
  Hs as InlineEdit,
  I0 as InlineEditProps,
  dt as Input,
  pb as InputParams,
  TP as JobCategory,
  Wu as JobQueueStatus,
  EP as JobQueueStatusProps,
  Vu as LookupItem,
  iu as MemoGeneratorBtn,
  fd as MemoStoreContext,
  Na as Menu,
  Gt as Modal,
  ca as PersonNotifications,
  $r as Popover,
  Pa as QueryAssist,
  WP as QueryAssistProps,
  la as QueryEditor,
  rt as RadioGroup,
  P_ as RadioGroupContext,
  zs as RangeSlider,
  b_ as RangeSliderProps,
  Qu as RecurPattern,
  pR as RecurPatternProps,
  nu as ReportBrowser,
  g_ as ReportBrowserContent,
  f_ as ReportBrowserProps,
  gS as SMGeneratorOptions,
  J5 as ST,
  H_ as STAILoaderProps,
  x_ as STAlertParams,
  e0 as STButtonGroupProps,
  Xb as STCheckboxListProps,
  D0 as STCheckboxProps,
  aN as STComponentWrapperProps,
  V1 as STDataSourceContext,
  z1 as STDataSourceEditorProps,
  ZL as STGeneratorEvents,
  ny as STGridProps,
  G5 as STMenuItemProps,
  qP as STMenuProps,
  Sb as STModalProps,
  k1 as STQueryEditorContext,
  I1 as STQueryEditorProps,
  N_ as STRadioGroupProps,
  $5 as STRadioOptionProps,
  q_ as STToolButtonParams,
  Q5 as STTreeNode,
  AS as STViewProps,
  Ku as ScheduleGrid,
  Ee as Select,
  Jb as SelectProps,
  su as SmGenerator,
  da as Spinner,
  Da as SupportAssist,
  kN as SupportAssistProps,
  Ji as Tab,
  oa as TabGroup,
  V0 as TabGroupContext,
  H0 as TabGroupProps,
  Q0 as TabProps,
  kn as Table,
  pN as TextAreaProps,
  Qo as Textarea,
  Ra as TimePicker,
  rR as TimePickerProps,
  Dt as ToolButton,
  Yu as Tree,
  qM as TreeContextValue,
  ou as View,
  ja as ViewContextJSX,
  Ia as ViewControl,
  oN as ViewControlProps,
  Zu as ViewFilters,
  BN as formatDate,
  F5 as launchQueryAssist,
  kP as launchRI,
  Uh as loadView,
  lu as openViewInDialog,
  IS as openViewWindow,
  qN as parseDateInput,
  iR as parseTimeInput,
  I5 as requestWebcamPhoto,
  Ut as requireCalendarContext,
  XL as requireCollaborativeEditContext,
  j5 as requireIacMenuContext,
  ch as requireQueryAssistContext,
  R_ as requireRadioGroupContext,
  V5 as requireRecurPatternContext,
  B5 as requireSupportAssistContext,
  Ga as requireViewContext,
  sN as requireViewControlContext,
  Xv as showConfirmation,
  ip as showDialog,
  cd as useDataSourceEditor,
  J2 as useGridStore,
  cc as useJobQueueStatusContext,
  eS as useMemoStore,
  ad as useSTQueryEditor,
  Fa as useStPersonNotificationsContext,
  z0 as useTabGroup,
  UM as useTree,
  TS as useViewContext,
  w5 as useViewFiltersContext,
  AP as viewJob
};
//# sourceMappingURL=st.bundle.js.map
